{"data":[{"id":"18_1750899815.950","type":"feed","offset":18,"verb":"TOPIC_ACKNOWLEDGED_ARTICLE","created_time":1750899815,"updated_time":1750899815,"target":{"id":"1919038742376747430","type":"article","url":"https://api.zhihu.com/articles/1919038742376747430","author":{"id":"2e3c3ecec897745b58ba87c955ab9882","url":"https://api.zhihu.com/people/2e3c3ecec897745b58ba87c955ab9882","user_type":"organization","url_token":"imaginationtech","name":"ImaginationTechnologies","headline":"Shrapening U Competitive Edge","avatar_url":"https://pic1.zhimg.com/50/v2-180e327a7fa158b4938ac033aa2d4e75_l.jpg?source=b6762063","is_org":true,"gender":-1,"followers_count":4683,"is_following":false,"is_followed":false},"title":"并行计算的崛起：为什么GPU将在边缘AI中取代NPU","comment_permission":"all","created":1750314592,"updated":1750314592,"voteup_count":1,"voting":0,"comment_count":0,"linkbox":{"category":"","pic":"","title":"","url":""},"excerpt":"文章翻译自EEnews Europe 原文链接：https://www.eenewseurope.com/en/the-rise-of-parallel-computing-why-gpus-will-eclipse-npus-for-edge-ai/ 人工智能（AI）不仅是一项技术突破，它更是软件编写、理解和执行方式的一次永久性变革。传统的软件开发基于确定性逻辑和大多是顺序执行的流程，而如今这一范式正在让位于概率模型、训练行为以及数据驱动的计算。这并不是一时的潮流。AI 代表了计算机科学的一次根本性、不可逆的转变 —— 从基于规则的编程，迈向自适应的、基于学习的系统，这些系统正逐步被集成到越来越…","excerpt_new":"文章翻译自EEnews Europe 原文链接：https://www.eenewseurope.com/en/the-rise-of-parallel-computing-why-gpus-will-eclipse-npus-for-edge-ai/ 人工智能（AI）不仅是一项技术突破，它更是软件编写、理解和执行方式的一次永久性变革。传统的软件开发基于确定性逻辑和大多是顺序执行的流程，而如今这一范式正在让位于概率模型、训练行为以及数据驱动的计算。这并不是一时的潮流。AI 代表了计算机科学的一次根本性、不可逆的转变 —— 从基于规则的编程，迈向自适应的、基于学习的系统，这些系统正逐步被集成到越来越…","preview_type":"default","preview_text":"","content":"\u003cp data-pid=\"uoId3TVB\"\u003e\u003ci\u003e文章翻译自EEnews Europe\u003c/i\u003e\u003c/p\u003e\u003cp data-pid=\"dy5b97zv\"\u003e\u003ci\u003e原文链接：\u003ca href=\"https://link.zhihu.com/?target=https%3A//www.eenewseurope.com/en/the-rise-of-parallel-computing-why-gpus-will-eclipse-npus-for-edge-ai/\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003e\u003cspan class=\"invisible\"\u003ehttps://www.\u003c/span\u003e\u003cspan class=\"visible\"\u003eeenewseurope.com/en/the\u003c/span\u003e\u003cspan class=\"invisible\"\u003e-rise-of-parallel-computing-why-gpus-will-eclipse-npus-for-edge-ai/\u003c/span\u003e\u003cspan class=\"ellipsis\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/i\u003e\u003c/p\u003e\u003cp data-pid=\"R_albGs_\"\u003e人工智能（AI）不仅是一项技术突破，它更是软件编写、理解和执行方式的一次永久性变革。传统的软件开发基于确定性逻辑和大多是顺序执行的流程，而如今这一范式正在让位于概率模型、训练行为以及数据驱动的计算。这并不是一时的潮流。AI 代表了计算机科学的一次根本性、不可逆的转变 —— 从基于规则的编程，迈向自适应的、基于学习的系统，这些系统正逐步被集成到越来越广泛的计算问题与能力中。\u003c/p\u003e\u003cp data-pid=\"w7intFKg\"\u003e这一转变也对硬件提出了相应的变革需求。在AI架构和算法不断演进（并将持续演进）的时代，为狭窄定义任务而打造的高度专用芯片的旧模式已不再适用。为了满足不断变化的AI需求（尤其是在边缘侧)，我们需要具备与工作负载同样动态、适应能力强的计算平台。\u003cbr/\u003e\u003c/p\u003e\u003cp data-pid=\"urZIUI0u\"\u003e这正是为什么通用并行处理器（即GPU）正在成为边缘AI的未来，并开始取代诸如神经网络处理器（NPU）这样的专用处理器。这不仅仅是性能的问题 —— 更是关于灵活性、可扩展性，以及与未来软件发展方向保持一致的问题。\u003cbr/\u003e\u003c/p\u003e\u003cp data-pid=\"ZMNixV-4\"\u003e\u003cb\u003eMakimoto波动理论与“灵活性”的回归\u003c/b\u003e\u003c/p\u003e\u003cp data-pid=\"TDjyiKW-\"\u003e要理解这一转变，我们只需回顾“Makimoto波动理论”：这是由日本工程师牧本次雄（Tsugio Makimoto）提出的一个概念，描述了计算产业在不同阶段不断在“标准化”与“定制化”之间摆动的趋势，其背后是市场需求、技术创新和软件复杂性等因素的持续变化。\u003cbr/\u003e（Makimoto 波动理论展现了计算产业在“灵活性”与“专用性”之间的历史摆动。而当前AI的发展轨迹，标志着计算正再次呈现出在“灵活性”和“通用平台”之间的摆动。）\u003cbr/\u003e这一模型与AI硬件的演变过程高度契合。在AI发展的早期阶段，工作负载较为明确且稳定，此时采用NPU等固定功能加速器是合理的。这类处理器对特定任务（例如使用CNN进行图像分类或目标检测）进行了深度优化。\u003cbr/\u003e但如今AI已进入高速演进阶段。我们已走出简单、静态模型的时代，迈入混合网络、Transformer架构、基础模型和持续创新的浪潮之中。为去年AI打造的定制硬件，根本无法跟上当今的发展节奏。\u003cbr/\u003e我们再次站在了“Makimoto拐点”上 —— 从专用硬件，回归到可扩展、可适配的通用计算平台。\u003c/p\u003e\u003cp data-pid=\"zh9RW8mZ\"\u003e\u003cb\u003eAI是一个并行计算问题，而非专用计算问题\u003c/b\u003e\u003cbr/\u003eAI的本质在于并行计算。深度学习严重依赖并发操作 —— 矩阵运算、张量乘法、向量计算 —— 这些正是GPU天生擅长的工作负载。能够同时渲染数百万像素的架构，如今正好可以处理数百万神经元的激活。\u003cbr/\u003e如今的通用GPU早已不仅仅用于图形处理。它们拥有可编程管线、计算着色器，以及日益增强的AI中心化设计，不仅能加速传统负载，也能支持新兴的AI工作负载，是边缘AI中强大而灵活的计算引擎。\u003cbr/\u003e相比之下，像NPU这样的专用处理器则难以应对持续的变革。它们对特定操作进行了优化，而当AI领域快速演进时，这些芯片便迅速被淘汰。显然，面对这种全新的软件范式，我们需要的是一种通用的、并行的、灵活的硬件平台 —— GPU。\u003cbr/\u003e\u003c/p\u003e\u003cp data-pid=\"2qxbIKmw\"\u003e\u003cb\u003e为什么通用平台在边缘侧更具优势\u003c/b\u003e\u003cbr/\u003e边缘AI不仅需要性能，更需要适应性、可重用性与较长的生命周期。现代GPU等通用并行处理器在这几个方面均具备明显优势：\u003c/p\u003e\u003cul\u003e\u003cli data-pid=\"OWNTL9KZ\"\u003e\u003cb\u003e灵活性\u003c/b\u003e：可编程，能够支持新的模型类型而无需更换硬件；\u003c/li\u003e\u003cli data-pid=\"TtyjgAYM\"\u003e\u003cb\u003e可扩展性\u003c/b\u003e：可适配从IoT传感器到智能摄像头再到自动驾驶汽车等各种边缘设备；\u003c/li\u003e\u003cli data-pid=\"uKl_U0Ao\"\u003e\u003cb\u003e软件生态成熟\u003c/b\u003e：拥有丰富的开源工具与开发标准（如OpenCL、LiteRT、TVM）；\u003c/li\u003e\u003cli data-pid=\"75RAfHiy\"\u003e\u003cb\u003e可持续性\u003c/b\u003e：延长产品生命周期，减少不断重新设计芯片的需求。\u003c/li\u003e\u003c/ul\u003e\u003cp data-pid=\"oo39Sw-N\"\u003e简而言之，GPU的通用并行计算从架构层面就为AI的持续演进而设计。\u003c/p\u003e\u003cp data-pid=\"9t5xGfsR\"\u003e\u003cbr/\u003e\u003cb\u003e展望未来\u003c/b\u003e\u003cbr/\u003e\u003cbr/\u003e尽管有越来越多的证据说明GPU具备的优势，市场仍然习惯将AI加速与NPU或定制芯片划等号。但正如图形行业早年发现，固定功能的图形管线无法跟上游戏创新的节奏，如今AI行业也发现：固定硬件无法匹配快速变化的软件需求。\u003cbr/\u003e是时候重新教育整个生态了。边缘AI的未来不属于那些高度优化但功能狭窄的芯片，而是属于可编程的、可适配的并行计算平台，它们能与智能软件共同成长并扩展。\u003cbr/\u003e几十年前，Makimoto就洞察了这一趋势。如今，我们正在亲身经历他的远见 —— 顺应着通用性和灵活性的浪潮前行。GPU 不再是追赶者，它已处于领先位置。\u003c/p\u003e","is_labeled":false,"visited_count":88,"favorite_count":2,"article_type":"normal","is_navigator":false,"navigator_vote":false,"vote_next_step":"vote"},"brief":"{\"source\": \"TS\", \"type\": \"article\", \"id\": 1919038742376747430}","attached_info":"CpgFCPmL+abA1MCFogEQBxoJMjU5Mjg0MzQ2IODczsIGKAEwAEASSjAKBkl0ZW1DRhIgZG9jX3R5cGU6IEFydGljbGUKaWQ6IDI1OTI0ODgwMAoYACAAOgBiIGE2MGJjOTE5YzhkODM1ZDZjZWU5YmE2NDA2Y2E2Y2YychMxOTE5MDM4NzQyMzc2NzQ3NDMwqgEJcmVjb21tZW5kwgEgMmUzYzNlY2VjODk3NzQ1YjU4YmE4N2M5NTVhYjk4ODLyAQoIDBIGTm9ybWFs8gEoCAoSJDNhZDBkNTgwLTBhMWUtNGI2YS04MGJjLTMzZjQ3ZGI3N2VhZvIBBQgLEgE0ggIAiAL/6YvO+jKSAiAyZTNjM2VjZWM4OTc3NDViNThiYTg3Yzk1NWFiOTg4MpoCAMoCFlNob3JJbnRlcmVzdFdlaWdodFJ1bGXKAhhQZXJpb2RJbnRlcmVzdFdlaWdodFJ1bGXKAhVVc2VyTGNuRXhpdFdlaWdodFJ1bGXaAgZJdGVtQ0boAgL6AgtOT1JNQUxfRkxPV4oDIDNhNjk1YjY3YjczNjQ4YjA4ZDhjZjIzYzNiYzVjYWYwmgMNCgJ2MhAAGgVvdGhlcqgDWNgDAOoDFXRleHRBbGxTaXRlTXZJdGVtQ0ZWMvoDHxIMVU5LTk9XTl9NT0RFIAAqDU5PX0lNQUdFX01PREWABACIBACSBAZOb3JtYWyaBAEyoAQAqAQAsAQAugQCYWnCBAM0MDDIBADSBA/mjqjojZDlt7Lmm7TmlrDYBADwBAD5BAAAACDhX6M/gQUAAAAAAAAAAIkFiyXxOlgz0T+SBQCaBQNkZnSiBQNkZnSyBQExuQUAAAAAAAAAANAFAOAFAOgFAPAFBJAGAKAGEqgGAZICLgoJMjU5Mjg0MzQ2EhMxOTE5MDM4NzQyMzc2NzQ3NDMwGAciCklNQUdFX1RFWFQ=","action_card":false},{"id":"19_1750899815.378","type":"feed","offset":19,"verb":"TOPIC_ACKNOWLEDGED_ARTICLE","created_time":1750899815,"updated_time":1750899815,"target":{"id":"1912760136939836775","type":"article","url":"https://api.zhihu.com/articles/1912760136939836775","author":{"id":"fa0776e37a7227705cd697558389d586","url":"https://api.zhihu.com/people/fa0776e37a7227705cd697558389d586","user_type":"people","url_token":"zhao-jun-min-80","name":"赵俊民","headline":"探索技术","avatar_url":"https://picx.zhimg.com/50/v2-3071382b74338d29ea9215503abf068d_l.jpg?source=b6762063","is_org":false,"gender":1,"followers_count":11079,"is_following":false,"is_followed":false},"title":"读《雪球特别版：段永平投资问答录（商业逻辑篇）》","comment_permission":"all","created":1748818217,"updated":1748852695,"voteup_count":2,"voting":0,"comment_count":0,"linkbox":{"category":"","pic":"","title":"","url":""},"excerpt":"没有强大的文化，就不会有伟大的公司1，本分：做正确的事，把事做正确 2，确定自己的stop doing list，反向思考，不知道哪些是正确的事，那就不要做一定不正确的事情。如不诚信，欺骗，攻击别人等 ◆ 段永平：利润之上的追求指的是把消费者需求放在公司短期利益前面。 ◆段永平：好的企业和企业家都是理想主义和现实主义的结合。没有理想主义做不大，不理解现实走不远 长长的坡，厚厚的雪——滚雪球◆ 我投资的标准很简单：商业…","excerpt_new":"没有强大的文化，就不会有伟大的公司1，本分：做正确的事，把事做正确 2，确定自己的stop doing list，反向思考，不知道哪些是正确的事，那就不要做一定不正确的事情。如不诚信，欺骗，攻击别人等 ◆ 段永平：利润之上的追求指的是把消费者需求放在公司短期利益前面。 ◆段永平：好的企业和企业家都是理想主义和现实主义的结合。没有理想主义做不大，不理解现实走不远 长长的坡，厚厚的雪——滚雪球◆ 我投资的标准很简单：商业…","preview_type":"default","preview_text":"","content":"\u003cp data-pid=\"4vLh28qs\"\u003e\u003cb\u003e没有强大的文化，就不会有伟大的公司\u003c/b\u003e\u003c/p\u003e\u003cp data-pid=\"jJSXRg5O\"\u003e1，本分：做正确的事，把事做正确\u003c/p\u003e\u003cp data-pid=\"EMyFUyf9\"\u003e2，确定自己的stop doing list，反向思考，不知道哪些是正确的事，那就不要做一定不正确的事情。如不诚信，欺骗，攻击别人等\u003c/p\u003e\u003chr/\u003e\u003cp data-pid=\"EiPzj-d3\"\u003e◆ 段永平：利润之上的追求指的是把消费者需求放在公司短期利益前面。\u003c/p\u003e\u003cp data-pid=\"PPW7luoD\"\u003e◆段永平：好的企业和企业家都是理想主义和现实主义的结合。没有理想主义做不大，不理解现实走不远\u003c/p\u003e\u003cp data-pid=\"UP2xMcVB\"\u003e\u003cb\u003e长长的坡，厚厚的雪——滚雪球\u003c/b\u003e\u003c/p\u003e\u003cp data-pid=\"NEkVJYkJ\"\u003e◆ 我投资的标准很简单：商业模式，企业文化，合理价钱。所以当商业模式和企业文化不错的公司价钱也不错时，我就会有兴趣。(2019-03-16)\u003c/p\u003e\u003cp data-pid=\"9Gsje79S\"\u003e◆ 价值投资最重要的是什么？段永平：right business,right people,right price.（对的生意，对的人，对的价钱。）这是老巴说的。对的生意说的就是生意模式，对的人指的就是企业文化。Price没有那么重要，business和people最重要。Culture跟founder（创始人）有很大关系。 商业模式最重要\u003c/p\u003e\u003cp data-pid=\"4dyrqTmB\"\u003e◆ 差异化是好商业模式的前提。简单讲一下差异化：就是用户需要但其他竞争对手满足不了的某些东西。(2018-11-05)\u003c/p\u003e\u003cp data-pid=\"oDmSrmoz\"\u003e◆ 投资确实就是买的未来的现金流（折现），未来现金流（折现）最大的保障就是“商业模式”，商业模式里最强的就是垄断，或者叫“护城河”。(2012-03-30)\u003c/p\u003e\u003cp data-pid=\"EKufdjTy\"\u003e◆ 能涨价的东西就表示他有“护城河”，能体会出这点来还是很有天赋的。\u003c/p\u003e\u003cp data-pid=\"BhRmpW82\"\u003e◆ 段永平：管理层不好的公司怎么会有很深的护城河呢？费解。(2013-04-02)段永平：“护城河”是用来判断公司内在价值的一个重要手段（不是唯一的）。\u003c/p\u003e\u003cp data-pid=\"iIqtuKcf\"\u003e◆ 最重要的是正直和诚信。要有好的企业文化做支撑\u003c/p\u003e\u003cp data-pid=\"p1O0GsYb\"\u003e◆ 明白差异化最简单的办法就是把自己当消费者，想象一下自己的体验，自己常去哪里，因为什么而改变等等。\u003c/p\u003e\u003cp data-pid=\"n9fp623f\"\u003e◆ 公司的企业文化是由3个部分组成的：使命、愿景以及核心价值观。 使命指的的企业存在的意义（“Mission”是为什么成立）；愿景是企业内大家的共同远景（“Vision”是我们要去哪里）；核心价值观“Core Values”是哪些事情是对的，哪些事情是不对。大是大非的问题。(2010-11-12)\u003c/p\u003e\u003cp data-pid=\"0A0jndMi\"\u003e◆ 愿景就是大家共同的远景的意思。没有愿景的公司容易陷入利润导向，最后容易被眼前利益诱惑而犯大错，从而导致公司寿命缩短\u003c/p\u003e\u003cp data-pid=\"amW9_h6S\"\u003e◆ 深读一个公司的企业文化并长期观察它是否言行一致非常有利于理解一个公司。\u003c/p\u003e\u003cp data-pid=\"t2V_SaV1\"\u003e◆ 理解的本分就是：“做对的事情、把事情做对”\u003c/p\u003e\u003cp data-pid=\"L0LLZ4eh\"\u003e◆ “不做的事情”其实也分两类：一类是谁都不应该做的事情，比如欺骗；另一类是和自己公司的使命和愿景相违背的。\u003c/p\u003e\u003cp data-pid=\"gJNdyDBB\"\u003e◆ 平常心其实就是在任何时候，尤其是在有诱惑的时候，能够排除所有外界的干扰，回到事物的本质（原点），辨别事情的是非与对错，知道什么是对的事情。\u003c/p\u003e\u003cp data-pid=\"lqOQUkz2\"\u003e◆ 《清静经》上说“人能常清静，天地悉皆归”。 平常心就是回到事物本源的心态，\u003c/p\u003e\u003cp data-pid=\"v9jbCiWo\"\u003e◆ 段永平：本分就是要做对的事情和要把事情做对。平常心就是回到事物本源的心态，也就是要努力认清什么是对的事情，认清事物的本质。(2019-09-23)\u003c/p\u003e\u003cp data-pid=\"0HZvAc5U\"\u003e◆ 信誉不是讲讲而已，只有需要付出代价的时候，才知道谁是讲（守）信誉的。原则是不应该有时间性的。(2012-11-17)\u003c/p\u003e\u003cp data-pid=\"I4wWx6dx\"\u003e◆ 如果我们要倒下的话，一定不要倒的很难看，不要欠员工钱，不要欠供应商钱，要尽量保护代理商……。我们12年没亏钱，13年没亏钱，但12-13年那一整年亏了非常多的钱，到13年中终于挺过来了\u003c/p\u003e\u003cp data-pid=\"q6ivZEu-\"\u003e◆ 选人本分诚信比聪明重要，合适性比合格性重要。(2019-09-10)\u003c/p\u003e\u003cp data-pid=\"MGrGEC4C\"\u003e◆ 段永平：老板给员工加薪或者发奖金其实都是员工该得的，非常不喜欢那种“恩赐”的感觉。(2018-09-2\u003c/p\u003e\u003cp data-pid=\"ExjCOPoj\"\u003e◆ 段永平：凡是员工见到领导就战战兢兢的公司，时间长了都会出问题的。因为这种公司员工大多都会慢慢变得没有担待，凡事希望交给上级去决定，效率慢慢会降低。除非这种公司的产品非常聚焦，大老板确实可以照顾到所有大方面，不然早晚会出问题的。我觉得日本企业这些年在有些行业出问题就是这个原因。(2018-09-22)\u003c/p\u003e\u003cp data-pid=\"oXdUXSlO\"\u003e◆ 段永平：发现用户需求的诀窍可能是总是站在用户的立场想问题。(2010-03-30)\u003c/p\u003e\u003cp class=\"ztext-empty-paragraph\"\u003e\u003cbr/\u003e\u003c/p\u003e\u003cp data-pid=\"d-HUhGuD\"\u003e◆ 很久以前黄峥曾经问过我一个问题：用户导向是放之四海而皆准的吗？我说，I believe so!I think he got the point！(2019-05-15)\u003c/p\u003e\u003cp data-pid=\"Z5zs3myD\"\u003e◆ 企业文化是指现阶段企业员工所普遍认同并自觉遵循的一系列理念和行为方式的总和，通常表现为企业价值观、行为、准则、道德规范和沿袭的传统与习惯等。\u003c/p\u003e\u003cp data-pid=\"Llc6HTa-\"\u003e◆ 段永平：任何对日本人的轻视都可能是愚蠢和危险的。\u003c/p\u003e\u003cp data-pid=\"C37HaGFX\"\u003e◆ 希望你什么时候能明白把鸡蛋多放几个篮子其实是有效提高抗风险的最好办法，虽然能明白这个东东非常不容易。\u003c/p\u003e\u003cp data-pid=\"ib31CIBJ\"\u003e◆ 段永平：我觉得看书可能不如看企业来的明白。书可以看《基业长青》，企业可以看苹果这些年的产品发布会（每年九月份的那个就好），或者多看几遍老巴在大学的问答交流。\u003c/p\u003e\u003cp data-pid=\"Kjjlz1bm\"\u003e◆ 伟大的产品是我们的“北极星”。在所有员工每天上班时，他们都会以此为目标。我们不会去做任何自认为不够伟大的产品；有些公司会这样做，但我们不会\u003c/p\u003e\u003cp data-pid=\"Mut6UdK5\"\u003e◆ 库克：我擅长于屏蔽噪音。我会回到核心问题：我们在做正确的事情吗？仍然记得自己的方向吗？我们是否专注于制造最好的设备，从而通过某种方式让人们的生活变得更丰富？\u003c/p\u003e\u003cp data-pid=\"GvaDjEFy\"\u003e◆ 段永平：能明白贵与便宜的关系非常不容易啊，绝大部分人大概一辈子都很难明白的。\u003c/p\u003e\u003cp data-pid=\"7n5qpn_5\"\u003e◆ 差异化其实就是顾客需要但别人没能满足的需求。千万别简单地理解成不一样。差异化的好产品一般都是长期积累厚积薄发出来的，当然偶尔也有运气的成分，但长期来讲，运气的成分可以忽略\u003c/p\u003e\u003cp data-pid=\"-LPu8N_V\"\u003e◆ We believe that technology is at it\u0026#39;s very best,at its most empowering,when it simply disappears.”(2013-09-11)\u003c/p\u003e\u003cp data-pid=\"SISUZiO6\"\u003e◆ “We believe that technology is at it\u0026#39;s very best,at its most empowering,when it simply disappears.”我的理解是：最牛的技术就是用户看不到的技术（技术消失的时候\u003c/p\u003e\u003cp data-pid=\"r_EO8NoT\"\u003e◆ 品牌最忌讳的就是用有含义的名字，因为本来含义就是应该通过产品去赋予的， 所谓品牌其实就是某种（些）差异化的浓缩。\u003c/p\u003e\u003cp data-pid=\"DnHlEQp3\"\u003e◆ 段永平：社会信任度越低，品牌的作用越大。(2010-07-08)\u003c/p\u003e\u003cp data-pid=\"VlrdKLGp\"\u003e◆ 营销不是本质，本质是产品。营销最重要的，就是不能瞎说。\u003c/p\u003e\u003cp data-pid=\"AIK2ePgg\"\u003e◆ 段永平：他说得很对，因为他知道消费者想要什么。知道消费者想要什么是一件非常困难的事，没听说市场调研可以解决这个问题。\u003c/p\u003e\u003cp data-pid=\"uOZzAYe6\"\u003e◆ 市场调研只能够帮你印证你的想法而已，你如果自己没想法市调是绝对没用的。其实苹果还是会做一些市调的，比如偶尔放点消息出来看看反映什么的。(2011-02-26)\u003c/p\u003e\u003cp data-pid=\"dstllFR3\"\u003e◆ 企业不是什么事都做，这是一种本分。也就是遵循“焦点法则”，把80%的精力放在20%的事情上，那么20%的事情会带来80%的效益。有多大能力做多大的事，而不是有多大的胆量。\u003c/p\u003e\u003cp data-pid=\"qGNYVAIC\"\u003e◆ 最不好的广告就是夸大其词的广告，靠这种广告的公司最后都不会有好下场，因为消费者长期来讲是个极聪明的群体。\u003c/p\u003e\u003cp data-pid=\"UlYIHIR2\"\u003e◆ 这里讲个最基本的广告概念：广告不会赋予产品任何东西。广告只是表达产品而已，好的广告表达的效率高。一个好的广告的制作是非常不容易的，而且大多成本很高，不了解的人很难想象\u003c/p\u003e\u003cp data-pid=\"kQdcoZJD\"\u003e◆ 段永平：苹果不太做推销式广告，做的基本上都是功能性或场景式广告。苹果广告见效慢点，但影响深，长期的潜移默化力量很大。(2016-05-09)\u003c/p\u003e\u003cp data-pid=\"10-tATcK\"\u003e◆ 小公司的广告则应该以销售广告为主，尤其是搜索广告可能最好，因为搜索广告更精准且较容易算出投入产出比。有些公司广告费比营业额高是肯定有毛病的，但问题出在哪里只有花钱的人才能最后找到，如果他们寿命足够长的话。(2011-11-08)\u003c/p\u003e\u003cp data-pid=\"PrcmG9NP\"\u003e◆ 。所谓要做对的事情实际上是通过不做不对的事情来实现的，这就是为什么要有stop doing list，意思就是“不做不对的事情”或者是立刻停止做那些不对的事情。\u003c/p\u003e\u003cp data-pid=\"nQ6cDW3C\"\u003e◆ 段永平：信誉不是讲讲而已，只有需要付出代价的时候，才知道谁是讲（守）信誉的。原则是不应该有时间性的。\u003c/p\u003e\u003cp data-pid=\"MLS38ft6\"\u003e◆ 只有当你需要付出代价的时候才知道你是不是个守信誉的人。“讲”信誉谁都会，但当需要“守”信誉的时候很多人就不行了。\u003c/p\u003e\u003cp class=\"ztext-empty-paragraph\"\u003e\u003cbr/\u003e\u003c/p\u003e\u003cp data-pid=\"-Lvxgy2z\"\u003e-- 来自微信读书\u003c/p\u003e","is_labeled":false,"visited_count":311,"favorite_count":4,"article_type":"normal","is_navigator":false,"navigator_vote":false,"vote_next_step":"vote"},"brief":"{\"source\": \"TS\", \"type\": \"article\", \"id\": 1912760136939836775}","attached_info":"Cu8FCPmL+abA1MCFogEQBxoJMjU4NDc5ODY5IKmy88EGKAIwAEATSkEKLFRTX1NPVVJDRV9UV09UT1dFUl9TSE9SVElOVEVSRVNUX1JFQ0FMTF9URVhUEgEwGAAgADoKeyJyYXciOiIifWIgYTYwYmM5MTljOGQ4MzVkNmNlZTliYTY0MDZjYTZjZjJyEzE5MTI3NjAxMzY5Mzk4MzY3NzWqAQlyZWNvbW1lbmTCASBmYTA3NzZlMzdhNzIyNzcwNWNkNjk3NTU4Mzg5ZDU4NvIBCggMEgZOb3JtYWzyASgIChIkZTNhNjMzOGYtZDhmOC00YTcyLTg2MWQtM2Y5OTJmNWFhZDg18gEFCAsSATSCAgCIAv/pi876MpICIGZhMDc3NmUzN2E3MjI3NzA1Y2Q2OTc1NTgzODlkNTg2mgIAygIWU2hvckludGVyZXN0V2VpZ2h0UnVsZcoCGFBlcmlvZEludGVyZXN0V2VpZ2h0UnVsZcoCFVVzZXJMY25FeGl0V2VpZ2h0UnVsZcoCF1Rlc3RlZEFuZFdvcmtXZWlnaHRSdWxl2gIsVFNfU09VUkNFX1RXT1RPV0VSX1NIT1JUSU5URVJFU1RfUkVDQUxMX1RFWFToAgP6AgtOT1JNQUxfRkxPV4oDIDNhNjk1YjY3YjczNjQ4YjA4ZDhjZjIzYzNiYzVjYWYwmgMNCgJ2MhAAGgVvdGhlcqgDtwLYAwDqAxpmZWVkX2F0dG1fdHdvdG93ZXJfdjJfdGV4dPoDHxIMVU5LTk9XTl9NT0RFIAAqDU5PX0lNQUdFX01PREWABACIBACSBAZOb3JtYWyaBAEzoAQAqAQAsAQAugQCYWnCBAM0MDDIBADSBA/mjqjojZDlt7Lmm7TmlrDYBADwBAD5BAAAAEBftLY/gQUAAAAAAAAAAIkFiyXxOlgz0T+SBQCaBQNkZnSiBQNkZnSyBQExuQUAAAAAAAAAANAFAOAFAOgFAPAFBJAGAKAGE6gGA5ICLgoJMjU4NDc5ODY5EhMxOTEyNzYwMTM2OTM5ODM2Nzc1GAciCklNQUdFX1RFWFQ=","action_card":false},{"id":"20_1750899815.74","type":"feed","offset":20,"verb":"TOPIC_ACKNOWLEDGED_ANSWER","created_time":1750899815,"updated_time":1750899815,"target":{"id":"55659492296","type":"answer","url":"https://api.zhihu.com/answers/55659492296","author":{"id":"d75fe4ac79d86a507c9adab2df2895ff","url":"https://api.zhihu.com/people/d75fe4ac79d86a507c9adab2df2895ff","user_type":"people","url_token":"ding-shuai-73-50-21","name":"纵横江湖","headline":"公众号：纵横江湖录。社会底层，摸爬滚打，十年磨一剑，小有成就","avatar_url":"https://pica.zhimg.com/50/v2-bfef7aefbe8abdaa9aab43f3c44b8407_l.jpg?source=b6762063","is_org":false,"gender":1,"followers_count":1530,"is_following":false,"is_followed":false},"created_time":1734224742,"updated_time":1734224742,"voteup_count":377,"thanks_count":38,"comment_count":25,"is_copyable":true,"question":{"id":"461793388","type":"question","url":"https://api.zhihu.com/questions/461793388","author":{"id":"4d5c09efe719015d8d511f98e9711c03","url":"https://api.zhihu.com/people/4d5c09efe719015d8d511f98e9711c03","user_type":"people","url_token":"a-hu-84-2","name":"抽象艺术Max","headline":"抽象艺术创作者，欢迎合作收藏。","avatar_url":"https://picx.zhimg.com/50/v2-6ab81675a91aecfeafa2fb11fe440467_l.jpg?source=b6762063","is_org":false,"gender":1,"followers_count":361,"is_following":false,"is_followed":false},"title":"怎么和贵人大领导相处？","created":1622155441,"answer_count":0,"follower_count":0,"comment_count":5,"bound_topic_ids":[2566,2738,16800,37593,135543],"is_following":false,"excerpt":"","relationship":{"is_author":false},"detail":"","question_type":"normal"},"excerpt":"一、学会隐藏情绪无论是层次高的大人物或是底层的普通人，都如同孩子一般，他们只是相对而言的大人。 只要有那么一刻能够让他觉得你是真正在乎他，他也会感动的，每个人的内心都是孤独的，所谓的高人、贵人则更加孤独，因为人爬得越高，懂他的人就越少，所谓强者都是孤独的就是这个道理。 所以他们不需要因为利益而靠近自己的人，需要你能在他开心的时候比他开心，难过的时候比他难过，真正同频共振的人追随自己。 二、功利心不…","excerpt_new":"一、学会隐藏情绪无论是层次高的大人物或是底层的普通人，都如同孩子一般，他们只是相对而言的大人。 只要有那么一刻能够让他觉得你是真正在乎他，他也会感动的，每个人的内心都是孤独的，所谓的高人、贵人则更加孤独，因为人爬得越高，懂他的人就越少，所谓强者都是孤独的就是这个道理。 所以他们不需要因为利益而靠近自己的人，需要你能在他开心的时候比他开心，难过的时候比他难过，真正同频共振的人追随自己。 二、功利心不…","preview_type":"default","preview_text":"","reshipment_settings":"allowed","content":"\u003cp data-pid=\"iaIKhN7-\"\u003e\u003cb\u003e一、学会隐藏情绪\u003c/b\u003e\u003c/p\u003e\u003cp data-pid=\"3agvUXBJ\"\u003e无论是层次高的大人物或是底层的普通人，都如同孩子一般，他们只是相对而言的大人。\u003c/p\u003e\u003cp data-pid=\"IUbUBlhP\"\u003e只要有那么一刻能够让他觉得你是真正在乎他，他也会感动的，每个人的内心都是孤独的，所谓的高人、贵人则更加孤独，因为人爬得越高，懂他的人就越少，所谓强者都是孤独的就是这个道理。\u003c/p\u003e\u003cp data-pid=\"cKjSOi7d\"\u003e所以他们不需要因为利益而靠近自己的人，需要你能在他开心的时候比他开心，难过的时候比他难过，真正同频共振的人追随自己。\u003c/p\u003e\u003cp data-pid=\"u9sBYZFb\"\u003e\u003cb\u003e二、功利心不能太重。\u003c/b\u003e\u003c/p\u003e\u003cp data-pid=\"VmHe5fd_\"\u003e本质是利益交换没错，但是很多事都明白，但是没法说破，说破了就继续不下去了，到时候你的筹码不如对方大，傻了不是。所以能做的，就是做好自己的事，尽最大的努力，这就是你的诚意。\u003c/p\u003e\u003cp data-pid=\"JsxvqnRh\"\u003e有的小伙伴就担心，那会不会大领导装傻，对，是装傻，不会真傻，他如果是你的负责人，那不会，你做了什么，做了多少，他心里有数。\u003c/p\u003e\u003cp data-pid=\"q1oPraf2\"\u003e如果他装傻，那可以了，他只是个大领导，不是贵人，放弃，下一个。\u003c/p\u003e\u003cp data-pid=\"5jl5hv58\"\u003e如果说看不出来，额，那可能确实不太适合这条路，或者，咱们想付出点沉没成本，交个学费，那也是好样的。\u003c/p\u003e\u003cp data-pid=\"8qN5GHwa\"\u003e功利心重了会导致什么，患得患失，自卑。这几点都会让你很快会 pass 掉，因为你不优秀，不出类拔萃了。就像面试的时候，什么最重要，放松，就像自家人唠嗑，很顺畅很自然，在战略上知道自己在做什么，在战术上轻松自然。\u003c/p\u003e\u003cp data-pid=\"euwcg4ce\"\u003e\u003cb\u003e三、忠诚度要高。\u003c/b\u003e\u003c/p\u003e\u003cp data-pid=\"dNFjMxSf\"\u003e我在基层呆了很多年，见了太多觉得自己聪明，站在墙头上的，我都知道的，大领导看不出来么，不要耍小聪明，再强调一遍，真的不要耍，能位高权重的人本来就比你聪明，又多活了十年二十年，你觉得他不知道么。\u003c/p\u003e\u003cp data-pid=\"gv5cIdeQ\"\u003e所以老实本分真的是太重要的品质了，他看破的心思就直接说，没什么，大领导也是从年轻上去的，你的想法他知道的比你想的多，但是可以换个方式说，怎么能说的让大领导心生怜悯，直接从领导变成贵人也是有好多方法啊哈哈。\u003c/p\u003e\u003cp data-pid=\"fRvjKt41\"\u003e不过老实不是傻啊，大智若愚贴切一些吧，是忠心耿耿的聪明，你想想要换做是你，你喜欢么。就像知否里小桃，看着傻嘛，是愚忠么，但是每次去打探消息都是她去啊，别人从未从她口中知道一点关于主子的消息啊。\u003c/p\u003e\u003cp data-pid=\"MRwZu7uX\"\u003e\u003cb\u003e四、要明确自己的位置，知道自己要什么。\u003c/b\u003e\u003c/p\u003e\u003cp data-pid=\"d57PD5A4\"\u003e这点很重要，听起来觉得空，但真的是撞了南墙你都不一定会回头，因为有些刻在骨子里的东西真的很难改\u003c/p\u003e\u003cp data-pid=\"17MD1WGN\"\u003e低位向高位交流，很重要的一点是控制好自己的情绪，找准自己的位置，工作很多时候不需要太多感情。觉得领导为难我了，我做了什么没有得到应有的回报。你可以有情绪，收起来。可以委屈，可以适度立人设，但是真的，如果想往上，不受委屈是不可能能\u003c/p\u003e\u003cp data-pid=\"OJiXOv6J\"\u003e想知道更多高价值的核心交往方式，请对我尊重并大方一些，舍得花重金加人我的VIP群，你要是太抠搜别说与我链接不上，我敢打赌，你连你的顶头上司你都搞不定，更别说与高人、贵人相处得来\u003c/p\u003e\u003cp data-pid=\"NDIvk7Jf\"\u003e接下来与朋友们说说在日常生活中与高人、贵人相关的话题。\u003c/p\u003e\u003cp data-pid=\"4oa-d_Uu\"\u003e\u003cb\u003e第一，人家高手凭什么会理你，人是没法融入高于自己的圈层的\u003c/b\u003e\u003c/p\u003e\u003cp data-pid=\"WCmixKmg\"\u003e\u003cb\u003e第二，跟高手打交道，总是很紧张，怎么办？\u003c/b\u003e\u003c/p\u003e\u003cp data-pid=\"K7eBGOgh\"\u003e关于第一个问题，我想说的是，我们一定要想尽办法跟高手发生交集，他们随便点拨两句，就够我们吃几年的，一定要相信这个事实。\u003c/p\u003e\u003cp data-pid=\"HaMyBasL\"\u003e另外，所有的高手，都需要小弟。而且你要知道，即使再有钱、再有地位的人，他也需要情绪价值，也需要成就感，也需要被崇拜、被追随、被恭维的感觉。\u003c/p\u003e\u003cp data-pid=\"ehshUrYC\"\u003e认准一个大佬，你知道从他那里可以获得非常宝贵的经验，你就放下身段，多去跟他接近。要知道，人心都是肉长的，当大佬知道你对他很信任、很崇拜，而且经常向他请教，他很可能就愿意帮助你成长。\u003c/p\u003e\u003cp data-pid=\"70velgad\"\u003e因为帮助一个人成长，是非常有成就感的一件事，跟钱无关。能量是需要传递的，而且这种正向传递的感觉非常舒\u003c/p\u003e\u003cp data-pid=\"xVla9p1N\"\u003e另外，从功利的角度来说，他培养过很多人，而且都做出成果了，那么对于他后续的营销、宣传，也是非常有帮助的。\u003c/p\u003e\u003cp data-pid=\"x2HVX_7C\"\u003e当然，大佬最反感的就是白眼狼，没人愿意帮助白眼狼。\u003c/p\u003e\u003cp data-pid=\"KvDwL0ET\"\u003e所以，你千万不能有索取心态，而是要养成“先付出”的习惯。\u003c/p\u003e\u003cp data-pid=\"MDtiUwp8\"\u003e身价越高的人，他的嗅觉就越灵敏。\u003c/p\u003e\u003cp data-pid=\"QjiETEl5\"\u003e你的一句话，一个表情，一个动作，就把你内心的动机暴露无遗了。\u003c/p\u003e\u003cp data-pid=\"eveZTCnO\"\u003e一个人的身价只要比你高，那么一起吃饭时，你一定要负责买\u003c/p\u003e\u003cp data-pid=\"5HnGP1A4\"\u003e另外，也不要刻意过度消费，你的收入低，请大佬吃碗面条、喝杯咖啡也可以，没人会瞧不起你。\u003c/p\u003e\u003cp data-pid=\"vKbYnH6W\"\u003e就如开奔驰宝马的人一般不会嘲讽开国产车的，因为他就是从那个阶段一步步走过来的，嘲笑他们就相当于嘲笑过去的自己。总之，只要你有这个心，对方是能感知到\u003c/p\u003e\u003cp data-pid=\"iaLG6MW7\"\u003e你永远也不要担心高能量场的人会误解你，这种概率很小\u003c/p\u003e\u003cp data-pid=\"ipPifbs3\"\u003e越富有的人越擅长辨别真心和真情实感，越贫穷的人越容易被虚情假意冲昏头脑。\u003c/p\u003e\u003cp data-pid=\"qFtE97BS\"\u003ezg有句老话：悦上者荣，悦下者蹇(jiǎn)\u003c/p\u003e\u003cp data-pid=\"yGhZ-G-J\"\u003e五千年的文化精髓都在这句话里了\u003c/p\u003e\u003cp data-pid=\"M6wwWSsK\"\u003e能取悦上层的人拥有荣华富贵，处处为下层着想的人却困难重重。\u003c/p\u003e\u003cp data-pid=\"QrURo_WD\"\u003e大家可以细细品味这句话，不要急着反驳。\u003c/p\u003e\u003cp data-pid=\"jFEpNl_s\"\u003e\u003cb\u003e下面再说说跟大佬打交道紧张这个话题。\u003c/b\u003e\u003c/p\u003e\u003cp data-pid=\"sqU1czvj\"\u003e首先你要知道，身价越高的人，一定是越有爱、越有智慧\u003c/p\u003e\u003cp data-pid=\"OFm877IP\"\u003e你永远也不要担心一个亿万富翁是个阴险的小人，但凡是能拉拢一班人马做事业的，人品肯定不会差，否则不会有人长期跟随他。\u003c/p\u003e\u003cp data-pid=\"TtUvO7FR\"\u003e其次，做任何事，能让你感到紧张和恐惧，只有一个原因：你不会。\u003c/p\u003e\u003cp data-pid=\"xdffyb5t\"\u003e会开车的人享受驾驶的乐趣，会演讲的人享受演讲的乐趣，会销售的人享受签单的乐趣……\u003c/p\u003e\u003cp data-pid=\"umulbYlB\"\u003e同理，会借力的人，享受站在巨人肩膀上的乐趣。\u003c/p\u003e\u003cp data-pid=\"M1HqZB8i\"\u003e很多事情，只要你愿意学习、愿意实践，就一定能学会。\u003c/p\u003e\u003cp data-pid=\"uIxeytvn\"\u003e所以，从今天起，如果你碰到一个有成果的前辈，先不要着急产生排斥心理，不要让自己的自尊心作怪，带着“先付出”的姿态，诚心诚意地去交往、去拜会，你会发现，你付出一分，一定会收获五分、十分。\u003c/p\u003e","relationship":{"is_thanked":false,"is_nothelp":false,"voting":0},"is_labeled":false,"visited_count":29242,"favorite_count":1066,"answer_type":"normal","is_navigator":false,"navigator_vote":false,"vote_next_step":"vote"},"brief":"{\"source\": \"TS\", \"type\": \"answer\", \"id\": 55659492296}","attached_info":"CtoGCPmL+abA1MCFogEQBBoJNzA0MjQ3OTAyIObW+LoGKPkCMBlAFEpICh9UU19TT1VSQ0VfWlJFQ0FMTF9JVEVNQ0ZfVVBWT1RFEh9kb2NfdHlwZTogQW5zd2VyCmlkOiA3MDUxMzM3ODYKGAAgADoASigKHVRTX1NPVVJDRV9ORUFSTElORV9DT05URU5UX1YyEgEwGAAgADoAWgg2NDkwMDE1MGIgYTYwYmM5MTljOGQ4MzVkNmNlZTliYTY0MDZjYTZjZjJyCzU1NjU5NDkyMjk2igEJNDYxNzkzMzg4qgEJcmVjb21tZW5kwgEgZDc1ZmU0YWM3OWQ4NmE1MDdjOWFkYWIyZGYyODk1ZmbyAQoIDBIGTm9ybWFs8gEoCAoSJGEyMzg2YzM0LWJjYjYtNDUxNy04ZjdjLWZhZmI2YWY1ZDAzYvIBBQgLEgE0ggIAiAL/6YvO+jKSAiBkNzVmZTRhYzc5ZDg2YTUwN2M5YWRhYjJkZjI4OTVmZpoCAMoCFlNob3JJbnRlcmVzdFdlaWdodFJ1bGXKAhZBY3Rpb25TaG9ySW50ZXJlc3RSdWxlygIbSW50ZXJhY3Rpb25TaG9ySW50ZXJlc3RSdWxlygIYUGVyaW9kSW50ZXJlc3RXZWlnaHRSdWxlygIVVXNlckxjbkV4aXRXZWlnaHRSdWxlygIUQ29udGVudEFnZVdlaWdodFJ1bGXaAh9UU19TT1VSQ0VfWlJFQ0FMTF9JVEVNQ0ZfVVBWT1RF6AIC+gILTk9STUFMX0ZMT1eKAyAzYTY5NWI2N2I3MzY0OGIwOGQ4Y2YyM2MzYmM1Y2FmMJoDDQoCdjIQABoFb3RoZXKoA7rkAdgDAOoDGXRleHRBbGxTaXRlQWN0aW9uSXRlbUNGVjL6Ax8SDFVOS05PV05fTU9ERSAAKg1OT19JTUFHRV9NT0RFgAQAiAQAkgQGTm9ybWFsmgQBMqAEAKgEALAEALoEBm1hbnVhbMIEAzE3MMgEANIED+aOqOiNkOW3suabtOaWsNgEAPAEAPkEAAAAYP+Yuj+BBQAAAAAAAAAAiQWLJfE6WDPRP5IFAJoFA2RmdKIFA2RmdLIFATG5BQAAAAAAAAAA0AUA4AUA6AUA8AUEkAYAoAYUqAYAkgImCgk3MDQyNDc5MDISCzU1NjU5NDkyMjk2GAQiCklNQUdFX1RFWFQ=","action_card":false},{"id":"21_1750899815.512","type":"feed","offset":21,"verb":"TOPIC_ACKNOWLEDGED_ANSWER","created_time":1750899815,"updated_time":1750899815,"target":{"id":"1920858314155204984","type":"answer","url":"https://api.zhihu.com/answers/1920858314155204984","author":{"id":"318cfa50de768737b6357d99cbaf81eb","url":"https://api.zhihu.com/people/318cfa50de768737b6357d99cbaf81eb","user_type":"people","url_token":"xu-kong-hui-guang-36","name":"虚空辉光","headline":"","avatar_url":"https://pic1.zhimg.com/50/v2-abed1a8c04700ba7d72b45195223e0ff_l.jpg?source=b6762063","is_org":false,"gender":-1,"followers_count":152,"is_following":false,"is_followed":false},"created_time":1750748309,"updated_time":1750748959,"voteup_count":216,"thanks_count":8,"comment_count":59,"is_copyable":true,"question":{"id":"1919629223070512374","type":"question","url":"https://api.zhihu.com/questions/1919629223070512374","author":{"id":"1efda1de522b988733afc793d7a9ed8c","url":"https://api.zhihu.com/people/1efda1de522b988733afc793d7a9ed8c","user_type":"people","url_token":"hua-zi-13-27","name":"靖姐想做个好妈妈","headline":"知势榜上榜答主｜海淀宝妈｜曾大厂打工｜极简美好生活","avatar_url":"https://picx.zhimg.com/50/v2-43aa4f0500842112e0e954893ad3298b_l.jpg?source=b6762063","is_org":false,"gender":0,"badge":[{"type":"identity_people","description":"对外经济贸易大学 国际贸易学硕士"}],"followers_count":4629,"is_following":false,"is_followed":false},"title":"如果你有300万，你是用来供孩子读书，还是留着以后给ta买房或者保底？","created":1750455271,"answer_count":0,"follower_count":0,"comment_count":76,"bound_topic_ids":[988,350098,2015521],"is_following":false,"excerpt":"","relationship":{"is_author":false},"detail":"","question_type":"normal"},"excerpt":"作为一个 上海（曾经的）中产家庭 出身，在北京生活快10年，TOP 2 本科+直博 非天坑专业 的男性来说，我觉得我很适合回答这个问题。 先说结论，我的评价是，读书除非赌那个神中神前0.05%，否则大概率只能提升你打工赚钱的能力，而就如同历史上的大部分时期一样， 靠辛苦赚来的钱是不被尊敬的，靠劳动赚钱的人也是不配被尊敬的。这不是一个道德/反道德评价，而是因为赚钱本身往往伴随着你作为人的机能和人格的劣化。你憧憬着别人…","excerpt_new":"作为一个 上海（曾经的）中产家庭 出身，在北京生活快10年，TOP 2 本科+直博 非天坑专业 的男性来说，我觉得我很适合回答这个问题。 先说结论，我的评价是，读书除非赌那个神中神前0.05%，否则大概率只能提升你打工赚钱的能力，而就如同历史上的大部分时期一样， 靠辛苦赚来的钱是不被尊敬的，靠劳动赚钱的人也是不配被尊敬的。这不是一个道德/反道德评价，而是因为赚钱本身往往伴随着你作为人的机能和人格的劣化。你憧憬着别人…","preview_type":"default","preview_text":"","reshipment_settings":"allowed","content":"\u003cp data-pid=\"HFsGV1jt\"\u003e作为一个 上海（曾经的）中产家庭 出身，在北京生活快10年，TOP 2 本科+直博 非天坑专业 的男性来说，我觉得我很适合回答这个问题。\u003c/p\u003e\u003cp data-pid=\"zo9l_UdZ\"\u003e先说结论，我的评价是，读书除非赌那个神中神前0.05%，否则大概率只能提升你打工赚钱的能力，而就如同历史上的大部分时期一样，\u003cb\u003e靠辛苦赚来的钱是不被尊敬的\u003c/b\u003e，\u003cb\u003e靠劳动赚钱的人也是不配被尊敬的\u003c/b\u003e。这不是一个道德/反道德评价，而是因为赚钱本身往往伴随着你作为人的机能和人格的劣化。你憧憬着别人的起点，觉得自己有一天能凭借自己的努力和他们一样成为堂堂正正的人。但当你爬上别人所在的起点时，你自己都很难再说自己是个人了。\u003c/p\u003e\u003cp class=\"ztext-empty-paragraph\"\u003e\u003cbr/\u003e\u003c/p\u003e\u003cp data-pid=\"Ndy9JuVY\"\u003e我家里曾经在一个比较兴旺的行业，直到10年左右也是四~五年存款（印象中）就可以全款一套房的状态，应该也算是主流小中产。但是再后来行业衰落了，这十几年几乎没涨工资，半死不活。现在就是普通家庭收入水平了。好在之前的年份里存了不少钱，虽然各种投资没怎么赚，但也还算有一定积累。等到我入学的年份，差不多是房价开始涨的时候，家里在讨论是否要买房。当时考虑说考上了TOP2以后，有相当多出国概率。如果是读硕可能需要先投入几百万，读博肯定就是瞄准海外定居，这种情况下，还是把钱留着以备需要比较好……然后就错过了房产最火的几年。\u003c/p\u003e\u003cp class=\"ztext-empty-paragraph\"\u003e\u003cbr/\u003e\u003c/p\u003e\u003cp data-pid=\"-YUZQvAC\"\u003e最后各种阴差阳错，在本校读了博。最终结果是，同学大体上分布在总包50-120万左右。考虑到北京日常的租房开销极大，实际上拿到白菜价的人一年连15万都未必存得下来；而拿到120的人大概能存50-60万。没办法，中国的政策惩罚按劳分配的人。\u003c/p\u003e\u003cp data-pid=\"aRQBSLPG\"\u003e那么你猜，在公平，竞争充分且残忍的相亲市场中，他们的这条烂命值多少钱？对这一点我做过调查，一个 双非一本+税前12万的主流工作+X万资产  vs  一个 TOP2+税前60万的大厂工作+无资产相比，这个X到多少的时候能反转？我在女性中调查，大部分人给这个X填的是400万。和题主给出的数字差不多。\u003c/p\u003e\u003cp data-pid=\"BgiPYU8Z\"\u003e（顺带一提这还得考虑到，后者的婚后收入是共同资产，因此女方是可以分钱的；前者的钱都是自己的，只能看不能拿，女方要用还得舔着。这再次印证了我前面的结论，辛苦赚来的钱是最劣等的钱）\u003c/p\u003e\u003cp data-pid=\"HKEk4G3j\"\u003e没办法，这就像是债权交易一样，在下降的时代，没有人相信未来。考虑到税+资产回报，此消彼长，后者的到手收益实际上也就比别人多25万左右，需要奋斗的15年才能换来。有多少人愿意相信15年！京沪有多少婚姻能维持十五年？对50万的白菜价来说，300万的房子已经算是遥不可及了，基本没有上桌吃饭的可能，早晚滚回家。\u003c/p\u003e\u003cp data-pid=\"w_BsHl1q\"\u003e另一方面，对百万级强者来说，他确实有在市场上凭借一己之力逆天改命的实力，但他们不仅是教育淘汰下来的 1%（cover 大部分强985）中的前 5%（从拿高水平offer比例来看），而且代价是奋斗的五年。当别人拿着万元的摸鱼工资优哉游哉，下班约会泡北漂妹的时候，在打工中沾染的疲劳怨气，正在逐渐拖垮你。让你变成一个客观的烂人。\u003c/p\u003e\u003cp data-pid=\"M_Sd2ebV\"\u003e没办法，世道就是这样。只有天生富的人中，才可能有一批好人，天生穷的人永远不可能成为好人的，即便有一天富了，也只能成为复仇者。（这么一想这个逻辑和incel很像，年轻时不被喜欢的人，以后就算能睡到再多女人也会厌女的）\u003c/p\u003e\u003cp class=\"ztext-empty-paragraph\"\u003e\u003cbr/\u003e\u003c/p\u003e\u003cp data-pid=\"PgEd8Kif\"\u003e当然我比这些同学还好些，因为我家毕竟是有一点积蓄的，而且房价越跌越爽，拿个白菜价也勉强能上上桌。但是对纯小镇做题家们来说就不一样了……所以奉劝一句中产阶级的家长们，别把自己子女降档成北漂沪漂水平。投钱读书，有几个人读书敢说比我们吊？到头来也不过如此罢了。\u003c/p\u003e\u003cp data-pid=\"VZYauGYw\"\u003e有时候如果人生能重来，我真希望我是一个只能考中专的轻度弱智，出去打工也只能赚几千块，这样家里肯定早早得替我想办法，现在就可以过上躺在家里混吃等死的低能量生活，甚至击败现在的我。\u003c/p\u003e\u003cp class=\"ztext-empty-paragraph\"\u003e\u003cbr/\u003e\u003c/p\u003e\u003cp data-pid=\"0VmhUAgi\"\u003e没仔细组织逻辑，摸鱼有感而发。有人看的话再慢慢补充吧。\u003c/p\u003e","relationship":{"is_thanked":false,"is_nothelp":false,"voting":0},"is_labeled":false,"visited_count":16972,"favorite_count":244,"answer_type":"normal","is_navigator":false,"navigator_vote":false,"vote_next_step":"vote"},"brief":"{\"source\": \"TS\", \"type\": \"answer\", \"id\": 1920858314155204984}","attached_info":"CokGCPmL+abA1MCFogEQBBoJNzMzNzcyNDg1IJWZ6cIGKNgBMDtAFUooChNUU19TT1VSQ0VfRkVFRFJFX1Y5EgEwGAAgADoKeyJyYXciOiIifVoJMTE1NDgxNzg5YiBhNjBiYzkxOWM4ZDgzNWQ2Y2VlOWJhNjQwNmNhNmNmMnITMTkyMDg1ODMxNDE1NTIwNDk4NIoBEzE5MTk2MjkyMjMwNzA1MTIzNzSqAQlyZWNvbW1lbmTCASAzMThjZmE1MGRlNzY4NzM3YjYzNTdkOTljYmFmODFlYvIBCggMEgZOb3JtYWzyASgIChIkYjQ0N2ZjM2QtZTNjZC00ZTMxLWJmMWUtNGYxYjAzODE3N2Jk8gEFCAsSATSCAgCIAv/pi876MpICIDMxOGNmYTUwZGU3Njg3MzdiNjM1N2Q5OWNiYWY4MWVimgIAygIWU2hvckludGVyZXN0V2VpZ2h0UnVsZcoCFkFjdGlvblNob3JJbnRlcmVzdFJ1bGXKAhtJbnRlcmFjdGlvblNob3JJbnRlcmVzdFJ1bGXKAhZSZXZpc2l0VmFsdWVXZWlnaHRSdWxlygIYUGVyaW9kSW50ZXJlc3RXZWlnaHRSdWxlygIVVXNlckxjbkV4aXRXZWlnaHRSdWxl2gITVFNfU09VUkNFX0ZFRURSRV9WOegCAvoCC05PUk1BTF9GTE9XigMgM2E2OTViNjdiNzM2NDhiMDhkOGNmMjNjM2JjNWNhZjCaAw0KAnYyEAAaBW90aGVyqAPMhAHYAwDqAwlmZWVkcmVfdjn6Ax8SDFVOS05PV05fTU9ERSAAKg1OT19JTUFHRV9NT0RFgAQAiAQAkgQGTm9ybWFsmgQBMqAEAKgEALAEALoEBm1hbnVhbMIEAzE3MMgEANIED+aOqOiNkOW3suabtOaWsNgEAPAEAPkEAAAA4D1UvD+BBQAAAAAAAAAAiQWLJfE6WDPRP5IFAJoFA2RmdKIFA2RmdLIFATG5BQAAAAAAAAAA0AUA4AUA6AUA8AUEkAYAoAYVqAYAkgIuCgk3MzM3NzI0ODUSEzE5MjA4NTgzMTQxNTUyMDQ5ODQYBCIKSU1BR0VfVEVYVA==","action_card":false},{"id":"22_1750899815.44","type":"feed","offset":22,"verb":"TOPIC_ACKNOWLEDGED_ANSWER","created_time":1750899815,"updated_time":1750899815,"target":{"id":"1921493015693881379","type":"answer","url":"https://api.zhihu.com/answers/1921493015693881379","author":{"id":"b326ad1c3193d2e9f38d60bfb31db3a9","url":"https://api.zhihu.com/people/b326ad1c3193d2e9f38d60bfb31db3a9","user_type":"people","url_token":"ooo-76-52-50","name":"斜杠青年OoO","headline":"10年互联网大厂经验，公众号「斜杠青年OoO」～","avatar_url":"https://picx.zhimg.com/50/v2-08ea93cdbe147ae85e86dce9a59a61f0_l.jpg?source=b6762063","is_org":false,"gender":0,"followers_count":122,"is_following":false,"is_followed":false},"created_time":1750899634,"updated_time":1750899634,"voteup_count":0,"thanks_count":0,"comment_count":0,"is_copyable":true,"question":{"id":"659948228","type":"question","url":"https://api.zhihu.com/questions/659948228","author":{"id":"561e1b93c065b1b70f3eb9430d0ba003","url":"https://api.zhihu.com/people/561e1b93c065b1b70f3eb9430d0ba003","user_type":"people","url_token":"a-li-mao-mao","name":"咚咚相对论","headline":"没啥特别之处，但也想与众不同","avatar_url":"https://pica.zhimg.com/50/v2-462f6347d5e2cfcde6a10184e6e27f23_l.jpg?source=b6762063","is_org":false,"gender":1,"badge":[{"type":"identity_people","description":"慕尼黑工业大学 运输与物流硕士"}],"followers_count":742,"is_following":false,"is_followed":false},"title":"35岁以上的失业人员都干什么去了？","created":1719365683,"answer_count":0,"follower_count":0,"comment_count":0,"bound_topic_ids":[3577,6086,13306,38282,101545],"is_following":false,"excerpt":"","relationship":{"is_author":false},"detail":"","question_type":"normal"},"excerpt":"今年36岁，女，失业2年多。 之前是个沪漂程序员，失业后就回到老家，没再继续上班。 目前没房没车没结婚没小孩，也没有负债。 现在每天都是假期，再也没有领导在你后面鞭策你干活，也不用面对办公室里的勾心斗角，更不用加班。 不过这一切的代价就是失去了“固定工资”。 刚失业的第一年过得还十分惬意，因为有赔偿金和失业金过渡，经济上不至于那么拮据。 但到第二年，失业金领完了，赔偿金也花的差不多了，而且我还打算给自己…","excerpt_new":"今年36岁，女，失业2年多。 之前是个沪漂程序员，失业后就回到老家，没再继续上班。 目前没房没车没结婚没小孩，也没有负债。 现在每天都是假期，再也没有领导在你后面鞭策你干活，也不用面对办公室里的勾心斗角，更不用加班。 不过这一切的代价就是失去了“固定工资”。 刚失业的第一年过得还十分惬意，因为有赔偿金和失业金过渡，经济上不至于那么拮据。 但到第二年，失业金领完了，赔偿金也花的差不多了，而且我还打算给自己…","preview_type":"default","preview_text":"","reshipment_settings":"allowed","content":"\u003cp data-pid=\"PgQyW80V\"\u003e今年36岁，女，失业2年多。\u003c/p\u003e\u003cp data-pid=\"wpzD_Ago\"\u003e之前是个沪漂程序员，失业后就回到老家，没再继续上班。\u003c/p\u003e\u003cp data-pid=\"i_p6M2JC\"\u003e目前没房没车没结婚没小孩，也没有负债。\u003c/p\u003e\u003cp data-pid=\"_pUyDhWt\"\u003e现在每天都是假期，再也没有领导在你后面鞭策你干活，也不用面对办公室里的勾心斗角，更不用加班。\u003c/p\u003e\u003cp data-pid=\"dT9kZgG8\"\u003e不过这一切的代价就是失去了“固定工资”。\u003c/p\u003e\u003cp data-pid=\"Jczzbo5_\"\u003e刚失业的第一年过得还十分惬意，因为有赔偿金和失业金过渡，经济上不至于那么拮据。\u003c/p\u003e\u003cp data-pid=\"tsRtfXyA\"\u003e但到第二年，失业金领完了，赔偿金也花的差不多了，而且我还打算给自己每月缴纳2000+的灵活就业社保。\u003c/p\u003e\u003cp data-pid=\"2aWaH4_M\"\u003e于是不得已，我得找些能赚钱的门路。\u003c/p\u003e\u003cp data-pid=\"7f-qk0nA\"\u003e··\u003c/p\u003e\u003cp data-pid=\"B2vfJewP\"\u003e都说失业后找不到工作就去送外卖吧。\u003c/p\u003e\u003cp data-pid=\"TqPW1BsP\"\u003e但不好意思，我一不会骑电动车，二是个路痴，三我确实觉得送外卖有点拉不下脸。\u003c/p\u003e\u003cp data-pid=\"Hweb0aMJ\"\u003e那去摆地摊吧？\u003c/p\u003e\u003cp data-pid=\"qqH6HpMP\"\u003e后也不太行，摆地摊不仅前期要投入一小笔钱，而且还冬冷夏热，我又这么内向，能不能卖出去不知道，估计得把我社死。\u003c/p\u003e\u003cp data-pid=\"pLg5J_PB\"\u003e怎么办？留给普通人的活路就还剩自媒体了吧。\u003c/p\u003e\u003cp data-pid=\"_fR4wici\"\u003e没办法，别的都干不了，只能硬着头皮上，背水一战。\u003c/p\u003e\u003cp data-pid=\"-2S7fEaD\"\u003e作为一个理工生，自媒体需要的所有技能都是我的弱项。\u003c/p\u003e\u003cp data-pid=\"MjNcg4X2\"\u003e不过好在，我愿意学习，而且执行能力还可以。\u003c/p\u003e\u003cp data-pid=\"ZcxgchBg\"\u003e于是我先进入的是自媒体写作领域，一年全网积累了2万多粉，变现了7万多。\u003c/p\u003e\u003cp data-pid=\"aIYe9h7_\"\u003e我发现做自媒体其实不难，但想做好自媒体，赚大钱那就有点难度了。\u003c/p\u003e\u003cp data-pid=\"58JGuCDB\"\u003e不过普通人靠它赚个零花钱还是绰绰有余的。\u003c/p\u003e\u003cp data-pid=\"xmB1VYSt\"\u003e今年我开了第二个写作账号，也就是现在这个，天赋不够就用数量来凑。\u003c/p\u003e\u003cp data-pid=\"ej5DVylA\"\u003e除此之外我还进军了短视频领域，运营一个月已经变现了500多。\u003c/p\u003e\u003cp data-pid=\"4aRoo8pr\"\u003e我觉得互联网时代，只要你愿意学，有执行力，网上的学习资料铺天盖地，根本就不用报什么大几千的培训班。\u003c/p\u003e\u003cp data-pid=\"8AfF1QZn\"\u003e所以，35岁以后，我虽然失业了，但我好像比以前更忙了，因为我有很多个自己的小项目，成长的天花板比原来高了很多，而且每个阶段都有新的目标和追求。\u003c/p\u003e\u003cp data-pid=\"_r4O0v4C\"\u003e··\u003c/p\u003e\u003cp data-pid=\"7YXM3MGl\"\u003e近两年失业的人越来越多。\u003c/p\u003e\u003cp data-pid=\"An2pJYTZ\"\u003e有的人失业后，历经千辛，还终于找到了一份工作。\u003c/p\u003e\u003cp data-pid=\"vU5_mmKj\"\u003e有的人失业后，破釜沉舟，做起了自媒体，没想到给自己带来意外的惊喜。\u003c/p\u003e\u003cp data-pid=\"OL3RLrVM\"\u003e35岁真的还很年轻，有很多事情可以尝试，千万别把自己画地为牢。\u003c/p\u003e\u003cp data-pid=\"ylPpXnvq\"\u003e不管上班还是不上班，都没有问题，上班有上班的活法，不上班有不上班的活法。\u003c/p\u003e\u003cp data-pid=\"4BsetsBM\"\u003e关键是你一直朝着你的目标前行。\u003c/p\u003e\u003cp data-pid=\"IG5WOWq0\"\u003e我们不必活成同一个模板，每个人都有自己的时差和使命。\u003c/p\u003e\u003cp data-pid=\"5sEcbvAh\"\u003e别被年龄定义和束缚，也别纠结于人一定要上班。\u003c/p\u003e\u003cp data-pid=\"L6avmtua\"\u003e只要自己有本事赚钱，不上班又何妨，你的人生应该由你自己定义，而不是被别人设计。\u003c/p\u003e","relationship":{"is_thanked":false,"is_nothelp":false,"voting":0},"is_labeled":true,"visited_count":1,"favorite_count":0,"answer_type":"normal","is_navigator":false,"navigator_vote":false,"vote_next_step":"vote"},"brief":"{\"source\": \"TS\", \"type\": \"answer\", \"id\": 1921493015693881379}","attached_info":"CpgGCPmL+abA1MCFogEQBBoJNzM0MDUxOTMyILK38sIGKAAwAEAWSiQKGVRTX1NPVVJDRV9XQVJNX1VQX05PUk1BTDESATAYACAAOgBKIgoXVFNfU09VUkNFX1dBUk1VUF9SVUNFTkUSATAYACAAOgBaCTEwODkzMzAyNmIgYTYwYmM5MTljOGQ4MzVkNmNlZTliYTY0MDZjYTZjZjJyEzE5MjE0OTMwMTU2OTM4ODEzNzmKAQk2NTk5NDgyMjiqAQlyZWNvbW1lbmTCASBiMzI2YWQxYzMxOTNkMmU5ZjM4ZDYwYmZiMzFkYjNhOfIBCggMEgZOb3JtYWzyASgIChIkZjEwNzgxNzUtNDFjMC00ZDFkLWJmNmItM2EyNmE5OTc5NjEy8gEFCAsSATSCAgCIAv/pi876MpICIGIzMjZhZDFjMzE5M2QyZTlmMzhkNjBiZmIzMWRiM2E5mgIAygIWU2hvckludGVyZXN0V2VpZ2h0UnVsZcoCGFBlcmlvZEludGVyZXN0V2VpZ2h0UnVsZcoCFVVzZXJMY25FeGl0V2VpZ2h0UnVsZcoCGkNvbnRlbnRXYXJtVXBJc29sYXRpb25SdWxlygIcQmF5ZXNGaXJzdExldmVsSXNvbGF0aW9uUnVsZcoCGENvbnRlbnRXYXJtVXBCcmVha0luUnVsZdoCGVRTX1NPVVJDRV9XQVJNX1VQX05PUk1BTDHoAgD6AgtOT1JNQUxfRkxPV4oDIDNhNjk1YjY3YjczNjQ4YjA4ZDhjZjIzYzNiYzVjYWYwmgMNCgJ2MhAAGgVvdGhlcqgDAdgDAOoDC3RleHRfcnVjZW5l+gMfEgxVTktOT1dOX01PREUgACoNTk9fSU1BR0VfTU9ERYAEAIgEAJIEBk5vcm1hbKAEAKgEALAEAMgEANIED+aOqOiNkOW3suabtOaWsNgEAPAEAPkEAAAAYINDuD+BBQAAAAAAAAAAiQWLJfE6WDPRP5IFAJoFA2RmdKIFA2RmdLIFATG5BQAAAAAAAAAA0AUA4AUA6AUA8AUEkAYAoAYWqAYBkgIuCgk3MzQwNTE5MzISEzE5MjE0OTMwMTU2OTM4ODEzNzkYBCIKSU1BR0VfVEVYVA==","action_card":false},{"id":"23_1750899815.48","type":"feed","offset":23,"verb":"TOPIC_ACKNOWLEDGED_ARTICLE","created_time":1750899815,"updated_time":1750899815,"target":{"id":"682585974","type":"article","url":"https://api.zhihu.com/articles/682585974","author":{"id":"ec16b49a4ea8a406f28f269820b8d7d9","url":"https://api.zhihu.com/people/ec16b49a4ea8a406f28f269820b8d7d9","user_type":"people","url_token":"ma-rong-bo-38","name":"浦东新村轱天乐","headline":"大部分人为了逃避真正的思考，愿意去做任何事。","avatar_url":"https://pic1.zhimg.com/50/677c0eb5cb97942ec9753cb511222ad4_l.jpg?source=b6762063","is_org":false,"gender":1,"badge":[{"type":"identity_people","description":"西安交通大学 微电子学与固体电子学硕士"}],"followers_count":3806,"is_following":false,"is_followed":false},"title":"transformer十问","comment_permission":"all","created":1708220294,"updated":1708220294,"voteup_count":752,"voting":0,"comment_count":6,"linkbox":{"category":"","pic":"","title":"","url":""},"excerpt":"1 Scaled Dot-Product Attention中为什么要除以 [公式] ? 1. 从纯数学上考虑：对于输入均值为0,方差为1的分布，点乘后结果其方差为dk，所以需要缩放一下。下图为原论文注释。   2. 从神经网络上考虑：防止在计算点积时数值过大，导致后续应用 softmax 函数时出现梯度消失的问题。   计算点积时，如果Q K的元素值和dk的值都很大，那么点积的结果可能会非常大，导致 softmax 函数的输入变得非常大。 softmax 函数在处理很大的输入…","excerpt_new":"1 Scaled Dot-Product Attention中为什么要除以 [公式] ? 1. 从纯数学上考虑：对于输入均值为0,方差为1的分布，点乘后结果其方差为dk，所以需要缩放一下。下图为原论文注释。   2. 从神经网络上考虑：防止在计算点积时数值过大，导致后续应用 softmax 函数时出现梯度消失的问题。   计算点积时，如果Q K的元素值和dk的值都很大，那么点积的结果可能会非常大，导致 softmax 函数的输入变得非常大。 softmax 函数在处理很大的输入…","preview_type":"default","preview_text":"","column":{"id":"c_1450515367378063360","type":"column","url":"https://api.zhihu.com/columns/c_1450515367378063360","author":{"id":"","url":"","user_type":"people","url_token":"","name":"匿名用户","headline":"","avatar_url":"https://picx.zhimg.com/v2-d41c2ceaed8f51999522f903672a521f_l.jpg?source=b6762063","is_org":false,"gender":-1,"followers_count":0,"is_following":false,"is_followed":false},"title":"自动驾驶算法","imageUrl":"https://picx.zhimg.com/v2-f111d7ee1c41944859e975a712c0883b_720w.jpg?source=d16d100b","comment_permission":"public","intro":"天下事以难而废者十之一，以惰而废者十之九。","updated":1701003140,"is_following":false},"content":"\u003ch2\u003e1 Scaled Dot-Product Attention中为什么要除以\u003cimg src=\"https://www.zhihu.com/equation?tex=%5Csqrt%7Bd_k%7D\" alt=\"\\sqrt{d_k}\" eeimg=\"1\"/\u003e ?\u003c/h2\u003e\u003cp data-pid=\"Vo7yyWmg\"\u003e\u003cb\u003e1. 从纯数学上考虑：对于输入均值为0,方差为1的分布，点乘后结果其方差为dk，所以需要缩放一下。下图为原论文注释。\u003c/b\u003e \u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic1.zhimg.com/v2-35479da59a2eefe59e523b06910b9976_1440w.jpg\" data-size=\"normal\" data-rawwidth=\"1855\" data-rawheight=\"133\" data-original-token=\"v2-35479da59a2eefe59e523b06910b9976\" class=\"origin_image zh-lightbox-thumb\" width=\"1855\" data-original=\"https://pic1.zhimg.com/v2-35479da59a2eefe59e523b06910b9976_r.jpg\"/\u003e\u003cfigcaption\u003eAttention is all you need\u003c/figcaption\u003e\u003c/figure\u003e\u003cp data-pid=\"8p-HcYbm\"\u003e\u003cb\u003e2. 从神经网络上考虑：防止在计算点积时数值过大，导致后续应用 softmax 函数时出现梯度消失的问题。\u003c/b\u003e \u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic4.zhimg.com/v2-42e4ec9e7e202aaf45f8f0506be7f25d_1440w.jpg\" data-size=\"normal\" data-rawwidth=\"675\" data-rawheight=\"126\" data-original-token=\"v2-1b63e46158ad563b5c22b9e2014559fb\" class=\"origin_image zh-lightbox-thumb\" width=\"675\" data-original=\"https://pic4.zhimg.com/v2-42e4ec9e7e202aaf45f8f0506be7f25d_r.jpg\"/\u003e\u003cfigcaption\u003e在这里插入图片描述\u003c/figcaption\u003e\u003c/figure\u003e\u003cp data-pid=\"d3x9fB29\"\u003e 计算点积时，如果Q K的元素值和dk的值都很大，那么点积的结果可能会非常大，导致 softmax 函数的输入变得非常大。 \u003cb\u003esoftmax 函数在处理很大的输入值时，会使输出的概率分布接近0或1，这会造成梯度非常小，难以通过梯度下降有效地训练模型，即出现梯度消失问题。\u003c/b\u003e 通过使用dk缩放点积的结果，可以使点积的数值范围被适当控制。\u003c/p\u003e\u003ch2\u003e2 Transformer 的基本组成是什么？\u003ca href=\"https://link.zhihu.com/?target=https%3A//arxiv.org/pdf/1706.03762.pdf\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003e\u003cspan class=\"invisible\"\u003ehttps://\u003c/span\u003e\u003cspan class=\"visible\"\u003earxiv.org/pdf/1706.0376\u003c/span\u003e\u003cspan class=\"invisible\"\u003e2.pdf\u003c/span\u003e\u003cspan class=\"ellipsis\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h2\u003e\u003cp class=\"ztext-empty-paragraph\"\u003e\u003cbr/\u003e\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic2.zhimg.com/v2-ea02b151e437c3429aed6321c29c95b9_1440w.jpg\" data-size=\"normal\" data-rawwidth=\"1031\" data-rawheight=\"1262\" data-original-token=\"v2-ff769ee0345776c4aba43206440ea833\" class=\"origin_image zh-lightbox-thumb\" width=\"1031\" data-original=\"https://pic2.zhimg.com/v2-ea02b151e437c3429aed6321c29c95b9_r.jpg\"/\u003e\u003cfigcaption\u003e在这里插入图片描述\u003c/figcaption\u003e\u003c/figure\u003e\u003cp class=\"ztext-empty-paragraph\"\u003e\u003cbr/\u003e\u003c/p\u003e\u003cp data-pid=\"Ek6BElde\"\u003eTransformer分为encoder和decoder两个部分。 Encode包含self-attention和前馈神经网络，用于提取特征； Decoder在自注意力和前馈神经网络中间多了一个cross-attention，用于和encoder的输出做交互。\u003c/p\u003e\u003ch2\u003e3 多头注意力机制如何实现？\u003c/h2\u003e\u003cp class=\"ztext-empty-paragraph\"\u003e\u003cbr/\u003e\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic2.zhimg.com/v2-6f9a8e60c0f6eb54b7c92afaace2f461_1440w.jpg\" data-size=\"normal\" data-rawwidth=\"2101\" data-rawheight=\"1162\" data-original-token=\"v2-ab2ad25d7cc379de18d3e94e3ea078cf\" class=\"origin_image zh-lightbox-thumb\" width=\"2101\" data-original=\"https://pic2.zhimg.com/v2-6f9a8e60c0f6eb54b7c92afaace2f461_r.jpg\"/\u003e\u003cfigcaption\u003e在这里插入图片描述\u003c/figcaption\u003e\u003c/figure\u003e\u003cp class=\"ztext-empty-paragraph\"\u003e\u003cbr/\u003e\u003c/p\u003e\u003cp data-pid=\"LSI1a7Pk\"\u003e每个头独立地在相同的输入上计算注意力权重，最后把所有头的输出合并。每个头关注一部分的特征，类似于卷积中通道的作用。\u003c/p\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode class=\"language-python\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003etorch\u003c/span\u003e\n\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003etorch.nn\u003c/span\u003e \u003cspan class=\"kn\"\u003eas\u003c/span\u003e \u003cspan class=\"nn\"\u003enn\u003c/span\u003e\n\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003etorch.nn.functional\u003c/span\u003e \u003cspan class=\"kn\"\u003eas\u003c/span\u003e \u003cspan class=\"nn\"\u003eF\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eMultiHeadAttention\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enn\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eModule\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"fm\"\u003e__init__\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eembed_size\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eheads\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"nb\"\u003esuper\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eMultiHeadAttention\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"fm\"\u003e__init__\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eembed_size\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eembed_size\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eheads\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eheads\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehead_dim\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eembed_size\u003c/span\u003e \u003cspan class=\"o\"\u003e//\u003c/span\u003e \u003cspan class=\"n\"\u003eheads\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eassert\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\n            \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehead_dim\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003eheads\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003eembed_size\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Embedding size needs to be divisible by heads\u0026#34;\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e# Separate linear layers for values, keys, and queries for each head\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003evalues\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enn\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLinear\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehead_dim\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehead_dim\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ebias\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"bp\"\u003eFalse\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ekeys\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enn\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLinear\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehead_dim\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehead_dim\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ebias\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"bp\"\u003eFalse\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003equeries\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enn\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLinear\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehead_dim\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehead_dim\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ebias\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"bp\"\u003eFalse\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003efc_out\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enn\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLinear\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eheads\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehead_dim\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eembed_size\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003eforward\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003evalues\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ekeys\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003equery\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eN\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003equery\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eshape\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e  \u003cspan class=\"c1\"\u003e# Number of examples\u003c/span\u003e\n        \u003cspan class=\"n\"\u003evalue_len\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ekey_len\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003equery_len\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003evalues\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eshape\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"n\"\u003ekeys\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eshape\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"n\"\u003equery\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eshape\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e# Split embeddings into self.heads pieces\u003c/span\u003e\n        \u003cspan class=\"n\"\u003evalues\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003evalues\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ereshape\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eN\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003evalue_len\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eheads\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehead_dim\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"n\"\u003ekeys\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ekeys\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ereshape\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eN\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ekey_len\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eheads\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehead_dim\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"n\"\u003equeries\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003equery\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ereshape\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eN\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003equery_len\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eheads\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehead_dim\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e# Apply linear transformation (separately for each head)\u003c/span\u003e\n        \u003cspan class=\"n\"\u003evalues\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003evalues\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003evalues\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"n\"\u003ekeys\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ekeys\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ekeys\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"n\"\u003equeries\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003equeries\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003equeries\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e# Attention mechanism (using torch.matmul for batch matrix multiplication)\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e# Calculate attention score\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eattention\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003etorch\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ematmul\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003equeries\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ekeys\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etranspose\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u003c/span\u003e \u003cspan class=\"n\"\u003etorch\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esqrt\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etorch\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etensor\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehead_dim\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003edtype\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003etorch\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003efloat32\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eattention\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eF\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esoftmax\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eattention\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003edim\u003c/span\u003e\u003cspan class=\"o\"\u003e=-\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e# Apply attention weights to values\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eout\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003etorch\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ematmul\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eattention\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003evalues\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e# Concatenate heads\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eout\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eout\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ereshape\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eN\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003equery_len\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eheads\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehead_dim\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e# Final linear layer\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eout\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003efc_out\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eout\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eout\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e# Example usage\u003c/span\u003e\n\u003cspan class=\"n\"\u003eembed_size\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e256\u003c/span\u003e\n\u003cspan class=\"n\"\u003eheads\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e8\u003c/span\u003e\n\u003cspan class=\"n\"\u003eN\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e  \u003cspan class=\"c1\"\u003e# Batch size\u003c/span\u003e\n\u003cspan class=\"n\"\u003esentence_length\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e5\u003c/span\u003e  \u003cspan class=\"c1\"\u003e# Length of the input sequence\u003c/span\u003e\n\u003cspan class=\"n\"\u003emodel\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eMultiHeadAttention\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eembed_size\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eheads\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e# Dummy input (batch size, sentence length, embedding size)\u003c/span\u003e\n\u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003etorch\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erand\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"n\"\u003eN\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esentence_length\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eembed_size\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e# Forward pass\u003c/span\u003e\n\u003cspan class=\"n\"\u003eout\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003emodel\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e  \u003cspan class=\"c1\"\u003e# In self-attention, queries, keys, values are all the same\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eprint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Input shape:\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eshape\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"k\"\u003eprint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Output shape:\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eout\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eshape\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2\u003e4 训练过程为什么需要 Mask 机制？\u003c/h2\u003e\u003cp data-pid=\"XwXiDv7v\"\u003e两个原因。 1. 屏蔽未来信息，防止未来帧参与训练。 2. 处理不同长度的序列，在批处理时对较短的序列进行填充（padding），并确保这些填充不会影响到模型的输出。\u003c/p\u003e\u003ch2\u003e5 mask机制如何实现？\u003c/h2\u003e\u003col\u003e\u003cli data-pid=\"LIcBu2yJ\"\u003e 屏蔽未来信息的 Mask：在自注意力层中，通过构造一个上三角矩阵（对于解码器），其中上三角部分（包括对角线，取决于具体实现）被设置为非常大的负数，这样在通过 softmax 层时，这些位置的权重接近于0，从而在计算加权和时不考虑未来的词。\u003cbr/\u003e \u003c/li\u003e\u003cli data-pid=\"ghAA66Lu\"\u003e Padding Mask：将填充位置的值设置为一个大的负数，使得经过 softmax 层后，这些位置的权重接近于0。\u003cbr/\u003e \u003c/li\u003e\u003c/ol\u003e\u003ch2\u003e6 Transformer 中的Positional Encoding有什么作用？\u003c/h2\u003e\u003cp data-pid=\"y25byQO3\"\u003e保证attention机制考虑序列的顺序，否则无法区分不同的位置的相同的输入。\u003c/p\u003e\u003ch2\u003e7 Transformer 如何处理长距离依赖问题？\u003c/h2\u003e\u003cp data-pid=\"Hcqmlucn\"\u003eTransformer 通过自注意力机制直接计算序列中任意两个位置之间的依赖关系，从而有效地解决了长距离依赖问题。\u003c/p\u003e\u003ch2\u003e8 Layer Normalization的作用是什么？\u003c/h2\u003e\u003cp data-pid=\"joph5Dca\"\u003eLayer Normalization有助于稳定深层网络的训练，通过对输入的每一层进行标准化处理（使输出均值为0，方差为1），可以加速训练过程并提高模型的稳定性。它通常在自注意力和前馈网络的输出上应用。\u003c/p\u003e\u003ch2\u003e9 能否用Batch Normalizatioin?\u003c/h2\u003e\u003cp data-pid=\"iaPoi4jj\"\u003e在 Transformer 架构中，层归一化（Layer Normalization，简称 LayerNorm）是首选的归一化方法，主要用于模型内部的每一层之后。理论上，层归一化可以被批归一化（Batch Normalization，简称 BatchNorm）替换，但是这两种归一化技术在应用上有着本质的不同，这些差异导致了在 Transformer 中通常优先选择层归一化而不是批归一化。\u003c/p\u003e\u003ch3\u003e层归一化（Layer Normalization）\u003c/h3\u003e\u003cul\u003e\u003cli data-pid=\"CYB4t3iG\"\u003e层归一化是对每个样本的所有特征执行归一化操作，独立于其他样本。这意味着，无论批次大小如何，LayerNorm 的行为都是一致的。\u003c/li\u003e\u003cli data-pid=\"ywGjNcp7\"\u003e在处理序列数据和自注意力机制时，LayerNorm 更加有效，因为它能够适应不同长度的输入，这在自然语言处理任务中尤为重要。\u003c/li\u003e\u003cli data-pid=\"WiX5JSXA\"\u003eLayerNorm 直接在每个样本的维度上工作，使得它在序列长度变化的情况下更为稳定。\u003c/li\u003e\u003c/ul\u003e\u003ch3\u003e批归一化（Batch Normalization）\u003c/h3\u003e\u003cul\u003e\u003cli data-pid=\"LbT9KXGG\"\u003e批归一化是在一个小批量的维度上进行归一化，这意味着它依赖于批次中所有样本的统计信息。因此，BatchNorm的行为会随着批次大小和内容的变化而变化，这在训练和推理时可能导致不一致的表现。 \u003c/li\u003e\u003cli data-pid=\"ZtiuTp6a\"\u003e在处理变长序列和自注意力结构时，BatchNorm可能不如 LayerNorm 高效，因为变长输入使得批次间的统计信息更加不稳定。\u003c/li\u003e\u003cli data-pid=\"fKh5Al80\"\u003eBatchNorm在训练时计算当前批次的均值和方差，在推理时使用整个训练集的移动平均统计信息。这种依赖于批次统计信息的特性使得 BatchNorm在小批量或在线学习场景中表现不佳。\u003c/li\u003e\u003c/ul\u003e\u003ch2\u003e10 手写Transformer中的Encoder模块\u003c/h2\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode class=\"language-python\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003etorch\u003c/span\u003e\n\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003etorch.nn\u003c/span\u003e \u003cspan class=\"kn\"\u003eas\u003c/span\u003e \u003cspan class=\"nn\"\u003enn\u003c/span\u003e\n\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003etorch.nn.functional\u003c/span\u003e \u003cspan class=\"kn\"\u003eas\u003c/span\u003e \u003cspan class=\"nn\"\u003eF\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eMultiHeadSelfAttention\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enn\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eModule\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"fm\"\u003e__init__\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eembed_size\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eheads\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"nb\"\u003esuper\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eMultiHeadSelfAttention\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"fm\"\u003e__init__\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eembed_size\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eembed_size\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eheads\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eheads\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehead_dim\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eembed_size\u003c/span\u003e \u003cspan class=\"o\"\u003e//\u003c/span\u003e \u003cspan class=\"n\"\u003eheads\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eassert\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\n            \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehead_dim\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003eheads\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003eembed_size\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Embedding size needs to be divisible by heads\u0026#34;\u003c/span\u003e\n\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003evalues\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enn\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLinear\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehead_dim\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehead_dim\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ebias\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"bp\"\u003eFalse\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ekeys\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enn\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLinear\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehead_dim\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehead_dim\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ebias\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"bp\"\u003eFalse\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003equeries\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enn\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLinear\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehead_dim\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehead_dim\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ebias\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"bp\"\u003eFalse\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003efc_out\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enn\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLinear\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eheads\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehead_dim\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eembed_size\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003eforward\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003evalues\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ekeys\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003equeries\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eN\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003equeries\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eshape\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n        \u003cspan class=\"n\"\u003evalue_len\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ekey_len\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003equery_len\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003evalues\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eshape\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"n\"\u003ekeys\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eshape\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"n\"\u003equeries\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eshape\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e# Split the embedding into self.heads different pieces\u003c/span\u003e\n        \u003cspan class=\"n\"\u003evalues\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003evalues\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ereshape\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eN\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003evalue_len\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eheads\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehead_dim\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"n\"\u003ekeys\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ekeys\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ereshape\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eN\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ekey_len\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eheads\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehead_dim\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"n\"\u003equeries\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003equeries\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ereshape\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eN\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003equery_len\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eheads\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehead_dim\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n        \u003cspan class=\"n\"\u003evalues\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003evalues\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003evalues\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"n\"\u003ekeys\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ekeys\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ekeys\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"n\"\u003equeries\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003equeries\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003equeries\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e# Attention mechanism\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e#attention = torch.einsum(\u0026#34;nqhd,nkhd-\u0026gt;nhqk\u0026#34;, [queries, keys])\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eattention\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003etorch\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ematmul\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003equeries\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ekeys\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etranspose\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u003c/span\u003e \u003cspan class=\"n\"\u003etorch\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esqrt\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etorch\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etensor\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehead_dim\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003edtype\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003etorch\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003efloat32\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\n        \u003cspan class=\"n\"\u003eattention\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eF\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esoftmax\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eattention\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eembed_size\u003c/span\u003e \u003cspan class=\"o\"\u003e**\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u003c/span\u003e \u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e)),\u003c/span\u003e \u003cspan class=\"n\"\u003edim\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n        \u003cspan class=\"n\"\u003eout\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003etorch\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ematmul\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eattention\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003evalues\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ereshape\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eN\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003equery_len\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eheads\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehead_dim\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e# out = torch.einsum(\u0026#34;nhql,nlhd-\u0026gt;nqhd\u0026#34;, [attention, values]).reshape(\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eN\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003equery_len\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eheads\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehead_dim\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n        \u003cspan class=\"n\"\u003eout\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003efc_out\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eout\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eout\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eTransformerBlock\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enn\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eModule\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"fm\"\u003e__init__\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eembed_size\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eheads\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003edropout\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eforward_expansion\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"nb\"\u003esuper\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eTransformerBlock\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"fm\"\u003e__init__\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eattention\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eMultiHeadSelfAttention\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eembed_size\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eheads\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003enorm1\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enn\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLayerNorm\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eembed_size\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003enorm2\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enn\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLayerNorm\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eembed_size\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003efeed_forward\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enn\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSequential\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n            \u003cspan class=\"n\"\u003enn\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLinear\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eembed_size\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eforward_expansion\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003eembed_size\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n            \u003cspan class=\"n\"\u003enn\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eReLU\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e\n            \u003cspan class=\"n\"\u003enn\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLinear\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eforward_expansion\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003eembed_size\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eembed_size\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edropout\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enn\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDropout\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edropout\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003eforward\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003equery\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eattention\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eattention\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003equery\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edropout\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003enorm1\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eattention\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003equery\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eforward\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003efeed_forward\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eout\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edropout\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003enorm2\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eforward\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eout\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eEncoder\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enn\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eModule\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"fm\"\u003e__init__\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eembed_size\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"n\"\u003enum_layers\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eheads\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"n\"\u003edevice\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eforward_expansion\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"n\"\u003edropout\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e):\u003c/span\u003e\n\n        \u003cspan class=\"nb\"\u003esuper\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eEncoder\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"fm\"\u003e__init__\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eembed_size\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eembed_size\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edevice\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edevice\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003elayers\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enn\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eModuleList\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e[\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eTransformerBlock\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003eembed_size\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003eheads\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003edropout\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003edropout\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003eforward_expansion\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eforward_expansion\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003e_\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"nb\"\u003erange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enum_layers\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e]\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edropout\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enn\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDropout\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edropout\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003eforward\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eout\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edropout\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003elayer\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003elayers\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eout\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003elayer\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eout\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eout\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eout\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eout\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e# Hyperparameters\u003c/span\u003e\n\u003cspan class=\"n\"\u003eembed_size\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e512\u003c/span\u003e\n\u003cspan class=\"n\"\u003enum_layers\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e6\u003c/span\u003e\n\u003cspan class=\"n\"\u003eheads\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e8\u003c/span\u003e\n\u003cspan class=\"n\"\u003edevice\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;cuda\u0026#34;\u003c/span\u003e \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003etorch\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecuda\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eis_available\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;cpu\u0026#34;\u003c/span\u003e\n\u003cspan class=\"n\"\u003eforward_expansion\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e4\u003c/span\u003e\n\u003cspan class=\"n\"\u003edropout\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mf\"\u003e0.1\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e# Example\u003c/span\u003e\n\u003cspan class=\"n\"\u003eencoder\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eEncoder\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eembed_size\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003enum_layers\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eheads\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003edevice\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eforward_expansion\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003edropout\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eto\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edevice\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003c/p\u003e","is_labeled":false,"visited_count":25961,"thumbnails":["https://picx.zhimg.com/50/v2-bf325922a74ad548743a205ddf5eae8c_720w.jpg?source=b6762063","https://picx.zhimg.com/50/v2-12f355e47b21eeb9bb7c0c3a02870ae9_720w.jpg?source=b6762063"],"favorite_count":2146,"article_type":"normal","is_navigator":false,"navigator_vote":false,"vote_next_step":"vote"},"brief":"{\"source\": \"TS\", \"type\": \"article\", \"id\": 682585974}","attached_info":"CqkHCPmL+abA1MCFogEQBxoJMjM5ODE1OTkwIIa/xa4GKPAFMAZAF0owCgZJdGVtQ0YSIGRvY190eXBlOiBBcnRpY2xlCmlkOiAyNTg5NTY5MjkKGAAgADoAWggxMjg2NjIzOGIgYTYwYmM5MTljOGQ4MzVkNmNlZTliYTY0MDZjYTZjZjJyCTY4MjU4NTk3NIoBFWNfMTQ1MDUxNTM2NzM3ODA2MzM2MKoBCXJlY29tbWVuZMIBIGVjMTZiNDlhNGVhOGE0MDZmMjhmMjY5ODIwYjhkN2Q58gEKCAwSBk5vcm1hbPIBKAgKEiRjZjRhYzAyOS0yYzVmLTQzOGYtYjQ4Zi1hZDc4ODQ5NTNiMWHyAQUICxIBNIICAIgC/+mLzvoykgIgZWMxNmI0OWE0ZWE4YTQwNmYyOGYyNjk4MjBiOGQ3ZDmaAgDKAhZTaG9ySW50ZXJlc3RXZWlnaHRSdWxlygIYUGVyaW9kSW50ZXJlc3RXZWlnaHRSdWxlygIVVXNlckxjbkV4aXRXZWlnaHRSdWxlygIUQ29udGVudEFnZVdlaWdodFJ1bGXKAhxCYXllc0ZpcnN0TGV2ZWxJc29sYXRpb25SdWxl2gIGSXRlbUNG6AID+gILTk9STUFMX0ZMT1eKAyAzYTY5NWI2N2I3MzY0OGIwOGQ4Y2YyM2MzYmM1Y2FmMJoDDQoCdjIQABoFb3RoZXKoA+nKAdgDAOoDFXRleHRBbGxTaXRlTXZJdGVtQ0ZWMvoD2gESDFVOS05PV05fTU9ERSAAKg1OT19JTUFHRV9NT0RFOi0IAhC/DhiFASIjdjItMzU0NzlkYTU5YTJlZWZlNTllNTIzYjA2OTEwYjk5NzY6LAgCEKMFGH4iI3YyLTFiNjNlNDYxNThhZDU2M2I1YzIyYjllMjAxNDU1OWZiOi0IBBCHCBjuCSIjdjItZmY3NjllZTAzNDU3NzZjNGFiYTQzMjA2NDQwZWE4MzM6LQgCELUQGIoJIiN2Mi1hYjJhZDI1ZDdjYzM3OWRlMThkM2U5NGUzZWEwNzhjZoAEAIgEAJIEBk5vcm1hbJoEATOgBACoBACwBAC6BAZtYW51YWzCBAMxNzDIBADSBA/mjqjojZDlt7Lmm7TmlrDYBADwBAD5BAAAACBBp44/gQUAAAAAAAAAAIkFiyXxOlgz0T+SBQCaBQNkZnSiBQNkZnSyBQExuQUAAAAAAAAAANAFAOAFAOgFAPAFBJAGAKAGF6gGAJICJAoJMjM5ODE1OTkwEgk2ODI1ODU5NzQYByIKSU1BR0VfVEVYVA==","action_card":false}],"paging":{"is_end":false,"is_start":false,"next":"https://www.zhihu.com/api/v3/feed/topstory/recommend?action=down\u0026ad_interval=-10\u0026after_id=23\u0026desktop=true\u0026end_offset=23\u0026page_number=5\u0026session_token=a60bc919c8d835d6cee9ba6406ca6cf2","previous":"https://www.zhihu.com/api/v3/feed/topstory/recommend?action=pull\u0026ad_interval=-10\u0026before_id=23\u0026desktop=true\u0026end_offset=23\u0026page_number=5\u0026session_token=a60bc919c8d835d6cee9ba6406ca6cf2","totals":0},"fresh_text":"推荐已更新"}
