{"data":[{"id":"96_1753854172.526","type":"feed","offset":96,"verb":"TOPIC_ACKNOWLEDGED_ARTICLE","created_time":1753854172,"updated_time":1753854172,"target":{"id":"1932122767123264318","type":"article","url":"https://api.zhihu.com/articles/1932122767123264318","author":{"id":"fab08e85fe6abb3765b759d99696a887","url":"https://api.zhihu.com/people/fab08e85fe6abb3765b759d99696a887","user_type":"people","url_token":"vllbc","name":"vllbc","headline":"nlper","avatar_url":"https://picx.zhimg.com/50/v2-ac39741b84929a35e2e4688233ed1e29_l.jpg?source=b6762063","is_org":false,"gender":-1,"followers_count":27,"is_following":false,"is_followed":false},"title":"verl的多轮工具调用（agent_loop）","comment_permission":"all","created":1753434169,"updated":1753706369,"voteup_count":75,"voting":0,"comment_count":1,"linkbox":{"category":"","pic":"","title":"","url":""},"excerpt":"Verl 最近实现了 agent loop 功能，也就是多轮工具调用 RL ，弥补了 verl 中 vllm 无法使用多轮 rollout 的不足。整体流程大致如下（来自 https://github.com/zhaochenyang20/Awesome-ML-SYS-Tutorial/blob/main/rlhf/verl/multi-turn/imgs/Multi-Turn_Rollout_Workflow.png ）   在官方实现中（目前在 verl/experimental/agent_loop 目录下），核心代码在 agent_loop.py中，single_turn_agent_loop.py和tool_agent_loop对应两种agent_loop，tool_parser.py定义了hermes工具解析类。所以重点就是在agent_loop.py中，各个类的协作流程如下图（来…","excerpt_new":"Verl 最近实现了 agent loop 功能，也就是多轮工具调用 RL ，弥补了 verl 中 vllm 无法使用多轮 rollout 的不足。整体流程大致如下（来自 https://github.com/zhaochenyang20/Awesome-ML-SYS-Tutorial/blob/main/rlhf/verl/multi-turn/imgs/Multi-Turn_Rollout_Workflow.png ）   在官方实现中（目前在 verl/experimental/agent_loop 目录下），核心代码在 agent_loop.py中，single_turn_agent_loop.py和tool_agent_loop对应两种agent_loop，tool_parser.py定义了hermes工具解析类。所以重点就是在agent_loop.py中，各个类的协作流程如下图（来…","preview_type":"default","preview_text":"","content":"\u003cp data-pid=\"QVeRvc-k\"\u003eVerl 最近实现了 agent loop 功能，也就是多轮工具调用 RL ，弥补了 verl 中 vllm 无法使用多轮 rollout 的不足。整体流程大致如下（来自 \u003ca href=\"https://link.zhihu.com/?target=https%3A//github.com/zhaochenyang20/Awesome-ML-SYS-Tutorial/blob/main/rlhf/verl/multi-turn/imgs/Multi-Turn_Rollout_Workflow.png\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003e\u003cspan class=\"invisible\"\u003ehttps://\u003c/span\u003e\u003cspan class=\"visible\"\u003egithub.com/zhaochenyang\u003c/span\u003e\u003cspan class=\"invisible\"\u003e20/Awesome-ML-SYS-Tutorial/blob/main/rlhf/verl/multi-turn/imgs/Multi-Turn_Rollout_Workflow.png\u003c/span\u003e\u003cspan class=\"ellipsis\"\u003e\u003c/span\u003e\u003c/a\u003e）\u003c/p\u003e\u003cp class=\"ztext-empty-paragraph\"\u003e\u003cbr/\u003e\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic4.zhimg.com/v2-06a066a39b1ebcd7d623589ea511273b_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"2110\" data-rawheight=\"1254\" data-original-token=\"v2-d2933240409e64044198afe8bb996712\" class=\"origin_image zh-lightbox-thumb\" width=\"2110\" data-original=\"https://pic4.zhimg.com/v2-06a066a39b1ebcd7d623589ea511273b_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"zDKltId8\"\u003e在官方实现中（目前在 verl/experimental/agent_loop 目录下），核心代码在 agent_loop.py中，single_turn_agent_loop.py和tool_agent_loop对应两种agent_loop，tool_parser.py定义了hermes工具解析类。所以重点就是在agent_loop.py中，各个类的协作流程如下图（来自deepwiki）：\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic3.zhimg.com/v2-394dd3ecde037d7e71fa51af4cb09ea2_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"2978\" data-rawheight=\"1890\" data-original-token=\"v2-1e7fc94ca0bdb73c43ec4e1259da815f\" class=\"origin_image zh-lightbox-thumb\" width=\"2978\" data-original=\"https://pic3.zhimg.com/v2-394dd3ecde037d7e71fa51af4cb09ea2_r.jpg\"/\u003e\u003c/figure\u003e\u003cp class=\"ztext-empty-paragraph\"\u003e\u003cbr/\u003e\u003c/p\u003e\u003cp data-pid=\"6GSSK69p\"\u003everl官方文档图如下（[Agent Loop — verl documentation](\u003ca href=\"https://link.zhihu.com/?target=https%3A//verl.readthedocs.io/en/latest/advance/agent_loop.html\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003e\u003cspan class=\"invisible\"\u003ehttps://\u003c/span\u003e\u003cspan class=\"visible\"\u003everl.readthedocs.io/en/\u003c/span\u003e\u003cspan class=\"invisible\"\u003elatest/advance/agent_loop.html\u003c/span\u003e\u003cspan class=\"ellipsis\"\u003e\u003c/span\u003e\u003c/a\u003e)）：\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic2.zhimg.com/v2-4c3d0e047c66e242619eae36e35cebe1_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1026\" data-rawheight=\"837\" data-original-token=\"v2-04e482c9bfb422955f25b5d86247cb16\" class=\"origin_image zh-lightbox-thumb\" width=\"1026\" data-original=\"https://pic2.zhimg.com/v2-4c3d0e047c66e242619eae36e35cebe1_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"w_-0mDni\"\u003e按照上面的流程图进行逐步讲解。\u003c/p\u003e\u003ch3\u003eAgentLoopManager\u003c/h3\u003e\u003cp data-pid=\"qUjr_TTH\"\u003eAgentLoopManager是入口处，在ray_trainer.py中由actor_rollout_wg初始化：\u003c/p\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode class=\"language-python\"\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003econfig\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eactor_rollout_ref\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erollout\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emode\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;async\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"kn\"\u003efrom\u003c/span\u003e \u003cspan class=\"nn\"\u003everl.experimental.agent_loop\u003c/span\u003e \u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"n\"\u003eAgentLoopManager\u003c/span\u003e\n\n            \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003easync_rollout_mode\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eTrue\u003c/span\u003e\n            \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003easync_rollout_manager\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eAgentLoopManager\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n                \u003cspan class=\"n\"\u003econfig\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003econfig\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eworker_group\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eactor_rollout_wg\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp data-pid=\"nCr3-Hsh\"\u003eAgentLoopManager需要先启动多个推理引擎服务器，数量为dp_size（world_size / tp_size ）。代码：\u003c/p\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode class=\"language-python\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eAgentLoopManager\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u0026#34;Agent loop manager that manages a group of agent loop workers.\u0026#34;\u0026#34;\u0026#34;\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"fm\"\u003e__init__\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003econfig\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eDictConfig\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eworker_group\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eRayWorkerGroup\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u0026#34;Initialize agent loop manager.\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e        Args:\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e            config (DictConfig): trainer config.\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e            worker_group (RayWorkerGroup): ActorRolloutRef worker group.\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e        \u0026#34;\u0026#34;\u0026#34;\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003econfig\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003econfig\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eworker_group\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eworker_group\u003c/span\u003e\n\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e_initialize_llm_servers\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e_init_agent_loop_workers\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003e_initialize_llm_servers\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e# 这里也对应了一开始图中的最下面的部分\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erollout_tp_size\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003econfig\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eactor_rollout_ref\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erollout\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etensor_model_parallel_size\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erollout_dp_size\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eworker_group\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eworld_size\u003c/span\u003e \u003cspan class=\"o\"\u003e//\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erollout_tp_size\u003c/span\u003e\n        \u003cspan class=\"o\"\u003e...\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eunready_dp_ranks\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003erange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erollout_dp_size\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ewhile\u003c/span\u003e \u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eunready_dp_ranks\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eservers\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003erollout_dp_rank\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eserver_class\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eoptions\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n                    \u003cspan class=\"c1\"\u003e# make sure AsyncvLLMServer colocates with its corresponding workers\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003escheduling_strategy\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eray\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eutil\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003escheduling_strategies\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNodeAffinitySchedulingStrategy\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003enode_id\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eworkers_info\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003erollout_dp_rank\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erollout_tp_size\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003esoft\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"bp\"\u003eFalse\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                    \u003cspan class=\"p\"\u003e),\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ef\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;async_llm_server_{rollout_dp_rank}\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eremote\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003econfig\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erollout_dp_size\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003erollout_dp_rank\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eworker_group\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ename_prefix\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003erollout_dp_rank\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003eunready_dp_ranks\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003erollout_dp_rank\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eserver\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003eservers\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eitems\u003c/span\u003e\u003cspan class=\"p\"\u003e():\u003c/span\u003e\n                \u003cspan class=\"k\"\u003etry\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003eaddress\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eray\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eserver\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eget_server_address\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eremote\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\n                    \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eserver_addresses\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003erollout_dp_rank\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eaddress\u003c/span\u003e\n                    \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003easync_llm_servers\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003erollout_dp_rank\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eserver\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003eunready_dp_ranks\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eremove\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003erollout_dp_rank\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eexcept\u003c/span\u003e \u003cspan class=\"ne\"\u003eException\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003eray\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ekill\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eserver\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eprint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ef\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;rollout server {rollout_dp_rank} failed, maybe address already in use, restarting...\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e# All server instances are ready, init AsyncLLM engine.\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eray\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e([\u003c/span\u003e\u003cspan class=\"n\"\u003eserver\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003einit_engine\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eremote\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003eserver\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003easync_llm_servers\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp data-pid=\"IR72Z8CA\"\u003eAgentLoopManager负责管理多个AgentLoopWorker，个数由参数\u003ccode\u003erollout.agent.num_workers\u003c/code\u003e确定。然后将prompt切分成num_worker个，让各个worker分别进行推理，这部分的代码如下：\u003c/p\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode class=\"language-python\"\u003e\u003cspan class=\"c1\"\u003e## 初始化各个worker\u003c/span\u003e\n \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003e_init_agent_loop_workers\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eagent_loop_workers\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[]\u003c/span\u003e\n        \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"nb\"\u003erange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003econfig\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eactor_rollout_ref\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erollout\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eagent\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003enum_workers\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n            \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eagent_loop_workers\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eappend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eAgentLoopWorker\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eoptions\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ef\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;agent_loop_worker_{i}\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eremote\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003econfig\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003easync_llm_servers\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"o\"\u003e...\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e## 根据worker的数量切分prompts，推理后再合并起来\u003c/span\u003e\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003egenerate_sequences\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eprompts\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eDataProto\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eDataProto\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003econfig\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eactor_rollout_ref\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erollout\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003efree_cache_engine\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ewake_up\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"n\"\u003echunkes\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eprompts\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003echunk\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eagent_loop_workers\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eoutputs\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eray\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e[\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eworker\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003egenerate_sequences\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eremote\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003echunk\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003eworker\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003echunk\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"nb\"\u003ezip\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eagent_loop_workers\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003echunkes\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003estrict\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"bp\"\u003eTrue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e]\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eoutput\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eDataProto\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003econcat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eoutputs\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp data-pid=\"YH1U9jah\"\u003e从初始化也说明了，我们在RayPPOTrainer中init_workers方法里面初始化好AgentLoopManager，同时也初始化好了推理服务器和各个workers。\u003c/p\u003e\u003ch3\u003eAsyncLLMServerManager\u003c/h3\u003e\u003cp data-pid=\"Enf98E7a\"\u003e在上面的代码中，可以看到我们在创建各个worker的时候传入了初始化好的servers，需要一个类来对这些server进行管理，即\u003ccode\u003eAsyncLLMServerManager\u003c/code\u003e类。具体的作用就是针对不同的request，来选择哪一个server进行推理，使用LRU算法来进行管理，具体如下：\u003c/p\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode class=\"language-python\"\u003e\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"fm\"\u003e__init__\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003econfig\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eDictConfig\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eserver_handles\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nb\"\u003elist\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eray\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eactor\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eActorHandle\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"n\"\u003emax_cache_size\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nb\"\u003eint\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e10000\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u0026#34;Initialize the AsyncLLMServerManager.\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e        Args:\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e            config (DictConfig): YAML config.\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e            server_handles (List[ray.actor.ActorHandle]): OpenAI compatible LLM server actor handles.\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e            max_cache_size (int, optional): max cache size for request_id to server mapping. Defaults to 10000.\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e        \u0026#34;\u0026#34;\u0026#34;\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003econfig\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003econfig\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eserver_handles\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eserver_handles\u003c/span\u003e\n        \u003cspan class=\"n\"\u003erandom\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eshuffle\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eserver_handles\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e# Least requests load balancing\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eweighted_serveres\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003ehash\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eserver\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003eserver\u003c/span\u003e\u003cspan class=\"p\"\u003e)]\u003c/span\u003e \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003eserver\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003eserver_handles\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eheapq\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eheapify\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eweighted_serveres\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e# LRU cache to map request_id to server\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erequest_id_to_server\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eLRUCache\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emaxsize\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003emax_cache_size\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003e_choose_server\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003erequest_id\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nb\"\u003estr\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eray\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eactor\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eActorHandle\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e# TODO: implement server pressure awareness load balancing\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003erequest_id\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erequest_id_to_server\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erequest_id_to_server\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003erequest_id\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\n        \u003cspan class=\"n\"\u003eserver\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eweighted_serveres\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e][\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e][\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eweighted_serveres\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e][\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eheapq\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eheapreplace\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eweighted_serveres\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eweighted_serveres\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erequest_id_to_server\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003erequest_id\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eserver\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eserver\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp data-pid=\"JwAx0NtM\"\u003e具体做法解释如下： 1. 建立了一个最小堆\u003ccode\u003eself.weighted_serveres\u003c/code\u003e，列表中的每个元素结构是 [0, (hash(server), server)]，即 [请求计数, (服务器哈希, 服务器句柄)]。heapq.heapify(self.weighted_serveres) 将这个列表转换成一个最小堆，堆的排序依据是每个元素的第一个值，也就是 请求计数。因此，请求数最少的服务器始终位于堆的顶部（self.weighted_serveres[0]）。 2. 创建了一个 self.request_id_to_server，这是一个 LRU (Least Recently Used) 缓存。这个缓存用于存储 request_id 到 server 句柄的映射。 3. 首先检查request_id是否在映射中，如果在的话直接返回对应的服务器句柄，否则需要给它分配一个全新的server，也就是请求计数最少的那个server，然后再更新堆和映射。\u003c/p\u003e\u003cp data-pid=\"p42SpR01\"\u003e这样做的目的是为了各个服务器之间的负载均衡。\u003c/p\u003e\u003cp data-pid=\"OV3ONde3\"\u003e实际的生成就是由这个类进行的，即\u003c/p\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode class=\"language-python\"\u003e\u003cspan class=\"nd\"\u003e@rollout_trace_op\u003c/span\u003e\n    \u003cspan class=\"n\"\u003easync\u003c/span\u003e \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003egenerate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"n\"\u003erequest_id\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eprompt_ids\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nb\"\u003elist\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nb\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e\n        \u003cspan class=\"n\"\u003esampling_params\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nb\"\u003edict\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nb\"\u003estr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eAny\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan class=\"nb\"\u003elist\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nb\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e]:\u003c/span\u003e\n        \u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u0026#34;Generate tokens from prompt ids.\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e        Args:\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e            request_id (str): request id for sticky session.\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e            prompt_ids (List[int]): List of prompt token ids.\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e            sampling_params (Dict[str, Any]): Sampling parameters for the chat completion.\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e        Returns:\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e            List[int]: List of generated token ids.\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e        \u0026#34;\u0026#34;\u0026#34;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eserver\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e_choose_server\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003erequest_id\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eoutput\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eawait\u003c/span\u003e \u003cspan class=\"n\"\u003eserver\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003egenerate\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eremote\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n            \u003cspan class=\"n\"\u003erequest_id\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003erequest_id\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eprompt_ids\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eprompt_ids\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n            \u003cspan class=\"n\"\u003esampling_params\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003esampling_params\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eoutput\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp data-pid=\"td7Mx-2k\"\u003e先选择合适的server，再利用该server的generate方法来进行推理。具体的类和方法在workers/rollout下。\u003c/p\u003e\u003ch3\u003eAgentLoopWorker\u003c/h3\u003e\u003cp data-pid=\"RMdwlsLC\"\u003e现在回到AgentLoopWorker中，前面已经提到了，我们用AgentLoopManager管理多个Worker，每一个Worker都可以用所有创建的server进行推理，接下来就看worker的generate_sequcences方法做了什么：\u003c/p\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode class=\"language-python\"\u003e\u003cspan class=\"n\"\u003easync\u003c/span\u003e \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003egenerate_sequences\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ebatch\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eDataProto\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eDataProto\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n        \u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u0026#34;Generate sequences from agent loop.\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e        Args:\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e            batch (DataProto): Input batch.\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e        Returns:\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e            DataProto: Output batch.\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e            - prompts: [bsz, prompt_length], prompt token ids from dataset.\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e            - responses: [bsz, response_length], output token ids include response tokens\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e              from LLM generation and observation tokens from tool_calls.\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e            - response_mask: [bsz, response_length], 1 for LLM generated tokens, 0 for observation/padding tokens.\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e            - input_ids: [bsz, prompt_length + response_length], whole sequence token ids, including prompt tokens\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e              and response tokens.\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e            - attention_mask: [bsz, prompt_length + response_length], 0 for padding tokens, 1 for other tokens.\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e            - position_ids: [bsz, prompt_length + response_length], incremental position ids.\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e            For multi-turn conversations:\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e            responses:     |\u0026lt;- LLM generation -\u0026gt;|\u0026lt;- tool_calls -\u0026gt;|\u0026lt;- LLM generation -\u0026gt;|\u0026lt;- padding -\u0026gt;|\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e            response_mask: | 1, 1, 1, ..., 1, 1 | 0, 0, .., 0, 0 | 1, 1, 1, ..., 1, 1 | 0, 0, ..., 0|\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e        \u0026#34;\u0026#34;\u0026#34;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003econfig\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003econfig\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eactor_rollout_ref\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erollout\u003c/span\u003e\n        \u003cspan class=\"n\"\u003esampling_params\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003edict\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n            \u003cspan class=\"n\"\u003etemperature\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003econfig\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etemperature\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n            \u003cspan class=\"n\"\u003etop_p\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003econfig\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etop_p\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n            \u003cspan class=\"n\"\u003erepetition_penalty\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mf\"\u003e1.0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e# override sampling params for validation\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003ebatch\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emeta_info\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;validate\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"bp\"\u003eFalse\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n            \u003cspan class=\"n\"\u003esampling_params\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;top_p\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003econfig\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eval_kwargs\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etop_p\u003c/span\u003e\n            \u003cspan class=\"n\"\u003esampling_params\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;temperature\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003econfig\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eval_kwargs\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etemperature\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e# by default, we assume it\u0026#39;s a single turn agent\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;agent_name\u0026#34;\u003c/span\u003e \u003cspan class=\"ow\"\u003enot\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003ebatch\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003enon_tensor_batch\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"n\"\u003ebatch\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003enon_tensor_batch\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;agent_name\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e([\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;single_turn_agent\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebatch\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003edtype\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"nb\"\u003eobject\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n        \u003cspan class=\"n\"\u003etasks\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[]\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eagent_names\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ebatch\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003enon_tensor_batch\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;agent_name\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eraw_prompts\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ebatch\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003enon_tensor_batch\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;raw_prompt\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;index\u0026#34;\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003ebatch\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003enon_tensor_batch\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eindex\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ebatch\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003enon_tensor_batch\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;index\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eelse\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eindex\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003earange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eraw_prompts\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\n        \u003cspan class=\"n\"\u003etrajectory_info\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eawait\u003c/span\u003e \u003cspan class=\"n\"\u003eget_trajectory_info\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n            \u003cspan class=\"n\"\u003ebatch\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emeta_info\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;global_steps\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003eindex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ebatch\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emeta_info\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;validate\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"bp\"\u003eFalse\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003eagent_name\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003emessages\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003etrajectory\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"nb\"\u003ezip\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eagent_names\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eraw_prompts\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003etrajectory_info\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003estrict\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"bp\"\u003eTrue\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n            \u003cspan class=\"n\"\u003etasks\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eappend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n                \u003cspan class=\"n\"\u003easyncio\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecreate_task\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e_run_agent_loop\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eagent_name\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003emessages\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etolist\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"n\"\u003esampling_params\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003etrajectory\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eoutputs\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eawait\u003c/span\u003e \u003cspan class=\"n\"\u003easyncio\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003egather\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003etasks\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n        \u003cspan class=\"n\"\u003eoutput\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e_postprocess\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eoutputs\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eoutput\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp data-pid=\"QOdYWWcB\"\u003e根据注释的信息，输入为batch数据，输出为推理后的prompt、response、mask等。这里需要先判断使用的agent_loop的类型，前面提到这里实现了single_turn和tool两种agent_loop，此外用户可以根据\u003ccode\u003eAgentLoopBase\u003c/code\u003e抽象类来自定义agent_loop（init_class和run两个方法）。 这里先是有一个判断，如果数据集中没有agent_name字段，则默认就是single_turn类型，因此如果你想使用agent_loop，必须在数据预处理的时候加入agent_name字段为tool_agent。这里创建了一个叫trajectory_info的变量，目的是为了rollout_trace，来区分保存到文件中的各个prompt生成的response。接下来进入到_run_agent_loop方法中：\u003c/p\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode class=\"language-python\"\u003e\u003cspan class=\"n\"\u003easync\u003c/span\u003e \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003e_run_agent_loop\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eagent_name\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nb\"\u003estr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"n\"\u003emessages\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nb\"\u003elist\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nb\"\u003edict\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nb\"\u003estr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eAny\u003c/span\u003e\u003cspan class=\"p\"\u003e]],\u003c/span\u003e\n        \u003cspan class=\"n\"\u003esampling_params\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nb\"\u003edict\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nb\"\u003estr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eAny\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e\n        \u003cspan class=\"n\"\u003etrajectory\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nb\"\u003edict\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nb\"\u003estr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eAny\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eAgentLoopOutput\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ewith\u003c/span\u003e \u003cspan class=\"n\"\u003erollout_trace_attr\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n            \u003cspan class=\"n\"\u003estep\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003etrajectory\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;step\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e\n            \u003cspan class=\"n\"\u003esample_index\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003etrajectory\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;sample_index\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e\n            \u003cspan class=\"n\"\u003erollout_n\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003etrajectory\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;rollout_n\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e\n            \u003cspan class=\"n\"\u003evalidate\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003etrajectory\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;validate\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e\n            \u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;agent_loop\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e):\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eassert\u003c/span\u003e \u003cspan class=\"n\"\u003eagent_name\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003e_agent_loop_registry\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\n                \u003cspan class=\"n\"\u003ef\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Agent loop {agent_name} not registered, registered agent loops: {_agent_loop_registry.keys()}\u0026#34;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eagent_loop_config\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003e_agent_loop_registry\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eagent_name\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eagent_loop\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ehydra\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eutils\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003einstantiate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n                \u003cspan class=\"n\"\u003econfig\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eagent_loop_config\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                \u003cspan class=\"n\"\u003etrainer_config\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003e_DummyConfig\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003econfig\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003econfig\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eserver_manager\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eserver_manager\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                \u003cspan class=\"n\"\u003etokenizer\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etokenizer\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eoutput\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eawait\u003c/span\u003e \u003cspan class=\"n\"\u003eagent_loop\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erun\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emessages\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esampling_params\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eoutput\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp data-pid=\"kT3oVXEE\"\u003e对于定义的不同的agent_loop，需要用register装饰器进行注册（设计模式中的工厂模式），register装饰器如下：\u003c/p\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode class=\"language-python\"\u003e\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003eregister\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eagent_name\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nb\"\u003estr\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n    \u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u0026#34;Register agent loop class.\u0026#34;\u0026#34;\u0026#34;\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003edecorator\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esubclass\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nb\"\u003etype\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eAgentLoopBase\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan class=\"nb\"\u003etype\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eAgentLoopBase\u003c/span\u003e\u003cspan class=\"p\"\u003e]:\u003c/span\u003e\n        \u003cspan class=\"n\"\u003efqdn\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ef\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;{subclass.__module__}.{subclass.__qualname__}\u0026#34;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003e_agent_loop_registry\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eagent_name\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;_target_\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003efqdn\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003esubclass\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003edecorator\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp data-pid=\"8KwMKFA5\"\u003e对于装饰的类，将这个信息存入一个名为 _agent_loop_registry 的全局字典中。 - 键 (Key)：在装饰器中提供的 agent_name 字符串 (e.g., \u0026#34;my_agent\u0026#34;)。\u003c/p\u003e\u003cul\u003e\u003cli data-pid=\"H4c_ArJv\"\u003e值 (Value)：一个特殊格式的字典 {\u0026#34;\u003ci\u003etarget\u003c/i\u003e\u0026#34;: \u0026#34;类的完整路径\u0026#34;}。\u003c/li\u003e\u003c/ul\u003e\u003cp data-pid=\"WhZF5Vwk\"\u003e这里我们注册了两个agent_name，然后利用hydra进行初始化，本文重点介绍tool_agent_loop，接下来转到ToolAgentLoop这个类中。\u003c/p\u003e\u003ch3\u003eToolAgentLoop\u003c/h3\u003e\u003cp data-pid=\"JgbtDEUv\"\u003e首先看初始化：\u003c/p\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode class=\"language-python\"\u003e\u003cspan class=\"nd\"\u003e@register\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;tool_agent\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eToolAgentLoop\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eAgentLoopBase\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n    \u003cspan class=\"nd\"\u003e@classmethod\u003c/span\u003e\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003einit_class\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003ecls\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003econfig\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003etokenizer\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"o\"\u003e**\u003c/span\u003e\u003cspan class=\"n\"\u003ekwargs\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"bp\"\u003ecls\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e_class_initialized\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003ecls\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e_class_initialized\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eTrue\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Performing class-level ToolAgentLoop initialization\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e# Initialize tools from config file\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003ecls\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etokenizer\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003etokenizer\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003ecls\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emax_user_turns\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003econfig\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eactor_rollout_ref\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erollout\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emulti_turn\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emax_user_turns\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003ecls\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emax_assistant_turns\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003econfig\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eactor_rollout_ref\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erollout\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emulti_turn\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emax_assistant_turns\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003ecls\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emax_parallel_calls\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003econfig\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eactor_rollout_ref\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erollout\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emulti_turn\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emax_parallel_calls\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003ecls\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emax_tool_response_length\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003econfig\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eactor_rollout_ref\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erollout\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emulti_turn\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emax_tool_response_length\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003ecls\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etool_response_truncate_side\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003econfig\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eactor_rollout_ref\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erollout\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emulti_turn\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etool_response_truncate_side\u003c/span\u003e\n        \u003cspan class=\"n\"\u003etool_config_path\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003econfig\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eactor_rollout_ref\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erollout\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emulti_turn\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etool_config_path\u003c/span\u003e\n        \u003cspan class=\"n\"\u003etool_list\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003einitialize_tools_from_config\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etool_config_path\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003etool_config_path\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e[]\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003ecls\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etools\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003etool\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003etool\u003c/span\u003e \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003etool\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003etool_list\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003ecls\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etool_schemas\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003etool\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etool_schema\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emodel_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eexclude_unset\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"bp\"\u003eTrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eexclude_none\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"bp\"\u003eTrue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003etool\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003etool_list\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003ecls\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etool_parser\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eToolParser\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eget_tool_parser\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003econfig\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eactor_rollout_ref\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erollout\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emulti_turn\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eformat\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"bp\"\u003ecls\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etokenizer\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ef\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Initialized tools: {cls.tools}\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n        \u003cspan class=\"bp\"\u003ecls\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eprompt_length\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003econfig\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eactor_rollout_ref\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erollout\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eprompt_length\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003ecls\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eresponse_length\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003econfig\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eactor_rollout_ref\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erollout\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eresponse_length\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003ecls\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esystem_prompt\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003etokenizer\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eapply_chat_template\u003c/span\u003e\u003cspan class=\"p\"\u003e([{}],\u003c/span\u003e \u003cspan class=\"n\"\u003eadd_generation_prompt\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"bp\"\u003eFalse\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003etokenize\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"bp\"\u003eTrue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp data-pid=\"KNS01qjC\"\u003e关于工具的初始化，来自于sglang团队，详细可以看博客：\u003ca href=\"https://link.zhihu.com/?target=https%3A//github.com/zhaochenyang20/Awesome-ML-SYS-Tutorial/blob/main/rlhf/verl/multi-turn/release_log/verl-multiturn-rollout-Release_ZH.md\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003eAwesome-ML-SYS-Tutorial/rlhf/verl/multi-turn/release_log/verl-multiturn-rollout-Release_ZH.md at main · zhaochenyang20/Awesome-ML-SYS-Tutorial · GitHub\u003c/a\u003e\u003c/p\u003e\u003cp data-pid=\"cB82IOlp\"\u003e简单来说就是将工具的信息定义在一个yaml文件中，将文件路径传入到actor_rollout_ref.rollout.multi_turn.tool_config_path参数，然后获取tool_schemas用于后续传入到chat_template中，此外在tool_parser.py中定义了tool_parser。\u003c/p\u003e\u003cp data-pid=\"IL7ccXJH\"\u003e这里还有一个值得注意的是system_prompt，这是因为进行chat_template的时候如果没有role为system的会自动加上，而在后面对工具返回结果进行单独chat_template的时候需要将自动添加的system prompt给删除，所以这里预存了一个system_prompt。\u003c/p\u003e\u003cp data-pid=\"eP59hjtS\"\u003e下面我们来看最核心的多轮rollout代码：\u003c/p\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode class=\"language-python\"\u003e\u003cspan class=\"nd\"\u003e@rollout_trace_op\u003c/span\u003e\n    \u003cspan class=\"n\"\u003easync\u003c/span\u003e \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003erun\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003emessages\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nb\"\u003elist\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nb\"\u003edict\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nb\"\u003estr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eAny\u003c/span\u003e\u003cspan class=\"p\"\u003e]],\u003c/span\u003e \u003cspan class=\"n\"\u003esampling_params\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nb\"\u003edict\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nb\"\u003estr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eAny\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eAgentLoopOutput\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n        \u003cspan class=\"n\"\u003emetrics\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n        \u003cspan class=\"n\"\u003erequest_id\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003euuid4\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehex\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eprompt_ids\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eawait\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eloop\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erun_in_executor\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n            \u003cspan class=\"bp\"\u003eNone\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n            \u003cspan class=\"k\"\u003elambda\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etokenizer\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eapply_chat_template\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n                \u003cspan class=\"n\"\u003emessages\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003etools\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etool_schemas\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eadd_generation_prompt\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"bp\"\u003eTrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003etokenize\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"bp\"\u003eTrue\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e),\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eresponse_mask\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[]\u003c/span\u003e\n\n        \u003cspan class=\"n\"\u003euser_turns\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eassistant_turns\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ewhile\u003c/span\u003e \u003cspan class=\"bp\"\u003eTrue\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ewith\u003c/span\u003e \u003cspan class=\"n\"\u003esimple_timer\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;generate_sequences\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003emetrics\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eresponse_ids\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eawait\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eserver_manager\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003egenerate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003erequest_id\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003erequest_id\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eprompt_ids\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eprompt_ids\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esampling_params\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003esampling_params\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eprompt_ids\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"n\"\u003eresponse_ids\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eresponse_mask\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eresponse_ids\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eassistant_turns\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e# reach max response length\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eresponse_mask\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;=\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eresponse_length\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ebreak\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e# reach max assistant turns\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emax_assistant_turns\u003c/span\u003e \u003cspan class=\"ow\"\u003eand\u003c/span\u003e \u003cspan class=\"n\"\u003eassistant_turns\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;=\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emax_assistant_turns\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ebreak\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e# reach max user turns\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emax_user_turns\u003c/span\u003e \u003cspan class=\"ow\"\u003eand\u003c/span\u003e \u003cspan class=\"n\"\u003euser_turns\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;=\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emax_user_turns\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ebreak\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e# no tool calls\u003c/span\u003e\n            \u003cspan class=\"n\"\u003e_\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003etool_calls\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eawait\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etool_parser\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eextract_tool_calls\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eresponse_ids\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"ow\"\u003enot\u003c/span\u003e \u003cspan class=\"n\"\u003etool_calls\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ebreak\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e# call tools\u003c/span\u003e\n            \u003cspan class=\"n\"\u003etasks\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[]\u003c/span\u003e\n            \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003etool_call\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003etool_calls\u003c/span\u003e\u003cspan class=\"p\"\u003e[:\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emax_parallel_calls\u003c/span\u003e\u003cspan class=\"p\"\u003e]:\u003c/span\u003e\n                \u003cspan class=\"n\"\u003etasks\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eappend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e_call_tool\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etool_call\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ewith\u003c/span\u003e \u003cspan class=\"n\"\u003esimple_timer\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;tool_calls\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003emetrics\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n                \u003cspan class=\"n\"\u003etool_responses\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eawait\u003c/span\u003e \u003cspan class=\"n\"\u003easyncio\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003egather\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003etasks\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"nb\"\u003eany\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eisinstance\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eitem\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ne\"\u003eException\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003eitem\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003etool_responses\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ebreak\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e# append tool_response_ids\u003c/span\u003e\n            \u003cspan class=\"n\"\u003etool_response_ids\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eawait\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eloop\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erun_in_executor\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n                \u003cspan class=\"bp\"\u003eNone\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                \u003cspan class=\"k\"\u003elambda\u003c/span\u003e \u003cspan class=\"n\"\u003emessages\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003etool_responses\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etokenizer\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eapply_chat_template\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003emessages\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eadd_generation_prompt\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"bp\"\u003eTrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003etokenize\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"bp\"\u003eTrue\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e),\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"n\"\u003etool_response_ids\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003etool_response_ids\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esystem_prompt\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e:]\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e# NOTE: last turn should not be user turn, or the EOS token reward\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e# can\u0026#39;t be propagated to previous token in GAE.\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eresponse_mask\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etool_response_ids\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;=\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eresponse_length\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ebreak\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003eprompt_ids\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"n\"\u003etool_response_ids\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eresponse_mask\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etool_response_ids\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"n\"\u003euser_turns\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\n\n        \u003cspan class=\"n\"\u003eresponse_ids\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eprompt_ids\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eresponse_mask\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e:]\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eprompt_ids\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eprompt_ids\u003c/span\u003e\u003cspan class=\"p\"\u003e[:\u003c/span\u003e \u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eprompt_ids\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eresponse_mask\u003c/span\u003e\u003cspan class=\"p\"\u003e)]\u003c/span\u003e\n\n        \u003cspan class=\"n\"\u003eoutput\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eAgentLoopOutput\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eprompt_ids\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eprompt_ids\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eresponse_ids\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eresponse_ids\u003c/span\u003e\u003cspan class=\"p\"\u003e[:\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eresponse_length\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eresponse_mask\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eresponse_mask\u003c/span\u003e\u003cspan class=\"p\"\u003e[:\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eresponse_length\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e\n            \u003cspan class=\"n\"\u003enum_turns\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003euser_turns\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003eassistant_turns\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n            \u003cspan class=\"n\"\u003emetrics\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003emetrics\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eoutput\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003easync\u003c/span\u003e \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003e_call_tool\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003etool_call\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eFunctionCall\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan class=\"nb\"\u003edict\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nb\"\u003estr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nb\"\u003estr\u003c/span\u003e\u003cspan class=\"p\"\u003e]:\u003c/span\u003e\n        \u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u0026#34;Call tool and return tool response.\u0026#34;\u0026#34;\u0026#34;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003etool\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003einstance_id\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eNone\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"bp\"\u003eNone\u003c/span\u003e\n        \u003cspan class=\"k\"\u003etry\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e# TODO: append malformed tool_call to the prompt: invalid function name or arguments\u003c/span\u003e\n            \u003cspan class=\"n\"\u003etool_name\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003etool_call\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ename\u003c/span\u003e\n            \u003cspan class=\"n\"\u003etool_args\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ejson\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eloads\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etool_call\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003earguments\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"n\"\u003etool\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etools\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003etool_name\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003einstance_id\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eawait\u003c/span\u003e \u003cspan class=\"n\"\u003etool\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecreate\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n            \u003cspan class=\"n\"\u003etool_response\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003e_\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003e_\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eawait\u003c/span\u003e \u003cspan class=\"n\"\u003etool\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eexecute\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003einstance_id\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003etool_args\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eexcept\u003c/span\u003e \u003cspan class=\"ne\"\u003eException\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"n\"\u003elogger\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eexception\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ef\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Error when executing tool: {e}\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\n        \u003cspan class=\"k\"\u003efinally\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003etool\u003c/span\u003e \u003cspan class=\"ow\"\u003eand\u003c/span\u003e \u003cspan class=\"n\"\u003einstance_id\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eawait\u003c/span\u003e \u003cspan class=\"n\"\u003etool\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erelease\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003einstance_id\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etool_response\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emax_tool_response_length\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etool_response_truncate_side\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;left\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n                \u003cspan class=\"n\"\u003etool_response\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003etool_response\u003c/span\u003e\u003cspan class=\"p\"\u003e[:\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emax_tool_response_length\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;...(truncated)\u0026#34;\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eelif\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etool_response_truncate_side\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;right\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n                \u003cspan class=\"n\"\u003etool_response\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;(truncated)...\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003etool_response\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emax_tool_response_length\u003c/span\u003e \u003cspan class=\"p\"\u003e:]\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eelse\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n                \u003cspan class=\"n\"\u003elength\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emax_tool_response_length\u003c/span\u003e \u003cspan class=\"o\"\u003e//\u003c/span\u003e \u003cspan class=\"mi\"\u003e2\u003c/span\u003e\n                \u003cspan class=\"n\"\u003etool_response\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003etool_response\u003c/span\u003e\u003cspan class=\"p\"\u003e[:\u003c/span\u003e\u003cspan class=\"n\"\u003elength\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;...(truncated)...\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003etool_response\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003elength\u003c/span\u003e\u003cspan class=\"p\"\u003e:]\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"s2\"\u003e\u0026#34;role\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;tool\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n            \u003cspan class=\"s2\"\u003e\u0026#34;content\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003etool_response\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp data-pid=\"zAFxyRDC\"\u003e还记得我们这里传入的batch是哪里来的吗？没错，是来自于AgentLoopManager根据num_workers切分的prompt。在run方法一开始，我们为每一个切分后的prompts设定一个request_id，在AsyncLLMServerManager中管理映射。 接下来对prompt进行chat_template，传入我们前面定义好的tool_schemas，这样system_prompt就会加入对应格式的工具信息。\u003c/p\u003e\u003cp data-pid=\"t1DqwEfp\"\u003e之后就进入到了多轮对话中，先是使用ServerManager进行generate，拼接上prompt_ids（为什么直接拼接tokenid详见issue:\u003ca href=\"https://link.zhihu.com/?target=https%3A//github.com/0russwest0/Agent-R1/issues/30%23issuecomment-2826155367\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003e训练途中突然崩了，无论是grpo还是reinforce++，出现nan · Issue #30 · 0russwest0/Agent-R1\u003c/a\u003e）。\u003c/p\u003e\u003cp data-pid=\"j9dk6U-A\"\u003e我们直接跳到工具解析的部分，定义好的tool_parser从response_ids中解析工具调用信息（其实就是正则表达式匹配），如果没有工具调用，则直接结束，否则就调用_call_tool方法调用工具。调用完工具后返回工具调用的结果，然后将其编码，并截断前面的system prompt，拼接在prompt_ids后，用于下个循环的推理。注意在训练的时候要将工具返回的结果进行掩码。也就是\u003ccode\u003eresponse_mask += [0] * len(tool_response_ids)\u003c/code\u003e。当达到最大循环或者回复长度超出设定的response_length，就结束推理。并按照AgentLoopOutput进行返回。\u003c/p\u003e\u003ch3\u003e返回\u003c/h3\u003e\u003cp data-pid=\"hhPLpNTc\"\u003e返回后，我们回到AgentLoopWorker的generate_sequences方法中，可以看到我们将返回的结果都放入了outputs变量中，而在最终输出前，需要进行后处理，也就是_postprocess方法。需要对prompt进行左pad，对response进行右pad，最后整合成DataProto返回。\u003c/p\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode class=\"language-python\"\u003e\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003egenerate_sequences\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eprompts\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eDataProto\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eDataProto\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n        \u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u0026#34;Split input batch and dispatch to agent loop workers.\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e        Args:\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e            prompts (DataProto): Input batch.\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e        Returns:\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e            DataProto: Output batch.\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e        \u0026#34;\u0026#34;\u0026#34;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003econfig\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eactor_rollout_ref\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erollout\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003efree_cache_engine\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ewake_up\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"n\"\u003echunkes\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eprompts\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003echunk\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eagent_loop_workers\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eoutputs\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eray\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e[\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eworker\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003egenerate_sequences\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eremote\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003echunk\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003eworker\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003echunk\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"nb\"\u003ezip\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eagent_loop_workers\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003echunkes\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003estrict\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"bp\"\u003eTrue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e]\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eoutput\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eDataProto\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003econcat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eoutputs\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003econfig\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eactor_rollout_ref\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erollout\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003efree_cache_engine\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esleep\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e# calculate performance metrics\u003c/span\u003e\n        \u003cspan class=\"n\"\u003emetrics\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eoutput\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emeta_info\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;metrics\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003eoutput\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003eoutputs\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e  \u003cspan class=\"c1\"\u003e# List[List[Dict[str, str]]]\u003c/span\u003e\n        \u003cspan class=\"n\"\u003etiming\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e_performance_metrics\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emetrics\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eoutput\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n        \u003cspan class=\"n\"\u003eoutput\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emeta_info\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;timing\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003etiming\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eoutput\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp data-pid=\"OqyxqYiy\"\u003e然后回到AgentLoopWorker的generate_sequences方法中，将各个worker推理的结果concat起来。并将一些metric放入meta_info来logger。\u003c/p\u003e","is_labeled":false,"visited_count":1696,"thumbnails":["https://pic1.zhimg.com/50/v2-ec36a9a4f2b80add16b944b0f7ca7b02_720w.jpg?source=b6762063","https://picx.zhimg.com/50/v2-90c610c88be2b480232f718b8a61caf4_720w.jpg?source=b6762063","https://picx.zhimg.com/50/v2-5754faf491ec89ac645d7eb71b37ef94_720w.jpg?source=b6762063"],"favorite_count":133,"article_type":"normal","is_navigator":false,"navigator_vote":false,"vote_next_step":"vote"},"brief":"{\"source\": \"TS\", \"type\": \"article\", \"id\": 1932122767123264318}","attached_info":"CqkGCNWknKXXuZ2kogEQBxoJMjYwODI5MDE3ILmQjcQGKEswAUBgSigKHVRTX1NPVVJDRV9JTlRFUkVTVF9XT1JEX01FUkdFEgEwGAAgADoAYiAwZWJhMWJlMzVkYTI5ZDI3ODNlYWU4MjIyZDNlNWU0OXITMTkzMjEyMjc2NzEyMzI2NDMxOKoBCXJlY29tbWVuZMIBIGZhYjA4ZTg1ZmU2YWJiMzc2NWI3NTlkOTk2OTZhODg38gEKCAwSBk5vcm1hbPIBKAgKEiQ3ZWRmOGE3MC1iMTI2LTQxYzktYThkNC03NmU2MjEyMTk5OWXyAQYICxICMTeCAgCIAtG8686FM5ICIGZhYjA4ZTg1ZmU2YWJiMzc2NWI3NTlkOTk2OTZhODg3mgIAygIWU2hvckludGVyZXN0V2VpZ2h0UnVsZcoCFVVzZXJMY25FeGl0V2VpZ2h0UnVsZdoCHVRTX1NPVVJDRV9JTlRFUkVTVF9XT1JEX01FUkdF6AID+gILTk9STUFMX0ZMT1eKAyAxMzJlOTVlNzcyMDE0MzZhYmVlNmYwMWJiNTQ3MjlhYpoDDQoCdjIQABoFb3RoZXKoA6AN2AMA6gMiSW50ZXJlc3RXb3JkTWVyZ2VWMU5ld1Bvb2xSZWNhbGxlcvoDrAESDFVOS05PV05fTU9ERSAAKg1OT19JTUFHRV9NT0RFOi0IAhC+EBjmCSIjdjItZDI5MzMyNDA0MDllNjQwNDQxOThhZmU4YmI5OTY3MTI6LQgCEKIXGOIOIiN2Mi0xZTdmYzk0Y2EwYmRiNzNjNDNlYzRlMTI1OWRhODE1ZjotCAQQgggYxQYiI3YyLTA0ZTQ4MmM5YmZiNDIyOTU1ZjI1YjVkODYyNDdjYjE2gAQAiAQAkgQGTm9ybWFsmgQBM6AEAKgEALAEALoEAmFpwgQDNDAwyAQA0gQP5o6o6I2Q5bey5pu05paw2AQA8AQA+QQAAAAAhfqDP4EFAAAAAAAAAACJBVSxE8ZYcNM/kgUAmgUDZGZ0ogUDZGZ0sgUBMbkFAAAAAAAAAADQBQDgBQDoBQDwBRGQBgCgBmCoBgGSAi4KCTI2MDgyOTAxNxITMTkzMjEyMjc2NzEyMzI2NDMxOBgHIgpJTUFHRV9URVhU","action_card":false},{"id":"97_1753854172.860","type":"feed","offset":97,"verb":"TOPIC_ACKNOWLEDGED_ANSWER","created_time":1753854172,"updated_time":1753854172,"target":{"id":"3349496288","type":"answer","url":"https://api.zhihu.com/answers/3349496288","author":{"id":"88aa64797a5563753f75e62b4b036ab9","url":"https://api.zhihu.com/people/88aa64797a5563753f75e62b4b036ab9","user_type":"people","url_token":"91-63-78-22","name":"元君","headline":"不正经的记者","avatar_url":"https://pic1.zhimg.com/50/v2-8232d54e53ddb706c2fc1120bc7bfbcb_l.jpg?source=b6762063","is_org":false,"gender":-1,"followers_count":864,"is_following":false,"is_followed":false},"created_time":1704348600,"updated_time":1704699221,"voteup_count":5771,"thanks_count":358,"comment_count":1009,"is_copyable":true,"question":{"id":"66228454","type":"question","url":"https://api.zhihu.com/questions/66228454","author":{"id":"4c79770288379fa458422817e80b9b0b","url":"https://api.zhihu.com/people/4c79770288379fa458422817e80b9b0b","user_type":"people","url_token":"wo-xue-fu-sha","name":"握雪拂沙","headline":"统计学","avatar_url":"https://pic1.zhimg.com/50/v2-65b9221d17eab93855edd08bbcaa35f7_l.jpg?source=b6762063","is_org":false,"gender":-1,"followers_count":8,"is_following":false,"is_followed":false},"title":"为什么项羽要在垓下突围后自刎呢？","created":1507180104,"answer_count":0,"follower_count":0,"comment_count":8,"bound_topic_ids":[7663,20774,25793,38823,260357],"is_following":false,"excerpt":"","relationship":{"is_author":false},"detail":"","question_type":"normal"},"excerpt":"几个事很多人没弄清楚。 项羽死前究竟有多丢脸，整个中国古代史都非常罕见。 第一，他抛下战斗力尚存的成建制部队，在无人知晓的情况下偷偷摸摸溜走。 基本上要点脸的主帅也会“分兵突围”（本质上也是溃逃），但这么做至少减少士兵的损失，但项羽是要见大势已去管他人死活的典型。 第二，项羽自杀。为什么要自杀？ 太史公写了两件事：第一，项羽逃命。第二，项羽逃不了自杀了。 这两件事本质是矛盾的，但是仔细研究你会发现两者…","excerpt_new":"几个事很多人没弄清楚。 项羽死前究竟有多丢脸，整个中国古代史都非常罕见。 第一，他抛下战斗力尚存的成建制部队，在无人知晓的情况下偷偷摸摸溜走。 基本上要点脸的主帅也会“分兵突围”（本质上也是溃逃），但这么做至少减少士兵的损失，但项羽是要见大势已去管他人死活的典型。 第二，项羽自杀。为什么要自杀？ 太史公写了两件事：第一，项羽逃命。第二，项羽逃不了自杀了。 这两件事本质是矛盾的，但是仔细研究你会发现两者…","preview_type":"default","preview_text":"","reshipment_settings":"allowed","content":"\u003cp data-pid=\"bnsGbR3G\"\u003e几个事很多人没弄清楚。\u003c/p\u003e\u003cp data-pid=\"R84BricF\"\u003e项羽死前究竟有多丢脸，整个中国古代史都非常罕见。\u003c/p\u003e\u003cp data-pid=\"fG5C2L6W\"\u003e第一，他抛下战斗力尚存的成建制部队，在无人知晓的情况下偷偷摸摸溜走。\u003c/p\u003e\u003cp data-pid=\"1O2wNdnp\"\u003e基本上要点脸的主帅也会“分兵突围”（本质上也是溃逃），但这么做至少减少士兵的损失，但项羽是要见大势已去管他人死活的典型。\u003c/p\u003e\u003cp data-pid=\"o5DGOcPD\"\u003e第二，项羽自杀。为什么要自杀？\u003c/p\u003e\u003cp data-pid=\"A3Uwt6zZ\"\u003e太史公写了两件事：第一，项羽逃命。第二，项羽逃不了自杀了。\u003c/p\u003e\u003cp data-pid=\"MPvaIZdi\"\u003e这两件事本质是矛盾的，但是仔细研究你会发现两者的区别。\u003c/p\u003e\u003cp data-pid=\"SeUAZ8Uo\"\u003e逃命是10万楚军➕十数万汉军眼睁睁看着的，历史参与者众多，根本没法翻供，更不可能不写。\u003c/p\u003e\u003cp data-pid=\"NL-JvJdW\"\u003e自杀是除了已经死了的项羽和操控智子的太史公以外没人知道的，像这样“如同亲临现场又无可旁证”的“史实”太史公还写了很多，共同点都是“既无法证实也无法证伪”，但有助于塑造人物，而且有趣的是，这些情节还都个个翔实，文笔斐然，起承转合好不精彩，不愧“无韵之离骚”。\u003c/p\u003e\u003cp class=\"ztext-empty-paragraph\"\u003e\u003cbr/\u003e\u003c/p\u003e\u003cp class=\"ztext-empty-paragraph\"\u003e\u003cbr/\u003e\u003c/p\u003e\u003cp data-pid=\"202ywtnY\"\u003e我发现有些人看史记只看项羽本纪（有些连原文都没看过，十面埋伏都出来了……）。\u003c/p\u003e\u003cp data-pid=\"mEKEMIQz\"\u003e这么说吧，司马迁原文明显有两种截然不同的画风。\u003c/p\u003e\u003cp data-pid=\"_xWyh77M\"\u003e一种是这样的：\u003c/p\u003e\u003cblockquote data-pid=\"R6eCOzc_\"\u003e项王军壁垓下，兵少食尽，汉军及诸侯兵围之数重。\u003c/blockquote\u003e\u003cp data-pid=\"eOBs_bRd\"\u003e言简意赅。\u003c/p\u003e\u003cp data-pid=\"Q8fNeZ6E\"\u003e一种是这样的：\u003c/p\u003e\u003cblockquote data-pid=\"kEPJ_Ly8\"\u003e项王自度不得脱。谓其骑曰：“吾起兵至今八岁矣，身七十馀战，所当者破，所击者服，未尝败北，遂霸有天下。然今卒困於此，此天之亡我，非战之罪也。今日固决死，原为诸君快战，必三胜之，为诸君溃围，斩将，刈旗，令诸君知天亡我，非战之罪也。”乃分其骑以为四队，四向。汉军围之数重。项王谓其骑曰：“吾为公取彼一将。”令四面骑驰下，期山东为三处。於是项王大呼驰下，汉军皆披靡，遂斩汉一将。是时，赤泉侯为骑将，追项王，项王瞋目而叱之，赤泉侯人马俱惊，辟易数里与其骑会为三处。汉军不知项王所在，乃分军为三，复围之。项王乃驰，复斩汉一都尉，杀数十百人，复聚其骑，亡其两骑耳。乃谓其骑曰：“何如？”骑皆伏曰：“如大王言。”\u003c/blockquote\u003e\u003cp data-pid=\"ygNee4D_\"\u003e嗯，你说军队正面冲杀是正经玩意儿我不说什么，项羽跟自家被斩的“其余26骑”对话是被哪个录音机记录下来了？太史公这个智子是音像画面面俱到啊，拍电影都没这么细的。不是不可能，但是这些文字就跟战地记者快报一样，不含“艺术加工”的可能性太低，最关键的，把这些文字去掉除了影响项羽人设完全不牵扯历史走向。\u003c/p\u003e\u003cp data-pid=\"9Zx9xfzA\"\u003e\u003cb\u003e补充一个：“项王自度不得脱”，翻译过来就是项羽寻思跑不掉了。所以我发现太史公光有智子还不太够，毕竟个人思想也能窃取。\u003c/b\u003e\u003c/p\u003e\u003cp data-pid=\"JoiluDJh\"\u003e我把最后这段去掉加工，大家自己看项羽是个什么东西：\u003c/p\u003e\u003cp data-pid=\"iWm_kN1_\"\u003e项王军壁垓下，兵少食尽，汉军及诸侯兵围之数重。於是项王乃上马骑，麾下壮士骑从者八百馀人，直夜溃围南出，驰走。平明，汉军乃觉之，令骑将灌婴以五千骑追之。项王已死，楚地皆降汉，独鲁不下。汉乃引天下兵欲屠之，为其守礼义，为主死节，乃持项王头视鲁，鲁父兄乃降。始，楚怀王初封项籍为鲁公，及其死，鲁最後下，故以鲁公礼葬项王穀城。汉王为发哀，泣之而去。（这个鲁公礼真的看一次笑一次，文化人骂人就是不一样）\u003c/p\u003e\u003cp data-pid=\"qJnVC7U2\"\u003e五年，高祖与诸侯兵共击楚军，与项羽决胜垓下。淮阴侯将三十万自当之，孔将军居左，费将军居右，皇帝在後，绛侯、柴将军在皇帝後。项羽之卒可十万。淮阴先合，不利，卻。孔将军、费将军纵，楚兵不利，淮阴侯复乘之，大败垓下。项羽卒闻汉军之楚歌，以为汉尽得楚地，项羽乃败而走，是以兵大败。使骑将灌婴追杀项羽东城，斩首八万，遂略定楚地。\u003c/p\u003e\u003cp data-pid=\"IWD6Ou0f\"\u003e你把这两段连起来看，事情脉络非常清晰。\u003c/p\u003e\u003cp data-pid=\"npPS9hHT\"\u003e项羽十万卒被汉军大破后陈兵垓下，此时楚汉相持，项羽的本钱就是这不到10万人。然后汉军星夜ktv，项羽缩蛋点800人连夜溃逃，没跟主力说（因为主力溃逃会被汉军发现，那他就走不了了），所以8万人傻乎乎被留下来给项羽“断后”了。然后汉军追杀东城分尸项羽，回头就把群龙无首8万人斩首，楚地定了。\u003c/p\u003e\u003cp data-pid=\"forbt3e_\"\u003e就这么个事。\u003c/p\u003e","relationship":{"is_thanked":false,"is_nothelp":false,"voting":0},"is_labeled":false,"visited_count":1233036,"favorite_count":1700,"answer_type":"normal","is_navigator":false,"navigator_vote":false,"vote_next_step":"vote"},"brief":"{\"source\": \"TS\", \"type\": \"answer\", \"id\": 3349496288}","attached_info":"CqcGCNWknKXXuZ2kogEQBBoJNjM5MDc3MDI1ILiX2awGKIstMPEHQGFKPwoqVFNfU09VUkNFX1pSRUNBTExfRkVFRFJFX05FV0JJRV9IT1VSTFlfUlVNEgEwGAAgADoKeyJyYXciOiIifVoIMTg3MTgyODhiIDBlYmExYmUzNWRhMjlkMjc4M2VhZTgyMjJkM2U1ZTQ5cgozMzQ5NDk2Mjg4igEINjYyMjg0NTSqAQlyZWNvbW1lbmTCASA4OGFhNjQ3OTdhNTU2Mzc1M2Y3NWU2MmI0YjAzNmFiOfIBCggMEgZOb3JtYWzyASgIChIkMjllOTQ1MTMtNWNlMS00Nzk1LTliMGItZGZkOGM1NzE4MjA48gEGCAsSAjE3ggIAiALRvOvOhTOSAiA4OGFhNjQ3OTdhNTU2Mzc1M2Y3NWU2MmI0YjAzNmFiOZoCAMoCFlNob3JJbnRlcmVzdFdlaWdodFJ1bGXKAhZBY3Rpb25TaG9ySW50ZXJlc3RSdWxlygIbSW50ZXJhY3Rpb25TaG9ySW50ZXJlc3RSdWxlygIWUmV2aXNpdFZhbHVlV2VpZ2h0UnVsZcoCFVVzZXJMY25FeGl0V2VpZ2h0UnVsZcoCFENvbnRlbnRBZ2VXZWlnaHRSdWxl2gIqVFNfU09VUkNFX1pSRUNBTExfRkVFRFJFX05FV0JJRV9IT1VSTFlfUlVN6AID+gILTk9STUFMX0ZMT1eKAyAxMzJlOTVlNzcyMDE0MzZhYmVlNmYwMWJiNTQ3MjlhYpoDDQoCdjIQABoFb3RoZXKoA4yhS9gDAOoDEG5ld2JpZV9mZWVkcmVfdjL6Ax8SDFVOS05PV05fTU9ERSAAKg1OT19JTUFHRV9NT0RFgAQAiAQAkgQGTm9ybWFsmgQBM6AEAKgEALAEALoEBm1hbnVhbMIEAzE2MMgEANIED+aOqOiNkOW3suabtOaWsNgEAPAEAPkEAAAAYK6AvT+BBQAAAAAAAAAAiQVUsRPGWHDTP5IFAJoFA2RmdKIFA2RmdLIFATG5BQAAAAAAAAAA0AUA4AUA6AUA8AURkAYAoAZhqAYDkgIlCgk2MzkwNzcwMjUSCjMzNDk0OTYyODgYBCIKSU1BR0VfVEVYVA==","action_card":false},{"id":"98_1753854172.857","type":"feed","offset":98,"verb":"TOPIC_ACKNOWLEDGED_ANSWER","created_time":1753854172,"updated_time":1753854172,"target":{"id":"1931421151680264020","type":"answer","url":"https://api.zhihu.com/answers/1931421151680264020","author":{"id":"7a25297c5fe6b6ce4636e32eb37b3313","url":"https://api.zhihu.com/people/7a25297c5fe6b6ce4636e32eb37b3313","user_type":"people","url_token":"31-34-66-64-35","name":"笃爱于斯","headline":"","avatar_url":"https://pic1.zhimg.com/50/v2-90a065ca6be0409e28e9723c7a95762c_l.jpg?source=b6762063","is_org":false,"gender":0,"followers_count":1113,"is_following":false,"is_followed":false},"created_time":1753266686,"updated_time":1753266686,"voteup_count":281,"thanks_count":3,"comment_count":74,"is_copyable":false,"question":{"id":"1921548221248938468","type":"question","url":"https://api.zhihu.com/questions/1921548221248938468","author":{"id":"6d217027315b4d69f44600baf3c3a2b1","url":"https://api.zhihu.com/people/6d217027315b4d69f44600baf3c3a2b1","user_type":"people","url_token":"36-68-7-45","name":"韩聪","headline":"","avatar_url":"https://pica.zhimg.com/50/v2-b6929b7daba594f604ca467fbe48792d_l.jpg?source=b6762063","is_org":false,"gender":0,"followers_count":549,"is_following":false,"is_followed":false},"title":"为什么一些人说被包养的女性普通人根本遇不到？被包养的女性后来都怎么样了？","created":1750912796,"answer_count":0,"follower_count":0,"comment_count":7,"bound_topic_ids":[307,5582,5619,6769,20331],"is_following":false,"excerpt":"","relationship":{"is_author":false},"detail":"","question_type":"normal"},"excerpt":"现实中的包养，就是周六大学门口见，一个周末几千块钱，金主不会干涉找男朋友(很少有金主对包养的有占有欲，甚至有一部分金主就喜欢包养的有男朋友)，其他就是生日送个礼物，比如喜欢滑雪，你生日的时候给你买块伯顿滑雪板，想出去玩一次，哄高兴陪高兴了给你出钱让你出去玩，就这样。","excerpt_new":"现实中的包养，就是周六大学门口见，一个周末几千块钱，金主不会干涉找男朋友(很少有金主对包养的有占有欲，甚至有一部分金主就喜欢包养的有男朋友)，其他就是生日送个礼物，比如喜欢滑雪，你生日的时候给你买块伯顿滑雪板，想出去玩一次，哄高兴陪高兴了给你出钱让你出去玩，就这样。","preview_type":"default","preview_text":"","reshipment_settings":"disallowed","content":"\u003cp data-pid=\"QZZ3wUmL\"\u003e现实中的包养，就是周六大学门口见，一个周末几千块钱，金主不会干涉找男朋友(很少有金主对包养的有占有欲，甚至有一部分金主就喜欢包养的有男朋友)，其他就是生日送个礼物，比如喜欢滑雪，你生日的时候给你买块伯顿滑雪板，想出去玩一次，哄高兴陪高兴了给你出钱让你出去玩，就这样。\u003c/p\u003e","relationship":{"is_thanked":false,"is_nothelp":false,"voting":0},"is_labeled":false,"visited_count":93056,"favorite_count":60,"answer_type":"normal","is_navigator":false,"navigator_vote":false,"vote_next_step":"vote"},"brief":"{\"source\": \"TS\", \"type\": \"answer\", \"id\": 1931421151680264020}","attached_info":"Cu0FCNWknKXXuZ2kogEQBBoJNzM4NDg3NDk1IP7zgsQGKJkCMEpAYkooCh1UU19TT1VSQ0VfTkVBUkxJTkVfQ09OVEVOVF9WMhIBMBgAIAA6AFoJMTE1NTYxOTQ1YiAwZWJhMWJlMzVkYTI5ZDI3ODNlYWU4MjIyZDNlNWU0OXITMTkzMTQyMTE1MTY4MDI2NDAyMIoBEzE5MjE1NDgyMjEyNDg5Mzg0NjiqAQlyZWNvbW1lbmTCASA3YTI1Mjk3YzVmZTZiNmNlNDYzNmUzMmViMzdiMzMxM/IBCggMEgZOb3JtYWzyASgIChIkZDY5ZDQ4MzAtZWYyMi00MjdkLThlYjEtOWU5NTUwNmVkM2Y38gEGCAsSAjE3ggIAiALRvOvOhTOSAiA3YTI1Mjk3YzVmZTZiNmNlNDYzNmUzMmViMzdiMzMxM5oCAMoCFlNob3JJbnRlcmVzdFdlaWdodFJ1bGXKAhZBY3Rpb25TaG9ySW50ZXJlc3RSdWxlygIbSW50ZXJhY3Rpb25TaG9ySW50ZXJlc3RSdWxlygIWUmV2aXNpdFZhbHVlV2VpZ2h0UnVsZcoCFVVzZXJMY25FeGl0V2VpZ2h0UnVsZdoCHVRTX1NPVVJDRV9ORUFSTElORV9DT05URU5UX1Yy6AIC+gILTk9STUFMX0ZMT1eKAyAxMzJlOTVlNzcyMDE0MzZhYmVlNmYwMWJiNTQ3MjlhYpoDDQoCdjIQABoFb3RoZXKoA4DXBdgDAPoDHxIMVU5LTk9XTl9NT0RFIAAqDU5PX0lNQUdFX01PREWABACIBACSBAZOb3JtYWyaBAEyoAQAqAQAsAQAugQGbWFudWFswgQDMTU4yAQA0gQP5o6o6I2Q5bey5pu05paw2AQA8AQA+QQAAAAAmla6P4EFAAAAAAAAAACJBVSxE8ZYcNM/kgUAmgUDZGZ0ogUDZGZ0sgUBMbkFAAAAAAAAAADQBQDgBQDoBQDwBRGQBgCgBmKoBgCSAi4KCTczODQ4NzQ5NRITMTkzMTQyMTE1MTY4MDI2NDAyMBgEIgpJTUFHRV9URVhU","action_card":false},{"id":"99_1753854172.694","type":"feed","offset":99,"verb":"TOPIC_ACKNOWLEDGED_ARTICLE","created_time":1753854172,"updated_time":1753854172,"target":{"id":"1921214932168450782","type":"article","url":"https://api.zhihu.com/articles/1921214932168450782","author":{"id":"1adc1ec991ac03222895b7c1fe52877e","url":"https://api.zhihu.com/people/1adc1ec991ac03222895b7c1fe52877e","user_type":"people","url_token":"--24-34-25","name":"白菜职场视频博客","headline":"分享YouTube / B站优质职场视频,供学习交流  ","avatar_url":"https://picx.zhimg.com/50/v2-d1b719ce608cc3d48fbd23a43a0a0ca4_l.jpg?source=b6762063","is_org":false,"gender":0,"followers_count":151,"is_following":false,"is_followed":false},"title":"如何成为超速学习者？快速学会任何新技能","comment_permission":"all","created":1750833397,"updated":1752570297,"voteup_count":41,"voting":0,"comment_count":1,"linkbox":{"category":"","pic":"","title":"","url":""},"excerpt":"我在b站看到了一篇很有趣的内容 ，给大家分享一下 一名学习爱好者。在半年内掌握了 六门外语，并在法国攻读社会学博士学位后，又前往德国继续深造。目前，我的研究领域拓展至心理学和神经科学。此外，我还自学了视频拍摄剪辑、游泳、健身、写作、烹饪以及电器维修等技能。     化妆技术确实有所提升。这并非 天赋使然，而是我在20多岁后通过努力掌握的技能。我想借此说明， 学习能力是可以培养的。一旦突破认知障碍并掌握正确方法，就…","excerpt_new":"我在b站看到了一篇很有趣的内容 ，给大家分享一下 一名学习爱好者。在半年内掌握了 六门外语，并在法国攻读社会学博士学位后，又前往德国继续深造。目前，我的研究领域拓展至心理学和神经科学。此外，我还自学了视频拍摄剪辑、游泳、健身、写作、烹饪以及电器维修等技能。     化妆技术确实有所提升。这并非 天赋使然，而是我在20多岁后通过努力掌握的技能。我想借此说明， 学习能力是可以培养的。一旦突破认知障碍并掌握正确方法，就…","preview_type":"default","preview_text":"","content":"\u003cp data-pid=\"ZPccUM7U\"\u003e我在b站看到了一篇很有趣的内容 ，给大家分享一下\u003c/p\u003e\u003cp data-pid=\"LBwCNBMq\"\u003e一名学习爱好者。在半年内掌握了\u003cb\u003e六门外语\u003c/b\u003e，并在法国攻读社会学博士学位后，又前往德国继续深造。目前，我的研究领域拓展至心理学和神经科学。此外，我还自学了视频拍摄剪辑、游泳、健身、写作、烹饪以及电器维修等技能。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic2.zhimg.com/v2-8ef8415d9e548c220eee506dd9fe364d_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-8ef8415d9e548c220eee506dd9fe364d\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pic2.zhimg.com/v2-8ef8415d9e548c220eee506dd9fe364d_r.jpg\"/\u003e\u003c/figure\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://picx.zhimg.com/v2-00ff7a7f42b588e36ae46a13e8784923_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-00ff7a7f42b588e36ae46a13e8784923\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://picx.zhimg.com/v2-00ff7a7f42b588e36ae46a13e8784923_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"GBd_Ydez\"\u003e化妆技术确实有所提升。这并非\u003cb\u003e天赋使然\u003c/b\u003e，而是我在20多岁后通过努力掌握的技能。\u003c/p\u003e\u003cp data-pid=\"NEBNUuNv\"\u003e我想借此说明，\u003cb\u003e学习能力\u003c/b\u003e是可以培养的。一旦突破认知障碍并掌握正确方法，就能快速习得新技能。\u003c/p\u003e\u003cp data-pid=\"vbhbUIKg\"\u003e本视频将重点介绍Scott Young的《Ultra Learning》（快速学习）一书。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pica.zhimg.com/v2-17150aa744d3ab750492641a7e6b00bc_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-17150aa744d3ab750492641a7e6b00bc\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pica.zhimg.com/v2-17150aa744d3ab750492641a7e6b00bc_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"uT2RflhD\"\u003e这本书的作者在一个月内掌握了\u003cb\u003e素描技巧\u003c/b\u003e，并在一年内学会了四种语言，完成了麻省理工学院（MIT）四年的计算机课程。书中介绍的许多方法与Adolf产生了强烈共鸣，他决定结合自身经验，系统梳理这些方法并与大家分享。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pica.zhimg.com/v2-f0f214ade3432e529b7f2205ec66033a_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-f0f214ade3432e529b7f2205ec66033a\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pica.zhimg.com/v2-f0f214ade3432e529b7f2205ec66033a_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"KPpOx1Q1\"\u003e本视频旨在帮助大家系统化地理解学习新事物的方法，从而更高效地规划学习路径。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic4.zhimg.com/v2-3bc7a5aaf63983a76c558e0bcdf89f1f_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-3bc7a5aaf63983a76c558e0bcdf89f1f\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pic4.zhimg.com/v2-3bc7a5aaf63983a76c558e0bcdf89f1f_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"wxu54opx\"\u003e如果你希望转换职业方向、迎接新挑战，或是梦想掌握一门乐器、学习外语、成为作家或摄影师。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic4.zhimg.com/v2-dfa623745db40a2163eaa8180a8e0a33_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-dfa623745db40a2163eaa8180a8e0a33\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pic4.zhimg.com/v2-dfa623745db40a2163eaa8180a8e0a33_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"O-c5Kn1v\"\u003e培养新的爱好，超速学习是一套有效的工具。若喜欢本视频，请一键三连。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic2.zhimg.com/v2-34b2704ab3a37d824b6c592e6d78848f_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-34b2704ab3a37d824b6c592e6d78848f\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pic2.zhimg.com/v2-34b2704ab3a37d824b6c592e6d78848f_r.jpg\"/\u003e\u003c/figure\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic3.zhimg.com/v2-2e5be993600e7c848a4f8e69aadd9ade_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-2e5be993600e7c848a4f8e69aadd9ade\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pic3.zhimg.com/v2-2e5be993600e7c848a4f8e69aadd9ade_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"2rbTp78D\"\u003e在探讨具体方法与工具前，首先需要强调认知与心态转变的重要性。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://picx.zhimg.com/v2-e841b52e45277f817baf279aa2f2d37d_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-e841b52e45277f817baf279aa2f2d37d\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://picx.zhimg.com/v2-e841b52e45277f817baf279aa2f2d37d_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"L1Z0WKti\"\u003e我在讲述个人成长经历的视频中曾提到，人生的转折点始于心态的转变。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic2.zhimg.com/v2-c903cef12dd1206a89ea3f0f81f503c5_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-c903cef12dd1206a89ea3f0f81f503c5\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pic2.zhimg.com/v2-c903cef12dd1206a89ea3f0f81f503c5_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"lwAf4dOT\"\u003e成人学习时，常陷入固有思维，认为这个年纪学习为时已晚，缺乏天赋，稍遇困难便轻言放弃。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://picx.zhimg.com/v2-b2f6e91e3a0e84fce5c28ffc773936d1_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-b2f6e91e3a0e84fce5c28ffc773936d1\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://picx.zhimg.com/v2-b2f6e91e3a0e84fce5c28ffc773936d1_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"gDg0oMnB\"\u003e心理学研究表明，许多人认为学习外语或乐器等技能的最佳时期是在儿童阶段，因此将希望寄托于下一代。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic4.zhimg.com/v2-4604c022ee1076d7292ec31e571f3411_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-4604c022ee1076d7292ec31e571f3411\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pic4.zhimg.com/v2-4604c022ee1076d7292ec31e571f3411_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"3vdul_VP\"\u003e心理学研究表明，成年人能够像儿童一样高效且快速地学习。持续保持活跃的学习状态，甚至有助于促进成年人大脑的发育。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://picx.zhimg.com/v2-85cf0e2d34de68edbe347e862699c875_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-85cf0e2d34de68edbe347e862699c875\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://picx.zhimg.com/v2-85cf0e2d34de68edbe347e862699c875_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"CZ4MP0lm\"\u003e这就说到了成长心态的重要性，这需要我们重新审视自己的能力，挑战固有思维。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic3.zhimg.com/v2-ca800d740e5f82792a2570870e7eff1e_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-ca800d740e5f82792a2570870e7eff1e\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pic3.zhimg.com/v2-ca800d740e5f82792a2570870e7eff1e_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"hFRsMHbU\"\u003e从告诉自己能力可以通过付出和努力培养开始，It’s never too old to learn。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic1.zhimg.com/v2-a202edb0f0a1aee31315358ee4af2dd8_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-a202edb0f0a1aee31315358ee4af2dd8\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pic1.zhimg.com/v2-a202edb0f0a1aee31315358ee4af2dd8_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"WAcJtE_f\"\u003e“活到老，学到老”是成为终身学习者的第一步，也是最核心的一步。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic3.zhimg.com/v2-0c3f99886ccb9ef50a95bdb204aad6a2_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-0c3f99886ccb9ef50a95bdb204aad6a2\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pic3.zhimg.com/v2-0c3f99886ccb9ef50a95bdb204aad6a2_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"U59q0sNo\"\u003e正如亨利·福特所言，无论20岁还是80岁，\u003cb\u003e停止学习的人终将老去\u003c/b\u003e，而持续学习的人永远年轻。\u003c/p\u003e\u003cp data-pid=\"fII0F8Mq\"\u003e接下来，我将重点介绍快速学习的几个关键原则。书中提到了九大原则，我将着重讲解其中最为核心的几点。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic1.zhimg.com/v2-fa26307c6c74cab58a9d55d2271cac86_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-fa26307c6c74cab58a9d55d2271cac86\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pic1.zhimg.com/v2-fa26307c6c74cab58a9d55d2271cac86_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"d4xyx7jf\"\u003e所谓\u003cb\u003e元学习\u003c/b\u003e，中文翻译有时称为后设学习，即在开始自学前，先花时间研究如何学习目标主题和技能。这包括梳理相关资源和方法，并根据个人学习风格制定计划，使学习路径更加清晰。\u003c/p\u003e\u003cp data-pid=\"fRCq5d4G\"\u003e简言之，就是明确每一步的学习目的、内容和实施方法。\u003cb\u003e首先需要确立学习目标\u003c/b\u003e，初期目标可能不够具体，但应确定大致方向。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://picx.zhimg.com/v2-0941b40f95b018a37b84c12c8550aa9f_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-0941b40f95b018a37b84c12c8550aa9f\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://picx.zhimg.com/v2-0941b40f95b018a37b84c12c8550aa9f_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"boR9PGdG\"\u003e例如，我自学法语是为了前往法国旅行时能够与人交流。在此过程中，掌握信息检索技能至关重要，这是将想法转化为实际行动的第一步。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://picx.zhimg.com/v2-f75f3842e84cb43d9fa473e48ef62ba3_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-f75f3842e84cb43d9fa473e48ef62ba3\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://picx.zhimg.com/v2-f75f3842e84cb43d9fa473e48ef62ba3_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"T6oKR5zY\"\u003e在这个互联网时代，我们拥有最丰富的资源。许多人怀揣着提升英语水平或健身的愿望，却不知从何着手。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic1.zhimg.com/v2-b1a6af6b2c81edb85534641431faf788_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-b1a6af6b2c81edb85534641431faf788\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pic1.zhimg.com/v2-b1a6af6b2c81edb85534641431faf788_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"WOd0b7l3\"\u003e其实只要花些时间搜索，一个模糊的想法就会逐渐清晰。当我萌生学习阿拉伯语的念头时，立刻开始搜索相关博客、YouTube视频，甚至查询大学是否有免费的兴趣课程。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pica.zhimg.com/v2-82c22dabe6b5caa238b31c52c9231780_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-qrcode-action=\"none\" data-original-token=\"v2-82c22dabe6b5caa238b31c52c9231780\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pica.zhimg.com/v2-82c22dabe6b5caa238b31c52c9231780_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"7zh66WPp\"\u003e结果确实如此。当时我抱着尝试的心态参加了阿拉伯语字母课程。在此期间，老师和同学为我提供了丰富的学习资源和有效的方法。\u003c/p\u003e\u003cp data-pid=\"a8yCWUSz\"\u003e这引出了第二个要点：\u003cb\u003e专家访谈法\u003c/b\u003e。通过与相关领域的专家，或是已经实现你目标的人交流，获取方向性建议，学会善用身边的资源。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://picx.zhimg.com/v2-927ec0bb9da402a298a15627b72585fb_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-927ec0bb9da402a298a15627b72585fb\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://picx.zhimg.com/v2-927ec0bb9da402a298a15627b72585fb_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"9foXEwZ4\"\u003e当时，我向班上学习过\u003cb\u003e阿拉伯语\u003c/b\u003e的同学请教，他不仅赠送了我入门的教材，还推荐了学校开设免费阿拉伯语兴趣课程的教师联系方式。\u003c/p\u003e\u003cp data-pid=\"AmRniAxy\"\u003e另一种方法是\u003cb\u003e标杆学习法\u003c/b\u003e，即研究他人掌握某项技能或科目的共同方法，这有助于设计初始的学习策略。例如，若想系统学习\u003cb\u003e神经科学\u003c/b\u003e，我首先会查阅学校相关课程的教学大纲。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pica.zhimg.com/v2-835d2959aa012cf79507304f1989bb54_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-835d2959aa012cf79507304f1989bb54\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pica.zhimg.com/v2-835d2959aa012cf79507304f1989bb54_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"M0jwwFzK\"\u003e在学习某项技能之前，可以投入10%的时间研究学习方法。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pica.zhimg.com/v2-fa8f4bcb4b8a55b451181a38c88ed15a_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-fa8f4bcb4b8a55b451181a38c88ed15a\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pica.zhimg.com/v2-fa8f4bcb4b8a55b451181a38c88ed15a_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"JNOFL9T4\"\u003e我个人认为，这10%的时间并非要求大家必须制定完美无缺的计划才开始执行，而是包含了前期的试错成本。有了初步计划后，便可先行尝试。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://picx.zhimg.com/v2-f8755ab0a3814c9ec5c780b5b32826af_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-f8755ab0a3814c9ec5c780b5b32826af\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://picx.zhimg.com/v2-f8755ab0a3814c9ec5c780b5b32826af_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"10fIWSg7\"\u003e在试水过程中调整计划的同时，往往会有新的发现和思路。以我学习阿拉伯语为例，我先参加了字母课程，在与老师和同学的交流中确定了适合的教材，并投入时间进行筛选和尝试。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic2.zhimg.com/v2-5a6c4464425d713de977e892f9c590b3_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-5a6c4464425d713de977e892f9c590b3\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pic2.zhimg.com/v2-5a6c4464425d713de977e892f9c590b3_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"w21YwJpW\"\u003e选到符合我学习目的的教材为止，最终将那本书从头到尾自学完成。随后，学习地图会逐渐具体化和精细化，例如决定是否参加班级课程或继续自学。\u003c/p\u003e\u003cp data-pid=\"ednIgmsS\"\u003e若选择自学，需规划\u003cb\u003e练习方式\u003c/b\u003e和\u003cb\u003e时间分配\u003c/b\u003e。这一过程需要一定的试错成本，不必追求一开始就制定完美的学习计划。例如，UP主根据个人经验分享了语言学习的资源和方法，建议大家多对比和尝试不同博主的方法，以找到最适合自己的方式。\u003c/p\u003e\u003cp data-pid=\"cK4LpbQy\"\u003e然而，\u003cb\u003e后设学习\u003c/b\u003e的真正益处在于长期效果，过程中能更深入地了解自己的学习风格。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic2.zhimg.com/v2-0f4d283200fea2bdec732d34a2ce6887_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-0f4d283200fea2bdec732d34a2ce6887\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pic2.zhimg.com/v2-0f4d283200fea2bdec732d34a2ce6887_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"MjqeETwp\"\u003e你将了解如何以最佳方式安排时间和管理动机，从而提升学习能力。同时，掌握处理常见问题的有效策略，这将进一步加速你学习新技能的进程。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic3.zhimg.com/v2-b5e439311e3988a014c798cd26000f80_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-b5e439311e3988a014c798cd26000f80\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pic3.zhimg.com/v2-b5e439311e3988a014c798cd26000f80_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"D2kxmmj-\"\u003e在语言学习方面，经过前期积累后，每增加一门新语言都能形成\u003cb\u003e更清晰的学习路径\u003c/b\u003e，从而避免走弯路，提升学习效率。随着掌握的技能增多，自信心也会增强，使学习过程更加愉悦，减少挫败感。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic3.zhimg.com/v2-9c185d21cbda3f1dfd4ad7c130d779cc_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-9c185d21cbda3f1dfd4ad7c130d779cc\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pic3.zhimg.com/v2-9c185d21cbda3f1dfd4ad7c130d779cc_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"GrIljJjf\"\u003e最佳的学习方法在于实践。或许有人会质疑：尚未掌握知识，如何付诸应用？\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pica.zhimg.com/v2-54510f108e117fca33f40c23c387f990_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-54510f108e117fca33f40c23c387f990\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pica.zhimg.com/v2-54510f108e117fca33f40c23c387f990_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"-qQs7HU1\"\u003e这里呢，\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic1.zhimg.com/v2-71fc6ac8a588ee5eab4724bca570eb4a_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-71fc6ac8a588ee5eab4724bca570eb4a\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pic1.zhimg.com/v2-71fc6ac8a588ee5eab4724bca570eb4a_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"DXbEqbnx\"\u003e意思是鼓励大家突破传统理论先行的学习模式。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic4.zhimg.com/v2-c48cdca86b06506336145696495509df_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-c48cdca86b06506336145696495509df\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pic4.zhimg.com/v2-c48cdca86b06506336145696495509df_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"ONTFi8Tb\"\u003e从一开始就将学习目标与实际应用相结合。Scott指出，传统教育往往忽视了这一点。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pica.zhimg.com/v2-3db723a48c67137698e98ab3e12d0de6_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-3db723a48c67137698e98ab3e12d0de6\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pica.zhimg.com/v2-3db723a48c67137698e98ab3e12d0de6_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"udbPvxjg\"\u003e\u003cb\u003e往往教授我们一套又一套的理论\u003c/b\u003e，期待我们能够举一反三，将理论运用于实践。然而现实中，人们\u003cb\u003e举一反三的能力\u003c/b\u003e普遍较弱。所学知识一旦情境变化，许多人便无所适从，鲜少有人能自如运用知识。\u003c/p\u003e\u003cp data-pid=\"ol_sH8Oi\"\u003e作者认为，\u003cb\u003e学习迁移能力缺失\u003c/b\u003e的原因在于多数正规学习不够直接。首先需明确知识的使用场景，练习时应尽可能贴近真实情境。若学习外语的目的是交流，在掌握基本语法后，应着重实际对话练习。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pica.zhimg.com/v2-519be28e2eb8215fc28c7917e0501204_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-519be28e2eb8215fc28c7917e0501204\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pica.zhimg.com/v2-519be28e2eb8215fc28c7917e0501204_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"_5DcM7-L\"\u003e可以直接练习口语对话，而非仅专注于语法书、课文和单词。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pica.zhimg.com/v2-6e82b57dc443a583fa200d5b0c346d02_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-6e82b57dc443a583fa200d5b0c346d02\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pica.zhimg.com/v2-6e82b57dc443a583fa200d5b0c346d02_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"f1SBwV9l\"\u003e我学习土耳其语和波斯语的初衷是为了旅行和交流，因此自学两周后便直接开始与语伴进行基础对话，从简单的问候、日常活动描述到场景模拟，如餐厅点餐、问路等，这些都紧扣我的学习目标。\u003c/p\u003e\u003cp data-pid=\"BBPusHu9\"\u003e在此过程中，教材和语法知识仅作为辅助工具。\u003cb\u003e我在视频中采访的许多语言高手都强调，提升口语的关键在于开口说\u003c/b\u003e，从一开始就要勇于表达。\u003c/p\u003e\u003cp data-pid=\"37Hti0XT\"\u003e若想提升英语口语，我始终推荐使用欧美外教平台\u003cb\u003eCambly\u003c/b\u003e，该平台的教师来自各行各业。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic2.zhimg.com/v2-7940ca782a6eadd3fa804b462312e129_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-7940ca782a6eadd3fa804b462312e129\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pic2.zhimg.com/v2-7940ca782a6eadd3fa804b462312e129_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"6C2Q0RGu\"\u003e而且时间灵活，\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://picx.zhimg.com/v2-1e8014fbb27c42d763f877b92b01968b_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-1e8014fbb27c42d763f877b92b01968b\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://picx.zhimg.com/v2-1e8014fbb27c42d763f877b92b01968b_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"Bm74Bsc1\"\u003e建议将每周的口语课程固定下来，推荐订阅每周一小时、二至四节的练习计划。这种口语对话练习更贴近真实场景。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic4.zhimg.com/v2-a12d8261c92a21f5ee8d0afd531506e5_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-a12d8261c92a21f5ee8d0afd531506e5\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pic4.zhimg.com/v2-a12d8261c92a21f5ee8d0afd531506e5_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"npYiFv1p\"\u003e持续练习有助于克服开口的恐惧，提升语感和对话能力。此外，\u003cb\u003e外教\u003c/b\u003e可根据需求提供发音、词汇和语法纠错，帮助提升综合英语能力。\u003c/p\u003e\u003cp data-pid=\"2dOesvlV\"\u003e感兴趣的朋友可点击简介栏链接，输入专属优惠码\u003cb\u003ezoelan50\u003c/b\u003e，所有用户现可享受年卡五折优惠，活动将于6月中旬截止。想要提升英语口语的朋友请尽快行动。\u003c/p\u003e\u003cp data-pid=\"NofpMDtp\"\u003e总而言之，学习新事物时，应尽量将其与\u003cb\u003e目标使用场景\u003c/b\u003e直接关联。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic2.zhimg.com/v2-df4edd5ecc074a584995719cbecfced1_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-df4edd5ecc074a584995719cbecfced1\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pic2.zhimg.com/v2-df4edd5ecc074a584995719cbecfced1_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"LuFpYC6q\"\u003e从一个真实的情景核心往外构建知识，这一原则与方法同样适用于其他领域，例如编程或运动。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pica.zhimg.com/v2-2171774e4d8c032d51178a4b36bf6574_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-2171774e4d8c032d51178a4b36bf6574\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pica.zhimg.com/v2-2171774e4d8c032d51178a4b36bf6574_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"WXqhe1DU\"\u003e音乐制作等等等等，\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic2.zhimg.com/v2-2105af0e60d98823a8b12008dcddf4d7_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-2105af0e60d98823a8b12008dcddf4d7\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pic2.zhimg.com/v2-2105af0e60d98823a8b12008dcddf4d7_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"fa8w1uIV\"\u003e专注力是高效学习的关键。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic1.zhimg.com/v2-5a86d41bbb75acde6bea088f8d1914dc_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-5a86d41bbb75acde6bea088f8d1914dc\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pic1.zhimg.com/v2-5a86d41bbb75acde6bea088f8d1914dc_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"dhxGAy-p\"\u003e相信大家都听说过心流（flow）状态。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic4.zhimg.com/v2-84f5ac80765d95892c9c0525c1028791_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-84f5ac80765d95892c9c0525c1028791\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pic4.zhimg.com/v2-84f5ac80765d95892c9c0525c1028791_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"gMHeQN90\"\u003e人们在心流状态下会高度集中注意力，完全投入到当前的活动中。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pica.zhimg.com/v2-bc196176af465d574f482b052fbc2608_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-bc196176af465d574f482b052fbc2608\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pica.zhimg.com/v2-bc196176af465d574f482b052fbc2608_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"wF1BGpod\"\u003e忽略外界干扰，体验高度的充实感与满足感。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic1.zhimg.com/v2-0815be28e1e18df38777bcea40db894a_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-0815be28e1e18df38777bcea40db894a\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pic1.zhimg.com/v2-0815be28e1e18df38777bcea40db894a_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"7r1JI8tK\"\u003e这一概念源自心理学家米哈伊·奇克森特米哈伊，其研究是积极心理学的重要组成部分。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic4.zhimg.com/v2-92d626789b23d63d14df880d34ba1565_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-92d626789b23d63d14df880d34ba1565\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pic4.zhimg.com/v2-92d626789b23d63d14df880d34ba1565_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"W4NX0OR0\"\u003e\u003cb\u003e心流状态\u003c/b\u003e通常出现在个人技能水平与所面临的挑战相匹配时。此时，任务既不会因过于简单而令人感到乏味，也不会因过于困难而引发焦虑。因此，\u003cb\u003e设置难度适宜的学习内容\u003c/b\u003e并制定清晰、具体的目标至关重要。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic4.zhimg.com/v2-dac562501aaae2bcf5fe425520477b05_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-dac562501aaae2bcf5fe425520477b05\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pic4.zhimg.com/v2-dac562501aaae2bcf5fe425520477b05_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"ET-r5T9u\"\u003e明确目标至关重要，但心流状态并非在所有情境下都能自然产生。例如，某些情况下需要刻意提升难度以突破瓶颈。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://picx.zhimg.com/v2-9c373917bc53988e21e0d0037ea8febb_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-9c373917bc53988e21e0d0037ea8febb\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://picx.zhimg.com/v2-9c373917bc53988e21e0d0037ea8febb_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"Ktlho8uS\"\u003e在调整学习难度时需保持\u003cb\u003e灵活性\u003c/b\u003e。请相信，当下的努力将使未来的技巧练习更加轻松愉快。\u003c/p\u003e\u003cp data-pid=\"xtUuegKS\"\u003e此外，APP还提供了以下提升注意力的方法：\u003cbr/\u003e首先，选择安静、光线明亮且整洁的学习环境，减少干扰物品。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic2.zhimg.com/v2-4ec6955a3faaf25403a0b0c976ec19e1_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-4ec6955a3faaf25403a0b0c976ec19e1\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pic2.zhimg.com/v2-4ec6955a3faaf25403a0b0c976ec19e1_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"_DuQDoML\"\u003e为了保持专注，我会将手机移出视线范围。例如，在进行线上学习时，我会关闭所有无关的窗口。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pica.zhimg.com/v2-6147eb251a6d78b2bf74f45e6a35c200_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-6147eb251a6d78b2bf74f45e6a35c200\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pica.zhimg.com/v2-6147eb251a6d78b2bf74f45e6a35c200_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"96JmhA56\"\u003e适当的社交媒体排读，\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic4.zhimg.com/v2-a33d747f14fc74c6ed1d55a639151387_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-a33d747f14fc74c6ed1d55a639151387\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pic4.zhimg.com/v2-a33d747f14fc74c6ed1d55a639151387_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"sFank3Vk\"\u003e社交媒体上丰富而杂乱的信息会导致认知负荷增加，引发大脑疲劳，进而影响注意力和记忆力。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://picx.zhimg.com/v2-dd03540e3731035531f02b98b00aae2b_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-dd03540e3731035531f02b98b00aae2b\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://picx.zhimg.com/v2-dd03540e3731035531f02b98b00aae2b_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"YhjiEEVF\"\u003e此外，多巴胺的过度驱动会导致我们在学习或工作中习惯性地分心。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic2.zhimg.com/v2-0d3e1ca4c3bcc2d82b8b051804c3e2ed_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-0d3e1ca4c3bcc2d82b8b051804c3e2ed\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pic2.zhimg.com/v2-0d3e1ca4c3bcc2d82b8b051804c3e2ed_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"klwz8g8Y\"\u003e频繁查看手机和社交软件会影响学习效率。我会利用苹果设备的屏幕使用时间功能进行自我管理，例如将每日使用Instagram的时间限制在30分钟以内。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic1.zhimg.com/v2-a950072aed6ba23573c503469d208fe2_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-a950072aed6ba23573c503469d208fe2\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pic1.zhimg.com/v2-a950072aed6ba23573c503469d208fe2_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"quzWOsMc\"\u003e时间到了程序就会自动上锁。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pica.zhimg.com/v2-112a97d5d96516fbccd56101049448c0_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-112a97d5d96516fbccd56101049448c0\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pica.zhimg.com/v2-112a97d5d96516fbccd56101049448c0_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"mOC9gRjJ\"\u003e此外，我会追踪每日屏幕时间的变化情况，记录其较上周的增减幅度，以此提醒自己合理控制使用时间并采用间隔学习法。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic1.zhimg.com/v2-be491d669bf77f8fa8daac3e0dff869a_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-be491d669bf77f8fa8daac3e0dff869a\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pic1.zhimg.com/v2-be491d669bf77f8fa8daac3e0dff869a_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"qkO-FV7N\"\u003e避免长时间高强度连续学习，\u003cb\u003e时间盒子\u003c/b\u003e和\u003cb\u003e番茄工作法\u003c/b\u003e都是不错的方法。关键在于合理安排学习与休息时间，同时保持健康的生活方式，如充足睡眠、避免熬夜、均衡饮食和加强锻炼，这些对大脑和注意力都有很大帮助。\u003c/p\u003e\u003cp data-pid=\"oUDaXJt1\"\u003e关于提升注意力的话题，可以单独制作一期视频进行详细探讨。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic1.zhimg.com/v2-75b28660a51455999154bdbf31cd351e_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-75b28660a51455999154bdbf31cd351e\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pic1.zhimg.com/v2-75b28660a51455999154bdbf31cd351e_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"mtYzV9TG\"\u003e接下来介绍的是深耕原则，也称为反复练习原则，其核心在于分离并强化练习技能中最薄弱的环节。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic4.zhimg.com/v2-5ae0b09208eb50becb5f8521b24c645f_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-5ae0b09208eb50becb5f8521b24c645f\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pic4.zhimg.com/v2-5ae0b09208eb50becb5f8521b24c645f_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"iwbLlIu9\"\u003e以实现全面提高。以健身为例，目标是提升全身力量和增加肌肉。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic3.zhimg.com/v2-436bd681e73cb9be571a1506c6912734_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-436bd681e73cb9be571a1506c6912734\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pic3.zhimg.com/v2-436bd681e73cb9be571a1506c6912734_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"ueCJOvAF\"\u003e我想要练习全幅深蹲，因为这对全身肌群都有益处。我意识到自己膝盖力量薄弱，这会影响深蹲的深度和负重能力。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pica.zhimg.com/v2-2230426166bfc7a658d8c1ce2d38796a_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-2230426166bfc7a658d8c1ce2d38796a\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pica.zhimg.com/v2-2230426166bfc7a658d8c1ce2d38796a_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"ZHNzf5KT\"\u003e我会进行一系列加强膝盖附近肌群的练习。在此提醒大家，找到自身短板后，务必学会通过搜索来解决问题。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic1.zhimg.com/v2-2df7cccaba78c7a3ccd89646b2db019c_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-2df7cccaba78c7a3ccd89646b2db019c\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pic1.zhimg.com/v2-2df7cccaba78c7a3ccd89646b2db019c_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"HxIZ0kGO\"\u003e寻求方法并通过反复练习突破。我在搜索膝盖相关的训练过程中，学到了许多新知识，意识到这类练习对\u003cb\u003e长期健康\u003c/b\u003e，尤其是老年阶段的益处。\u003c/p\u003e\u003cp data-pid=\"I98G__VY\"\u003e在学习过程中，要学会交替运用\u003cb\u003e直接学习\u003c/b\u003e和反复操练两种方式。直接练习即针对目标技能进行实践，例如通过实际对话学习语言，或通过写作练习提升写作技巧。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic3.zhimg.com/v2-5cc3867ab033fbca4e015d6379d72548_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-5cc3867ab033fbca4e015d6379d72548\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pic3.zhimg.com/v2-5cc3867ab033fbca4e015d6379d72548_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"k_mWe2ve\"\u003e通过拍摄视频来提升拍摄和口播技巧，随后分析学习内容，提炼关键要素，找出薄弱环节，并进行针对性训练。\u003c/p\u003e\u003cp data-pid=\"0AHASNIr\"\u003e例如在口语练习中发现发音或词汇的短板时，可以有针对性地加强训练。\u003cb\u003e越早开始交替练习，进步的速度就越快。\u003c/b\u003e\u003c/p\u003e\u003cp data-pid=\"Hcs3fWXH\"\u003e随着分析能力和提升技巧的增强，投入的努力将带来显著成效。虽然这种练习方式看似辛苦，许多人望而却步，但想要实现\u003cb\u003e超速学习\u003c/b\u003e，就必须勇于直面困难、解决问题、攻克弱点，而非沉溺于舒适区。\u003c/p\u003e\u003cp data-pid=\"hZJSQA7S\"\u003e这需要强大的学习动机，并对积极进取的学习方式保持适应。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://picx.zhimg.com/v2-49dda39687e5f3881b36222a40986837_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-49dda39687e5f3881b36222a40986837\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://picx.zhimg.com/v2-49dda39687e5f3881b36222a40986837_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"0Qx-t-F-\"\u003eScotian书中还提到几个原则，重点关注学习细节，例如记忆方法和复习方法。\u003c/p\u003e\u003cp data-pid=\"GQ5FLWPx\"\u003e感兴趣的读者可以查阅相关书籍和资料。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic4.zhimg.com/v2-4f8d6a45f8281d832d80946fe67e51eb_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-4f8d6a45f8281d832d80946fe67e51eb\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pic4.zhimg.com/v2-4f8d6a45f8281d832d80946fe67e51eb_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"Ogcf0LyD\"\u003e最后，书中提到的一点值得探讨：以实验的态度看待学习过程。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic3.zhimg.com/v2-b2374636b691d708edb42d9f9c52d566_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-b2374636b691d708edb42d9f9c52d566\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pic3.zhimg.com/v2-b2374636b691d708edb42d9f9c52d566_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"HdZgWvCc\"\u003e成长的心态\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic4.zhimg.com/v2-a8e87064024b434e16c109628c063f2d_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-a8e87064024b434e16c109628c063f2d\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pic4.zhimg.com/v2-a8e87064024b434e16c109628c063f2d_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"9caISYOy\"\u003e认定自己可以自我改进和成长，制定计划并不畏惧试错以改善结果。当你开始学习一项新技能时，\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic3.zhimg.com/v2-99c87732a762e4e9911505ce86c56ed6_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-99c87732a762e4e9911505ce86c56ed6\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pic3.zhimg.com/v2-99c87732a762e4e9911505ce86c56ed6_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"hHNqlF2T\"\u003e在学习初期，寻找并效仿能力更强的人是非常有益的，因为大家的起点相似，遵循\u003cb\u003e“先模仿后创新”\u003c/b\u003e的原则有助于快速进步。然而，随着技能水平的提升，单纯依赖榜样已不足以满足发展需求。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic1.zhimg.com/v2-b29b194df6f1f43113c26a22de3d6d40_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-b29b194df6f1f43113c26a22de3d6d40\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pic1.zhimg.com/v2-b29b194df6f1f43113c26a22de3d6d40_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"CtsSe0rU\"\u003e每个人遇到的问题各不相同，解决问题的方法也因人而异。许多问题需要\u003cb\u003e自行探索\u003c/b\u003e和解决，以找到独特的路径。\u003c/p\u003e\u003cp data-pid=\"tet6YLph\"\u003e此外，当运用原有技巧时，常会遇到\u003cb\u003e瓶颈期\u003c/b\u003e，导致停滞不前。此时不应抱怨或放弃，而应保持耐心，始终以解决问题为导向。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://picx.zhimg.com/v2-843083da6b46efc76dd8a2cba128ec55_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-843083da6b46efc76dd8a2cba128ec55\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://picx.zhimg.com/v2-843083da6b46efc76dd8a2cba128ec55_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"WjCYmfbe\"\u003e探索可选选项后，努力尝试实践。这一过程可能发展出独特的见解与原创性成果，解决他人无法解决的问题，最终形成\u003cb\u003e个人学习艺术\u003c/b\u003e。\u003c/p\u003e\u003cp data-pid=\"zfVLEEpY\"\u003e随着学习内容的增加和速度的提升，问题核心将从\u003cb\u003e如何学习\u003c/b\u003e转变为如何更高效、更快速地学习。\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic4.zhimg.com/v2-e094a79444a9d0fbea1f46f3ef4799d7_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"720\" data-original-token=\"v2-e094a79444a9d0fbea1f46f3ef4799d7\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pic4.zhimg.com/v2-e094a79444a9d0fbea1f46f3ef4799d7_r.jpg\"/\u003e\u003c/figure\u003e\u003cp data-pid=\"3hmYQUEO\"\u003e\u003cb\u003e超速学习\u003c/b\u003e并非易事，需要合理规划时间并付诸努力。更重要的是，要将\u003cb\u003e理论与实践\u003c/b\u003e相结合，真正做到知行合一。掌握学习方法所带来的回报将让你受益终身。\u003c/p\u003e\u003cp data-pid=\"BToS5sH3\"\u003e我还有许多新技能渴望学习，这让我对生活充满热情与动力。这个世界实在有太多有趣的事物值得探索。\u003c/p\u003e\u003cp data-pid=\"spZTWayu\"\u003e希望今天的分享对你有所启发。若你对视频中某个话题特别感兴趣，欢迎通过弹幕或评论告诉我，未来可能会制作相关内容。\u003c/p\u003e\u003cblockquote data-pid=\"3qgflMzI\"\u003e文章来源：「来源见截图水印」\u003c/blockquote\u003e","is_labeled":false,"visited_count":1876,"thumbnails":["https://pica.zhimg.com/50/v2-07c7c1c8b9585788a9220f9008129703_720w.jpg?source=b6762063","https://picx.zhimg.com/50/v2-8be455fa4eeadac1519ef5a983a984f8_720w.jpg?source=b6762063","https://pica.zhimg.com/50/v2-f87783d9502379bb8b4cb7566c8722fe_720w.jpg?source=b6762063","https://picx.zhimg.com/50/v2-eebc04b28883f71e10e153f8436a1a74_720w.jpg?source=b6762063","https://picx.zhimg.com/50/v2-7651f302547876394d39677ef1626be4_720w.jpg?source=b6762063","https://picx.zhimg.com/50/v2-0c420c5ebb14bfa778ce3d098a769cc3_720w.jpg?source=b6762063","https://pic1.zhimg.com/50/v2-20bc700a308d49b0b5b9581cb96c4f52_720w.jpg?source=b6762063","https://picx.zhimg.com/50/v2-123acdb6684d31b7e78a0c3ca53e2f92_720w.jpg?source=b6762063","https://picx.zhimg.com/50/v2-561f925aa35160ec9c48599f8dba4d7a_720w.jpg?source=b6762063","https://pic1.zhimg.com/50/v2-a3c30dbe8cba8c12d93ff69e64e6cb9d_720w.jpg?source=b6762063","https://pica.zhimg.com/50/v2-02c563bfd3d231e30320265a0a54d7e1_720w.jpg?source=b6762063","https://pica.zhimg.com/50/v2-2a27a8debdf21cc95e57ee27520b1469_720w.jpg?source=b6762063","https://picx.zhimg.com/50/v2-84bf1a7515f121fe9d31d6c78b50db23_720w.jpg?source=b6762063","https://pic1.zhimg.com/50/v2-59343ef436c027856fbe07b57eb54806_720w.jpg?source=b6762063","https://picx.zhimg.com/50/v2-1137ae612078c35abde3846bb80f4503_720w.jpg?source=b6762063","https://pica.zhimg.com/50/v2-9d8cf0354e6b135682ac740616b52f76_720w.jpg?source=b6762063","https://pica.zhimg.com/50/v2-5968fa74c16d5f4281925774a32d8224_720w.jpg?source=b6762063","https://pic1.zhimg.com/50/v2-c17e5e1eee21654a514b284950b25e7d_720w.jpg?source=b6762063","https://picx.zhimg.com/50/v2-caeb9776bd528e4ce381eee2eadb34a2_720w.jpg?source=b6762063","https://pica.zhimg.com/50/v2-1044477d6b72d93c252040882868e080_720w.jpg?source=b6762063","https://picx.zhimg.com/50/v2-648b774bda7f4d54ad12c77884aac4b1_720w.jpg?source=b6762063","https://pic1.zhimg.com/50/v2-1e18cc48eedbd5b21632ad18176d3e3a_720w.jpg?source=b6762063","https://picx.zhimg.com/50/v2-2d23bad713dcc14a9bee75bd0e54b617_720w.jpg?source=b6762063","https://pic1.zhimg.com/50/v2-0ccc65601ec9b424e48e34a1f1fc4749_720w.jpg?source=b6762063","https://pica.zhimg.com/50/v2-c1e57d284b5e088810b50bc4981e2d1d_720w.jpg?source=b6762063","https://picx.zhimg.com/50/v2-33cf5b899a4099aa88c123260feaf1d8_720w.jpg?source=b6762063","https://pic1.zhimg.com/50/v2-0c9ed6d80b3d6f0bac9b327b71f3077e_720w.jpg?source=b6762063","https://picx.zhimg.com/50/v2-57cc323073330dd48385c325db0c9279_720w.jpg?source=b6762063","https://pica.zhimg.com/50/v2-8e73adccf51055093ee1881f405b9cb8_720w.jpg?source=b6762063","https://pica.zhimg.com/50/v2-ade4eed8d1c98fa51af5356c332fc651_720w.jpg?source=b6762063","https://pic1.zhimg.com/50/v2-af76304b6b8a11405d8fe0083135bffb_720w.jpg?source=b6762063","https://pica.zhimg.com/50/v2-625dd925e9883fa7b878a6e68783674e_720w.jpg?source=b6762063","https://picx.zhimg.com/50/v2-a8c4a41d5971cfef0e7dfa1dc838fd78_720w.jpg?source=b6762063","https://pic1.zhimg.com/50/v2-e5fef5fef397439d84973044b9248d64_720w.jpg?source=b6762063","https://picx.zhimg.com/50/v2-cfda634c79b3e5da5faa646203b8f82b_720w.jpg?source=b6762063","https://picx.zhimg.com/50/v2-1494591bdcdbcc6da117119ca3d1a78c_720w.jpg?source=b6762063","https://pica.zhimg.com/50/v2-0343cddf47c045338047245bd7fc9584_720w.jpg?source=b6762063","https://picx.zhimg.com/50/v2-80beead3cfae2ece19b1981a2cc900fa_720w.jpg?source=b6762063","https://picx.zhimg.com/50/v2-fdbd5774395979ab83f275df08ee875c_720w.jpg?source=b6762063","https://picx.zhimg.com/50/v2-2b3d89316544145f25ef3fc350e18a00_720w.jpg?source=b6762063","https://picx.zhimg.com/50/v2-06438a33ae07ebcccbe4b114ce66d0bd_720w.jpg?source=b6762063","https://picx.zhimg.com/50/v2-cf34e76625b29d3a32792ceba27d40a2_720w.jpg?source=b6762063","https://picx.zhimg.com/50/v2-264d4e319b9fe1a23649de75bf9d31c2_720w.jpg?source=b6762063","https://picx.zhimg.com/50/v2-eb8932631e1803451a97c88fae9fbf2a_720w.jpg?source=b6762063","https://pic1.zhimg.com/50/v2-e98b7e1f1917646af3642b44365d760b_720w.jpg?source=b6762063","https://pica.zhimg.com/50/v2-4717bba58b482d05930b9ea415ca28fb_720w.jpg?source=b6762063","https://picx.zhimg.com/50/v2-f105f506ee9ae42102c94faadc74e5df_720w.jpg?source=b6762063","https://picx.zhimg.com/50/v2-4710bb3b67addfa96a4d9e27923d4f02_720w.jpg?source=b6762063","https://picx.zhimg.com/50/v2-7fbb97d16dc9669642a2ab0f42f202ab_720w.jpg?source=b6762063","https://pic1.zhimg.com/50/v2-fe2d3f69f96d91deb97f13473e6fe8e2_720w.jpg?source=b6762063","https://pica.zhimg.com/50/v2-60e7377042efe3581fd249510a191b9f_720w.jpg?source=b6762063","https://pic1.zhimg.com/50/v2-5f25d3b67a8f57822a992f8e5868ec40_720w.jpg?source=b6762063","https://pica.zhimg.com/50/v2-21f537abebe3f8c0fa1f2fe047a59529_720w.jpg?source=b6762063","https://picx.zhimg.com/50/v2-48672fc97434ebfab315491144417d00_720w.jpg?source=b6762063","https://picx.zhimg.com/50/v2-1e992a26c75750d05e499638783a9451_720w.jpg?source=b6762063","https://picx.zhimg.com/50/v2-0d6821855c12378169ca2a7812c3e9fb_720w.jpg?source=b6762063","https://picx.zhimg.com/50/v2-b8d27d7d3b69f50eb275f403c6681880_720w.jpg?source=b6762063","https://pic1.zhimg.com/50/v2-336bb0ecfa87c21de4cc2cb5c6e218f6_720w.jpg?source=b6762063","https://picx.zhimg.com/50/v2-c86b21e92769543f61f62f81567ab7d9_720w.jpg?source=b6762063","https://picx.zhimg.com/50/v2-a83195aa0e2b97435e5a3bee62fb78f1_720w.jpg?source=b6762063","https://pica.zhimg.com/50/v2-b4b7975d5a16e90d55a4b7dc8ffe787c_720w.jpg?source=b6762063","https://pic1.zhimg.com/50/v2-ed499e3fead056b8b23e3ad3ea11a939_720w.jpg?source=b6762063","https://pic1.zhimg.com/50/v2-70e6d62067373d7fff598863d69b0f59_720w.jpg?source=b6762063","https://pic1.zhimg.com/50/v2-b8cca9fa3c5de148383ba82d69b75b88_720w.jpg?source=b6762063","https://pic1.zhimg.com/50/v2-65a939fad0593e724becc706b0ce02aa_720w.jpg?source=b6762063","https://pic1.zhimg.com/50/v2-d316c2b27526a04949de20998012568d_720w.jpg?source=b6762063","https://pic1.zhimg.com/50/v2-3870934842f4347b3d013db31fa4d655_720w.jpg?source=b6762063","https://pic1.zhimg.com/50/v2-2b9d785289598af4d38470dddfe9dd34_720w.jpg?source=b6762063","https://picx.zhimg.com/50/v2-9fd6dd991755487ca6c86a62daba3324_720w.jpg?source=b6762063"],"favorite_count":240,"article_type":"normal","is_navigator":false,"navigator_vote":false,"vote_next_step":"vote"},"brief":"{\"source\": \"TS\", \"type\": \"article\", \"id\": 1921214932168450782}","attached_info":"CsceCNWknKXXuZ2kogEQBxoJMjU5NTM3MTkyIPWx7sIGKCkwAUBjSigKHVRTX1NPVVJDRV9JTlRFUkVTVF9XT1JEX01FUkdFEgEwGAAgADoAYiAwZWJhMWJlMzVkYTI5ZDI3ODNlYWU4MjIyZDNlNWU0OXITMTkyMTIxNDkzMjE2ODQ1MDc4MqoBCXJlY29tbWVuZMIBIDFhZGMxZWM5OTFhYzAzMjIyODk1YjdjMWZlNTI4Nzdl8gEKCAwSBk5vcm1hbPIBKAgKEiRmODFhYmMxNC1mZmRiLTQ2OTYtODUxMS01NjhiOWNiMzY2MTbyAQYICxICMTeCAgCIAtG8686FM5ICIDFhZGMxZWM5OTFhYzAzMjIyODk1YjdjMWZlNTI4NzdlmgIAygIWU2hvckludGVyZXN0V2VpZ2h0UnVsZcoCFVVzZXJMY25FeGl0V2VpZ2h0UnVsZdoCHVRTX1NPVVJDRV9JTlRFUkVTVF9XT1JEX01FUkdF6AID+gILTk9STUFMX0ZMT1eKAyAxMzJlOTVlNzcyMDE0MzZhYmVlNmYwMWJiNTQ3MjlhYpoDDQoCdjIQABoFb3RoZXKoA9QO2AMA6gMiSW50ZXJlc3RXb3JkTWVyZ2VWMU5ld1Bvb2xSZWNhbGxlcvoDyhkSDFVOS05PV05fTU9ERSAAKg1OT19JTUFHRV9NT0RFOi0IAxCAChjQBSIjdjItOGVmODQxNWQ5ZTU0OGMyMjBlZWU1MDZkZDlmZTM2NGQ6LQgDEIAKGNAFIiN2Mi0wMGZmN2E3ZjQyYjU4OGUzNmFlNDZhMTNlODc4NDkyMzotCAIQgAoY0AUiI3YyLTE3MTUwYWE3NDRkM2FiNzUwNDkyNjQxYTdlNmIwMGJjOi0IAxCAChjQBSIjdjItZjBmMjE0YWRlMzQzMmU1MjliN2YyMjA1ZWM2NjAzM2E6LQgDEIAKGNAFIiN2Mi0zYmM3YTVhYWY2Mzk4M2E3NmM1NThlMGJjZGY4OWYxZjotCAMQgAoY0AUiI3YyLWRmYTYyMzc0NWRiNDBhMjE2M2VhYTgxODBhOGUwYTMzOi0IAhCAChjQBSIjdjItMzRiMjcwNGFiM2EzN2Q4MjRiNmM1OTJlNmQ3ODg0OGY6LQgDEIAKGNAFIiN2Mi0yZTViZTk5MzYwMGU3Yzg0OGE0ZjhlNjlhYWRkOWFkZTotCAMQgAoY0AUiI3YyLWU4NDFiNTJlNDUyNzdmODE3YmFmMjc5YWEyZjJkMzdkOi0IAxCAChjQBSIjdjItYzkwM2NlZjEyZGQxMjA2YTg5ZWEzZjBmODFmNTAzYzU6LQgDEIAKGNAFIiN2Mi1iMmY2ZTkxZTNhMGU4NGZjZTVjMjhmZmM3NzM5MzZkMTotCAIQgAoY0AUiI3YyLTQ2MDRjMDIyZWUxMDc2ZDcyOTJlYzMxZTU3MWYzNDExOi0IAxCAChjQBSIjdjItODVjZjBlMmQzNGRlNjhlZGJlMzQ3ZTg2MjY5OWM4NzU6LQgCEIAKGNAFIiN2Mi1jYTgwMGQ3NDBlNWY4Mjc5MmEyNTcwODcwZTdlZmYxZTotCAMQgAoY0AUiI3YyLWEyMDJlZGIwZjBhMWFlZTMxMzE1MzU4ZWU0YWYyZGQ4Oi0IAhCAChjQBSIjdjItMGMzZjk5ODg2Y2NiOWVmNTBhOTViZGIyMDRhYWQ2YTI6LQgCEIAKGNAFIiN2Mi1mYTI2MzA3YzZjNzRjYWI1OGE5ZDU1ZDIyNzFjYWM4NjotCAMQgAoY0AUiI3YyLTA5NDFiNDBmOTViMDE4YTM3Yjg0YzEyYzg1NTBhYTlmOi0IAxCAChjQBSIjdjItZjc1ZjM4NDJlODRjYjQzZDlmYTQ3M2U0OGVmNjJiYTM6LQgDEIAKGNAFIiN2Mi1iMWE2YWY2YjJjODFlZGI4NTUzNDY0MTQzMWZhZjc4ODotCAMQgAoY0AUiI3YyLTkyN2VjMGJiOWRhNDAyYTI5OGExNTYyN2I3MjU4NWZiOi0IAhCAChjQBSIjdjItODM1ZDI5NTlhYTAxMmNmNzk1MDczMDRmMTk4OWJiNTQ6LQgCEIAKGNAFIiN2Mi1mYThmNGJjYjRiOGE1NWI0NTExODFhMzhjODhlZDE1YTotCAMQgAoY0AUiI3YyLWY4NzU1YWIwYTM4MTRjOWVjNWM3ODBiNWIzMjgyNmFmOi0IAxCAChjQBSIjdjItNWE2YzQ0NjQ0MjVkNzEzZGU5NzdlODkyZjljNTkwYjM6LQgDEIAKGNAFIiN2Mi0wZjRkMjgzMjAwZmVhMmJkZWM3MzJkMzRhMmNlNjg4NzotCAMQgAoY0AUiI3YyLWI1ZTQzOTMxMWUzOTg4YTAxNGM3OThjZDI2MDAwZjgwOi0IAhCAChjQBSIjdjItOWMxODVkMjFjYmRhM2YxZGZkNGFkN2MxMzBkNzc5Y2M6LQgDEIAKGNAFIiN2Mi01NDUxMGYxMDhlMTE3ZmNhMzNmNDBjMjNjMzg3Zjk5MDotCAIQgAoY0AUiI3YyLTcxZmM2YWM4YTU4OGVlNWVhYjQ3MjRiY2E1NzBlYjRhOi0IAhCAChjQBSIjdjItYzQ4Y2RjYTg2YjA2NTA2MzM2MTQ1Njk2NDk1NTA5ZGY6LQgDEIAKGNAFIiN2Mi0zZGI3MjNhNDhjNjcxMzc2OThlOThhYjNlMTJkMGRlNjotCAMQgAoY0AUiI3YyLTUxOWJlMjhlMmViODIxNWZjMjhjNzkxN2UwNTAxMjA0Oi0IAxCAChjQBSIjdjItNmU4MmI1N2RjNDQzYTU4M2ZhMjAwZDViMGMzNDZkMDI6LQgCEIAKGNAFIiN2Mi03OTQwY2E3ODJhNmVhZGQzZmE4MDRiNDYyMzEyZTEyOTotCAIQgAoY0AUiI3YyLTFlODAxNGZiYjI3YzQyZDc2M2Y4NzdiOTJiMDE5NjhiOi0IAxCAChjQBSIjdjItYTEyZDgyNjFjOTJhMjFmNWVlOGQwYWZkNTMxNTA2ZTU6LQgDEIAKGNAFIiN2Mi1kZjRlZGQ1ZWNjMDc0YTU4NDk5NTcxOWNiZWNmY2VkMTotCAMQgAoY0AUiI3YyLTIxNzE3NzRlNGQ4YzAzMmQ1MTE3OGE0YjM2YmY2NTc0Oi0IAxCAChjQBSIjdjItMjEwNWFmMGU2MGQ5ODgyM2E4YjEyMDA4ZGNkZGY0ZDc6LQgDEIAKGNAFIiN2Mi01YTg2ZDQxYmJiNzVhY2RlNmJlYTA4OGY4ZDE5MTRkYzotCAMQgAoY0AUiI3YyLTg0ZjVhYzgwNzY1ZDk1ODkyYzljMDUyNWMxMDI4NzkxOi0IAxCAChjQBSIjdjItYmMxOTYxNzZhZjQ2NWQ1NzRmNDgyYjA1MmZiYzI2MDg6LQgCEIAKGNAFIiN2Mi0wODE1YmUyOGUxZTE4ZGYzODc3N2JjZWE0MGRiODk0YTotCAUQgAoY0AUiI3YyLTkyZDYyNjc4OWIyM2Q2M2QxNGRmODgwZDM0YmExNTY1Oi0IAxCAChjQBSIjdjItZGFjNTYyNTAxYWFhZTJiY2Y1ZmU0MjU1MjA0NzdiMDU6LQgCEIAKGNAFIiN2Mi05YzM3MzkxN2JjNTM5ODhlMjFlMGQwMDM3ZWE4ZmViYjotCAMQgAoY0AUiI3YyLTRlYzY5NTVhM2ZhYWYyNTQwM2EwYjBjOTc2ZWMxOWUxOi0IAhCAChjQBSIjdjItNjE0N2ViMjUxYTZkNzhiMmJmNzRmNDVlNmEzNWMyMDA6LQgDEIAKGNAFIiN2Mi1hMzNkNzQ3ZjE0ZmM3NGM2ZWQxZDU1YTYzOTE1MTM4NzotCAMQgAoY0AUiI3YyLWRkMDM1NDBlMzczMTAzNTUzMWYwMmI5OGIwMGFhZTJiOi0IAxCAChjQBSIjdjItMGQzZTFjYTRjM2JjYzJkODJiOGIwNTE4MDRjM2UyZWQ6LQgDEIAKGNAFIiN2Mi1hOTUwMDcyYWVkNmJhMjM1NzNjNTAzNDY5ZDIwOGZlMjotCAMQgAoY0AUiI3YyLTExMmE5N2Q1ZDk2NTE2ZmJjY2Q1NjEwMTA0OTQ0OGMwOi0IAhCAChjQBSIjdjItYmU0OTFkNjY5YmY3N2Y4ZmE4ZGFhYzNlMGRmZjg2OWE6LQgCEIAKGNAFIiN2Mi03NWIyODY2MGE1MTQ1NTk5OTE1NGJkYmYzMWNkMzUxZTotCAMQgAoY0AUiI3YyLTVhZTBiMDkyMDhlYjUwYmVjYjVmODUyMWIyNGM2NDVmOi0IBBCAChjQBSIjdjItNDM2YmQ2ODFlNzNjYjliZTU3MWExNTA2YzY5MTI3MzQ6LQgEEIAKGNAFIiN2Mi0yMjMwNDI2MTY2YmZjN2E2NThkOGMxY2UyZDM4Nzk2YTotCAMQgAoY0AUiI3YyLTJkZjdjY2NhYmE3OGM3YTNjY2Q4OTY0NmIyZGIwMTljOi0IAxCAChjQBSIjdjItNWNjMzg2N2FiMDMzZmJjYTRlMDE1ZDYzNzlkNzI1NDg6LQgDEIAKGNAFIiN2Mi00OWRkYTM5Njg3ZTVmMzg4MWIzNjIyMmE0MDk4NjgzNzotCAMQgAoY0AUiI3YyLTRmOGQ2YTQ1ZjgyODFkODMyZDgwOTQ2ZmU2N2U1MWViOi0IAxCAChjQBSIjdjItYjIzNzQ2MzZiNjkxZDcwOGVkYjQyZDlmOWM1MmQ1NjY6LQgDEIAKGNAFIiN2Mi1hOGU4NzA2NDAyNGI0MzRlMTZjMTA5NjI4YzA2M2YyZDotCAMQgAoY0AUiI3YyLTk5Yzg3NzMyYTc2MmU0ZTk5MTE1MDVjZTg2YzU2ZWQ2Oi0IBBCAChjQBSIjdjItYjI5YjE5NGRmNmYxZjQzMTEzYzI2YTIyZGUzZDZkNDA6LQgCEIAKGNAFIiN2Mi04NDMwODNkYTZiNDZlZmM3NmRkOGEyY2JhMTI4ZWM1NTotCAIQgAoY0AUiI3YyLWUwOTRhNzk0NDRhOWQwZmJlYTFmNDZmM2VmNDc5OWQ3gAQAiAQAkgQGTm9ybWFsmgQBM6AEAKgEALAEALoEAmFpwgQDNDAwyAQA0gQP5o6o6I2Q5bey5pu05paw2AQA8AQA+QQAAADgNrmoP4EFAAAAAAAAAACJBVSxE8ZYcNM/kgUAmgUDZGZ0ogUDZGZ0sgUBMbkFAAAAAAAAAADQBQDgBQDoBQDwBRGQBgCgBmOoBgCSAi4KCTI1OTUzNzE5MhITMTkyMTIxNDkzMjE2ODQ1MDc4MhgHIgpJTUFHRV9URVhU","action_card":false},{"id":"100_1753854172.662","type":"feed","offset":100,"verb":"TOPIC_ACKNOWLEDGED_ANSWER","created_time":1753854172,"updated_time":1753854172,"target":{"id":"1933793992555857896","type":"answer","url":"https://api.zhihu.com/answers/1933793992555857896","author":{"id":"c6a356599857c349d85e87c0e4f1a1a2","url":"https://api.zhihu.com/people/c6a356599857c349d85e87c0e4f1a1a2","user_type":"people","url_token":"paullu","name":"进击的小学生","headline":"进击的小小学生","avatar_url":"https://pic1.zhimg.com/50/v2-af6dc3a823d86b8ef0753b4699718d6a_l.jpg?source=b6762063","is_org":false,"gender":1,"followers_count":274,"is_following":false,"is_followed":false},"created_time":1753832415,"updated_time":1753832415,"voteup_count":1,"thanks_count":0,"comment_count":0,"is_copyable":false,"question":{"id":"1925210074843972008","type":"question","url":"https://api.zhihu.com/questions/1925210074843972008","author":{"id":"f463e3866be9d9a456306209d0db8780","url":"https://api.zhihu.com/people/f463e3866be9d9a456306209d0db8780","user_type":"people","url_token":"chen-kun-16-41","name":"陈坤","headline":"","avatar_url":"https://pic1.zhimg.com/50/v2-c2b648d5ae7a5165d7ac6158f9afe035_l.jpg?source=b6762063","is_org":false,"gender":1,"followers_count":0,"is_following":false,"is_followed":false},"title":"自学编程，只看书，没人教，学得会吗?","created":1751785850,"answer_count":0,"follower_count":0,"comment_count":5,"bound_topic_ids":[30960],"is_following":false,"excerpt":"","relationship":{"is_author":false},"detail":"","question_type":"normal"},"excerpt":"只要勤动手、多思考没有学不会的。 首先，定目标。为什么要学习编程，尽量把目标定大一点，比如成为架构师设计一套xx系统 第二，拆解目标。 准备分几步走，首先解决完成什么，再完成什么。 该阶段遵守“先做出来，再优化”。这一步主要从环境、简单开发、测试部署都会有点了解了 第三，看大神们的开源项目。模仿它们，修改前面的项目。 最后，多锻炼，多阅读，别害怕出错。坚持走下去，别停留。","excerpt_new":"只要勤动手、多思考没有学不会的。 首先，定目标。为什么要学习编程，尽量把目标定大一点，比如成为架构师设计一套xx系统 第二，拆解目标。 准备分几步走，首先解决完成什么，再完成什么。 该阶段遵守“先做出来，再优化”。这一步主要从环境、简单开发、测试部署都会有点了解了 第三，看大神们的开源项目。模仿它们，修改前面的项目。 最后，多锻炼，多阅读，别害怕出错。坚持走下去，别停留。","preview_type":"default","preview_text":"","reshipment_settings":"disallowed","content":"\u003cp data-pid=\"7zOBaw5R\"\u003e只要勤动手、多思考没有学不会的。\u003c/p\u003e\u003cp data-pid=\"pju341Yq\"\u003e首先，定目标。为什么要学习编程，尽量把目标定大一点，比如成为架构师设计一套xx系统\u003c/p\u003e\u003cp data-pid=\"bE3EyIRU\"\u003e第二，拆解目标。\u003c/p\u003e\u003cp data-pid=\"pKo-Q-k4\"\u003e准备分几步走，首先解决完成什么，再完成什么。\u003c/p\u003e\u003cp data-pid=\"zwPFs1Wf\"\u003e该阶段遵守“先做出来，再优化”。这一步主要从环境、简单开发、测试部署都会有点了解了\u003c/p\u003e\u003cp data-pid=\"HJ8xLGXK\"\u003e第三，看大神们的开源项目。模仿它们，修改前面的项目。\u003c/p\u003e\u003cp data-pid=\"aVFqRDf9\"\u003e最后，多锻炼，多阅读，别害怕出错。坚持走下去，别停留。\u003c/p\u003e","relationship":{"is_thanked":false,"is_nothelp":false,"voting":0},"is_labeled":true,"visited_count":35,"favorite_count":2,"answer_type":"normal","is_navigator":false,"navigator_vote":false,"vote_next_step":"vote"},"brief":"{\"source\": \"TS\", \"type\": \"answer\", \"id\": 1933793992555857896}","attached_info":"CowGCNWknKXXuZ2kogEQBBoJNzM5NTM3MzM1IN+3pcQGKAEwAEBkSiQKGVRTX1NPVVJDRV9XQVJNX1VQX05PUk1BTDISATAYACAAOgBKLwokVFNfU09VUkNFX1dBUk1VUF9UV09UT1dFUl9FWFBWMl9URVhUEgEwGAAgADoAWgkxMTU3MDE3MDFiIDBlYmExYmUzNWRhMjlkMjc4M2VhZTgyMjJkM2U1ZTQ5chMxOTMzNzkzOTkyNTU1ODU3ODk2igETMTkyNTIxMDA3NDg0Mzk3MjAwOKoBCXJlY29tbWVuZMIBIGM2YTM1NjU5OTg1N2MzNDlkODVlODdjMGU0ZjFhMWEy8gEKCAwSBk5vcm1hbPIBKAgKEiRhYzRhZGQ3Ny00NGNkLTQxYjctOWRkZi01OTM5MmUwMDJhZDbyAQYICxICMTeCAgCIAtG8686FM5ICIGM2YTM1NjU5OTg1N2MzNDlkODVlODdjMGU0ZjFhMWEymgIAygIWU2hvckludGVyZXN0V2VpZ2h0UnVsZcoCFVVzZXJMY25FeGl0V2VpZ2h0UnVsZcoCGENvbnRlbnRXYXJtVXBCcmVha0luUnVsZdoCGVRTX1NPVVJDRV9XQVJNX1VQX05PUk1BTDLoAgL6AgtOT1JNQUxfRkxPV4oDIDEzMmU5NWU3NzIwMTQzNmFiZWU2ZjAxYmI1NDcyOWFimgMNCgJ2MhAAGgVvdGhlcqgDI9gDAOoDL2NvbnRlbnRXYXJtdXBUd29Ub3dlclR2cFRleHROb3JtYWxFeHBWMlJlY2FsbGVy+gMfEgxVTktOT1dOX01PREUgACoNTk9fSU1BR0VfTU9ERYAEAIgEAJIEBk5vcm1hbJoEATKgBACoBACwBAC6BAJhacIEAzQwMMgEANIED+aOqOiNkOW3suabtOaWsNgEAPAEAPkEAAAA4K2Miz+BBQAAAAAAAAAAiQVUsRPGWHDTP5IFAJoFA2RmdKIFA2RmdLIFATG5BQAAAAAAAAAA0AUA4AUA6AUA8AURkAYAoAZkqAYBkgIuCgk3Mzk1MzczMzUSEzE5MzM3OTM5OTI1NTU4NTc4OTYYBCIKSU1BR0VfVEVYVA==","action_card":false},{"id":"101_1753854172.69","type":"feed","offset":101,"verb":"TOPIC_ACKNOWLEDGED_ANSWER","created_time":1753854172,"updated_time":1753854172,"target":{"id":"1908928080120116401","type":"answer","url":"https://api.zhihu.com/answers/1908928080120116401","author":{"id":"7455f31dc4cbc8d095faffe4c010883b","url":"https://api.zhihu.com/people/7455f31dc4cbc8d095faffe4c010883b","user_type":"people","url_token":"ni-ni-26-13-28","name":"热爱可抵岁月漫长","headline":"非淡泊无以明志，非宁静无以致远","avatar_url":"https://pic1.zhimg.com/50/v2-c502f8f11ad1313000375dd31107d984_l.jpg?source=b6762063","is_org":false,"gender":1,"followers_count":11,"is_following":false,"is_followed":false},"created_time":1747903920,"updated_time":1747903920,"voteup_count":1869,"thanks_count":55,"comment_count":165,"is_copyable":true,"question":{"id":"39441398","type":"question","url":"https://api.zhihu.com/questions/39441398","author":{"id":"535e1fd49b1ae9f0179a80080792b296","url":"https://api.zhihu.com/people/535e1fd49b1ae9f0179a80080792b296","user_type":"people","url_token":"azure-will","name":"Azure will","headline":"喜欢一直拿着相机的代码狗","avatar_url":"https://pic1.zhimg.com/50/5f29a1ea62b7131d5269ab430e3c1112_l.jpg?source=b6762063","is_org":false,"gender":-1,"followers_count":2,"is_following":false,"is_followed":false},"title":"程序员界有哪些经典的笑话?","created":1452660096,"answer_count":0,"follower_count":0,"comment_count":6,"bound_topic_ids":[707,4453,7897,12452,17637],"is_following":false,"excerpt":"","relationship":{"is_author":false},"detail":"","question_type":"normal"},"thumbnail":"https://picx.zhimg.com/50/v2-4e7472e442a7eb255ff4647004006c43_720w.jpg?source=b6762063","excerpt":"刚刚在小红书看到一个，承包我一下午的笑点","excerpt_new":"刚刚在小红书看到一个，承包我一下午的笑点","preview_type":"default","preview_text":"","reshipment_settings":"allowed","content":"\u003cp data-pid=\"jmM7L_88\"\u003e\u003ci\u003e刚刚在小红书看到一个，承包我一下午的笑点\u003c/i\u003e\u003c/p\u003e\u003cfigure data-size=\"normal\"\u003e\u003cimg src=\"https://pic3.zhimg.com/v2-43f396ee7a4bef2ad2b848da43e94bb6_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1280\" data-rawheight=\"2844\" data-original-token=\"v2-9e8e8714ca96abefb08a85ad570eec21\" data-default-watermark-src=\"https://picx.zhimg.com/v2-7b8ac91cb719440248129f4f5da2aa6d_b.jpg\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pic3.zhimg.com/v2-43f396ee7a4bef2ad2b848da43e94bb6_r.jpg\"/\u003e\u003c/figure\u003e\u003cp\u003e\u003c/p\u003e","relationship":{"is_thanked":false,"is_nothelp":false,"voting":0},"is_labeled":false,"visited_count":397632,"thumbnails":["https://picx.zhimg.com/50/v2-4e7472e442a7eb255ff4647004006c43_720w.jpg?source=b6762063"],"favorite_count":109,"answer_type":"normal","is_navigator":false,"navigator_vote":false,"vote_next_step":"vote"},"brief":"{\"source\": \"TS\", \"type\": \"answer\", \"id\": 1908928080120116401}","attached_info":"CoYHCNWknKXXuZ2kogEQBBoJNzI4NTc5MjkxILDLu8EGKM0OMKUBQGVKKAodVFNfU09VUkNFX0lOVEVSRVNUX1dPUkRfTUVSR0USATAYACAAOgBKOAotVFNfU09VUkNFX0lOVEVSRVNUX1dPUkRfQ09OVEVOVF9WQUxVRV9MRVZFTF9DEgEwGAAgADoAWgc3OTgzNjA5YiAwZWJhMWJlMzVkYTI5ZDI3ODNlYWU4MjIyZDNlNWU0OXITMTkwODkyODA4MDEyMDExNjQwMYoBCDM5NDQxMzk4qgEJcmVjb21tZW5kwgEgNzQ1NWYzMWRjNGNiYzhkMDk1ZmFmZmU0YzAxMDg4M2LyAQoIDBIGTm9ybWFs8gEoCAoSJDNkM2RjNDAzLWQ5ZDQtNDY5OC05MGQ2LTNlMTBiZDE5ZTJlOfIBBggLEgIxN4ICAIgC0bzrzoUzkgIgNzQ1NWYzMWRjNGNiYzhkMDk1ZmFmZmU0YzAxMDg4M2KaAgDKAhZTaG9ySW50ZXJlc3RXZWlnaHRSdWxlygIWQWN0aW9uU2hvckludGVyZXN0UnVsZcoCG0ludGVyYWN0aW9uU2hvckludGVyZXN0UnVsZcoCFlJldmlzaXRWYWx1ZVdlaWdodFJ1bGXKAhVVc2VyTGNuRXhpdFdlaWdodFJ1bGXKAhRDb250ZW50QWdlV2VpZ2h0UnVsZdoCHVRTX1NPVVJDRV9JTlRFUkVTVF9XT1JEX01FUkdF6AIC+gILTk9STUFMX0ZMT1eKAyAxMzJlOTVlNzcyMDE0MzZhYmVlNmYwMWJiNTQ3MjlhYpoDDQoCdjIQABoFb3RoZXKoA8CiGNgDAOoDIkludGVyZXN0V29yZE1lcmdlVjFOZXdQb29sUmVjYWxsZXL6A04SDFVOS05PV05fTU9ERSAAKg1OT19JTUFHRV9NT0RFOi0IAhCAChicFiIjdjItOWU4ZTg3MTRjYTk2YWJlZmIwOGE4NWFkNTcwZWVjMjGABACIBACSBAZOb3JtYWyaBAEyoAQAqAQAsAQAugQGbWFudWFswgQDMTcwyAQA0gQP5o6o6I2Q5bey5pu05paw2AQA8AQA+QQAAAAg1CnAP4EFAAAAAAAAAACJBVSxE8ZYcNM/kgUAmgUDZGZ0ogUDZGZ0sgUBMbkFAAAAAAAAAADQBQDgBQDoBQDwBRGQBgCgBmWoBgCSAi4KCTcyODU3OTI5MRITMTkwODkyODA4MDEyMDExNjQwMRgEIgpJTUFHRV9URVhU","action_card":false}],"paging":{"is_end":false,"is_start":false,"next":"https://www.zhihu.com/api/v3/feed/topstory/recommend?action=down\u0026ad_interval=-10\u0026after_id=101\u0026desktop=true\u0026end_offset=101\u0026page_number=18\u0026session_token=0eba1be35da29d2783eae8222d3e5e49","previous":"https://www.zhihu.com/api/v3/feed/topstory/recommend?action=pull\u0026ad_interval=-10\u0026before_id=101\u0026desktop=true\u0026end_offset=101\u0026page_number=18\u0026session_token=0eba1be35da29d2783eae8222d3e5e49","totals":0},"fresh_text":"推荐已更新"}
