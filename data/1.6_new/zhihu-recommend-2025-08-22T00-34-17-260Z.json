{
  "data": [
    {
      "id": "594_1755822903.473",
      "type": "feed",
      "offset": 594,
      "verb": "TOPIC_ACKNOWLEDGED_ANSWER",
      "created_time": 1755822903,
      "updated_time": 1755822903,
      "target": {
        "id": "2811498443",
        "type": "answer",
        "url": "https://api.zhihu.com/answers/2811498443",
        "author": {
          "id": "f6a696b6316d58e81a84faf8700b6290",
          "url": "https://api.zhihu.com/people/f6a696b6316d58e81a84faf8700b6290",
          "user_type": "people",
          "url_token": "xie-liang-chen-91-80",
          "name": "将择道长",
          "headline": "睿智人",
          "avatar_url": "https://pic1.zhimg.com/50/v2-20207f299240015bca4b34ab4f4754d3_l.jpg?source=b6762063",
          "is_org": false,
          "gender": -1,
          "followers_count": 11313,
          "is_following": false,
          "is_followed": false
        },
        "created_time": 1671681272,
        "updated_time": 1671681272,
        "voteup_count": 25322,
        "thanks_count": 1266,
        "comment_count": 495,
        "is_copyable": true,
        "question": {
          "id": "49379992",
          "type": "question",
          "url": "https://api.zhihu.com/questions/49379992",
          "author": {
            "id": "5ff96b32c1f61df77fad34d3b72924e6",
            "url": "https://api.zhihu.com/people/5ff96b32c1f61df77fad34d3b72924e6",
            "user_type": "people",
            "url_token": "hai-de-90",
            "name": "海德",
            "headline": "前·死会计",
            "avatar_url": "https://pic1.zhimg.com/50/75232a8fc61e71cf67b84e7a8ceeec9c_l.jpg?source=b6762063",
            "is_org": false,
            "gender": -1,
            "followers_count": 2,
            "is_following": false,
            "is_followed": false
          },
          "title": "中国狸花猫有什么优缺点呢？",
          "created": 1470641950,
          "answer_count": 0,
          "follower_count": 0,
          "comment_count": 65,
          "bound_topic_ids": [
            1570,
            290769
          ],
          "is_following": false,
          "excerpt": "",
          "relationship": {
            "is_author": false
          },
          "detail": "",
          "question_type": "normal"
        },
        "excerpt": "优点：后脑勺像西瓜",
        "excerpt_new": "优点：后脑勺像西瓜",
        "preview_type": "default",
        "preview_text": "",
        "reshipment_settings": "allowed",
        "content": "<p data-pid=\"6-K_ZplU\">优点：后脑勺像西瓜</p><figure data-size=\"normal\"><img src=\"https://picx.zhimg.com/v2-1bb950f4f38b8c581f419f6bb21cb2d9_1440w.jpg\" data-rawwidth=\"524\" data-rawheight=\"524\" data-size=\"normal\" data-original-token=\"v2-2da540149d10a8bee58c0130ab6b696a\" data-default-watermark-src=\"https://pic4.zhimg.com/v2-8042e485629514b806ddb3e6ed2ac2c9_b.jpg\" class=\"origin_image zh-lightbox-thumb\" width=\"524\" data-original=\"https://picx.zhimg.com/v2-1bb950f4f38b8c581f419f6bb21cb2d9_r.jpg\"/></figure><p class=\"ztext-empty-paragraph\"><br/></p><figure data-size=\"normal\"><img src=\"https://pic1.zhimg.com/v2-f90fe81d3885bf99d4e39ca4f29dccec_1440w.jpg\" data-rawwidth=\"523\" data-rawheight=\"521\" data-size=\"normal\" data-original-token=\"v2-7463806f171a94d576bb3ccd74cfc39f\" data-default-watermark-src=\"https://pic2.zhimg.com/v2-b1749ee56311d68b88f068cc9935d0fd_b.jpg\" class=\"origin_image zh-lightbox-thumb\" width=\"523\" data-original=\"https://pic1.zhimg.com/v2-f90fe81d3885bf99d4e39ca4f29dccec_r.jpg\"/></figure><p class=\"ztext-empty-paragraph\"><br/></p><figure data-size=\"normal\"><img src=\"https://pic2.zhimg.com/v2-f0d385c4090b4e5d8aeed05c81f29ce3_1440w.jpg\" data-rawwidth=\"523\" data-rawheight=\"560\" data-size=\"normal\" data-original-token=\"v2-4d2a2d3d1c3bcdd95deda96aabc55f4d\" data-default-watermark-src=\"https://pica.zhimg.com/v2-e2575b11e6ffec18d195e43c86a89e36_b.jpg\" class=\"origin_image zh-lightbox-thumb\" width=\"523\" data-original=\"https://pic2.zhimg.com/v2-f0d385c4090b4e5d8aeed05c81f29ce3_r.jpg\"/></figure><p class=\"ztext-empty-paragraph\"><br/></p><figure data-size=\"normal\"><img src=\"https://pic2.zhimg.com/v2-ff161dfdab318ec05c9e133beb4ba63d_1440w.jpg\" data-rawwidth=\"522\" data-rawheight=\"526\" data-size=\"normal\" data-original-token=\"v2-470254a1eaa0d8b69b4e9087a47b5e6d\" data-default-watermark-src=\"https://pic2.zhimg.com/v2-a8ca03d46ceaf11ce0e469dfae49b39b_b.jpg\" class=\"origin_image zh-lightbox-thumb\" width=\"522\" data-original=\"https://pic2.zhimg.com/v2-ff161dfdab318ec05c9e133beb4ba63d_r.jpg\"/></figure><p class=\"ztext-empty-paragraph\"><br/></p><figure data-size=\"normal\"><img src=\"https://pic4.zhimg.com/v2-4fed00940c4e5ea22e3a41e416bac275_1440w.jpg\" data-rawwidth=\"523\" data-rawheight=\"522\" data-size=\"normal\" data-original-token=\"v2-73e401e1c50cce301f3cf8fb47588e75\" data-default-watermark-src=\"https://pic4.zhimg.com/v2-84c8d9f112a6b6f1d472b6c3af2a347f_b.jpg\" class=\"origin_image zh-lightbox-thumb\" width=\"523\" data-original=\"https://pic4.zhimg.com/v2-4fed00940c4e5ea22e3a41e416bac275_r.jpg\"/></figure><p class=\"ztext-empty-paragraph\"><br/></p><figure data-size=\"normal\"><img src=\"https://pic2.zhimg.com/v2-ed2b6433e6c708919502a27e8ec8becd_1440w.jpg\" data-rawwidth=\"522\" data-rawheight=\"525\" data-size=\"normal\" data-original-token=\"v2-b6fabeae12e2bc5c13be726af1bd9877\" data-default-watermark-src=\"https://pic2.zhimg.com/v2-39b4a6954e5ac5e3475b4e9cc91ae565_b.jpg\" class=\"origin_image zh-lightbox-thumb\" width=\"522\" data-original=\"https://pic2.zhimg.com/v2-ed2b6433e6c708919502a27e8ec8becd_r.jpg\"/></figure><p></p>",
        "relationship": {
          "is_thanked": false,
          "is_nothelp": false,
          "voting": 0
        },
        "is_labeled": false,
        "visited_count": 1346736,
        "favorite_count": 1755,
        "answer_type": "normal",
        "is_navigator": false,
        "navigator_vote": false,
        "vote_next_step": "vote"
      },
      "brief": "{\"source\": \"TS\", \"type\": \"answer\", \"id\": 2811498443}",
      "attached_info": "Ct4HCPrr7P6UlarMuwEQBBoJNTQxMjY3NjAxIPipj50GKOrFATDvA0DSBEo5ChNUU19TT1VSQ0VfSE9UX0NST1NTEhxob3RfcmVjYWxsXzdkOm5vcm1hbDptb250aGx5GAAgADoAWggxMTk2ODM3OWIgZjA3NWJiMDBjMjlmNGMzMzYyNWE1OWJiMzUxYWUwYTdyCjI4MTE0OTg0NDOKAQg0OTM3OTk5MqoBCXJlY29tbWVuZMIBIGY2YTY5NmI2MzE2ZDU4ZTgxYTg0ZmFmODcwMGI2Mjkw8gEKCAwSBk5vcm1hbPIBKAgKEiRlNDU4Mjc0Yi0yZWU2LTQ4ZmMtOGFkNC0xMDU3ZjAxZTUzOTLyAQcICxIDMTAwggIAiAKloc35jDOSAiBmNmE2OTZiNjMxNmQ1OGU4MWE4NGZhZjg3MDBiNjI5MJoCAMoCFlNob3JJbnRlcmVzdFdlaWdodFJ1bGXKAhVVc2VyTGNuRXhpdFdlaWdodFJ1bGXKAhRDb250ZW50QWdlV2VpZ2h0UnVsZdoCE1RTX1NPVVJDRV9IT1RfQ1JPU1PoAgL6AgtOT1JNQUxfRkxPV4oDIGRlNTlhN2I3NzNmOTQ0ZjZiNDRkMGNkMTU3MjNkYmE4mgMNCgJ2MhAAGgVvdGhlcqgDsJlS2AMA6gMVaG90Q3Jvc3NNZXJnZVJlY2FsbGVy+gO5AhIMVU5LTk9XTl9NT0RFIAAqDU5PX0lNQUdFX01PREU6LQgDEIwEGIwEIiN2Mi0yZGE1NDAxNDlkMTBhOGJlZTU4YzAxMzBhYjZiNjk2YTotCAMQiwQYiQQiI3YyLTc0NjM4MDZmMTcxYTk0ZDU3NmJiM2NjZDc0Y2ZjMzlmOi0IAxCLBBiwBCIjdjItNGQyYTJkM2QxYzNiY2RkOTVkZWRhOTZhYWJjNTVmNGQ6LQgAEIoEGI4EIiN2Mi00NzAyNTRhMWVhYTBkOGI2OWI0ZTkwODdhNDdiNWU2ZDotCAMQiwQYigQiI3YyLTczZTQwMWUxYzUwY2NlMzAxZjNjZjhmYjQ3NTg4ZTc1Oi0IAxCKBBiNBCIjdjItYjZmYWJlYWUxMmUyYmM1YzEzYmU3MjZhZjFiZDk4NzeABACIBACSBAZOb3JtYWyaBAEyoAQAqAQAsAQAugQGbWFudWFswgQDMTYwyAQA0gQP5o6o6I2Q5bey5pu05paw2AQA8AQA+QQAAABALsakP4EFAAAAAAAAAACJBcB4Ju0hVNk/kgUAmgUDZGZ0ogUDZGZ0sgUBMbkFAAAAAAAAAADQBQDgBQDoBQDwBWSQBgCgBtgEqAYBkgIlCgk1NDEyNjc2MDESCjI4MTE0OTg0NDMYBCIKSU1BR0VfVEVYVA==",
      "action_card": false
    },
    {
      "id": "595_1755822903.273",
      "type": "feed",
      "offset": 595,
      "verb": "TOPIC_ACKNOWLEDGED_ARTICLE",
      "created_time": 1755822903,
      "updated_time": 1755822903,
      "target": {
        "id": "1929845374434124267",
        "type": "article",
        "url": "https://api.zhihu.com/articles/1929845374434124267",
        "author": {
          "id": "51d67deb200634cb06f8350f541b11da",
          "url": "https://api.zhihu.com/people/51d67deb200634cb06f8350f541b11da",
          "user_type": "people",
          "url_token": "yshlove-93",
          "name": "物联网心球",
          "headline": "微信公众号：物联网心球",
          "avatar_url": "https://pica.zhimg.com/50/v2-e62091a4e4472127b46d2b18b0e474d0_l.jpg?source=b6762063",
          "is_org": false,
          "gender": 1,
          "followers_count": 686,
          "is_following": false,
          "is_followed": false
        },
        "title": "网络编程之端口复用",
        "image_url": "https://picx.zhimg.com/v2-98fe482a064848bbc1808a2b1f4e075e.jpg?source=7e7ef6e2&needBackground=1",
        "comment_permission": "all",
        "created": 1752891585,
        "updated": 1752891857,
        "voteup_count": 9,
        "voting": 0,
        "comment_count": 0,
        "linkbox": {
          "category": "",
          "pic": "",
          "title": "",
          "url": ""
        },
        "excerpt": "在进行网络编程时，经常会出现“Address already in use”的错误。错误原因是TCP或UDP套接字尝试绑定已被绑定的端口。简单来说，就是两个套接字绑定相同的IP和端口，第二个套接字将无法绑定该IP和端口。 实际情况，两个套接字很大可能是需要绑定相同IP和端口的，比如，TCP套接字关闭时，如果该TCP套接字处于TIME_WAIT状态，将一直霸占该IP和端口，导致新的TCP套接字无法绑定该IP和端口。另外，一些高性能的服务器（Nginx），通过…",
        "excerpt_new": "在进行网络编程时，经常会出现“Address already in use”的错误。错误原因是TCP或UDP套接字尝试绑定已被绑定的端口。简单来说，就是两个套接字绑定相同的IP和端口，第二个套接字将无法绑定该IP和端口。 实际情况，两个套接字很大可能是需要绑定相同IP和端口的，比如，TCP套接字关闭时，如果该TCP套接字处于TIME_WAIT状态，将一直霸占该IP和端口，导致新的TCP套接字无法绑定该IP和端口。另外，一些高性能的服务器（Nginx），通过…",
        "preview_type": "default",
        "preview_text": "",
        "content": "<p data-pid=\"vJq5B7Ya\">    在进行网络编程时，经常会出现“Address already in use”的错误。错误原因是TCP或UDP套接字尝试绑定已被绑定的端口。简单来说，就是两个套接字绑定相同的IP和端口，第二个套接字将无法绑定该IP和端口。</p><p data-pid=\"LCU0eErM\">    实际情况，两个套接字很大可能是需要绑定相同IP和端口的，比如，TCP套接字关闭时，如果该TCP套接字处于TIME_WAIT状态，将一直霸占该IP和端口，导致新的TCP套接字无法绑定该IP和端口。另外，一些高性能的服务器（Nginx），通过多进程监听同一端口提升性能，也需要多个套接字绑定相同的IP和端口。</p><h2>1.SO_REUSEADDR和SO_REUSEPORT选项介绍</h2><p data-pid=\"b88cHzOw\">    SO_REUSEADDR和SO_REUSEPORT是用来实现端口复用的两个套接字选项，按照字面意思理解，SO_REUSEADDR指的是地址复用，SO_REUSEPORT指的是端口复用。学习这两个套接字选项时，我们得纠正一个错误的观念，就是认为二者是两个独立的概念，需要分开来讲解。</p><p data-pid=\"d_11EsPl\">    SO_REUSEADDR和SO_REUSEPORT具有很强的关联性，必须放在一起来讲解。我们的学习目的不是为了区分二者，而是要理解二者是如何影响端口复用的实现逻辑。</p><p data-pid=\"CKb11Izk\">    SO_REUSEADDR和SO_REUSEPORT都是属于SOL_SOCKET级别的套接字选项，设置示例代码如下，注意，这两个套接字选项的设置必须在调用bind函数之前：</p><div class=\"highlight\"><pre><code class=\"language-c\"><span class=\"kt\">int</span> <span class=\"n\">on</span> <span class=\"o\">=</span> <span class=\"mi\">1</span><span class=\"p\">;</span> <span class=\"cm\">/* 1：开启；0：关闭 */</span>\n<span class=\"n\">setsockopt</span><span class=\"p\">(</span><span class=\"n\">sockfd</span><span class=\"p\">,</span> <span class=\"n\">SOL_SOCKET</span><span class=\"p\">,</span> <span class=\"n\">SO_REUSEADDR</span><span class=\"p\">,</span> <span class=\"o\">&amp;</span><span class=\"n\">on</span><span class=\"p\">,</span> <span class=\"k\">sizeof</span><span class=\"p\">(</span><span class=\"n\">on</span><span class=\"p\">));</span>\n<span class=\"kt\">int</span> <span class=\"n\">on1</span> <span class=\"o\">=</span> <span class=\"mi\">1</span><span class=\"p\">;</span> <span class=\"cm\">/* 1：开启；0：关闭 */</span>\n<span class=\"n\">setsockopt</span><span class=\"p\">(</span><span class=\"n\">sockfd</span><span class=\"p\">,</span> <span class=\"n\">SOL_SOCKET</span><span class=\"p\">,</span> <span class=\"n\">SO_REUSEPORT</span><span class=\"p\">,</span> <span class=\"o\">&amp;</span><span class=\"n\">on1</span><span class=\"p\">,</span> <span class=\"k\">sizeof</span><span class=\"p\">(</span><span class=\"n\">on1</span><span class=\"p\">));</span>\n<span class=\"n\">bind</span><span class=\"p\">(......);</span></code></pre></div><p data-pid=\"lQfpBnu-\">    我们来看一下内核实现原理，如图1所示。</p><figure data-size=\"normal\"><img src=\"https://pic4.zhimg.com/v2-6cab2640a98b02d09a6e60f13e5a182f_1440w.jpg\" data-size=\"normal\" data-rawwidth=\"988\" data-rawheight=\"794\" data-original-token=\"v2-6cab2640a98b02d09a6e60f13e5a182f\" class=\"origin_image zh-lightbox-thumb\" width=\"988\" data-original=\"https://pic4.zhimg.com/v2-6cab2640a98b02d09a6e60f13e5a182f_r.jpg\"/><figcaption>图 1 SO_REUSEADDR和SO_REUSEPORT选项内核实现原理</figcaption></figure><p data-pid=\"skVmLfqA\">    SO_REUSEADDR选项对应的是sock对象的sk_reuse成员，SO_REUSEPORT选项对应的是sock对象的sk_reuseport成员。用户程序调用setsockopt函数并传入0或1来设置sk_reuse和sk_reuseport。实现原理非常简单，这里不再赘述。</p><p data-pid=\"HBTiJDHW\">    UDP和TCP端口复用的逻辑存在差异，我们分开来讲解，首先，我们来看一下UDP如何实现端口复用的。</p><p data-pid=\"Nu6enWeP\"><b>往期精品文章推荐：</b></p><p data-pid=\"oJys0oxj\"><a href=\"https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzkyNDIyNzU4Mg%3D%3D%26mid%3D2247485862%26idx%3D1%26sn%3D034d59b71ddf975de7ad36c8ca633eab%26chksm%3Dc1d84b37f6afc221df4206b11c6ba1342141c1a62e09e3d94473b65e12671222dbbd231ca3fe%23rd\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">Linux高性能编程_malloc原理</a></p><p data-pid=\"sTBDrmVa\"><a href=\"https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzkyNDIyNzU4Mg%3D%3D%26mid%3D2247485784%26idx%3D1%26sn%3Da41fe1e49fe6fcc43233a74106377063%26chksm%3Dc1d84bc9f6afc2df4884f1d2711935e8adcfbca42794b2f2507854897ab9bd72be4e453daf9c%23rd\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">Linux高性能编程_Reactor模型</a></p><p data-pid=\"d6S4jXuS\"><a href=\"https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzkyNDIyNzU4Mg%3D%3D%26mid%3D2247485738%26idx%3D1%26sn%3D2c8e3022238261d42039feed84fd52cc%26chksm%3Dc1d84bbbf6afc2adecbfb4ce9ce8187b6cb7ebc631353b38eaafdd3d5cf51338e6df899d24a8%23rd\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">Linux高性能编程_时间轮</a></p><p data-pid=\"q5T4G-_d\"><a href=\"https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzkyNDIyNzU4Mg%3D%3D%26mid%3D2247485690%26idx%3D1%26sn%3D55a7bbce2f631f598e57c5c3bb9ee2c9%26chksm%3Dc1d84a6bf6afc37dd32d1ca81d2e68556c64d1c34051f62d660131e0ab694fcbb81ef7cc0104%23rd\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">Linux高性能编程_协程</a></p><p data-pid=\"nqrtrQYG\"><a href=\"https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzkyNDIyNzU4Mg%3D%3D%26mid%3D2247485660%26idx%3D1%26sn%3D6150f8f55128931081746cbb43ca1ae5%26chksm%3Dc1d84a4df6afc35b353fb9d9571280cf5d41f69b3c45799f08a5068b12d09e53474524c243fc%23rd\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">Linux高性能编程_无锁队列</a></p><h2>2.UDP绑定相同IP和端口</h2><p data-pid=\"MiHZIrAC\">    UDP绑定相同IP和端口的内核实现原理如图2所示。</p><figure data-size=\"normal\"><img src=\"https://pic1.zhimg.com/v2-06375e1284db88ff892842cd8666b84a_1440w.jpg\" data-size=\"normal\" data-rawwidth=\"1080\" data-rawheight=\"806\" data-original-token=\"v2-06375e1284db88ff892842cd8666b84a\" class=\"origin_image zh-lightbox-thumb\" width=\"1080\" data-original=\"https://pic1.zhimg.com/v2-06375e1284db88ff892842cd8666b84a_r.jpg\"/><figcaption>图 2 绑定相同IP和端口</figcaption></figure><p data-pid=\"UqtYdJub\">    Linux内核维护了一个UDP端口号哈希表，该表记录了每个UDP端口号都被哪些套接字绑定了。UDP是否能绑定该IP和端口号，得看哈希表中端口号链表中是否存在与之冲突的套接字。何谓冲突呢？即链表中某个套接字和新套接字的sk_reuse不都为1，且二者sk_reuseport不都为1。</p><p data-pid=\"TSvBvKWl\">    我们做一个形象的比喻，端口号链表中的套接字就像一些既得利益者，牢牢占据者端口号资源，新套接字想要加入它们的阵营，需要得到所有既得利益者的支持，只要有一个套接字不支持，那么新套接字将无法加入链表。不支持的条件就是二者sk_reuse不都为1，且二者sk_port不都为1。</p><p data-pid=\"vuV3cuA_\">    我们将新套接字是否能绑定相同的IP和端口进行了整理，见表1，注意，新套接字需要和链表中所有的套接字都按照表1进行比较，全部通过后才能绑定成功，新套接字才能加入链表。</p><figure data-size=\"normal\"><img src=\"https://pic3.zhimg.com/v2-318e857457817db98089ef69fdba6a2a_1440w.jpg\" data-size=\"normal\" data-rawwidth=\"668\" data-rawheight=\"117\" data-original-token=\"v2-318e857457817db98089ef69fdba6a2a\" class=\"origin_image zh-lightbox-thumb\" width=\"668\" data-original=\"https://pic3.zhimg.com/v2-318e857457817db98089ef69fdba6a2a_r.jpg\"/><figcaption>表 1 UDP套接字端口复用条件</figcaption></figure><p data-pid=\"SWtRLMHv\">    默认情况，首个套接字的sk_reuse和sk_reuseport都为0，没有开启端口复用，后续所有的套接字不管sk_reuse和sk_useport为多少，都无法绑定相同的IP和端口。</p><p data-pid=\"Jnf6D6Z1\">    当首个套接字设置了sk_reuse和sk_reuseport后，后续套接字只需要按照表1去设置置sk_reuse和sk_reuseport，就能绑定成功。</p><p data-pid=\"MkLRV-vV\">    我们来看一下内核源码，验证上述逻辑，内核源码中有一个udp_lib_lport_inuse函数，用来判断新的UDP套接字是否能够绑定该IP和端口，非关键代码已经省略，源码如下:</p><div class=\"highlight\"><pre><code class=\"language-c\"><span class=\"cm\">/*\n</span><span class=\"cm\">UDP套接字是否可以绑定相同IP和端口判断。\n</span><span class=\"cm\">返回0：可以绑定；返回1：不可以绑定\n</span><span class=\"cm\">*/</span>\n<span class=\"n\">staticintudp_lib_lport_inuse</span><span class=\"p\">(</span><span class=\"k\">struct</span> <span class=\"n\">net</span> <span class=\"o\">*</span><span class=\"n\">net</span><span class=\"p\">,</span> <span class=\"n\">__u16</span> <span class=\"n\">num</span><span class=\"p\">,</span>\n<span class=\"k\">const</span> <span class=\"k\">struct</span> <span class=\"n\">udp_hslot</span> <span class=\"o\">*</span><span class=\"n\">hslot</span><span class=\"p\">,</span>\n<span class=\"n\">unsignedlong</span> <span class=\"o\">*</span><span class=\"n\">bitmap</span><span class=\"p\">,</span>\n<span class=\"k\">struct</span> <span class=\"n\">sock</span> <span class=\"o\">*</span><span class=\"n\">sk</span><span class=\"p\">,</span> <span class=\"n\">unsignedintlog</span><span class=\"p\">)</span>\n<span class=\"p\">{</span>\n    <span class=\"n\">structsock</span> <span class=\"o\">*</span><span class=\"n\">sk2</span><span class=\"p\">;</span>\n    <span class=\"n\">sk_for_each</span><span class=\"p\">(</span><span class=\"n\">sk2</span><span class=\"p\">,</span> <span class=\"o\">&amp;</span><span class=\"n\">hslot</span><span class=\"o\">-&gt;</span><span class=\"n\">head</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n        <span class=\"cm\">/* 两个套接字的sk_reuse有一个为0且IP地址相同，条件为真 */</span>\n        <span class=\"k\">if</span> <span class=\"p\">((</span><span class=\"o\">!</span><span class=\"n\">sk2</span><span class=\"o\">-&gt;</span><span class=\"n\">sk_reuse</span> <span class=\"o\">||</span> <span class=\"o\">!</span><span class=\"n\">sk</span><span class=\"o\">-&gt;</span><span class=\"n\">sk_reuse</span><span class=\"p\">)</span> <span class=\"o\">&amp;&amp;</span> \n            <span class=\"n\">inet_rcv_saddr_equal</span><span class=\"p\">(</span><span class=\"n\">sk</span><span class=\"p\">,</span> <span class=\"n\">sk2</span><span class=\"p\">,</span> <span class=\"nb\">true</span><span class=\"p\">))</span> <span class=\"p\">{</span>\n            <span class=\"cm\">/* 两个套接字的sk_reuse都为1，条件为真，可以绑定 */</span>\n            <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"n\">sk2</span><span class=\"o\">-&gt;</span><span class=\"n\">sk_reuseport</span> <span class=\"o\">&amp;&amp;</span> <span class=\"n\">sk</span><span class=\"o\">-&gt;</span><span class=\"n\">sk_reuseport</span> <span class=\"p\">)</span> <span class=\"p\">{</span>\n                <span class=\"n\">return0</span><span class=\"p\">;</span>\n            <span class=\"cm\">/* 条件为假，不可以绑定 */</span>\n            <span class=\"p\">}</span> <span class=\"k\">else</span> <span class=\"p\">{</span>\n                <span class=\"n\">return1</span><span class=\"p\">;</span>\n            <span class=\"p\">}</span>\n        <span class=\"p\">}</span>\n    <span class=\"p\">}</span>\n    <span class=\"n\">return0</span><span class=\"p\">;</span>\n<span class=\"p\">}</span></code></pre></div><p data-pid=\"qmPQpSUM\">至此，UDP套接字绑定相同IP和端口的知识点已经讲解完，大家认真学完上述知识点，就能轻松让你UDP套接字绑定相同的IP和端口了。</p><p data-pid=\"RC_j5rXc\">    前面章节在介绍TCP和UDP套接字调用bind函数绑定源地址时，提到了一个特殊的IP地址INADDR_ANY（0x00000000），INADDR_ANY是绑定本机本机所有IP的意思。那么一个套接字绑定INADDR_ANY和端口，另外一个套接字绑定具体IP和端口，二者之间是否需要符合端口复用逻辑呢？答案是，内核在做端口冲突检测时，会把INADDR_ANY看做是一个具体IP地址，检测逻辑和具体IP一样，这里不需要把INADDR_ANY特殊化。</p><h2>3.UDP由谁接收数据？</h2><p data-pid=\"ZR8rX40t\">    多个UDP套接字绑定了相同IP和端口后，当有数据到来时，该由谁来接收数据呢？我们先不着急回答这个问题，我们先来看UDP接收数据部分的内核实现原理，如图3所示。</p><figure data-size=\"normal\"><img src=\"https://pic1.zhimg.com/v2-56e3273466482d6f57d1e13473190918_1440w.jpg\" data-size=\"normal\" data-rawwidth=\"1080\" data-rawheight=\"1027\" data-original-token=\"v2-56e3273466482d6f57d1e13473190918\" class=\"origin_image zh-lightbox-thumb\" width=\"1080\" data-original=\"https://pic1.zhimg.com/v2-56e3273466482d6f57d1e13473190918_r.jpg\"/><figcaption>图 3 多个UDP套接字接收数据内核实现原理</figcaption></figure><p data-pid=\"aI25LJEF\">    当一个UDP数据报从网卡接收至内核网络协议栈时，需要根据UDP数据报的目的IP和目的端口匹配UDP套接字，再将UDP数据报存储至UDP套接字接收缓冲区。开启端口复用后，多个UDP套接字会绑定相同的IP和端口，这些套接字都能够接收数据，但最终只能由一个套接字来接收数据。</p><p data-pid=\"y-crWvKs\">    内核通过积分制来选择最终的套接字，套接字绑定的源IP和源端口和UDP数据报的目的IP和目的端口相同是入围条件，注意，这里先不讨论特殊IP地址INADDR_ANY。然后，以下情况分别会有对应的积分：</p><ul><li data-pid=\"lgrVO38j\">目的IP匹配加4分：套接字绑定的目的IP和UDP数据报的源IP匹配。</li><li data-pid=\"_WGv5MOl\">目的端口匹配加4分：套接字绑定的目的端口和UDP数据报的源端口匹配。</li><li data-pid=\"FTSubKlO\">网络接口相同加4分：套接字绑定的网络接口和UDP数据包接收的网络接口相同。</li><li data-pid=\"ArVFGasl\">CPU缓存命中加1分：套接字上次接收数据时被调度的CPU和本次被调度的CPU相同。</li></ul><p data-pid=\"i0lXAdXl\">    最后，最高分的套接字将被选中来接收数据。值得注意的是，UDP套接字如果不通过connect绑定目的IP和目的端口，将无法获取到前两种情况的积分，如果另外一个套接字调绑定了目的IP和目的端口，那么它的积分会一直高于前者，将一直由它来接收数据。所以UDP套接字一旦调用connect函数绑定了目的IP和目的端口，就能优先接收数据，这也是前面节中实现自定义UDP accept函数的基础。</p><p data-pid=\"xwJB2zjs\">    选择由哪个套接字接收数据不是固定的。影响套接字积分有很多条件， 有一些条件是动态变化的，内核会根据套接字积分的变换，动态地将数据导入不同的套接字，这样就实现了负载均衡。用户程序启动多个线程或进程来监听相同的IP和端口，多个线程的处理效率会高于单个线程或进程。</p><p data-pid=\"-rEQuK_C\">    前面我们提到过特殊的IP地址INADDR_ANY，如果两个UDP套接字分别绑定了INADDR_ANY和具体IP，接收数据时，该如何匹配套接字呢？答案是具体IP的优先级高于INADDR_ANY，只有具体IP匹配失败后，才会去匹配INADDR_ANY。INADDR_ANY不会和具体IP放在一起去比分，二者是单独进行比分的，先比较具体IP，再比较INADDR_ANY。</p><p data-pid=\"l3RPcTbK\">    我们来看一下内核源码，如下。</p><div class=\"highlight\"><pre><code class=\"language-c\"><span class=\"cm\">/*\n</span><span class=\"cm\">    UDP套接字匹配函数\n</span><span class=\"cm\">*/</span>\n<span class=\"k\">struct</span> <span class=\"n\">sock</span> <span class=\"o\">*</span><span class=\"nf\">__udp4_lib_lookup</span><span class=\"p\">(</span><span class=\"k\">struct</span> <span class=\"n\">net</span> <span class=\"o\">*</span><span class=\"n\">net</span><span class=\"p\">,</span> <span class=\"n\">__be32</span> <span class=\"n\">saddr</span><span class=\"p\">,</span>\n<span class=\"n\">__be16</span> <span class=\"n\">sport</span><span class=\"p\">,</span> <span class=\"n\">__be32</span> <span class=\"n\">daddr</span><span class=\"p\">,</span> <span class=\"n\">__be16</span> <span class=\"n\">dport</span><span class=\"p\">,</span> <span class=\"kt\">int</span> <span class=\"n\">dif</span><span class=\"p\">,</span>\n<span class=\"kt\">int</span> <span class=\"n\">sdif</span><span class=\"p\">,</span> <span class=\"k\">struct</span> <span class=\"n\">udp_table</span> <span class=\"o\">*</span><span class=\"n\">udptable</span><span class=\"p\">,</span> <span class=\"k\">struct</span> <span class=\"n\">sk_buff</span> <span class=\"o\">*</span><span class=\"n\">skb</span><span class=\"p\">)</span>\n<span class=\"p\">{</span>\n    <span class=\"p\">......</span>\n    <span class=\"n\">hash2</span> <span class=\"o\">=</span> <span class=\"n\">ipv4_portaddr_hash</span><span class=\"p\">(</span><span class=\"n\">net</span><span class=\"p\">,</span> <span class=\"n\">daddr</span><span class=\"p\">,</span> <span class=\"n\">hnum</span><span class=\"p\">);</span>\n    <span class=\"n\">slot2</span> <span class=\"o\">=</span> <span class=\"n\">hash2</span> <span class=\"o\">&amp;</span> <span class=\"n\">udptable</span><span class=\"o\">-&gt;</span><span class=\"n\">mask</span><span class=\"p\">;</span>\n    <span class=\"n\">hslot2</span> <span class=\"o\">=</span> <span class=\"o\">&amp;</span><span class=\"n\">udptable</span><span class=\"o\">-&gt;</span><span class=\"n\">hash2</span><span class=\"p\">[</span><span class=\"n\">slot2</span><span class=\"p\">];</span>\n\n    <span class=\"cm\">/* 具体IP进行比分 */</span>\n    <span class=\"n\">result</span> <span class=\"o\">=</span> <span class=\"n\">udp4_lib_lookup2</span><span class=\"p\">(</span><span class=\"n\">net</span><span class=\"p\">,</span><span class=\"n\">saddr</span><span class=\"p\">,</span><span class=\"n\">sport</span><span class=\"p\">,</span><span class=\"n\">daddr</span><span class=\"p\">,</span><span class=\"n\">hnum</span><span class=\"p\">,</span> \n                              <span class=\"n\">dif</span><span class=\"p\">,</span><span class=\"n\">sdif</span><span class=\"p\">,</span><span class=\"n\">hslot2</span><span class=\"p\">,</span><span class=\"n\">skb</span><span class=\"p\">);</span>\n\n    <span class=\"cm\">/* 具体IP匹配成功，且套接字绑定了目的地址，跳转至done*/</span>\n    <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"o\">!</span><span class=\"n\">IS_ERR_OR_NULL</span><span class=\"p\">(</span><span class=\"n\">result</span><span class=\"p\">)</span> <span class=\"o\">&amp;&amp;</span> <span class=\"n\">result</span><span class=\"o\">-&gt;</span><span class=\"n\">sk_state</span> <span class=\"o\">==</span> \n        <span class=\"n\">TCP_ESTABLISHED</span><span class=\"p\">)</span>\n        <span class=\"k\">goto</span> <span class=\"n\">done</span><span class=\"p\">;</span>\n\n    <span class=\"cm\">/* 具体IP匹配成功，跳转至done */</span>\n    <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"n\">result</span><span class=\"p\">)</span>\n        <span class=\"k\">goto</span> <span class=\"n\">done</span><span class=\"p\">;</span>\n\n    <span class=\"n\">hash2</span> <span class=\"o\">=</span> <span class=\"n\">ipv4_portaddr_hash</span><span class=\"p\">(</span><span class=\"n\">net</span><span class=\"p\">,</span> <span class=\"n\">htonl</span><span class=\"p\">(</span><span class=\"n\">INADDR_ANY</span><span class=\"p\">),</span> <span class=\"n\">hnum</span><span class=\"p\">);</span>\n    <span class=\"n\">slot2</span> <span class=\"o\">=</span> <span class=\"n\">hash2</span> <span class=\"o\">&amp;</span> <span class=\"n\">udptable</span><span class=\"o\">-&gt;</span><span class=\"n\">mask</span><span class=\"p\">;</span>\n    <span class=\"n\">hslot2</span> <span class=\"o\">=</span> <span class=\"o\">&amp;</span><span class=\"n\">udptable</span><span class=\"o\">-&gt;</span><span class=\"n\">hash2</span><span class=\"p\">[</span><span class=\"n\">slot2</span><span class=\"p\">];</span>\n\n    <span class=\"cm\">/* INADDR_ANY进行比分 */</span>\n    <span class=\"n\">result</span> <span class=\"o\">=</span> <span class=\"n\">udp4_lib_lookup2</span><span class=\"p\">(</span><span class=\"n\">net</span><span class=\"p\">,</span> <span class=\"n\">saddr</span><span class=\"p\">,</span> <span class=\"n\">sport</span><span class=\"p\">,</span>\n    <span class=\"n\">htonl</span><span class=\"p\">(</span><span class=\"n\">INADDR_ANY</span><span class=\"p\">),</span> <span class=\"n\">hnum</span><span class=\"p\">,</span> <span class=\"n\">dif</span><span class=\"p\">,</span> <span class=\"n\">sdif</span><span class=\"p\">,</span> <span class=\"n\">hslot2</span><span class=\"p\">,</span> <span class=\"n\">skb</span><span class=\"p\">);</span>\n\n<span class=\"nl\">done</span><span class=\"p\">:</span>\n    <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"n\">IS_ERR</span><span class=\"p\">(</span><span class=\"n\">result</span><span class=\"p\">))</span>\n         <span class=\"n\">returnNULL</span><span class=\"p\">;</span>\n    <span class=\"k\">return</span> <span class=\"n\">result</span><span class=\"p\">;</span>\n<span class=\"p\">}</span></code></pre></div><p data-pid=\"g7szDdWz\">   TCP绑定相同IP和端口的逻辑和UDP基本相同，我们可以参考图9-6来理解。新TCP套接字要绑定相同IP和端口同样需要和端口号链表中的套接字一一进行比较，只要和其中一个套接字有冲突，那么就无法绑定成功。TCP判断两个套接字是否有冲突和UDP有差异，可以总结为：两个套接字的sk_reuseport不都为1，则表示二者冲突。不管两个套接字的sk_reuse为多少，我们只要对sk_reuseport进行判断即可。</p><p data-pid=\"EyfU1pD0\">    INADDR_ANY的判断和UDP基本相同，这里不再赘述。</p><h2>5.TCP由谁接收数据？</h2><p data-pid=\"hVsex5zF\">    TCP是面相连接的协议，由谁来接收数据其实很简单，只有建立连接的两个套接字才能交互数据。但是，建立连接的过程，则需要匹配套接字。比如，两个TCP服务端程序绑定相同的IP和端口，三次握手环节，客户端的连接请求需要匹配正确的套接字处理。</p><p data-pid=\"-tkTHUVw\">    如图4所示，当一个TCP数据段通过网卡接收至内核时，内核会优先去查询established哈希表（存储已建立连接的套接字），如果在该哈希表中查找到匹配的套接字（四元组相同），那么将由该套接字来接收数据。需要注意的是，从established哈希表中只会查找到一个匹配的套接字，因为一个套接字不能和多个套接字同时建立连接。</p><figure data-size=\"normal\"><img src=\"https://pic4.zhimg.com/v2-a426eef3386b8de2dfec2c9f472a4af9_1440w.jpg\" data-size=\"normal\" data-rawwidth=\"1080\" data-rawheight=\"1045\" data-original-token=\"v2-a426eef3386b8de2dfec2c9f472a4af9\" class=\"origin_image zh-lightbox-thumb\" width=\"1080\" data-original=\"https://pic4.zhimg.com/v2-a426eef3386b8de2dfec2c9f472a4af9_r.jpg\"/><figcaption>图 4 多个TCP套接字接收数据内核实现原理</figcaption></figure><p data-pid=\"Wh43KewA\">    如果查询established哈希表失败，那么接下来会去查询listen哈希表。服务端程序调用listen函数，会将TCP套接字插入listen哈希表。 TCP服务端如果开启端口复用，那么listen哈希表中将有多个套接字和TCP数据报四元组匹配。</p><p data-pid=\"cVvs5Se3\">    那么，该由谁来接收数据呢？TCP同样采用积分制来决定由谁接收数据，TCP的积分制非常简单，只有一个加分条件：CPU缓存命中加1分。积分最高的TCP套接字将来处理此次TCP连接请求，并和客户端完成三次握手。三次握手成功后，会创建一个新的TCP套接字（已建立连接）插入TCP established哈希表。</p><p data-pid=\"ERaOsKqz\"><b>总结：</b><br/><b>感谢阅读，欢迎点赞，评论，转发。有任何问题和建议请联系博主。</b></p><p data-pid=\"d9qnp81k\"><b>原文链接：</b><a href=\"https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s/QbcceFIm8mTv-b5WHuQVSw\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">网络编程之端口复用</a></p>",
        "is_labeled": false,
        "visited_count": 576,
        "thumbnails": [
          "https://picx.zhimg.com/v2-98fe482a064848bbc1808a2b1f4e075e.jpg?source=7e7ef6e2&needBackground=1",
          "https://pic1.zhimg.com/50/v2-04d386154e04fa1cfba424b57c17f238_720w.jpg?source=b6762063",
          "https://picx.zhimg.com/50/v2-6d6076ee44ffd1e9bcb8c35ac84c6b96_720w.jpg?source=b6762063",
          "https://picx.zhimg.com/50/v2-d41850f2a33355bc4f485dad8bd3185f_720w.jpg?source=b6762063",
          "https://picx.zhimg.com/50/v2-d9f89f2fb359c991a06a35eac62e80cf_720w.jpg?source=b6762063",
          "https://picx.zhimg.com/50/v2-228e9698f4ad37fbd73179a2106dea69_720w.jpg?source=b6762063"
        ],
        "favorite_count": 52,
        "article_type": "normal",
        "is_navigator": false,
        "navigator_vote": false,
        "vote_next_step": "vote"
      },
      "brief": "{\"source\": \"TS\", \"type\": \"article\", \"id\": 1929845374434124267}",
      "attached_info": "Cs4ICPrr7P6UlarMuwEQBxoJMjYwNTUyODUzIMGB7MMGKAkwAEDTBEpCCi1UU19TT1VSQ0VfVFdPVE9XRVJfTVVMVElfU0NFTkVfVjFfUkVDQUxMX1RFWFQSATAYACAAOgp7InJhdyI6IiJ9YiBmMDc1YmIwMGMyOWY0YzMzNjI1YTU5YmIzNTFhZTBhN3ITMTkyOTg0NTM3NDQzNDEyNDI2N4IBX2h0dHBzOi8vcGljeC56aGltZy5jb20vdjItOThmZTQ4MmEwNjQ4NDhiYmMxODA4YTJiMWY0ZTA3NWUuanBnP3NvdXJjZT03ZTdlZjZlMiZuZWVkQmFja2dyb3VuZD0xqgEJcmVjb21tZW5kwgEgNTFkNjdkZWIyMDA2MzRjYjA2ZjgzNTBmNTQxYjExZGHyAQoIDBIGTm9ybWFs8gEoCAoSJDM2YzUzMmJiLTAyNGQtNGJlZS04MTc1LWU1ZmM4ZDg2Mjc1OPIBBwgLEgMxMDCCAgCIAqahzfmMM5ICIDUxZDY3ZGViMjAwNjM0Y2IwNmY4MzUwZjU0MWIxMWRhmgIAygIWU2hvckludGVyZXN0V2VpZ2h0UnVsZcoCFVVzZXJMY25FeGl0V2VpZ2h0UnVsZcoCFENvbnRlbnRBZ2VXZWlnaHRSdWxl2gItVFNfU09VUkNFX1RXT1RPV0VSX01VTFRJX1NDRU5FX1YxX1JFQ0FMTF9URVhU6AID+gILTk9STUFMX0ZMT1eKAyBkZTU5YTdiNzczZjk0NGY2YjQ0ZDBjZDE1NzIzZGJhOJoDDQoCdjIQABoFb3RoZXKoA8AE2AMA6gMVdGV4dEZlZWRUd29Ub3dlclYxQWxs+gO4AhIMVU5LTk9XTl9NT0RFIAAqDU5PX0lNQUdFX01PREU6LQgEENwHGJoGIiN2Mi02Y2FiMjY0MGE5OGIwMmQwOWE2ZTYwZjEzZTVhMTgyZjotCAIQuAgYpgYiI3YyLTA2Mzc1ZTEyODRkYjg4ZmY4OTI4NDJjZDg2NjZiODRhOiwIAhCcBRh1IiN2Mi0zMThlODU3NDU3ODE3ZGI5ODA4OWVmNjlmZGJhNmEyYTotCAIQuAgYgwgiI3YyLTU2ZTMyNzM0NjY0ODJkNmY1N2QxZTEzNDczMTkwOTE4Oi0IAhC4CBiVCCIjdjItYTQyNmVlZjMzODZiOGRlMmRmZWMyYzlmNDcyYTRhZjk6LQgCELgIGIMIIiN2Mi05OGZlNDgyYTA2NDg0OGJiYzE4MDhhMmIxZjRlMDc1ZYAEAIgEAJIEBk5vcm1hbJoEATOgBACoBACwBAC6BAJhacIEAzQwMMgEANIED+aOqOiNkOW3suabtOaWsNgEAPAEAPkEAAAAwOEOkD+BBQAAAAAAAAAAiQXAeCbtIVTZP5IFAJoFA2RmdKIFA2RmdLIFATG5BQAAAAAAAAAA0AUA4AUA6AUA8AVkkAYAoAbZBKgGA5ICLgoJMjYwNTUyODUzEhMxOTI5ODQ1Mzc0NDM0MTI0MjY3GAciCklNQUdFX1RFWFQ=",
      "action_card": false
    },
    {
      "id": "596_1755822903.837",
      "type": "feed",
      "offset": 596,
      "verb": "TOPIC_ACKNOWLEDGED_ANSWER",
      "created_time": 1755822903,
      "updated_time": 1755822903,
      "target": {
        "id": "1942006480569111595",
        "type": "answer",
        "url": "https://api.zhihu.com/answers/1942006480569111595",
        "author": {
          "id": "53d6ded5682a976ce165ab4738d0068a",
          "url": "https://api.zhihu.com/people/53d6ded5682a976ce165ab4738d0068a",
          "user_type": "people",
          "url_token": "ting-zhong-wei-mian-ke",
          "name": "幽州大肚肚",
          "headline": "同名公粽号“幽州大肚肚”，欢迎关注",
          "avatar_url": "https://pica.zhimg.com/50/v2-94bf707ed7f7170c20b26503c974ef02_l.jpg?source=b6762063",
          "is_org": false,
          "gender": 1,
          "badge": [
            {
              "type": "best_answerer",
              "description": "科研话题下的优秀答主",
              "topic_names": [
                "科研"
              ],
              "topic_ids": [
                2232
              ]
            }
          ],
          "followers_count": 43798,
          "is_following": false,
          "is_followed": false
        },
        "created_time": 1755790425,
        "updated_time": 1755790425,
        "voteup_count": 14,
        "thanks_count": 1,
        "comment_count": 0,
        "is_copyable": true,
        "question": {
          "id": "1941827528743413431",
          "type": "question",
          "url": "https://api.zhihu.com/questions/1941827528743413431",
          "author": {
            "id": "76f8efb0f51f43e27588e4305b6e6a3c",
            "url": "https://api.zhihu.com/people/76f8efb0f51f43e27588e4305b6e6a3c",
            "user_type": "people",
            "url_token": "sunqian-15",
            "name": "小花",
            "headline": "头脑是心脏的延伸。",
            "avatar_url": "https://picx.zhimg.com/50/v2-e85961c395aac694a61199c57c72ef37_l.jpg?source=b6762063",
            "is_org": false,
            "gender": -1,
            "followers_count": 141,
            "is_following": false,
            "is_followed": false
          },
          "title": "如果书包里只能放一本课外书，你会带哪本「精神储备粮」？",
          "created": 1755747760,
          "answer_count": 0,
          "follower_count": 0,
          "comment_count": 0,
          "bound_topic_ids": [
            113,
            7677,
            1315638,
            3183003,
            4068242
          ],
          "is_following": false,
          "excerpt": "",
          "relationship": {
            "is_author": false
          },
          "detail": "",
          "question_type": "normal"
        },
        "excerpt": "我的手边书经常换。 最近经常翻的是《大明王朝1566》。其实，这部电视剧我已经看了不知道多少遍了，这本书也看了10遍以上，光读书笔记就有几十页。 为什么最近又拿出来看呢？ 在职场摸爬滚打了三年有余，发现周围阿谀奉承、阴险狡诈之徒如过江之鲫，为了蜗角虚名蝇头微利而无所不用其极，自己还是像个大学生一样有些单纯。 恰好《大明王朝1566》这本书，讲了大量的帝王心术与官场痼疾，从某种角度，这洽洽也是一份职场生存指南，…",
        "excerpt_new": "我的手边书经常换。 最近经常翻的是《大明王朝1566》。其实，这部电视剧我已经看了不知道多少遍了，这本书也看了10遍以上，光读书笔记就有几十页。 为什么最近又拿出来看呢？ 在职场摸爬滚打了三年有余，发现周围阿谀奉承、阴险狡诈之徒如过江之鲫，为了蜗角虚名蝇头微利而无所不用其极，自己还是像个大学生一样有些单纯。 恰好《大明王朝1566》这本书，讲了大量的帝王心术与官场痼疾，从某种角度，这洽洽也是一份职场生存指南，…",
        "preview_type": "default",
        "preview_text": "",
        "reshipment_settings": "allowed",
        "content": "<p data-pid=\"wdykGydK\">我的手边书经常换。</p><p data-pid=\"AimFH_Q2\">最近经常翻的是《大明王朝1566》。其实，这部电视剧我已经看了不知道多少遍了，这本书也看了10遍以上，光读书笔记就有几十页。</p><p data-pid=\"-AFgu7SM\">为什么最近又拿出来看呢？</p><p data-pid=\"9lP3y6Dk\">在职场摸爬滚打了三年有余，发现周围阿谀奉承、阴险狡诈之徒如过江之鲫，为了蜗角虚名蝇头微利而无所不用其极，自己还是像个大学生一样有些单纯。</p><p data-pid=\"_yNydoO3\">恰好《大明王朝1566》这本书，讲了大量的帝王心术与官场痼疾，从某种角度，这洽洽也是一份职场生存指南，越琢磨越有味道。</p><p data-pid=\"ybdxQDuB\">比如哈，我发现大老板经常说车轱辘话，让下面的人去揣测，去争抢，这种事在大明王朝中亦有记载：</p><blockquote data-pid=\"-NPZcEvW\">万稳万当，不如一默。任何一句话，你不说出来便是那句话的主人，你说了出来，便是那句话的奴隶。</blockquote><p data-pid=\"vUJ5kipY\">这就叫做太极政治：</p><blockquote data-pid=\"paZ2znSX\">太极政治的真谛，政不由己出，都交给下面的人去办，去争，做对了，他便认可，做错了，责任永远事下面的。</blockquote><p data-pid=\"JOKRLpsy\">连不怎么表态都说的很清楚：</p><blockquote data-pid=\"RYdyhxaz\">表态是不要本钱的，出主意日后可要担干系。</blockquote><p data-pid=\"tXZIwFw5\">当然还有一些看起来不起眼但真追究的话往往能放翻一船人的事，如果你能在恰当的节点装作不经意地在大领导面前提起来，说不定能达到自己不可告人的目标：</p><blockquote data-pid=\"GEe7gkD1\">有些事不上称没有四两，上了称一千斤也打不住。</blockquote><p data-pid=\"16DiG_XJ\">总之，这本书堪称职场圣经，菜鸡时时勤拂拭，必然开卷有益。</p>",
        "relationship": {
          "is_thanked": false,
          "is_nothelp": false,
          "voting": 0
        },
        "is_labeled": false,
        "visited_count": 198,
        "favorite_count": 1,
        "answer_type": "normal",
        "is_navigator": false,
        "navigator_vote": false,
        "vote_next_step": "vote"
      },
      "brief": "{\"source\": \"TS\", \"type\": \"answer\", \"id\": 1942006480569111595}",
      "attached_info": "CtgFCPrr7P6UlarMuwEQBBoJNzQzMzQxNTgzINn4nMUGKA4wAEDUBEo6CilUU19TT1VSQ0VfRklSU1RfREVHUkVFX1NPQ0lBTF9VU0VSX0FDVElPThIHMTgwNzkzMRgAIAA6AFoJMTE2MjkyMjMwYiBmMDc1YmIwMGMyOWY0YzMzNjI1YTU5YmIzNTFhZTBhN3ITMTk0MjAwNjQ4MDU2OTExMTU5NYoBEzE5NDE4Mjc1Mjg3NDM0MTM0MzGqAQlyZWNvbW1lbmTCASA1M2Q2ZGVkNTY4MmE5NzZjZTE2NWFiNDczOGQwMDY4YfIBCggMEgZOb3JtYWzyASgIChIkOWRjYzRjODUtN2YwOS00NWQ5LWEzNGEtN2Y5ZTM0ZGEwZWM28gEHCAsSAzEwMIICAIgCpqHN+YwzkgIgNTNkNmRlZDU2ODJhOTc2Y2UxNjVhYjQ3MzhkMDA2OGGaAgDKAhZTaG9ySW50ZXJlc3RXZWlnaHRSdWxlygIVVXNlckxjbkV4aXRXZWlnaHRSdWxl2gIpVFNfU09VUkNFX0ZJUlNUX0RFR1JFRV9TT0NJQUxfVVNFUl9BQ1RJT07oAgT6AgtOT1JNQUxfRkxPV4oDIGRlNTlhN2I3NzNmOTQ0ZjZiNDRkMGNkMTU3MjNkYmE4mgMNCgJ2MhAAGgVvdGhlcqgDxgHYAwDqAx1maXJzdERlZ3JlZVVzZXJBY3Rpb25SZWNhbGxlcvoDHxIMVU5LTk9XTl9NT0RFIAAqDU5PX0lNQUdFX01PREWABACIBACSBAZOb3JtYWyaBAE0oAQAqAQAsAQAugQCYWnCBAM0MDDIBADSBA/mjqjojZDlt7Lmm7TmlrDYBADwBAD5BAAAAKCX/6E/gQUAAAAAAAAAAIkFwHgm7SFU2T+SBQCaBQNkZnSiBQNkZnSyBQExuQUAAAAAAAAAANAFAOAFAOgFAPAFZJAGAKAG2gSoBgCSAi4KCTc0MzM0MTU4MxITMTk0MjAwNjQ4MDU2OTExMTU5NRgEIgpJTUFHRV9URVhU",
      "action_card": false
    },
    {
      "id": "597_1755822903.528",
      "type": "feed",
      "offset": 597,
      "verb": "TOPIC_ACKNOWLEDGED_ANSWER",
      "created_time": 1755822903,
      "updated_time": 1755822903,
      "target": {
        "id": "3573508068",
        "type": "answer",
        "url": "https://api.zhihu.com/answers/3573508068",
        "author": {
          "id": "e50450aaaf85efe0f61fc64c88aac8e1",
          "url": "https://api.zhihu.com/people/e50450aaaf85efe0f61fc64c88aac8e1",
          "user_type": "people",
          "url_token": "USHERYEH",
          "name": "Jasper Yeh",
          "headline": "信缘",
          "avatar_url": "https://picx.zhimg.com/50/v2-a5852ae8bb2129ad1f3b64ab39a9899b_l.jpg?source=b6762063",
          "is_org": false,
          "gender": -1,
          "followers_count": 167,
          "is_following": false,
          "is_followed": false
        },
        "created_time": 1721912780,
        "updated_time": 1754447625,
        "voteup_count": 499,
        "thanks_count": 40,
        "comment_count": 39,
        "is_copyable": true,
        "question": {
          "id": "359404780",
          "type": "question",
          "url": "https://api.zhihu.com/questions/359404780",
          "author": {
            "id": "610226c18770a168edcdd4c9d6faee0b",
            "url": "https://api.zhihu.com/people/610226c18770a168edcdd4c9d6faee0b",
            "user_type": "people",
            "url_token": "floatisca",
            "name": "Firenze",
            "headline": "",
            "avatar_url": "https://picx.zhimg.com/50/v2-d1a0933c6e8c6891e0d3259a2f33d4eb_l.jpg?source=b6762063",
            "is_org": false,
            "gender": -1,
            "followers_count": 8,
            "is_following": false,
            "is_followed": false
          },
          "title": "你看过什么封神级的网络小说?",
          "created": 1575523321,
          "answer_count": 0,
          "follower_count": 0,
          "comment_count": 53,
          "bound_topic_ids": [
            73,
            1873,
            2058,
            15858,
            44871
          ],
          "is_following": false,
          "excerpt": "",
          "relationship": {
            "is_author": false
          },
          "detail": "",
          "question_type": "normal"
        },
        "thumbnail": "https://pic1.zhimg.com/50/v2-58d53c305c7435f0008afc0c22d0fbec_720w.jpg?source=b6762063",
        "excerpt": "（最后更新时间：2025.08）一、单主简介 2012至今，阅文4.6亿； 口味：都市、历史、仙侠、玄幻、奇幻、科幻、军事、游戏、悬疑等等；二、神作&大神推荐1.神作推荐：TOP1：《诡秘之主》爱潜水的乌贼（类推：《放开那个女巫》《奥术神座》《高天之上》）TOP2：《吞噬星空》我吃西红柿（类推：《寸芒》《星辰变》《还真道》《间客》《超级英雄》《卡徒》《龙族》《点道为止》《世界树的游戏》《超神机械师》《完美世界》《洪荒元符…",
        "excerpt_new": "（最后更新时间：2025.08）一、单主简介 2012至今，阅文4.6亿； 口味：都市、历史、仙侠、玄幻、奇幻、科幻、军事、游戏、悬疑等等；二、神作&大神推荐1.神作推荐：TOP1：《诡秘之主》爱潜水的乌贼（类推：《放开那个女巫》《奥术神座》《高天之上》）TOP2：《吞噬星空》我吃西红柿（类推：《寸芒》《星辰变》《还真道》《间客》《超级英雄》《卡徒》《龙族》《点道为止》《世界树的游戏》《超神机械师》《完美世界》《洪荒元符…",
        "preview_type": "default",
        "preview_text": "",
        "reshipment_settings": "allowed",
        "content": "<p data-pid=\"w7L_l1g9\"><i>（最后更新时间：2025.08）</i></p><h2><i>一、单主简介</i></h2><p data-pid=\"p5MbYcce\"><i>2012至今，阅文4.6亿；</i></p><p data-pid=\"GWR5O89d\"><i>口味：都市、历史、仙侠、玄幻、奇幻、科幻、军事、游戏、悬疑等等；</i></p><h2><i>二、神作&amp;大神推荐</i></h2><h3><i>1.</i><b><i>神作推荐：</i></b></h3><blockquote data-pid=\"XlloPfQD\"><b>TOP1：《诡秘之主》爱潜水的乌贼</b></blockquote><ul><li data-pid=\"9cI5kINL\"><i>（类推：《放开那个女巫》《奥术神座》《高天之上》）</i></li></ul><blockquote data-pid=\"wYMo0ZBN\"><b>TOP2：《吞噬星空》我吃西红柿</b></blockquote><ul><li data-pid=\"IX4PYOIz\"><i>（类推：《寸芒》《星辰变》《还真道》《间客》《超级英雄》《卡徒》《龙族》《点道为止》《世界树的游戏》《超神机械师》《完美世界》《洪荒元符录》《星空王座》）</i></li></ul><blockquote data-pid=\"B8pDFBrc\"><b>TOP3：《通天之路》无罪 </b></blockquote><ul><li data-pid=\"r0fcDBo0\"><i>（类推：《万鬼之主》《万妖之主》《武墓》《仙国大帝》《万古仙穹》《长生不死》《永生》《大主宰》《斗破苍穹》）</i></li></ul><blockquote data-pid=\"nXyzD_PS\"><b>TOP4：《我欲封天》耳根</b></blockquote><ul><li data-pid=\"VoV1Lyi1\"><i>（类推：《三寸人间》《求魔》《仙路至尊》《立道庭》《人道崛起》《我真是族长》《沧元图》《莽荒纪》《飞剑问道》《剑道独神》）</i></li></ul><blockquote data-pid=\"UmdJ7eQN\"><b>TOP5：《庆余年》猫腻 </b></blockquote><ul><li data-pid=\"LdmbBHnf\"><i>（类推：《剑王朝》《将夜》《紫川》《宠魅》《亵渎》《魔法学徒》《魔运苍茫》《恶魔法则》《琴帝》《光明纪元》《易鼎》）</i></li></ul><blockquote data-pid=\"pnjVzsMV\"><b>TOP6：《三界血歌》血红</b></blockquote><ul><li data-pid=\"1pjq6jDx\"><i>（类推：《盘龙》《魔兽领主》《冰火魔厨》《众神世界》《罪恶之城》《巫师亚伯》《巫师之旅》《雪鹰领主》《儒道至圣》《斗罗大陆》《兽血沸腾》《洪荒元符录》《异界兽医》）</i></li></ul><blockquote data-pid=\"H2iSMUkY\"><b>TOP7：《大画家》醛石</b></blockquote><ul><li data-pid=\"xQHc5jym\"><i>（类推：《腾飞我的航空时代》《医师1879》《超级能源强国》《冠军教父》《我们是冠军》《冠军传奇》《狂狮少帅》《红叛军》《绿茵教父》）</i></li></ul><blockquote data-pid=\"oaJ6j1mx\"><b>TOP8：《女兵英姿》江心舟</b></blockquote><p data-pid=\"MCHcxloU\"><i>（类推：《幕后》《中国猎人》《大国战隼》《重生之军营》《帝王之友》）</i></p><blockquote data-pid=\"sEDDaTp5\"><b>TOP9：《汉阙》七月新番</b></blockquote><ul><li data-pid=\"i4asVFD2\"><i>（类推：《苏厨》《秦吏》《宋风》《锦衣夜行》《战国赵为王》《雄秦崛起》《新书》《春秋我为王》《雅骚》《上品寒士》《绍宋》《赘婿》《恶汉》《篡唐》）</i></li></ul><blockquote data-pid=\"lLtHxvVv\"><b>TOP10：《重生之超级学霸》志鸟村</b></blockquote><ul><li data-pid=\"KPboOF1L\"><i>（类推：《医师》《医路坦途》《超级医生》《修真庄园主》《黄金渔场》《亏成首富从游戏开始》《医路青云》）</i></li></ul><h3><b><i>2.大神推荐：</i></b></h3><p data-pid=\"gKn5S5Wv\"><i>（以下作家不分先后，另，仅为个人对其作品偏好，若无拜读则不在此列，若有大神推荐可留言评论区！）</i></p><p data-pid=\"EQqe7H3Z\"><b>（1）都市类：</b></p><p data-pid=\"n_BQ7yVp\"><b>①吏场：</b><i>瑞根、寂寞读南华、不信天下掉馅饼、格鱼、烟斗老哥、蔡晋、洞房不败、何常在</i></p><p data-pid=\"rn0RM62j\"><b>②职业：</b><i>草席、叶南天、志鸟村、安溪柚、林海听涛、壮乡小仨、醛石、花十八朵、步枪、长风、江心舟、天下霸唱、臧福生、地黄丸、青衫取醉、全金属弹壳</i></p><p data-pid=\"BiGDMhd1\"><b>③娱乐：</b><i>七七家d猫猫、睡觉会变白、射手座李不二、司马、机器人瓦力、青城无忌、齐佩甲、咯嘣</i></p><p data-pid=\"aDHalZwi\"><b>（2）历史类：</b></p><p data-pid=\"nZnhXprQ\"><i>贼道三痴、七月新番、庚新、榴弹怕水、戒念、二子从周、愤怒的香蕉、刀笔之吏、熙檬父、马桶上的小孩、月关、王梓钧、多木木多</i></p><p data-pid=\"gLGvHKGR\"><b>（3）仙玄奇：</b></p><p data-pid=\"1MFy5iSB\"><b>①仙侠：</b><i>我吃西红柿、无罪、鲁西平、耳根、无极书虫、梦入神机、山人有妙计、睡秋、观棋、六道沉沦、猛虎道长、烽火戏诸侯、孤独漂流</i></p><p data-pid=\"0RTqZHRl\"><b>②玄幻：</b><i>血红、天蚕土豆、跳舞、辰东、江南、猫腻、老猪、唐家三少、梦入神机、方想</i></p><p data-pid=\"4X--D4iP\"><b>③奇幻：</b><i>爱潜水的乌贼、烟雨江南、吃瓜子群众、一行白鹭上青天、高坡、静官、永恒之火、乱、二目</i> </p><p class=\"ztext-empty-paragraph\"><br/></p><hr/><p class=\"ztext-empty-paragraph\"><br/></p><p data-pid=\"_XUBpVIT\"><b><i>【结语】</i></b>：对于神作定义，个人偏好为主，其中有些书对于老白们来说是小白文，但毕竟是曾经小白时期的启蒙文，从早期三少、番茄、土豆的玄幻文，到七七家的娱乐文和瑞根等官场文，到猫腻科幻文和七月、三痴等历史文，再到如今各个军事文职场文种田文等等，每个阶段都有每个阶段的心头好，那是小白往长白山上一步一步爬的梯子。</p><p data-pid=\"nlKVBkyV\"><b>玄幻奇幻仙侠</b>，除其构造的恢弘世界外，更看重当时独树一帜的修炼晋升体系：如《诡秘》塔罗牌，《封天》《三界》《永生》《星辰变》的星空修炼，《仙国》《长生》《万妖》《洪荒》的气运系列，《还真》《佛本》《修道人生》的练气体系等等；值得一提的是，《蛊真人》的修炼体系让人拍案，但其情节就如鲜花下那坨东东，三拾三弃。</p><p data-pid=\"s_p0zE_d\"><b>都市类</b>，目前是偏好是不同职业理想人生，如医生文《医师》《医路》，特种兵《战隼》《猎人》，种田文《庄园主》《渔场》等等，但前期阅读更倾向于重生过去，比如吏场文、娱乐文等。这两者的差异除了说是否有系统或异能，或者有先知先觉能力占得先机，比较欣赏的是存在某种天赋后去拼搏钻研精神，兼具大国小家的情怀，如军事文医学文等。另外，为何在众多体育竞技中，更偏爱足球文呢？可能是除其团队拼搏、结局的不确定性、强者不一定胜等等这样的内在含义赋予外，还有就是从低级联赛往上，从三冠王到七冠王，从普通球队到豪门，这样一步步“打怪升级”，还有可以随时买明星球员的“BUFF”等这样的网文爽点存在。</p><p data-pid=\"JLZQQMos\"><b>历史类</b>，一个是偏老套路，穿回某朝统一天下的王霸热血文，如《战国》《春秋》《雄秦》《绍宋》《赘婿》，一个是辅助型全能型的权谋文，如《锦衣》《苏厨》《秦吏》《汉阙》《雅骚》《寒士》等，其中更欣赏驱逐鞑虏创建文明的历史文，利用蝴蝶翅膀扇走野蛮。至今，贼道三痴和七月新番笔下的历史余音久久回响，赞兮叹兮惋兮！</p><p data-pid=\"9TXe8M5W\"><b>其他类，科幻文</b>，主要是光脑/机甲/星舰等一系列所幻想的星际文明产物，但比较精彩的是探讨星空文明和道德准则，人类与机械如何共生共存的关系，如《间客》《超神》等。<b>游戏文</b>，看的风格也是侧重进入游戏世界或携带游戏面板。如《世界树》《魔兽》等等。<b>悬疑文</b>，唯一一本是《鬼吹灯》。</p><p data-pid=\"yzhgJY40\">总而言之，本阶段单主更青睐都市职业和历史文。</p><p data-pid=\"NvUhpVCb\">附：《2012-2025年书单》</p><p data-pid=\"HpDITNqR\">（特别说明：以下小说分类参照知乎文章：<b><i><span class=\"nolink\">天羽久美琉</span></i></b><a href=\"https://zhuanlan.zhihu.com/p/676911161\" class=\"internal\" target=\"_blank\">《网络小说有哪些流派？ 流派之间又是怎样划分的？》</a>）</p><figure data-size=\"normal\"><img src=\"https://pic2.zhimg.com/v2-30c1e83d5be5dbe9b4cd4880a4cc8a55_1440w.jpg\" data-rawwidth=\"1520\" data-rawheight=\"4891\" data-size=\"normal\" data-original-token=\"v2-7da898bc5a53a8a4705b153db3d18f4c\" data-default-watermark-src=\"https://pica.zhimg.com/v2-600cd1488e1dde9dd2692b9afb9cd972_b.jpg\" class=\"origin_image zh-lightbox-thumb\" width=\"1520\" data-original=\"https://pic2.zhimg.com/v2-30c1e83d5be5dbe9b4cd4880a4cc8a55_r.jpg\"/><figcaption>《2012-2025年书单》</figcaption></figure><p data-pid=\"ePs0a6HY\"><b>以上有误之处，欢迎书友们指正！！！</b></p>",
        "relationship": {
          "is_thanked": false,
          "is_nothelp": false,
          "voting": 0
        },
        "is_labeled": false,
        "visited_count": 92320,
        "thumbnails": [
          "https://pic1.zhimg.com/50/v2-58d53c305c7435f0008afc0c22d0fbec_720w.jpg?source=b6762063"
        ],
        "favorite_count": 1994,
        "answer_type": "normal",
        "is_navigator": false,
        "navigator_vote": false,
        "vote_next_step": "vote"
      },
      "brief": "{\"source\": \"TS\", \"type\": \"answer\", \"id\": 3573508068}",
      "attached_info": "CusFCPrr7P6UlarMuwEQBBoJNjc5Nzk5NjAzIMybibUGKPMDMCdA1QRKLgodVFNfU09VUkNFX0ZFRURfVVNFUl9FWFBFUlRfQ0YSBzE5MTIzNTkYACAAOgBaCDQyMTQ2MjIxYiBmMDc1YmIwMGMyOWY0YzMzNjI1YTU5YmIzNTFhZTBhN3IKMzU3MzUwODA2OIoBCTM1OTQwNDc4MKoBCXJlY29tbWVuZMIBIGU1MDQ1MGFhYWY4NWVmZTBmNjFmYzY0Yzg4YWFjOGUx8gEKCAwSBk5vcm1hbPIBKAgKEiRkYjMwYWEyMy0wMjJkLTQwMDctYTg4MC1jYmRhYmI0NWNmYzTyAQcICxIDMTAwggIAiAKmoc35jDOSAiBlNTA0NTBhYWFmODVlZmUwZjYxZmM2NGM4OGFhYzhlMZoCAMoCFlNob3JJbnRlcmVzdFdlaWdodFJ1bGXKAhVVc2VyTGNuRXhpdFdlaWdodFJ1bGXKAhRDb250ZW50QWdlV2VpZ2h0UnVsZdoCHVRTX1NPVVJDRV9GRUVEX1VTRVJfRVhQRVJUX0NG6AID+gILTk9STUFMX0ZMT1eKAyBkZTU5YTdiNzczZjk0NGY2YjQ0ZDBjZDE1NzIzZGJhOJoDDQoCdjIQABoFb3RoZXKoA6DRBdgDAOoDEGFpR3JhcGhFbWJVc2VyQ0b6A04SDFVOS05PV05fTU9ERSAAKg1OT19JTUFHRV9NT0RFOi0IAhDwCxibJiIjdjItN2RhODk4YmM1YTUzYThhNDcwNWIxNTNkYjNkMThmNGOABACIBACSBAZOb3JtYWyaBAEzoAQAqAQAsAQAugQGbWFudWFswgQDMTcwyAQA0gQP5o6o6I2Q5bey5pu05paw2AQA8AQA+QQAAACgSTOSP4EFAAAAAAAAAACJBcB4Ju0hVNk/kgUAmgUDZGZ0ogUDZGZ0sgUBMbkFAAAAAAAAAADQBQDgBQDoBQDwBWSQBgCgBtsEqAYAkgIlCgk2Nzk3OTk2MDMSCjM1NzM1MDgwNjgYBCIKSU1BR0VfVEVYVA==",
      "action_card": false
    },
    {
      "id": "598_1755822903.773",
      "type": "feed",
      "offset": 598,
      "verb": "TOPIC_ACKNOWLEDGED_ARTICLE",
      "created_time": 1755822903,
      "updated_time": 1755822903,
      "target": {
        "id": "1941511071568495144",
        "type": "article",
        "url": "https://api.zhihu.com/articles/1941511071568495144",
        "author": {
          "id": "ae8fd74bed1af8e11898fad6e07f27aa",
          "url": "https://api.zhihu.com/people/ae8fd74bed1af8e11898fad6e07f27aa",
          "user_type": "people",
          "url_token": "59-56-69-69",
          "name": "大模型学习教程",
          "headline": "两年大模型工作经验，分享知识和技术",
          "avatar_url": "https://pica.zhimg.com/50/v2-cb1930ec68e2b2697660502cb56d3e6a_l.jpg?source=b6762063",
          "is_org": false,
          "gender": 0,
          "followers_count": 423,
          "is_following": false,
          "is_followed": false
        },
        "title": "SFT与RL在AI模型中的作用解析：记忆与泛化的分工与协同！",
        "comment_permission": "all",
        "created": 1755672639,
        "updated": 1755672639,
        "voteup_count": 2,
        "voting": 0,
        "comment_count": 0,
        "linkbox": {
          "category": "",
          "pic": "",
          "title": "",
          "url": ""
        },
        "excerpt": "一、摘要监督微调 (SFT)和强化学习(RL)是基础模型广泛采用的后训练技术。然而，它们各自在增强模型泛化能力方面的作用仍不明确。   本文研究了 SFT 和 RL 对泛化和记忆的相对影响，重点关注文本和视觉环境。 我们引入了 Generalpoints，一种算术推理卡牌游戏，并考虑了 V-IRL，一个真实世界的导航环境，以评估使用 SFT 和 RL训练的模型如何在文本和视觉领域泛化到未见过的变体。   我们发现，RL，特别是当使用基于结果的奖励进行训练…",
        "excerpt_new": "一、摘要监督微调 (SFT)和强化学习(RL)是基础模型广泛采用的后训练技术。然而，它们各自在增强模型泛化能力方面的作用仍不明确。   本文研究了 SFT 和 RL 对泛化和记忆的相对影响，重点关注文本和视觉环境。 我们引入了 Generalpoints，一种算术推理卡牌游戏，并考虑了 V-IRL，一个真实世界的导航环境，以评估使用 SFT 和 RL训练的模型如何在文本和视觉领域泛化到未见过的变体。   我们发现，RL，特别是当使用基于结果的奖励进行训练…",
        "preview_type": "default",
        "preview_text": "",
        "content": "<h2><b>一、摘要</b></h2><p data-pid=\"WlU9tU1r\">监督微调 (SFT)和强化学习(RL)是基础模型广泛采用的后训练技术。然而，它们各自在增强模型泛化能力方面的作用仍不明确。</p><figure data-size=\"normal\"><img src=\"https://pica.zhimg.com/v2-ff05ff4ec729282d777c3ee4ddcd1a0a_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"960\" data-rawheight=\"399\" data-original-token=\"v2-d38596eb0022b274f69729c0300a6dc1\" class=\"origin_image zh-lightbox-thumb\" width=\"960\" data-original=\"https://pica.zhimg.com/v2-ff05ff4ec729282d777c3ee4ddcd1a0a_r.jpg\"/></figure><p data-pid=\"fisKjOdi\">本文研究了 SFT 和 RL 对泛化和记忆的相对影响，重点关注文本和视觉环境。</p><p data-pid=\"GhO9-CL7\">我们引入了 Generalpoints，一种算术推理卡牌游戏，并考虑了 V-IRL，一个真实世界的导航环境，以评估使用 SFT 和 RL训练的模型如何在文本和视觉领域泛化到未见过的变体。</p><figure data-size=\"normal\"><img src=\"https://pic4.zhimg.com/v2-57d5f8db238013bf1e718e3966d78117_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1080\" data-rawheight=\"857\" data-original-token=\"v2-188ed2c816670f88704b0efea0b44263\" class=\"origin_image zh-lightbox-thumb\" width=\"1080\" data-original=\"https://pic4.zhimg.com/v2-57d5f8db238013bf1e718e3966d78117_r.jpg\"/></figure><p data-pid=\"TCOWnajd\">我们发现，RL，特别是当使用基于结果的奖励进行训练时，在基于规则的文本和视觉环境中均能展现出泛化能力。</p><p data-pid=\"ydQqH2w5\">相比之下，SFT倾向于记忆训练数据，并且在两种情况下都难以泛化到分布外的数据。进一步的分析表明，RL提升了模型潜在的视觉识别能力，从而有助于其在视觉领域增强泛化能力。</p><p data-pid=\"L0H2qfQR\">尽管 RL具有更强的泛化能力，但我们发现 SFT对于有效的 RL训练仍然至关重要: SFT稳定了模型的输出格式，使得后续的RL能够实现性能的提升。这些研究结果证明了 RL 在复杂的、多模态任务中获取可泛化知识的优势。</p><figure data-size=\"normal\"><img src=\"https://pica.zhimg.com/v2-0c42e3f85dc7bf77b271a30c07615976_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1080\" data-rawheight=\"407\" data-original-token=\"v2-b8e02d49e03c9bbb63c7ff3a05dbe9bd\" class=\"origin_image zh-lightbox-thumb\" width=\"1080\" data-original=\"https://pica.zhimg.com/v2-0c42e3f85dc7bf77b271a30c07615976_r.jpg\"/></figure><h2><b>二、引言</b></h2><p data-pid=\"RnwjXOZS\">虽然 SFT 和 RL 都被广泛用于基础模型训练，但它们对泛化的独特影响仍然不清楚，这使得构建可靠和鲁棒的AI智能体系统具有挑战性。</p><p data-pid=\"QKawUGUl\">分析基础模型的泛化能力的一个关键挑战是将数据记忆1与可迁移原则的获取分离开来。因此，我们研究了SFT或RL主要是记忆训练数据，还是学习可以适应新任务变体的可泛化原则这一关键问题。</p><p data-pid=\"woUqAtmo\">为了解决这个问题，我们关注泛化的两个方面:基于文本的规则泛化和视觉泛化。对于文本规则，我们研究模型将学习到的规则(给定文本提示词)应用于这些规则的变体的能力。</p><figure data-size=\"normal\"><img src=\"https://pic2.zhimg.com/v2-c52527cd3f61466544d1324436031ba3_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1080\" data-rawheight=\"468\" data-original-token=\"v2-a106ed38b7fbbdba90d611271ab368e7\" class=\"origin_image zh-lightbox-thumb\" width=\"1080\" data-original=\"https://pic2.zhimg.com/v2-c52527cd3f61466544d1324436031ba3_r.jpg\"/></figure><p data-pid=\"qeK43Jjf\">对于视觉语言模型(VLM)，视觉泛化衡量在给定任务中，视觉输入(如颜色和空间布局)变化时性能的一致性。为了研究基于文本和视觉的泛化，我们研究了两个不同的任务，这两个任务体现了基于规则和视觉的变体。</p><p data-pid=\"Ql3sFXiK\">我们的第一个任务是Generalpoints，这是一个原创的纸牌游戏任务，类似于RL4VLM 中的 Points24 任务，旨在评估模型的算术推理能力。</p><p data-pid=\"hz23XQun\">在 Generalpoints中，模型接收四张牌(以文本描述或图像形式呈现)，并且需要使用每张牌的数值恰好一次来计算目标数字(默认为 24)。其次，我们采用了v-IRL，这是一个真实的导航任务，侧重于模型的空间推理能力。</p><figure data-size=\"normal\"><img src=\"https://pic3.zhimg.com/v2-7eb04724ccb6dafdca995fc522d28f7c_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"652\" data-rawheight=\"298\" data-original-token=\"v2-995a911b441f905426a44a244b7eb82c\" class=\"origin_image zh-lightbox-thumb\" width=\"652\" data-original=\"https://pic3.zhimg.com/v2-7eb04724ccb6dafdca995fc522d28f7c_r.jpg\"/></figure><h2>三、Training Computation(GFLOPs)  </h2><p data-pid=\"2Wy0BqFn\">我们采用类似于 @zhai2024finetuning 的多步强化学习框架，通过在主干模型上进行监督微调(SFT)后实例化强化学习(RL)，并使用顺序修订公式。</p><p data-pid=\"hgbA1_wl\">在 Generalpoints和V-IRL中我们观察到强化学习(RL)学习了可泛化的规则(以文本形式表达)，其中分布内的性能提升也转移到了未见过的规则。相比之下，监督微调(SFT)似乎记住了训练规则，并且无法泛化(例如:参见1)。</p><p data-pid=\"W32ECKYm\">除了基于文本规则的泛化之外，我们还进一步研究了视觉领域的泛化，并观察到强化学习(RL)也泛化到了视觉分布外(OOD)任务，而监督微调(SFT)仍然表现不佳。</p><figure data-size=\"normal\"><img src=\"https://pica.zhimg.com/v2-402c81eb5f5ea872dd1bb64205b7bd1e_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"690\" data-rawheight=\"532\" data-original-token=\"v2-66838b7cad5978db5f8b91635650a3a8\" class=\"origin_image zh-lightbox-thumb\" width=\"690\" data-original=\"https://pica.zhimg.com/v2-402c81eb5f5ea872dd1bb64205b7bd1e_r.jpg\"/></figure><p data-pid=\"gJEPG9vh\">作为视觉分布外(OOD)泛化能力的副产品，我们的多轮强化学习(RL)方法在v-IRL 小型基准测试中实现了最先进的性能，提高了[+33.8%](44.0%→77.8%)，突显了强化学习(RL) 的泛化能力。</p><p data-pid=\"UlK97IRd\">为了理解强化学习(RL)如何影响模型的视觉能力，我们对 Generalpoints进行了额外的分析，揭示了使用基于结果的奖励函数训练强化学习(RL)可以提高视觉识别能力。</p><p data-pid=\"V-RzFYCB\">虽然强化学习(RL)表现出比监督微调(SFT)更优越的泛化能力，但我们表明监督微调(SFT)仍然有助于稳定模型的输出格式，使强化学习(RL)能够实现其性能提升。</p><p data-pid=\"epjt75a9\">最后但并非最不重要的一点是，我们观察到通过增加最大步数来扩大推理时间计算可以带来更好的泛化。</p><figure data-size=\"normal\"><img src=\"https://pic1.zhimg.com/v2-0822934de505688ebfdb3b7d9abde498_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"572\" data-rawheight=\"510\" data-original-token=\"v2-14f39223c05298a82671f90a3794bb8d\" class=\"origin_image zh-lightbox-thumb\" width=\"572\" data-original=\"https://pic1.zhimg.com/v2-0822934de505688ebfdb3b7d9abde498_r.jpg\"/></figure><p data-pid=\"-ZNi0YoI\"><b>如何学习大模型 AI ？</b><br/><br/>由于新岗位的生产效率，要优于被取代岗位的生产效率，所以实际上整个社会的生产效率是提升的。<br/><br/>但是具体到个人，只能说是：<br/><br/>最先掌握AI的人，将会比较晚掌握AI的人有竞争优势。<br/>这句话，放在计算机、互联网、移动互联网的开局时期，都是一样的道理。<br/><br/><b>我在一线互联网企业工作十余年里，指导过不少同行后辈。帮助很多人得到了学习和成长。</b><br/><br/>我意识到有很多经验和知识值得分享给大家，也可以通过我们的能力和经验解答大家在人工智能学习中的很多困惑，所以在工作繁忙的情况下还是坚持各种整理和分享。但苦于知识传播途径有限，很多互联网行业朋友无法获得正确的资料得到学习提升，故此将并将重要的AI大模型资料包括AI大模型入门学习思维导图、精品AI大模型学习书籍手册、视频教程、实战学习等录播视频免费分享出来。<br/><br/><b>这份完整版的大模型 AI 学习资料，朋友们如果有需要的话可以点击下方卡片免费领取【保证100%免费】</b></p><a href=\"https://zhuanlan.zhihu.com/p/1938615489128538250\" data-draft-node=\"block\" data-draft-type=\"link-card\" class=\"internal\">2025最新AI大模型学习资料合集，允许白嫖，学完拿下大厂offer，你要悄悄努力然后惊艳所有人！</a><h2><b>四、Post-training.</b></h2><p data-pid=\"96n3Yk8-\">后期训练对于提升模型性能至关重要。此阶段通常采用大规模监督微调(SFT)和/或强化学习(RL)。SFT通过在特定任务的、通常为指令格式的数据集上训练预训练模型，使其适应下游任务。</p><p data-pid=\"C211bit_\">先前的研究，例如 FLAN，表明在多样化的指令调整数据集上进行微调可以显著提升在未见任务上的零样本学习性能。</p><p data-pid=\"wpXBK4Jw\">此外，LIMA 表明，监督微调充当了一个“格式教师”，有效地使模型的响应适应所需的格式，同时利用了预训练大语言模型的能力。</p><figure data-size=\"normal\"><img src=\"https://pica.zhimg.com/v2-b944d7d53cf3f98e1d4c4c38da0698d4_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1080\" data-rawheight=\"482\" data-original-token=\"v2-4ed7dae2780ce73a1fb58547dd649462\" class=\"origin_image zh-lightbox-thumb\" width=\"1080\" data-original=\"https://pica.zhimg.com/v2-b944d7d53cf3f98e1d4c4c38da0698d4_r.jpg\"/></figure><p data-pid=\"F1ZeNxuJ\">相比之下，强化学习主要用于使模型与人类偏好对齐，或训练基础模型来解决特定任务。</p><p data-pid=\"4rjPon2n\">我们的工作与先前的研究不同，因为我们的目标是比较分析 SFT和 RL在大语言模型和视觉语言模型上的泛化和记忆能力，而先前的研究主要集中在仅研究这两种后期训练方法中的一种(或仅研究大语言模型或视觉语言模型)，或者仅研究一种后期训练方法。</p><h2><b>五、大语言模型/视觉语言模型中的记忆与泛化</b></h2><p data-pid=\"E4ERnANR\">多项研究已经检验了神经网络中记忆和泛化之间的相互作用。在大语言模型中，记忆可以表现为模型记住训练数据，而泛化则反映了模型输出分布与预训练数据分布之间的差异。</p><figure data-size=\"normal\"><img src=\"https://pic2.zhimg.com/v2-4cc0faaaf25cae8c68db23b39d80fd69_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1080\" data-rawheight=\"437\" data-original-token=\"v2-22ea834343fe7a15f4ee5f060500413f\" class=\"origin_image zh-lightbox-thumb\" width=\"1080\" data-original=\"https://pic2.zhimg.com/v2-4cc0faaaf25cae8c68db23b39d80fd69_r.jpg\"/></figure><p data-pid=\"0cANyPhy\">先前的研究表明，大语言模型在更简单、知识密集的任务上表现出更多的过拟合，而在更复杂、推理密集的任务上表现出更大的泛化能力。</p><p data-pid=\"vO5YTpSw\">例如，最近的研究表明，大语言模型通过在自回归生成之前预先计算推理图，发展出超出其训练数据的推理技能，这为泛化提供了有力的证据。</p><p data-pid=\"mGkZM-iF\">我们的研究采取了一种不同的方法，通过研究不同的后训练范式在基于文本规则和视觉变体的情况下对记忆与泛化的作用。</p><p data-pid=\"LIz5MBlH\">我们在单模态(大语言模型)和多态(视觉语言模型)设置中进行了比较研究，并证明强化学习(RL)比监督微调(SFT)能带来更好的泛化性能。</p><figure data-size=\"normal\"><img src=\"https://pica.zhimg.com/v2-ce4ad8e23ffb9666f32b3719a45a34f8_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1080\" data-rawheight=\"613\" data-original-token=\"v2-72480089ba684300692ac191ec1db0d7\" class=\"origin_image zh-lightbox-thumb\" width=\"1080\" data-original=\"https://pica.zhimg.com/v2-ce4ad8e23ffb9666f32b3719a45a34f8_r.jpg\"/></figure><h2><b>六、扩展推理时计算</b></h2><p data-pid=\"GOffWJn5\">最近的研究越来越关注扩展推理时计算，以提高模型性能。早期的研究引导模型生成中间推理步骤，并在给出最终答案之前扩展响应。</p><p data-pid=\"CSwQjthL\">随后的工作表明，在推理过程中微调验证器可以提高模型准确性，从而有效地利用测试时计算。</p><p data-pid=\"3fH6RSVf\">最近的研究结果揭示了推理时计算的“缩放定律”，强调了增加计算资源带来的显著性能提升。</p><p data-pid=\"BlABckys\">我们的工作在两个方面基于这些发现。首先，我们将推理时验证的见解整合到一个多轮强化学习(RL)公式中，该公式允许模型识别并纠正其错误。</p><figure data-size=\"normal\"><img src=\"https://pic1.zhimg.com/v2-b908616e063b5316f0f772a9e8d3870c_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1080\" data-rawheight=\"901\" data-original-token=\"v2-b240ab431289f859030d7c53b6e4a841\" class=\"origin_image zh-lightbox-thumb\" width=\"1080\" data-original=\"https://pic1.zhimg.com/v2-b908616e063b5316f0f772a9e8d3870c_r.jpg\"/></figure><p data-pid=\"dWLuDtZC\">其次，我们研究了推理时验证对强化学习泛化的影响，表明扩展推理时验证(就最大验证步骤数而言)是强化学习泛化的关键，提升视觉语言模型(VLMs)的视觉能力。</p><p data-pid=\"wahd9V-3\">尽管视觉语言模型在解决各种具有挑战性的任务(例如解决高级大学考试题和空间理解任务)方面展现出了卓越的技能，但它们在视觉感知方面也存在局限性。</p><p data-pid=\"n01Y0Ugt\">先前为增强视觉语言模型的视觉感知所做的努力包括结合多个视觉编码器、策划高质量的SFT数据，以及通过解冻视觉骨干网络来改进SFT微调训练方法。</p><p data-pid=\"32kWKFZj\">虽然这些先前的工作主要侧重于在SFT微调阶段进行的实验，但我们的工作表明，强化学习(RL)也可以提高视觉感知。</p><figure data-size=\"normal\"><img src=\"https://pica.zhimg.com/v2-b47e42978b8b0ba74e2138fc673b4d42_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1080\" data-rawheight=\"543\" data-original-token=\"v2-9675ea97547fac932552e57fe20d1c7e\" class=\"origin_image zh-lightbox-thumb\" width=\"1080\" data-original=\"https://pica.zhimg.com/v2-b47e42978b8b0ba74e2138fc673b4d42_r.jpg\"/></figure><h2><b>七、标准强化学习术语</b></h2><figure data-size=\"normal\"><img src=\"https://pic2.zhimg.com/v2-a45833dc7496049314928269c6f3f93d_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"478\" data-rawheight=\"101\" data-original-token=\"v2-23d08796ee1edb54e776ffbb5e3122d8\" class=\"origin_image zh-lightbox-thumb\" width=\"478\" data-original=\"https://pic2.zhimg.com/v2-a45833dc7496049314928269c6f3f93d_r.jpg\"/></figure><figure data-size=\"normal\"><img src=\"https://pic4.zhimg.com/v2-ef46bee866ddcbe0425fd08d518bd267_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1080\" data-rawheight=\"1353\" data-original-token=\"v2-d93352c955daa04ae35d63cd5b60bed2\" class=\"origin_image zh-lightbox-thumb\" width=\"1080\" data-original=\"https://pic4.zhimg.com/v2-ef46bee866ddcbe0425fd08d518bd267_r.jpg\"/></figure><figure data-size=\"normal\"><img src=\"https://pic2.zhimg.com/v2-1321e9fad61fc11bf160615923a5528b_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"872\" data-rawheight=\"499\" data-original-token=\"v2-32cc5a604c36c7a499971021c1672d9c\" class=\"origin_image zh-lightbox-thumb\" width=\"872\" data-original=\"https://pic2.zhimg.com/v2-1321e9fad61fc11bf160615923a5528b_r.jpg\"/></figure><h2><b>八、评估任务</b></h2><p data-pid=\"EeF4ho4U\">为了评估不同后训练方法的泛化能力，我们选择了两个任务，这两个任务都提供了规则和视觉变化。</p><p data-pid=\"iaMBt6bB\">第一个任务 Generalpoints 是我们设计的一个新环境，用于评估算术推理能力。</p><p data-pid=\"ehQXIqAr\">第二个任务 V-IR 被选择来检验模型在开放世界视觉导航领域的推理能力。</p><p data-pid=\"xs9dDUGa\"><b>通用点数环境</b></p><p data-pid=\"2nSJuW0a\">我们最初的 Generalpoints环境，在 Points24 环境之上实例化，旨在评估算术推理的泛化能力。</p><p data-pid=\"aksq84MJ\">环境的每个状态s包含4 张卡片，以文本形式(在 GP-变体中)或以图像形式(在GP-VL 变体中)描述; 有关Generalpoints的视觉示例，请参见图2左侧。</p><p data-pid=\"mb73FgSv\">目标是使用卡片上的所有4个数字，且每个数字仅使用一次，生成一个等于目标数字(默认为 24)的等式。</p><p data-pid=\"LpvZ-EG6\">请注意，当 Generalpoints 的输入以图像形式呈现(GP-VL)时，它自然需要视觉语言模型 (VLM)在解决等式之会引入额外的视觉挑战，很难识别所有卡片。</p><p data-pid=\"FrDf0K7t\"><b>规则变体。</b></p><p data-pid=\"3GNEYfoW\">为了研究模型是学习算术运算还是仅仅记忆训练后的数据我们在 Generalpoints 中引入了规则变体。</p><p data-pid=\"09uIEoRE\">这些变体包括将符号J、Q 和K分别解释为 、和，或者全部解释为相同的数字。这些变体确保了对模型在不同设置下泛化算术推理能力的严格评估。</p><p data-pid=\"g4wmebjr\">每个规则都在输入提示词中以文本形式指定，请参见图3中的{tasks rules}部分。为了研究基于规则的泛化，我们使用一种规则对模型进行微调，然后使用不同的规则进行评估。</p><p data-pid=\"HsSXsU1l\"><b>视觉变体。</b></p><p data-pid=\"ZJpgcju1\">Genera1points环境也可以自然地进行定制，以评估跨视觉变体的泛化能力。由于主要的视觉挑战是识别每张卡片的数字: 而与卡片的颜色无关，我们将不同颜色的卡片视为该任务的视觉变体。</p><p data-pid=\"Xwd332OI\">在视觉泛化设置中，我们使用一种颜色的卡片训练模型，然后使用另一种颜色测试 OOD(分布外)性能。</p><figure data-size=\"normal\"><img src=\"https://pic2.zhimg.com/v2-b8da77ae512f1ebb8f4692c4f196da59_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"825\" data-rawheight=\"633\" data-qrcode-action=\"none\" data-original-token=\"v2-cf74e0ba34053c86046e288cdeec8fab\" class=\"origin_image zh-lightbox-thumb\" width=\"825\" data-original=\"https://pic2.zhimg.com/v2-b8da77ae512f1ebb8f4692c4f196da59_r.jpg\"/></figure><h2><b>九、V-IRL 环境</b></h2><p data-pid=\"SYmuomAR\">虽然 Generalpoints 环境旨在评估算术推理能力，但我们进一步利用 V-IRL 环境来研究开放世界导航领域中空间推理能力，该领域使用真实的视觉输入。</p><p data-pid=\"EulcpSR_\">与Generalpoints类似，我们考虑该环境的两个版本，一个(V-IRL-L)由纯语言描述组成2另一个(V-IRL-VL)包括视觉-语言输入。</p><p data-pid=\"BdcuFGR8\">V-IRL 中的主要视觉挑战在于在采取行动之前从视觉观察中识别不同的地标3。目标是通过遵循包含空间信息的一组指令导航到目标位置。</p><p data-pid=\"HPgDqD8q\"><b>规则变体</b></p><p data-pid=\"Qfj_zcLl\">为了评估模型是否具备空间知识，或者仅仅是记忆了训练后的数据，我们考虑两种不同的动作空间配置。</p><p data-pid=\"8LxD34Pp\">第一种变体使用绝对方向动作空间，包括{北，东北，东，东南，南，西南，西，西北}。</p><p data-pid=\"IXq7jvo-\">第二种变体采用相对方向动作空间，包含{左，右，稍微左，稍微右}。这种相对配置分别将当前方向向左或向右调整 90 度或45 度。v-IRL 中导航任务的概述在图4中提供。</p><p data-pid=\"rDZ3agxK\"><b>视觉变化。</b></p><p data-pid=\"CFIs8f4E\">V-IRL 中的主要视觉挑战在于从视觉观察中识别地标(例如，图4中所示的绿色部分)。</p><p data-pid=\"8zPojeD_\">由于V-IR环境包含来自不同城市的视觉观察，我们可以通过训练模型在一个地点进行导航，然后在不同地点评估其性能来评估 V-IRL 中的视觉泛化能力。</p><p data-pid=\"Mik7VzS9\"><b>结果</b></p><figure data-size=\"normal\"><img src=\"https://pic3.zhimg.com/v2-8124a2edd75f966b92515c275a4647a8_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"889\" data-rawheight=\"432\" data-original-token=\"v2-e8df1b0af1ce7e1881eca21684297392\" class=\"origin_image zh-lightbox-thumb\" width=\"889\" data-original=\"https://pic3.zhimg.com/v2-8124a2edd75f966b92515c275a4647a8_r.jpg\"/></figure><figure data-size=\"normal\"><img src=\"https://pic3.zhimg.com/v2-4059e35fca25387efb0fdac26c80d838_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"875\" data-rawheight=\"226\" data-original-token=\"v2-fa738cf65c9cd53f295560e34d915f0a\" class=\"origin_image zh-lightbox-thumb\" width=\"875\" data-original=\"https://pic3.zhimg.com/v2-4059e35fca25387efb0fdac26c80d838_r.jpg\"/></figure><p data-pid=\"hkdqqC4v\">在本节中，我们展示了一些实验，这些实验旨在研究通过强化学习(RL)和监督微调(SFT)进行后训练所带来的泛化能力我们采用 Llama-3.2-Vision-11B 作为主干模型。</p><p data-pid=\"UR87SNfs\">遵循 RLHF 和RL4VLM 的标准流程，我们在运行 RL 之前使用 SFT 初始化模型。我们特别研究以下问题:</p><p data-pid=\"murckx_N\">SFT 或 RL 如何影响模型对不同规则的泛化能力?</p><p data-pid=\"Dje6OldZ\">当模型包含视觉组件时，RL/SFT如何影响其对不同视觉变体的泛化能力?</p><p data-pid=\"znfD-4IY\">RL/SFT如何影响视觉语言模型(VLM)中的视觉识别能力?</p><p data-pid=\"yg7Rsosv\">SFT 在 RL 训练中扮演什么角色?</p><p data-pid=\"unzP2pRW\">验证迭代次数如何影响泛化能力?</p><p data-pid=\"0LieUd6N\"><b>规则泛化</b></p><p data-pid=\"wcZeo_Y0\">我们评估了不同的后训练方法在 Generalpoints和V-IRL上的性能。这两个任务各自包含纯语言(-)和视觉语言(-V)变体，并且都包含规则的变体。</p><p data-pid=\"0InvsS8A\">对于每个任务，我们分别针对单个规则，调整 RL和 SFT的训练计算量。</p><p data-pid=\"2FVl3YuN\">在 Generalpoints任务中，分布内(ID)的情况将所有J、Q、K视为 10，而分布外(OOD)的情况则将它们分别解释为 11、12和13。</p><p data-pid=\"OEoJ-UCD\">对于V-IRL 任务，分布内(ID)的情况采用绝对方向坐标系，而分布外(OOD)的情况则使用相对方向动作空间。</p><p data-pid=\"RnEcQnOo\"><b>RL 泛化，SFT 记忆。</b></p><p data-pid=\"kVEtCVhD\">如图5所示，强化学习(RL)在所有任务上，包括单态(LLM)和多模态(VLM)，都持续提高超出分布(OOD)的性能。</p><p data-pid=\"9OtC_W0X\">具体而言，图6表明，强化学习(RL)在GP-L上实现了[+3.5%]的增长(11.5%→15.0%)，在 V-IRL-L 上实现了[+11.0%]的增长(80.8%-&gt; 91.8%)。</p><p data-pid=\"jBZ3PJ6F\">即使在 VLM 中增加了视觉识别的挑战，强化学习(RL)在 GP-VL上仍然保持了[+3.0%](11.2%→&gt;14.2%)的一致性能提升，在 v-IRL-V上则为[+9.3%](35.7%→&gt;45.0%)。</p><p data-pid=\"xOKowa-f\">相比之下，监督微调(SFT)在所有任务的所有超出分布(OOD)评估中都表现出性能下降: 在GP-L上[-8.1%](11.5%→3.4%)，在V-IR-L上-79.5%，在GP-VL上-5.6%，在V-IRL-V上[-33.2%](35.7% → 2.5%)。</p><figure data-size=\"normal\"><img src=\"https://pica.zhimg.com/v2-0e2ac915f4a3669cef3f53c185cfacc0_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"823\" data-rawheight=\"286\" data-original-token=\"v2-caf7afe6722e802da6da6753020a60c6\" class=\"origin_image zh-lightbox-thumb\" width=\"823\" data-original=\"https://pica.zhimg.com/v2-0e2ac915f4a3669cef3f53c185cfacc0_r.jpg\"/></figure><figure data-size=\"normal\"><img src=\"https://pic2.zhimg.com/v2-e2ba5bb3ff6e2d53498fa0a10784d653_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"831\" data-rawheight=\"284\" data-original-token=\"v2-6451d04e8ac4272f46b08bf5a8d7d950\" class=\"origin_image zh-lightbox-thumb\" width=\"831\" data-original=\"https://pic2.zhimg.com/v2-e2ba5bb3ff6e2d53498fa0a10784d653_r.jpg\"/></figure><h2><b>十、视觉分布外任务中的泛化</b></h2><p data-pid=\"0PbIxWLd\">强化学习(RL)在规则变化中展现出泛化能力，而监督微调(SFT)则呈现相反的趋势。</p><p data-pid=\"Bve3c5QZ\">由于视觉语言模型(VLMS)也包含视觉模态，接下来我们将研究视觉变化对分布外(OOD)泛化的影响。</p><p data-pid=\"zx38qVTH\">对于Generalpoints，我们使用黑色花色(，)训练视觉语言模型，并在红色花色(，)上测试其分布外性能。</p><p data-pid=\"8Vvz4uU6\">对于v-IR，我们使用在纽约市收集的路线数据训练模型，并在包含世界各地不同城市路线的原始v-IRL视觉语言导航(VLN)迷你基准上评估模型。请注意，本节中的实验规则保持一致。</p><p data-pid=\"fFNtVaHq\"><b>RL 在视觉 OOD 任务中展现泛化能力</b></p><figure data-size=\"normal\"><img src=\"https://pic1.zhimg.com/v2-14320287521f8c543adefeedc1334b3c_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"837\" data-rawheight=\"323\" data-original-token=\"v2-5582efc881aef8555431152d419a0099\" class=\"origin_image zh-lightbox-thumb\" width=\"837\" data-original=\"https://pic1.zhimg.com/v2-14320287521f8c543adefeedc1334b3c_r.jpg\"/></figure><p class=\"ztext-empty-paragraph\"><br/></p><p class=\"ztext-empty-paragraph\"><br/></p><figure data-size=\"normal\"><img src=\"https://pic2.zhimg.com/v2-3ee6220b0480c60351c65999eae08ad3_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"843\" data-rawheight=\"369\" data-original-token=\"v2-b4ed54df34c7707b6f2084081be4bb74\" class=\"origin_image zh-lightbox-thumb\" width=\"843\" data-original=\"https://pic2.zhimg.com/v2-3ee6220b0480c60351c65999eae08ad3_r.jpg\"/></figure><p data-pid=\"sJ4pN0Pv\">如图7 所示，我们观察到 RL仍然在视觉 OOD 任务中展现泛化能力，而 SFT的表现则持续下降。</p><p data-pid=\"hGlKS7-Y\">具体而言，在Gp-VL 和VIRL-VL 中，RL的性能提升分别为[+17.6%](23.6%→41.2%)和 [+61.1%](16.7%→77.8%)，而 SFT的性能则分别下降了-9.9% 和 -5.6%。</p><p data-pid=\"W4D_vprq\">作为这项视觉 OOD 研究的额外成果，我们还展示了我们的多轮 RL方法改进了 v-IRL 小型基准测试中的最先进结果(参见 @yang2024v的表5)，性能提升了 [+33.8%](44.0% →77.8%)。</p><p data-pid=\"eRV4s-s1\">与 V-IRL 中报告的先前最先进方法不同，该方法依赖于两阶段 VLM-LLM 协作技术以及在闭源模型上进行的定制化提示词工程，我们的端到端 RL 方法使得开源模型能够达到更优越的性能。</p><p data-pid=\"gPVCqD69\"><b>RL 提升视觉能力</b></p><p data-pid=\"WgFgsj0S\">基于上述观察，即使用 RL训练的视觉语言模型(VLM)可以泛化到视觉 OOD 任务，我们考虑一个自然的后续问题: RL 如何影响 VLM 的视觉能力？</p><p data-pid=\"mu8-2IY7\">为了研究这个问题，我们在 GP-VL 环境中进行了额外的消融研究，以调查 RL和 SFT的 OOD 性能，以及模型在识别输入图像中的4张卡片方面的视觉识别准确率。</p><p data-pid=\"znGWg_g3\">特别是，我们研究了通过 RL/SFT 扩展后训练计算如何影响基于规则的OOD 的泛化，以及视觉识别准确率和视觉 OOD)</p><p data-pid=\"0bcHxSKw\">扩展强化学习(RL)提升视觉语言模型(VLM)训练中的视觉识别准确率。</p><p data-pid=\"uz0QFq1Y\">如图8所示，我们观察到视觉语言模型的视觉识别准确率在很大程度上影响了整体性能，这与@zhong2024law中的观察结果相似。</p><p data-pid=\"G3Y1hgfS\">此外，扩展强化学习的计算量也提高了视觉识别准确率，这是其泛化能力的副产品。而扩展监督微调(SFT)则会降低视觉识别准确率和整体性能。</p><p data-pid=\"HXN4L-FL\"><b>SFT在 RL训练中的作用</b></p><p data-pid=\"2U0O8hwB\">尽管如前所述，强化学习(RL)在泛化模型的推理和视觉能力方面具有优越性，但实验流程仍然是在 SFT之后 实例化 RL。</p><p data-pid=\"G3-9ZDZD\">在本小节中，我们关注另一个关键问题:SFT对于RL训练是否是必要的?为了回答这个问题，我们进行了额外的实验，直接将端到端的 RL 应用于对基础模型 Llama3.2 进行后训练，在纯语言情况下使用 GeneralPoints。</p><figure data-size=\"normal\"><img src=\"https://pica.zhimg.com/v2-1dc843bdac16e267573fee71cfc49f36_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"710\" data-rawheight=\"353\" data-original-token=\"v2-23f0779d8dbabf8fa0ee2c7238a1eb8d\" class=\"origin_image zh-lightbox-thumb\" width=\"710\" data-original=\"https://pica.zhimg.com/v2-1dc843bdac16e267573fee71cfc49f36_r.jpg\"/></figure><p data-pid=\"pQ0T46s4\">当主干模型不遵循指令时，SFT(监督微调)对于RL(强化学习)训练是必要的。</p><p data-pid=\"37Z0XSUZ\">图2表明，如果没有 SFT，所有端到端的 RL 运行都无法取得改进。更具体地说，我们观察到，如果没有 SFT，基础模型会表现出较差的指令遵循能力。</p><p data-pid=\"ZO7B39gA\">在图9提供了一个详细的失败案例，揭示了基础 Llama-3.2-Vision-11B 模型倾向于生成冗长、离题且非结构化的响应。</p><p data-pid=\"Jv52CYuD\">这个问题使得检索任务相关的信息和用于 RL训练的奖励变得不可能。请注意，由于主干模型的差异，我们的结果与@deepseekai2025deepseekr1的结果并不矛盾，后者认为SFT对于下游 RL 训练是不必要的。</p><p data-pid=\"Q_WvD0ts\"><b>验证迭代的作用</b></p><p data-pid=\"4f-y1uOU\">验证是我们多步骤训练和评估流程中的另一个关键组成部分(参见图10)。为了验证其必要性并更好地理解其效果，我们使用 GP-L 进行了不同验证迭代次数{1,3,5,10}的强化学习实验。</p><p class=\"ztext-empty-paragraph\"><br/></p><figure data-size=\"normal\"><img src=\"https://pic3.zhimg.com/v2-a5eec1c39a0faeb307ae95b36124b2a8_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"663\" data-rawheight=\"483\" data-original-token=\"v2-56d4603daae9d1cb3f41242c542d7045\" class=\"origin_image zh-lightbox-thumb\" width=\"663\" data-original=\"https://pic3.zhimg.com/v2-a5eec1c39a0faeb307ae95b36124b2a8_r.jpg\"/></figure><p data-pid=\"TdQXI3N2\">扩大验证规模可以提高泛化能力。</p><p data-pid=\"ZliIBXlc\">在图3中，我们观察到，随着验证步骤的增加，强化学习的泛化能力表现更佳。</p><p data-pid=\"juv7OqmO\">更具体地说，在所有实验的计算预算相同的情况下，我们观察到[+2.15%]{style=&#34;color: darkgreen&#34;}(3步)[+2.99%]{style=&#34;color: darkgreen&#34;}(5步)和[+5.99%]{style=&#34;color: darkgreen&#34;}(10步)的性能提升。</p><p data-pid=\"Q4-Px_cZ\">相比之下，在仅有一个验证步骤的情况下，我们仅观察到OOD(超出分布)性能的[+0.48%]的边际提升。</p><h3>十一、AI大模型从0到精通全套学习大礼包</h3><p data-pid=\"zfpRy8mb\">我在一线互联网企业工作十余年里，指导过不少同行后辈。帮助很多人得到了学习和成长。</p><p data-pid=\"csMUzyIt\">只要你是真心想学AI大模型，我这份资料就可以无偿共享给你学习。大模型行业确实也需要更多的有志之士加入进来，我也真心希望帮助大家学好这门技术，如果日后有什么学习上的问题，欢迎找我交流，有技术上面的问题，我是很愿意去帮助大家的！<br/></p><h3><i><b>1.从入门到精通的全套视频教程</b></i></h3><p data-pid=\"gWGS3yUm\">包含提示词工程、RAG、Agent等技术点<br/></p><figure data-size=\"normal\"><img src=\"https://pica.zhimg.com/v2-e8c19b6de1afa458275cfabf1967b916_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1351\" data-rawheight=\"853\" data-original-token=\"v2-be97ce55cb438ec2ba2d3e8d2768b2d4\" class=\"origin_image zh-lightbox-thumb\" width=\"1351\" data-original=\"https://pica.zhimg.com/v2-e8c19b6de1afa458275cfabf1967b916_r.jpg\"/></figure><h3><i><b>2.AI大模型学习路线图（还有视频解说）</b></i></h3><p data-pid=\"8Sgj5NDF\">全过程AI大模型学习路线</p><figure data-size=\"normal\"><img src=\"https://pic1.zhimg.com/v2-cf4aaaf4f291b697e11b73844558fc04_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"626\" data-rawheight=\"106\" data-original-token=\"v2-3874e83f318b8577b4ac18f3d574e55e\" class=\"origin_image zh-lightbox-thumb\" width=\"626\" data-original=\"https://pic1.zhimg.com/v2-cf4aaaf4f291b697e11b73844558fc04_r.jpg\"/></figure><h3><i><b>3.学习电子书籍和技术文档</b></i></h3><p data-pid=\"-UiCTwjk\">市面上的大模型书籍确实太多了，这些是我精选出来的</p><figure data-size=\"normal\"><img src=\"https://pica.zhimg.com/v2-2ac2994e021221e3a52048d9ccb4dfc2_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"670\" data-rawheight=\"508\" data-qrcode-action=\"none\" data-original-token=\"v2-ceb93e183072d3094a6c05810ebc1904\" class=\"origin_image zh-lightbox-thumb\" width=\"670\" data-original=\"https://pica.zhimg.com/v2-2ac2994e021221e3a52048d9ccb4dfc2_r.jpg\"/></figure><h3><i><b>4.大模型面试题目详解</b></i></h3><figure data-size=\"normal\"><img src=\"https://pic2.zhimg.com/v2-1f581381d33656898a9658043575aacf_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1222\" data-rawheight=\"860\" data-original-token=\"v2-165e3ee78f5087f2fc0f2179b8c10c92\" class=\"origin_image zh-lightbox-thumb\" width=\"1222\" data-original=\"https://pic2.zhimg.com/v2-1f581381d33656898a9658043575aacf_r.jpg\"/></figure><p data-pid=\"NOZJ-WkT\"><b>【这份完整版的大模型 AI 学习资料已经打包好，朋友们如果需要可以点击下方小卡片 100%免费】 </b></p><a href=\"https://zhuanlan.zhihu.com/p/1938615489128538250\" data-draft-node=\"block\" data-draft-type=\"link-card\" class=\"internal\">2025最新AI大模型学习资料合集，允许白嫖，学完拿下大厂offer，你要悄悄努力然后惊艳所有人！</a><p></p>",
        "is_labeled": false,
        "visited_count": 25,
        "thumbnails": [
          "https://picx.zhimg.com/50/v2-993c312c2e829f01c0aebe50be52a588_720w.jpg?source=b6762063",
          "https://picx.zhimg.com/50/v2-24d8cfbc37e9ff6461e8d38f221ccddd_720w.jpg?source=b6762063",
          "https://picx.zhimg.com/50/v2-d93352c955daa04ae35d63cd5b60bed2_720w.jpg?source=b6762063",
          "https://pic1.zhimg.com/50/v2-be97ce55cb438ec2ba2d3e8d2768b2d4_720w.jpg?source=b6762063",
          "https://picx.zhimg.com/50/v2-78b16a12e1859016337520059d62b2a6_720w.jpg?source=b6762063"
        ],
        "favorite_count": 4,
        "article_type": "normal",
        "is_navigator": false,
        "navigator_vote": false,
        "vote_next_step": "vote"
      },
      "brief": "{\"source\": \"TS\", \"type\": \"article\", \"id\": 1941511071568495144}",
      "attached_info": "Cr0PCPrr7P6UlarMuwEQBxoJMjYxOTg4Mjg3IL/glcUGKAIwAEDWBEojChhUU19TT1VSQ0VfV0FSTV9VUF9CT09TVDESATAYACAAOgBKLQoiVFNfU09VUkNFX1dBUk1fVVBfSElHSF9JTlRFUkFDVElPThIBMBgAIAA6AGIgZjA3NWJiMDBjMjlmNGMzMzYyNWE1OWJiMzUxYWUwYTdyEzE5NDE1MTEwNzE1Njg0OTUxNDSqAQlyZWNvbW1lbmTCASBhZThmZDc0YmVkMWFmOGUxMTg5OGZhZDZlMDdmMjdhYfIBCggMEgZOb3JtYWzyASgIChIkNDQ2MTA2MGYtMjdiOS00YjY0LTlhYzYtODNkNzIxZjExMWEw8gEHCAsSAzEwMIICAIgCpqHN+YwzkgIgYWU4ZmQ3NGJlZDFhZjhlMTE4OThmYWQ2ZTA3ZjI3YWGaAgDKAhZTaG9ySW50ZXJlc3RXZWlnaHRSdWxlygIVVXNlckxjbkV4aXRXZWlnaHRSdWxlygIcQmF5ZXNGaXJzdExldmVsSXNvbGF0aW9uUnVsZcoCGENvbnRlbnRXYXJtVXBCcmVha0luUnVsZdoCGFRTX1NPVVJDRV9XQVJNX1VQX0JPT1NUMegCA/oCC05PUk1BTF9GTE9XigMgZGU1OWE3Yjc3M2Y5NDRmNmI0NGQwY2QxNTcyM2RiYTiaAw0KAnYyEAAaBW90aGVyqAMZ2AMA6gMedGV4dF9oaWdoX2ludGVyYWN0aW9uX3JlY2FsbGVy+gPjCRIMVU5LTk9XTl9NT0RFIAAqDU5PX0lNQUdFX01PREU6LQgEEMAHGI8DIiN2Mi1kMzg1OTZlYjAwMjJiMjc0ZjY5NzI5YzAzMDBhNmRjMTotCAQQuAgY2QYiI3YyLTE4OGVkMmM4MTY2NzBmODg3MDRiMGVmZWEwYjQ0MjYzOi0IAxC4CBiXAyIjdjItYjhlMDJkNDllMDNjOWJiYjYzYzdmZjNhMDVkYmU5YmQ6LQgCELgIGNQDIiN2Mi1hMTA2ZWQzOGI3ZmJiZGJhOTBkNjExMjcxYWIzNjhlNzotCAMQjAUYqgIiI3YyLTk5NWE5MTFiNDQxZjkwNTQyNmE0NGEyNDRiN2ViODJjOi0IBBCyBRiUBCIjdjItNjY4MzhiN2NhZDU5NzhkYjVmOGI5MTYzNTY1MGEzYTg6LQgEELwEGP4DIiN2Mi0xNGYzOTIyM2MwNTI5OGE4MjY3MWY5MGEzNzk0YmI4ZDotCAQQuAgY4gMiI3YyLTRlZDdkYWUyNzgwY2U3M2ExZmI1ODU0N2RkNjQ5NDYyOi0IAhC4CBi1AyIjdjItMjJlYTgzNDM0M2ZlN2ExNWY0ZWU1ZjA2MDUwMDQxM2Y6LQgCELgIGOUEIiN2Mi03MjQ4MDA4OWJhNjg0MzAwNjkyYWMxOTFlYzFkYjBkNzotCAIQuAgYhQciI3YyLWIyNDBhYjQzMTI4OWY4NTkwMzBkN2M1M2I2ZTRhODQxOi0IBBC4CBifBCIjdjItOTY3NWVhOTc1NDdmYWM5MzI1NTJlNTdmZTIwZDFjN2U6LAgCEN4DGGUiI3YyLTIzZDA4Nzk2ZWUxZWRiNTRlNzc2ZmZiYjVlMzEyMmQ4Oi0IAhC4CBjJCiIjdjItZDkzMzUyYzk1NWRhYTA0YWUzNWQ2M2NkNWI2MGJlZDI6LQgCEOgGGPMDIiN2Mi0zMmNjNWE2MDRjMzZjN2E0OTk5NzEwMjFjMTY3MmQ5YzotCAIQ+QYYsAMiI3YyLWU4ZGYxYjBhZjFjZTdlMTg4MWVjYTIxNjg0Mjk3MzkyOi0IAxDrBhjiASIjdjItZmE3MzhjZjY1YzljZDUzZjI5NTU2MGUzNGQ5MTVmMGE6LQgCELcGGJ4CIiN2Mi1jYWY3YWZlNjcyMmU4MDJkYTZkYTY3NTMwMjBhNjBjNjotCAIQvwYYnAIiI3YyLTY0NTFkMDRlOGFjNDI3MmY0NmIwOGJmNWE4ZDdkOTUwOi0IAhDFBhjDAiIjdjItNTU4MmVmYzg4MWFlZjg1NTU0MzExNTJkNDE5YTAwOTk6LQgCEMsGGPECIiN2Mi1iNGVkNTRkZjM0Yzc3MDdiNmYyMDg0MDgxYmU0YmI3NDotCAIQxgUY4QIiI3YyLTIzZjA3NzlkOGRiYWJmOGZhMGVlMmM3MjM4YTFlYjhkOi0IAxCXBRjjAyIjdjItNTZkNDYwM2RhYWU5ZDFjYjNmNDEyNDJjNTQyZDcwNDU6LQgCEMcKGNUGIiN2Mi1iZTk3Y2U1NWNiNDM4ZWMyYmEyZDNlOGQyNzY4YjJkNDosCAIQ8gQYaiIjdjItMzg3NGU4M2YzMThiODU3N2I0YWMxOGYzZDU3NGU1NWU6LQgCEMYJGNwGIiN2Mi0xNjVlM2VlNzhmNTA4N2YyZmMwZjIxNzliOGMxMGM5MoAEAIgEAJIEBk5vcm1hbJoEATOgBACoBACwBAC6BAJhacIEAzQwMMgEANIED+aOqOiNkOW3suabtOaWsNgEAPAEAPkEAAAAAEmZgz+BBQAAAAAAAAAAiQXAeCbtIVTZP5IFAJoFA2RmdKIFA2RmdLIFATG5BQAAAAAAAAAA0AUA4AUA6AUA8AVkkAYAoAbcBKgGAZICLgoJMjYxOTg4Mjg3EhMxOTQxNTExMDcxNTY4NDk1MTQ0GAciCklNQUdFX1RFWFQ=",
      "action_card": false
    },
    {
      "id": "599_1755822903.816",
      "type": "feed",
      "offset": 599,
      "verb": "TOPIC_ACKNOWLEDGED_ANSWER",
      "created_time": 1755822903,
      "updated_time": 1755822903,
      "target": {
        "id": "1940012061867377228",
        "type": "answer",
        "url": "https://api.zhihu.com/answers/1940012061867377228",
        "author": {
          "id": "ffb2ac771ccdb2c505ad0f08fd84cecb",
          "url": "https://api.zhihu.com/people/ffb2ac771ccdb2c505ad0f08fd84cecb",
          "user_type": "people",
          "url_token": "gao-xing-1-14",
          "name": "琼脂菌",
          "headline": "编玉子，采星花，织成华景买君夸。",
          "avatar_url": "https://pic1.zhimg.com/50/v2-e8586dc034c59627dfa5ba64346efb36_l.jpg?source=b6762063",
          "is_org": false,
          "gender": 1,
          "followers_count": 236,
          "is_following": false,
          "is_followed": false
        },
        "created_time": 1755314919,
        "updated_time": 1755314919,
        "voteup_count": 12,
        "thanks_count": 0,
        "comment_count": 5,
        "is_copyable": true,
        "question": {
          "id": "565195799",
          "type": "question",
          "url": "https://api.zhihu.com/questions/565195799",
          "author": {
            "id": "e19ecb2806b517465495f16940353153",
            "url": "https://api.zhihu.com/people/e19ecb2806b517465495f16940353153",
            "user_type": "people",
            "url_token": "taki-56-89",
            "name": "Intellijc",
            "headline": "一个热爱艺术的理工科宅宅",
            "avatar_url": "https://picx.zhimg.com/50/v2-c1accc06712414e73827dc8dc54b519b_l.jpg?source=b6762063",
            "is_org": false,
            "gender": -1,
            "followers_count": 1,
            "is_following": false,
            "is_followed": false
          },
          "title": "可以分享一下obsidian不太用折腾的美观配置和插件组合吗?",
          "created": 1667808729,
          "answer_count": 0,
          "follower_count": 0,
          "comment_count": 0,
          "bound_topic_ids": [
            3673,
            604460,
            2293832
          ],
          "is_following": false,
          "excerpt": "",
          "relationship": {
            "is_author": false
          },
          "detail": "",
          "question_type": "normal"
        },
        "thumbnail": "https://picx.zhimg.com/50/v2-09147299588d46ffa8445ec170a10177_720w.jpg?source=b6762063",
        "excerpt": "分享一个超简洁的css样式，笔记网格背景。 ▍特性 不依赖插件，所有主题通用，轻量简洁css。 自适应黑白双色，跟随主题切换。 自适应屏幕大小，多端通用。 随屏幕移动，模拟纸质效果。 ▍效果预览     ▍使用方法 1，在 `/库文件夹/.obsidian/snippets/`里新建空白.Css文件，粘贴以下文本：/* Moy-网格背景 */ /* 更新日期：2024.10.29 */ /* 原始代码来自：https://spacexcode.com/blog/pure-css-grid-line/ */ /* 亦有参考：https…",
        "excerpt_new": "分享一个超简洁的css样式，笔记网格背景。 ▍特性 不依赖插件，所有主题通用，轻量简洁css。 自适应黑白双色，跟随主题切换。 自适应屏幕大小，多端通用。 随屏幕移动，模拟纸质效果。 ▍效果预览     ▍使用方法 1，在 `/库文件夹/.obsidian/snippets/`里新建空白.Css文件，粘贴以下文本：/* Moy-网格背景 */ /* 更新日期：2024.10.29 */ /* 原始代码来自：https://spacexcode.com/blog/pure-css-grid-line/ */ /* 亦有参考：https…",
        "preview_type": "default",
        "preview_text": "",
        "reshipment_settings": "allowed",
        "content": "<p data-pid=\"TNeQqbkU\">分享一个超简洁的css样式，笔记网格背景。</p><p data-pid=\"HN3WGJni\">▍特性</p><p data-pid=\"jIL5vw0H\">不依赖插件，所有主题通用，轻量简洁css。</p><p data-pid=\"11blNBpi\">自适应黑白双色，跟随主题切换。</p><p data-pid=\"XBpFIrz9\">自适应屏幕大小，多端通用。</p><p data-pid=\"TAi8O001\">随屏幕移动，模拟纸质效果。</p><p data-pid=\"HoAJfPeF\">▍效果预览</p><figure data-size=\"normal\"><img src=\"https://pic2.zhimg.com/v2-09147299588d46ffa8445ec170a10177_1440w.jpg\" data-rawwidth=\"1280\" data-rawheight=\"2844\" data-size=\"normal\" data-original-token=\"v2-09147299588d46ffa8445ec170a10177\" data-default-watermark-src=\"https://pic1.zhimg.com/v2-de09f4910a24029e3021d259d1a18ab6_b.jpg\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://pic2.zhimg.com/v2-09147299588d46ffa8445ec170a10177_r.jpg\"/><figcaption>日间模式-网格背景预览</figcaption></figure><p class=\"ztext-empty-paragraph\"><br/></p><figure data-size=\"normal\"><img src=\"https://picx.zhimg.com/v2-b7f8b402ee095d6628ab9d9d6bef5aa1_1440w.jpg\" data-rawwidth=\"1280\" data-rawheight=\"2844\" data-size=\"normal\" data-original-token=\"v2-b7f8b402ee095d6628ab9d9d6bef5aa1\" data-default-watermark-src=\"https://pica.zhimg.com/v2-cc04b49ae7f1d31b7bb872edc1026f6e_b.jpg\" class=\"origin_image zh-lightbox-thumb\" width=\"1280\" data-original=\"https://picx.zhimg.com/v2-b7f8b402ee095d6628ab9d9d6bef5aa1_r.jpg\"/><figcaption>夜间模式-网格背景预览</figcaption></figure><p data-pid=\"L6zw_QWQ\">▍使用方法</p><p data-pid=\"mtHIHuxm\">1，在<b>`/库文件夹/.obsidian/snippets/`里新建空白.Css文件，粘贴以下文本：</b></p><div class=\"highlight\"><pre><code class=\"language-text\">/* Moy-网格背景 */\n/* 更新日期：2024.10.29 */\n\n/* 原始代码来自：https://spacexcode.com/blog/pure-css-grid-line/ */\n/* 亦有参考：https://forum-zh.obsidian.md/t/topic/37076 */\n\n/* ============================================================ */\n\n/* 2025年8月4日@阿琼： 移除点阵样式，增加背景跟随页面移动，更改从左上角开始绘图，保证方格完整性 */\n\n/* ============================================================ */\n\n/* 亮暗主题的不同配色 */\n.theme-dark {\n  --grid-line-color-1: #3d3d3f66;\n  --grid-line-color-2: #74747440;\n}\n\n.theme-light {\n  --grid-line-color-1: #c7c7c740;\n  --grid-line-color-2: #afafaf40;\n}\n\n/* 网格背景 */\n.markdown-reading-view .markdown-rendered, \n.markdown-source-view.mod-cm6 .cm-scroller,\n.grid-bg {\n  /* 网格基础样式 */\n  background-size: 20px 20px;\n  background-position: 0 0; /* 从左上角开始绘制 */\n  background-image: \n    linear-gradient(to right, var(--grid-line-color-1) 1px, transparent 1px), \n    linear-gradient(to bottom, var(--grid-line-color-2) 1px, transparent 1px);\n  \n  /* 使网格随内容滚动 */\n  background-attachment: local;\n  \n  /* 移除遮罩确保顶部第一条线可见 */\n  -webkit-mask-image: none;\n  mask-image: none;\n}\n\n/* 避免 Hover Editor 里奇怪的异常表现 */\n.popover .grid-bg {\n  background-attachment: scroll;\n}\n\n/* ============================================================ */</code></pre></div><p data-pid=\"aCpwzbJk\">2，打开obsidian，设置-&gt;外观-&gt;css代码片段，勾选建立的css文件样式。</p><figure data-size=\"normal\"><img src=\"https://picx.zhimg.com/v2-10595cfbdae3627f3adc212ef037e869_1440w.jpg\" data-rawwidth=\"1440\" data-rawheight=\"3200\" data-size=\"normal\" data-original-token=\"v2-10595cfbdae3627f3adc212ef037e869\" data-default-watermark-src=\"https://pic2.zhimg.com/v2-4245806d1ff329fe54a724622c6dce37_b.jpg\" class=\"origin_image zh-lightbox-thumb\" width=\"1440\" data-original=\"https://picx.zhimg.com/v2-10595cfbdae3627f3adc212ef037e869_r.jpg\"/></figure><p data-pid=\"kgaOBWmb\">以上。</p>",
        "relationship": {
          "is_thanked": false,
          "is_nothelp": false,
          "voting": 0
        },
        "is_labeled": false,
        "visited_count": 710,
        "thumbnails": [
          "https://pic1.zhimg.com/50/v2-09147299588d46ffa8445ec170a10177_720w.jpg?source=b6762063",
          "https://picx.zhimg.com/50/v2-b7f8b402ee095d6628ab9d9d6bef5aa1_720w.jpg?source=b6762063",
          "https://pic1.zhimg.com/50/v2-10595cfbdae3627f3adc212ef037e869_720w.jpg?source=b6762063"
        ],
        "favorite_count": 19,
        "answer_type": "normal",
        "is_navigator": false,
        "navigator_vote": false,
        "vote_next_step": "vote"
      },
      "brief": "{\"source\": \"TS\", \"type\": \"answer\", \"id\": 1940012061867377228}",
      "attached_info": "CukGCPrr7P6UlarMuwEQBBoJNzQyNDU1ODc4IOf1/8QGKAwwBUDXBEpCCi1UU19TT1VSQ0VfVFdPVE9XRVJfTVVMVElfU0NFTkVfVjFfUkVDQUxMX1RFWFQSATAYACAAOgp7InJhdyI6IiJ9Wgg4Nzg4MDk3MGIgZjA3NWJiMDBjMjlmNGMzMzYyNWE1OWJiMzUxYWUwYTdyEzE5NDAwMTIwNjE4NjczNzcyMjiKAQk1NjUxOTU3OTmqAQlyZWNvbW1lbmTCASBmZmIyYWM3NzFjY2RiMmM1MDVhZDBmMDhmZDg0Y2VjYvIBCggMEgZOb3JtYWzyASgIChIkMGNkYWMwNGYtYjY3Ni00ZDY2LThhOTYtYjBiOTUzYmRjZTEz8gEHCAsSAzEwMIICAIgCpqHN+YwzkgIgZmZiMmFjNzcxY2NkYjJjNTA1YWQwZjA4ZmQ4NGNlY2KaAgDKAhZTaG9ySW50ZXJlc3RXZWlnaHRSdWxlygIVVXNlckxjbkV4aXRXZWlnaHRSdWxl2gItVFNfU09VUkNFX1RXT1RPV0VSX01VTFRJX1NDRU5FX1YxX1JFQ0FMTF9URVhU6AID+gILTk9STUFMX0ZMT1eKAyBkZTU5YTdiNzczZjk0NGY2YjQ0ZDBjZDE1NzIzZGJhOJoDDQoCdjIQABoFb3RoZXKoA8YF2AMA6gMfdGV4dEZlZWRUd29Ub3dlcldhcm11cFN1Y2Nlc3NWMfoDrAESDFVOS05PV05fTU9ERSAAKg1OT19JTUFHRV9NT0RFOi0IAhCAChicFiIjdjItMDkxNDcyOTk1ODhkNDZmZmE4NDQ1ZWMxNzBhMTAxNzc6LQgCEIAKGJwWIiN2Mi1iN2Y4YjQwMmVlMDk1ZDY2MjhhYjlkOWQ2YmVmNWFhMTotCAIQoAsYgBkiI3YyLTEwNTk1Y2ZiZGFlMzYyN2YzYWRjMjEyZWYwMzdlODY5gAQAiAQAkgQGTm9ybWFsmgQBM6AEAKgEALAEALoEAmFpwgQDNDAwyAQA0gQP5o6o6I2Q5bey5pu05paw2AQA8AQA+QQAAADgda+QP4EFAAAAAAAAAACJBcB4Ju0hVNk/kgUAmgUDZGZ0ogUDZGZ0sgUBMbkFAAAAAAAAAADQBQDgBQDoBQDwBWSQBgCgBt0EqAYAkgIuCgk3NDI0NTU4NzgSEzE5NDAwMTIwNjE4NjczNzcyMjgYBCIKSU1BR0VfVEVYVA==",
      "action_card": false
    }
  ],
  "paging": {
    "is_end": false,
    "is_start": false,
    "next": "https://www.zhihu.com/api/v3/feed/topstory/recommend?action=down&ad_interval=-10&after_id=599&desktop=true&end_offset=605&page_number=101&session_token=f075bb00c29f4c33625a59bb351ae0a7",
    "previous": "https://www.zhihu.com/api/v3/feed/topstory/recommend?action=pull&ad_interval=-10&before_id=599&desktop=true&end_offset=605&page_number=101&session_token=f075bb00c29f4c33625a59bb351ae0a7",
    "totals": 0
  },
  "fresh_text": "推荐已更新"
}