{
  "data": [
    {
      "id": "432_1755822710.290",
      "type": "feed",
      "offset": 432,
      "verb": "TOPIC_ACKNOWLEDGED_ANSWER",
      "created_time": 1755822710,
      "updated_time": 1755822710,
      "target": {
        "id": "1917705752879015121",
        "type": "answer",
        "url": "https://api.zhihu.com/answers/1917705752879015121",
        "author": {
          "id": "d400f97b7b0fbcf541a506ecbafc18a1",
          "url": "https://api.zhihu.com/people/d400f97b7b0fbcf541a506ecbafc18a1",
          "user_type": "people",
          "url_token": "ac9kcq",
          "name": "明君",
          "headline": "互联网10+年|大厂码农|逆向专家",
          "avatar_url": "https://picx.zhimg.com/50/v2-e11c679802f8c472e77a017fd2eed592_l.jpg?source=b6762063",
          "is_org": false,
          "gender": 1,
          "followers_count": 564,
          "is_following": false,
          "is_followed": false
        },
        "created_time": 1749996680,
        "updated_time": 1749996680,
        "voteup_count": 19,
        "thanks_count": 1,
        "comment_count": 7,
        "is_copyable": true,
        "question": {
          "id": "582771512",
          "type": "question",
          "url": "https://api.zhihu.com/questions/582771512",
          "author": {
            "id": "1378c9fda7ce6a9fa5535dd4f7cb84d3",
            "url": "https://api.zhihu.com/people/1378c9fda7ce6a9fa5535dd4f7cb84d3",
            "user_type": "people",
            "url_token": "80-83-51-16",
            "name": "昆虞耕者",
            "headline": "",
            "avatar_url": "https://picx.zhimg.com/50/v2-abed1a8c04700ba7d72b45195223e0ff_l.jpg?source=b6762063",
            "is_org": false,
            "gender": 0,
            "followers_count": 22,
            "is_following": false,
            "is_followed": false
          },
          "title": "独立开发者都使用了哪些技术栈？",
          "created": 1675830600,
          "answer_count": 0,
          "follower_count": 0,
          "comment_count": 3,
          "bound_topic_ids": [
            1772,
            5531,
            163718
          ],
          "is_following": false,
          "excerpt": "",
          "relationship": {
            "is_author": false
          },
          "detail": "",
          "question_type": "normal"
        },
        "thumbnail": "https://picx.zhimg.com/50/v2-2b7891bd5b5a9875a7a79ddbe30a7749_720w.jpg?source=b6762063",
        "excerpt": "Android逆向独立开发者，从业10+年。 先来看这个领域的业务栈，再看其背后的技术栈。 【Android逆向业务栈 - 冰山一角咯】：爬虫&自动化 - 数据采集、RPA自动化工具 流量运营业务 - 社交平台运营、流量获取 薅羊毛&优惠券 - 福利活动参与、激励任务抢单抢票 - 本地生活抢单、票务抢购马甲包业务 - 广告变现、隐藏功能实现 海外运营工具 - 海外APP协议破解、群控系统游戏相关 - 游戏修改、辅助外挂其他技术服务 - 专项技术、竞品…",
        "excerpt_new": "Android逆向独立开发者，从业10+年。 先来看这个领域的业务栈，再看其背后的技术栈。 【Android逆向业务栈 - 冰山一角咯】：爬虫&自动化 - 数据采集、RPA自动化工具 流量运营业务 - 社交平台运营、流量获取 薅羊毛&优惠券 - 福利活动参与、激励任务抢单抢票 - 本地生活抢单、票务抢购马甲包业务 - 广告变现、隐藏功能实现 海外运营工具 - 海外APP协议破解、群控系统游戏相关 - 游戏修改、辅助外挂其他技术服务 - 专项技术、竞品…",
        "preview_type": "default",
        "preview_text": "",
        "reshipment_settings": "allowed",
        "content": "<p data-pid=\"Fx270Lqk\">Android逆向独立开发者，从业10+年。</p><p data-pid=\"y8j5oOrP\">先来看这个领域的业务栈，再看其背后的技术栈。</p><p data-pid=\"Er1wpXOW\"><i>【</i>Android逆向<i>业务栈 - 冰山一角咯】</i>：</p><ul><li data-pid=\"ZmHvyauO\"><b>爬虫&amp;自动化</b> - 数据采集、RPA自动化工具</li><li data-pid=\"_viCSTun\"><b> 流量运营业务</b> - 社交平台运营、流量获取</li><li data-pid=\"AOF-Q81o\"><b> 薅羊毛&amp;优惠券</b> - 福利活动参与、激励任务</li><li data-pid=\"uMw4gpnQ\"><b>抢单抢票</b> - 本地生活抢单、票务抢购</li><li data-pid=\"77uJ1qxk\"><b>马甲包业务</b> - 广告变现、隐藏功能实现</li><li data-pid=\"LqYdJt9D\"><b> 海外运营工具</b> - 海外APP协议破解、群控系统</li><li data-pid=\"w4n1DiE3\"><b>游戏相关</b> - 游戏修改、辅助外挂</li><li data-pid=\"Iygog1XU\"><b>其他技术服务</b> - 专项技术、竞品分析，SDK破解服务</li></ul><figure data-size=\"normal\"><img src=\"https://pic4.zhimg.com/v2-9e5f955d25178876e56c79630aefb73f_1440w.jpg\" data-size=\"normal\" data-rawwidth=\"1341\" data-rawheight=\"1021\" data-original-token=\"v2-1f5f4a0536484e4e33d4da20485e228e\" data-default-watermark-src=\"https://picx.zhimg.com/v2-6ff1d0be64e452119a3034c97ab2635d_b.jpg\" class=\"origin_image zh-lightbox-thumb\" width=\"1341\" data-original=\"https://pic4.zhimg.com/v2-9e5f955d25178876e56c79630aefb73f_r.jpg\"/><figcaption>Android逆向业务栈(放大看)</figcaption></figure><p data-pid=\"i1Ou2wU6\"><i>【</i>Android逆向<i>技术栈-真正的靠技术吃饭】：</i></p><ul><li data-pid=\"3e8jWXl7\"><b>编译语言</b> - Java/Kotlin、C/C++、JNI、汇编等</li><li data-pid=\"Oy_kJzoI\"><b>反编译工具</b> - IDA Pro、Ghidra、JADX、ApkTool等</li><li data-pid=\"tCzd2xx2\"><b>协议&amp;算法</b> - 网络协议、加密算法、数据格式</li><li data-pid=\"omYD3Ttx\"><b>混淆加固</b> - 代码混淆、VMP、OLLVM等保护技术</li><li data-pid=\"WiKPMnR5\"><b>静态分析</b> - 文件结构、APK/DEX/SO分析</li><li data-pid=\"1KLB-hmQ\"><b>动态分析</b> - 内存分析、调试、Trace技术</li><li data-pid=\"4Sq-oe1u\"><b>三方框架</b> - Frida、Xposed、Unicorn等</li><li data-pid=\"hbS8qQtN\"><b>操作系统</b> - Linux/Android系统机制</li><li data-pid=\"Kbu0ry5H\"><b>抓包工具</b> - Charles、Wireshark等网络分析工具</li><li data-pid=\"I93xg4wz\"><b>对抗技术</b> - 反调试、环境检测、防护绕过</li></ul><figure data-size=\"normal\"><img src=\"https://pic4.zhimg.com/v2-e7fa51ad7b3ce621a15f455a9b224a9b_1440w.jpg\" data-size=\"normal\" data-rawwidth=\"1347\" data-rawheight=\"896\" data-original-token=\"v2-8cc2b20ff4436bc73760403cb48fa2e8\" data-default-watermark-src=\"https://pic2.zhimg.com/v2-f0090c6fd7bbc59f3e2dc843d5a67183_b.jpg\" class=\"origin_image zh-lightbox-thumb\" width=\"1347\" data-original=\"https://pic4.zhimg.com/v2-e7fa51ad7b3ce621a15f455a9b224a9b_r.jpg\"/><figcaption>Android逆向技术栈(放大看)</figcaption></figure><p data-pid=\"EbK5YF3P\">可以说，逆向开发者们都是靠真刀真枪才能混到饭吃的~</p>",
        "relationship": {
          "is_thanked": false,
          "is_nothelp": false,
          "voting": 0
        },
        "is_labeled": false,
        "visited_count": 1674,
        "thumbnails": [
          "https://picx.zhimg.com/50/v2-2b7891bd5b5a9875a7a79ddbe30a7749_720w.jpg?source=b6762063",
          "https://picx.zhimg.com/50/v2-3049f0dce938cf69076e550b974147ce_720w.jpg?source=b6762063"
        ],
        "favorite_count": 39,
        "answer_type": "normal",
        "is_navigator": false,
        "navigator_vote": false,
        "vote_next_step": "vote"
      },
      "brief": "{\"source\": \"TS\", \"type\": \"answer\", \"id\": 1917705752879015121}",
      "attached_info": "CtAGCLORnKmrzqKuiwEQBBoJNzMyMzU5NDc3IIipu8IGKBMwB0CwA0ooCh1UU19TT1VSQ0VfTkVBUkxJTkVfQ09OVEVOVF9WMhIBMBgAIAA6AEowCgZJdGVtQ0YSIGRvY190eXBlOiBRdWVzdGlvbgppZDogNjAwMDU2MDUKGAAgADoAWgg5MTc4NjI0OGIgZjA3NWJiMDBjMjlmNGMzMzYyNWE1OWJiMzUxYWUwYTdyEzE5MTc3MDU3NTI4NzkwMTUxMjGKAQk1ODI3NzE1MTKqAQlyZWNvbW1lbmTCASBkNDAwZjk3YjdiMGZiY2Y1NDFhNTA2ZWNiYWZjMThhMfIBCggMEgZOb3JtYWzyASgIChIkZWM2YzFjMjMtNjgyMC00NTUxLWI2YzktYzllNTczNjFlMGUz8gEGCAsSAjczggIAiALMvMH5jDOSAiBkNDAwZjk3YjdiMGZiY2Y1NDFhNTA2ZWNiYWZjMThhMZoCAMoCFlNob3JJbnRlcmVzdFdlaWdodFJ1bGXKAhVVc2VyTGNuRXhpdFdlaWdodFJ1bGXKAhdUZXN0ZWRBbmRXb3JrV2VpZ2h0UnVsZcoCFVF1ZXN0aW9uSXNvbGF0aW9uUnVsZdoCHVRTX1NPVVJDRV9ORUFSTElORV9DT05URU5UX1Yy6AIC+gILTk9STUFMX0ZMT1eKAyA1M2QyZGUxYjRjNzA0NmMzYWZkYjhhODNhNmUxMzQzNpoDDQoCdjIQABoFb3RoZXKoA4oN2AMA+gN9EgxVTktOT1dOX01PREUgACoNTk9fSU1BR0VfTU9ERTotCAQQvQoY/QciI3YyLTFmNWY0YTA1MzY0ODRlNGUzM2Q0ZGEyMDQ4NWUyMjhlOi0IAhDDChiAByIjdjItOGNjMmIyMGZmNDQzNmJjNzM3NjA0MDNjYjQ4ZmEyZTiABACIBACSBAZOb3JtYWyaBAEyoAQAqAQAsAQAugQCYWnCBAM0MDDIBADSBA/mjqjojZDlt7Lmm7TmlrDYBADwBAD5BAAAAIBF4ag/gQUAAAAAAAAAAIkF4OtG7NRU2T+SBQCaBQNkZnSiBQNkZnSyBQExuQUAAAAAAAAAANAFAOAFAOgFAPAFSZAGAKAGtAOoBgGSAi4KCTczMjM1OTQ3NxITMTkxNzcwNTc1Mjg3OTAxNTEyMRgEIgpJTUFHRV9URVhU",
      "action_card": false
    },
    {
      "id": "433_1755822710.142",
      "type": "feed",
      "offset": 433,
      "verb": "TOPIC_ACKNOWLEDGED_ANSWER",
      "created_time": 1755822710,
      "updated_time": 1755822710,
      "target": {
        "id": "1938734767030904575",
        "type": "answer",
        "url": "https://api.zhihu.com/answers/1938734767030904575",
        "author": {
          "id": "9f5f259d3c040c56d0a733ba7cdb856f",
          "url": "https://api.zhihu.com/people/9f5f259d3c040c56d0a733ba7cdb856f",
          "user_type": "people",
          "url_token": "yu-zhou-87-39-30",
          "name": "伃舟",
          "headline": "想要看你评论留言～",
          "avatar_url": "https://pic1.zhimg.com/50/v2-76c9685c9790ef4b2bc20ba0067e0a7a_l.jpg?source=b6762063",
          "is_org": false,
          "gender": 0,
          "followers_count": 286,
          "is_following": false,
          "is_followed": false
        },
        "created_time": 1755010388,
        "updated_time": 1755010555,
        "voteup_count": 440,
        "thanks_count": 25,
        "comment_count": 30,
        "is_copyable": true,
        "question": {
          "id": "530822862",
          "type": "question",
          "url": "https://api.zhihu.com/questions/530822862",
          "author": {
            "id": "",
            "url": "",
            "user_type": "people",
            "url_token": "",
            "name": "匿名用户",
            "headline": "",
            "avatar_url": "https://picx.zhimg.com/v2-d41c2ceaed8f51999522f903672a521f_l.jpg?source=b6762063",
            "is_org": false,
            "gender": -1,
            "followers_count": 0,
            "is_following": false,
            "is_followed": false
          },
          "title": "一个极简到极致的人是什么样？",
          "created": 1651328699,
          "answer_count": 0,
          "follower_count": 0,
          "comment_count": 2,
          "bound_topic_ids": [
            11707,
            62955,
            161108
          ],
          "is_following": false,
          "excerpt": "",
          "relationship": {
            "is_author": false
          },
          "detail": "",
          "question_type": "normal"
        },
        "excerpt": "1. 生活主线非常明确 。 比如给自己三年时间考试，争取考入体制内，这三年稳当发展，杜绝社交和娱乐开支，一切为考试服务 。 考上之后了 也会思考自己的生活主线，比如给自己三个月时间恢复身材，给自己一个月时间找到某个不为名利的爱好 ，生活有盼头 ，有目标。 2. 人际关系极简，断舍离掉了身边的血包，以及负面的磁场环境，只和正向的，能滋养自己的人共事和生活。记住，很多时候，仅仅是因为不合适，并不是你自己人不好。另…",
        "excerpt_new": "1. 生活主线非常明确 。 比如给自己三年时间考试，争取考入体制内，这三年稳当发展，杜绝社交和娱乐开支，一切为考试服务 。 考上之后了 也会思考自己的生活主线，比如给自己三个月时间恢复身材，给自己一个月时间找到某个不为名利的爱好 ，生活有盼头 ，有目标。 2. 人际关系极简，断舍离掉了身边的血包，以及负面的磁场环境，只和正向的，能滋养自己的人共事和生活。记住，很多时候，仅仅是因为不合适，并不是你自己人不好。另…",
        "preview_type": "default",
        "preview_text": "",
        "reshipment_settings": "allowed",
        "content": "<p data-pid=\"sVPgVcJN\">1. 生活主线非常明确 。 比如给自己三年时间考试，争取考入体制内，这三年稳当发展，杜绝社交和娱乐开支，一切为考试服务 。 考上之后了 也会思考自己的生活主线，比如给自己三个月时间恢复身材，给自己一个月时间找到某个不为名利的爱好 ，生活有盼头 ，有目标。</p><p data-pid=\"WvzrNvu2\">2. 人际关系极简，断舍离掉了身边的血包，以及负面的磁场环境，只和正向的，能滋养自己的人共事和生活。记住，很多时候，仅仅是因为不合适，并不是你自己人不好。另外在工作中，直接说话 ，当面说话，一分钟之内说清楚问题，领导要的就是复杂问题简单化，直击重点，釜底抽薪，给出结果方案，批准之后立刻行动。</p><p data-pid=\"oR5VMJGU\">3.饮食极简。单位每个月饭卡稳定打钱，每个月1号卡里的钱就会稳定增加 ，就吃食堂，挺方便的，每天都有一个水果，其他的零食一概不吃，想吃的零食我一定放进抽屉囤起来，回去给我老弟吃。一定要戒零食。</p><p data-pid=\"M9eft3x1\">4.衣服极简。 少买衣服 ，十套八套就足够了。虽然我咸鱼出了好多，但是真的 消费主义盛行的时候我买了好多衣服，现在依旧在消耗。数了一下 大概有60多件，争取极简留30件即可。</p><p></p>",
        "relationship": {
          "is_thanked": false,
          "is_nothelp": false,
          "voting": 0
        },
        "is_labeled": false,
        "visited_count": 44563,
        "favorite_count": 601,
        "answer_type": "normal",
        "is_navigator": false,
        "navigator_vote": false,
        "vote_next_step": "vote"
      },
      "brief": "{\"source\": \"TS\", \"type\": \"answer\", \"id\": 1938734767030904575}",
      "attached_info": "CvcFCLORnKmrzqKuiwEQBBoJNzQxODgzMDE1INSq7cQGKLgDMB5AsQNKKAodVFNfU09VUkNFX05FQVJMSU5FX0NPTlRFTlRfVjISATAYACAAOgBKMAobVFNfU09VUkNFX0JBU0lDX0lORk9fUkVDQUxMEgEwGAAgADoKeyJyYXciOiIifVoIODAyNDI4NzhiIGYwNzViYjAwYzI5ZjRjMzM2MjVhNTliYjM1MWFlMGE3chMxOTM4NzM0NzY3MDMwOTA0NTc1igEJNTMwODIyODYyqgEJcmVjb21tZW5kwgEgOWY1ZjI1OWQzYzA0MGM1NmQwYTczM2JhN2NkYjg1NmbyAQoIDBIGTm9ybWFs8gEoCAoSJDA0MDljNjhiLTBkMjItNDMzNy04OTljLTZhZTgwMjhiY2ZhMfIBBggLEgI3M4ICAIgCzLzB+YwzkgIgOWY1ZjI1OWQzYzA0MGM1NmQwYTczM2JhN2NkYjg1NmaaAgDKAhZTaG9ySW50ZXJlc3RXZWlnaHRSdWxlygIWUmV2aXNpdFZhbHVlV2VpZ2h0UnVsZcoCFVVzZXJMY25FeGl0V2VpZ2h0UnVsZcoCFVF1ZXN0aW9uSXNvbGF0aW9uUnVsZdoCHVRTX1NPVVJDRV9ORUFSTElORV9DT05URU5UX1Yy6AIC+gILTk9STUFMX0ZMT1eKAyA1M2QyZGUxYjRjNzA0NmMzYWZkYjhhODNhNmUxMzQzNpoDDQoCdjIQABoFb3RoZXKoA5PcAtgDAPoDHxIMVU5LTk9XTl9NT0RFIAAqDU5PX0lNQUdFX01PREWABACIBACSBAZOb3JtYWyaBAEyoAQAqAQAsAQAugQGbWFudWFswgQDMTU5yAQA0gQP5o6o6I2Q5bey5pu05paw2AQA8AQA+QQAAAAg+h2sP4EFAAAAAAAAAACJBeDrRuzUVNk/kgUAmgUDZGZ0ogUDZGZ0sgUBMbkFAAAAAAAAAADQBQDgBQDoBQDwBUmQBgCgBrUDqAYDkgIuCgk3NDE4ODMwMTUSEzE5Mzg3MzQ3NjcwMzA5MDQ1NzUYBCIKSU1BR0VfVEVYVA==",
      "action_card": false
    },
    {
      "id": "434_1755822710.83",
      "type": "feed",
      "offset": 434,
      "verb": "TOPIC_ACKNOWLEDGED_ANSWER",
      "created_time": 1755822710,
      "updated_time": 1755822710,
      "target": {
        "id": "1939918537171903951",
        "type": "answer",
        "url": "https://api.zhihu.com/answers/1939918537171903951",
        "author": {
          "id": "03a862179ce2e17d20e0782870c4d2bf",
          "url": "https://api.zhihu.com/people/03a862179ce2e17d20e0782870c4d2bf",
          "user_type": "people",
          "url_token": "yu-han-qing-50",
          "name": "爱卿平身",
          "headline": "爱讲故事的爱卿",
          "avatar_url": "https://picx.zhimg.com/50/c8216bc72f065f2325696166d06d70f3_l.jpg?source=b6762063",
          "is_org": false,
          "gender": 1,
          "followers_count": 197,
          "is_following": false,
          "is_followed": false
        },
        "created_time": 1755292621,
        "updated_time": 1755602057,
        "voteup_count": 908,
        "thanks_count": 20,
        "comment_count": 64,
        "is_copyable": false,
        "question": {
          "id": "486759965",
          "type": "question",
          "url": "https://api.zhihu.com/questions/486759965",
          "author": {
            "id": "33b909ceb79fde4d234bab64be581bc8",
            "url": "https://api.zhihu.com/people/33b909ceb79fde4d234bab64be581bc8",
            "user_type": "people",
            "url_token": "tian-qi-yu-bao-27-52",
            "name": "笒忙",
            "headline": "可怜可怜我吧，给我转些钱",
            "avatar_url": "https://picx.zhimg.com/50/v2-ddb5e08c9593df3dd5df28710f1b8494_l.jpg?source=b6762063",
            "is_org": false,
            "gender": 1,
            "followers_count": 361,
            "is_following": false,
            "is_followed": false
          },
          "title": "为什么老实人就不能学学渣男的前期呢？",
          "created": 1631595557,
          "answer_count": 0,
          "follower_count": 0,
          "comment_count": 176,
          "bound_topic_ids": [
            740,
            114819,
            88206,
            1405311,
            2258808
          ],
          "is_following": false,
          "excerpt": "",
          "relationship": {
            "is_author": false
          },
          "detail": "",
          "question_type": "normal"
        },
        "excerpt": "问：为什么希特勒执政后，德国能一扫一战阴霾，无视凡尔赛条约，迅速实现经济腾飞？ 答：因为贷款给的比条约要赔的都多。 问：为什么其他国家不能学学德国前期，然后安安心心发展。 答：因为贷款要还的，根本不敢借。 问：为什么德国不能收收心，和平发展？ 答：因为贷款根本还不起，不是不想收心，而是不能收心。 问：为什么还不起德国也敢借？ 答：因为他一开始就不准备还。",
        "excerpt_new": "问：为什么希特勒执政后，德国能一扫一战阴霾，无视凡尔赛条约，迅速实现经济腾飞？ 答：因为贷款给的比条约要赔的都多。 问：为什么其他国家不能学学德国前期，然后安安心心发展。 答：因为贷款要还的，根本不敢借。 问：为什么德国不能收收心，和平发展？ 答：因为贷款根本还不起，不是不想收心，而是不能收心。 问：为什么还不起德国也敢借？ 答：因为他一开始就不准备还。",
        "preview_type": "default",
        "preview_text": "",
        "reshipment_settings": "disallowed",
        "content": "<p data-pid=\"zXosrWLU\">问：为什么希特勒执政后，德国能一扫一战阴霾，无视凡尔赛条约，迅速实现经济腾飞？</p><p data-pid=\"d22Do0VA\">答：因为贷款给的比条约要赔的都多。</p><p data-pid=\"7EyF9Q17\">问：为什么其他国家不能学学德国前期，然后安安心心发展。</p><p data-pid=\"0mh8V31Z\">答：因为贷款要还的，根本不敢借。</p><p data-pid=\"nImGu3wE\">问：为什么德国不能收收心，和平发展？</p><p data-pid=\"ki12jJdh\">答：因为贷款根本还不起，不是不想收心，而是不能收心。</p><p data-pid=\"Y0xqeiiQ\">问：为什么还不起德国也敢借？</p><p data-pid=\"3RMb6c6u\">答：因为他一开始就不准备还。</p>",
        "relationship": {
          "is_thanked": false,
          "is_nothelp": false,
          "voting": 0
        },
        "is_labeled": false,
        "visited_count": 39674,
        "favorite_count": 81,
        "answer_type": "normal",
        "is_navigator": false,
        "navigator_vote": false,
        "vote_next_step": "vote"
      },
      "brief": "{\"source\": \"TS\", \"type\": \"answer\", \"id\": 1939918537171903951}",
      "attached_info": "CtkFCLORnKmrzqKuiwEQBBoJNzQyNDIwNTcwIM3H/sQGKIwHMEBAsgNKKAodVFNfU09VUkNFX05FQVJMSU5FX0NPTlRFTlRfVjISATAYACAAOgBKKwoWVFNfU09VUkNFX0ZFRURSRV9NU19WMhIBMBgAIAA6CnsicmF3IjoiIn1aCDcwNDUwMzUzYiBmMDc1YmIwMGMyOWY0YzMzNjI1YTU5YmIzNTFhZTBhN3ITMTkzOTkxODUzNzE3MTkwMzk1MYoBCTQ4Njc1OTk2NaoBCXJlY29tbWVuZMIBIDAzYTg2MjE3OWNlMmUxN2QyMGUwNzgyODcwYzRkMmJm8gEKCAwSBk5vcm1hbPIBKAgKEiRmNDBmNTVhNi1hNjQwLTQ2OTMtOGM0OS1lM2RmYzE1NTA0YjDyAQYICxICNzOCAgCIAsy8wfmMM5ICIDAzYTg2MjE3OWNlMmUxN2QyMGUwNzgyODcwYzRkMmJmmgIAygIWU2hvckludGVyZXN0V2VpZ2h0UnVsZcoCFVVzZXJMY25FeGl0V2VpZ2h0UnVsZcoCFVF1ZXN0aW9uSXNvbGF0aW9uUnVsZdoCHVRTX1NPVVJDRV9ORUFSTElORV9DT05URU5UX1Yy6AIC+gILTk9STUFMX0ZMT1eKAyA1M2QyZGUxYjRjNzA0NmMzYWZkYjhhODNhNmUxMzQzNpoDDQoCdjIQABoFb3RoZXKoA/q1AtgDAPoDHxIMVU5LTk9XTl9NT0RFIAAqDU5PX0lNQUdFX01PREWABACIBACSBAZOb3JtYWyaBAEyoAQAqAQAsAQAugQGbWFudWFswgQDMTU5yAQA0gQP5o6o6I2Q5bey5pu05paw2AQA8AQA+QQAAACAFmW4P4EFAAAAAAAAAACJBeDrRuzUVNk/kgUAmgUDZGZ0ogUDZGZ0sgUBMbkFAAAAAAAAAADQBQDgBQDoBQDwBUmQBgCgBrYDqAYAkgIuCgk3NDI0MjA1NzASEzE5Mzk5MTg1MzcxNzE5MDM5NTEYBCIKSU1BR0VfVEVYVA==",
      "action_card": false
    },
    {
      "id": "435_1755822710.302",
      "type": "feed",
      "offset": 435,
      "verb": "TOPIC_ACKNOWLEDGED_ARTICLE",
      "created_time": 1755822710,
      "updated_time": 1755822710,
      "target": {
        "id": "1924420373912462774",
        "type": "article",
        "url": "https://api.zhihu.com/articles/1924420373912462774",
        "author": {
          "id": "4c9692e51fdf986477f334bef2ff9bcf",
          "url": "https://api.zhihu.com/people/4c9692e51fdf986477f334bef2ff9bcf",
          "user_type": "people",
          "url_token": "mkuruike",
          "name": "实战思维导图",
          "headline": "点亮自己，照亮他人！",
          "avatar_url": "https://pic1.zhimg.com/50/v2-2d9af15bf20d5e3ed0ba558066110d53_l.jpg?source=b6762063",
          "is_org": false,
          "gender": 1,
          "followers_count": 63,
          "is_following": false,
          "is_followed": false
        },
        "title": "读 100 本不如吃透 1 本！曾国藩私藏的 4 个读书方法，难怪古人能成大师",
        "comment_permission": "all",
        "created": 1751625149,
        "updated": 1751625149,
        "voteup_count": 31,
        "voting": 0,
        "comment_count": 2,
        "linkbox": {
          "category": "",
          "pic": "",
          "title": "",
          "url": ""
        },
        "excerpt": "很多人读书像撒芝麻，贪多求快却浅尝辄止。曾国藩早就点破真相：&#34;挖 200 口浅井，不如深挖 2 口百米深井。&#34; 这 4 种被古人验证过的读书法，能让你的学习效率暴涨 10 倍 ——   一、精读 1 本＞泛读 100 本的核心法则：挖井读书法狠招精髓：锁定 1 本书死磕到底，拒绝「书架收藏癖」 反常识案例：有人每年列 50 本读书计划，最后本本只翻前 30 页；而钱钟书读《管锥编》时，同一本书批注修改 12 次，终成学术泰斗 实操步骤： ① 每…",
        "excerpt_new": "很多人读书像撒芝麻，贪多求快却浅尝辄止。曾国藩早就点破真相：&#34;挖 200 口浅井，不如深挖 2 口百米深井。&#34; 这 4 种被古人验证过的读书法，能让你的学习效率暴涨 10 倍 ——   一、精读 1 本＞泛读 100 本的核心法则：挖井读书法狠招精髓：锁定 1 本书死磕到底，拒绝「书架收藏癖」 反常识案例：有人每年列 50 本读书计划，最后本本只翻前 30 页；而钱钟书读《管锥编》时，同一本书批注修改 12 次，终成学术泰斗 实操步骤： ① 每…",
        "preview_type": "default",
        "preview_text": "",
        "content": "<p data-pid=\"An6hkJfc\">很多人读书像撒芝麻，贪多求快却浅尝辄止。曾国藩早就点破真相：&#34;挖 200 口浅井，不如深挖 2 口百米深井。&#34; </p><p data-pid=\"apdZCsRX\">这 4 种被古人验证过的读书法，能让你的学习效率暴涨 10 倍 ——</p><p class=\"ztext-empty-paragraph\"><br/></p><figure data-size=\"normal\"><img src=\"https://pic2.zhimg.com/v2-911228ff2e7b35f241ffc6aeca334b07_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1024\" data-rawheight=\"974\" data-original-token=\"v2-d55869d651a0a4483d4466a1951ae6d0\" class=\"origin_image zh-lightbox-thumb\" width=\"1024\" data-original=\"https://pic2.zhimg.com/v2-911228ff2e7b35f241ffc6aeca334b07_r.jpg\"/></figure><p class=\"ztext-empty-paragraph\"><br/></p><p class=\"ztext-empty-paragraph\"><br/></p><p data-pid=\"QNNN3Ncd\"><b>一、精读 1 本＞泛读 100 本的核心法则：挖井读书法</b></p><p data-pid=\"yeVxO8-Y\">狠招精髓：锁定 1 本书死磕到底，拒绝「书架收藏癖」</p><p data-pid=\"qrFWI2pe\">反常识案例：有人每年列 50 本读书计划，最后本本只翻前 30 页；而钱钟书读《管锥编》时，同一本书批注修改 12 次，终成学术泰斗</p><p data-pid=\"hqv8uT9k\">实操步骤：</p><p data-pid=\"5rDDGPj3\">① 每年挑 2-3 本「人生奠基书」（如行业经典 / 思维框架书）</p><p data-pid=\"MuME_id7\">② 用「康奈尔笔记法」，每读 1 章必写 3 个应用场景</p><p class=\"ztext-empty-paragraph\"><br/></p><p data-pid=\"hzYVTtw7\"><b>二、从入门到精通的黄金公式：炖肉读书法</b></p><p data-pid=\"qiazsUZH\">分两步吃透全书：先猛火快攻搭框架，再文火慢炖嚼细节</p><p data-pid=\"vW7gqlhH\">真实案例：读《孙子兵法》时，先 3 天速览 13 篇标记核心概念；随后两个月，每天用「战场案例 + 职场场景」双维度拆解，比如用「知己知彼」做竞品分析</p><p class=\"ztext-empty-paragraph\"><br/></p><p data-pid=\"PcA_mkwT\"><b>三、啃陌生书的杀手锏：登山读书法</b></p><p data-pid=\"B3-ylG7Q\">专治「买书如山倒，读书如抽丝」</p><p class=\"ztext-empty-paragraph\"><br/></p><p data-pid=\"WfC2QG-f\">三大铁律：</p><p data-pid=\"SVfJB8jY\">1、新书入手 48 小时内必须开读</p><p data-pid=\"L7yDvg7d\">2、设「登山时刻表」：如 5 天读完心理学书，每天强制啃 1 章</p><p data-pid=\"HYNI0JX3\">3、中断补救：超过 1 天没读，需重读前 1 章找回状态</p><p data-pid=\"8YktTRqQ\">亲测效果：用这招读《博弈论》，5 天读完比断断续续 1 个月理解度高 3 倍</p><p class=\"ztext-empty-paragraph\"><br/></p><p data-pid=\"RTJ6Y-ts\"><b>四、让经典越读越新的魔法：摘果读书法</b></p><p data-pid=\"LYwfw8sL\">适用于《论语》《道德经》等读过 3 遍以上的书</p><p data-pid=\"GbHM7lX7\">高阶技巧：</p><p data-pid=\"iiKP51oi\">1、「主题式挖掘」：重读《孟子》时，专门整理「大丈夫人格」的 10 条职场应用法则</p><p data-pid=\"CzTcUoeZ\">2、 「跨学科联想」：用《庄子》&#34;庖丁解牛&#34; 理解编程中的模块化思维</p><p data-pid=\"-LopJiHm\">名人示范：南怀瑾读《金刚经》超百遍，每次用不同颜色笔标注，终成经典解读大家</p><p class=\"ztext-empty-paragraph\"><br/></p><p data-pid=\"_J-ajcIr\">每日行动清单：</p><p data-pid=\"e98gQ6vq\">用「挖井法」挑 1 本本月精读书，在扉页写清「读这本书要解决什么问题」</p><p data-pid=\"3LICWSXG\">用「炖肉法」拆分计划：3 天通读 + 21 天精读（设手机提醒防拖延）</p><p data-pid=\"qmReDc3g\">终极心法：读书不是堆数量，而是把 1% 的知识转化为 100% 的行动力。就像曾国藩说的「结硬寨，打呆仗」，读书的笨功夫，才是真聪明！</p>",
        "is_labeled": false,
        "visited_count": 1208,
        "thumbnails": [
          "https://picx.zhimg.com/50/v2-bcc8beb2076d44d01cc8820d279379f9_720w.jpg?source=b6762063"
        ],
        "favorite_count": 122,
        "article_type": "normal",
        "is_navigator": false,
        "navigator_vote": false,
        "vote_next_step": "vote"
      },
      "brief": "{\"source\": \"TS\", \"type\": \"article\", \"id\": 1924420373912462774}",
      "attached_info": "CsQGCLORnKmrzqKuiwEQBxoJMjU5OTAxMzQ4IL3bnsMGKB8wAkCzA0pCCi1UU19TT1VSQ0VfVFdPVE9XRVJfTVVMVElfU0NFTkVfVjFfUkVDQUxMX1RFWFQSATAYACAAOgp7InJhdyI6IiJ9SigKHVRTX1NPVVJDRV9ORUFSTElORV9DT05URU5UX1YyEgEwGAAgADoAYiBmMDc1YmIwMGMyOWY0YzMzNjI1YTU5YmIzNTFhZTBhN3ITMTkyNDQyMDM3MzkxMjQ2Mjc3NKoBCXJlY29tbWVuZMIBIDRjOTY5MmU1MWZkZjk4NjQ3N2YzMzRiZWYyZmY5YmNm8gEKCAwSBk5vcm1hbPIBKAgKEiQ5N2ZlMTFhZi04ZjNkLTRmNzMtYWFkNi1mMTg4ZGI2OWE2YTTyAQYICxICNzOCAgCIAsy8wfmMM5ICIDRjOTY5MmU1MWZkZjk4NjQ3N2YzMzRiZWYyZmY5YmNmmgIAygIWU2hvckludGVyZXN0V2VpZ2h0UnVsZcoCFVVzZXJMY25FeGl0V2VpZ2h0UnVsZcoCFENvbnRlbnRBZ2VXZWlnaHRSdWxlygIXU2FtZUF1dGhvcklzb2xhdGlvblJ1bGXaAi1UU19TT1VSQ0VfVFdPVE9XRVJfTVVMVElfU0NFTkVfVjFfUkVDQUxMX1RFWFToAgP6AgtOT1JNQUxfRkxPV4oDIDUzZDJkZTFiNGM3MDQ2YzNhZmRiOGE4M2E2ZTEzNDM2mgMNCgJ2MhAAGgVvdGhlcqgDuAnYAwDqAxV0ZXh0RmVlZFR3b1Rvd2VyVjFBbGz6A04SDFVOS05PV05fTU9ERSAAKg1OT19JTUFHRV9NT0RFOi0IBRCACBjOByIjdjItZDU1ODY5ZDY1MWEwYTQ0ODNkNDQ2NmExOTUxYWU2ZDCABACIBACSBAZOb3JtYWyaBAEzoAQAqAQAsAQAugQCYWnCBAM0MDDIBADSBA/mjqjojZDlt7Lmm7TmlrDYBADwBAD5BAAAAIBV96Q/gQUAAAAAAAAAAIkF4OtG7NRU2T+SBQCaBQNkZnSiBQNkZnSyBQExuQUAAAAAAAAAANAFAOAFAOgFAPAFSZAGAKAGtwOoBgCSAi4KCTI1OTkwMTM0OBITMTkyNDQyMDM3MzkxMjQ2Mjc3NBgHIgpJTUFHRV9URVhU",
      "action_card": false
    },
    {
      "id": "436_1755822710.539",
      "type": "feed",
      "offset": 436,
      "verb": "TOPIC_ACKNOWLEDGED_ARTICLE",
      "created_time": 1755822710,
      "updated_time": 1755822710,
      "target": {
        "id": "1941904010639574034",
        "type": "article",
        "url": "https://api.zhihu.com/articles/1941904010639574034",
        "author": {
          "id": "9ff9b5dc61304eef4bdfc6f787864e72",
          "url": "https://api.zhihu.com/people/9ff9b5dc61304eef4bdfc6f787864e72",
          "user_type": "people",
          "url_token": "qian-dan-91",
          "name": "运维开发故事",
          "headline": "微信公众号：运维开发故事",
          "avatar_url": "https://picx.zhimg.com/50/v2-9bf972cbe8cded586272bb60bd6228c2_l.jpg?source=b6762063",
          "is_org": false,
          "gender": -1,
          "followers_count": 2913,
          "is_following": false,
          "is_followed": false
        },
        "title": "AIOps系列 | 开发一个 K8s Chat 命令行工具",
        "image_url": "https://pica.zhimg.com/v2-b357cd788a24f2dd9d2040e4c40d8b1f.jpg?source=7e7ef6e2&needBackground=1",
        "comment_permission": "all",
        "created": 1755766077,
        "updated": 1755766077,
        "voteup_count": 0,
        "voting": 0,
        "comment_count": 0,
        "linkbox": {
          "category": "",
          "pic": "",
          "title": "",
          "url": ""
        },
        "excerpt": "!! 大家好，我是乔克，一个爱折腾的运维工程，一个睡觉都被自己丑醒的云原生爱好者。 作者：乔克 公众号：运维开发故事 博客：https://jokerbai.com ✍ 道路千万条，安全第一条。操作不规范，运维两行泪。 在前面我们介绍了[[03.大模型入门实战]]和 [[04.Agent入门实战]]，了解了 AI 开发的基本流程，本章节我们将使用讨论如何将 Kubernetes 和 AI 结合起来。 本文主要从以下几个方面进行介绍： 怎么和 Kubernetes 进行交互 C…",
        "excerpt_new": "!! 大家好，我是乔克，一个爱折腾的运维工程，一个睡觉都被自己丑醒的云原生爱好者。 作者：乔克 公众号：运维开发故事 博客：https://jokerbai.com ✍ 道路千万条，安全第一条。操作不规范，运维两行泪。 在前面我们介绍了[[03.大模型入门实战]]和 [[04.Agent入门实战]]，了解了 AI 开发的基本流程，本章节我们将使用讨论如何将 Kubernetes 和 AI 结合起来。 本文主要从以下几个方面进行介绍： 怎么和 Kubernetes 进行交互 C…",
        "preview_type": "default",
        "preview_text": "",
        "content": "<p></p><blockquote data-pid=\"Xv_9PVAK\"> !! 大家好，我是乔克，一个爱折腾的运维工程，一个睡觉都被自己丑醒的云原生爱好者。<br/>  作者：乔克<br/>公众号：运维开发故事<br/>博客：<a href=\"https://link.zhihu.com/?target=https%3A//jokerbai.com\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">https://</span><span class=\"visible\">jokerbai.com</span><span class=\"invisible\"></span></a><br/> <br/> ✍ 道路千万条，安全第一条。操作不规范，运维两行泪。<br/> </blockquote><p data-pid=\"ascuCjHU\">在前面我们介绍了[[03.大模型入门实战]]和 [[04.Agent入门实战]]，了解了 AI 开发的基本流程，本章节我们将使用讨论如何将 Kubernetes 和 AI 结合起来。</p><p data-pid=\"4EqMTgok\">本文主要从以下几个方面进行介绍：</p><ul><li data-pid=\"GUyHZ_n-\"> 怎么和 Kubernetes 进行交互<br/> </li><li data-pid=\"YIjkETrQ\"> Cobra 工具库介绍<br/> </li><li data-pid=\"VUUvlOOc\"> 开发 Chat K8s 命令行工具<br/> </li></ul><blockquote data-pid=\"okaCHDn5\"> Tips：文章只是起到抛砖引玉的作用，做大做强还需各位自己努力。<br/> </blockquote><h2>怎么和 Kubernetes 进行交互</h2><p data-pid=\"zJMSXX2S\">Kubernetes 集群是云原生时代中最重要的基础设施，它里面运行着成千上万的 Pods，在日常的运维工作中，SRE 常用 <code>kubectl</code> 命令与它进行交互。</p><p data-pid=\"5Z6H5bY1\"><code>kubectl</code> 是官方开发的客户端，已经将所有常用的操作集成到里面了。但是， 如果我们要通过接口与 Kubernetes 进行交互，就需要使用官方的一个核心库 <code>Client-go</code>。</p><p data-pid=\"V2QcpMP6\"><code>client-go</code> 是 Kubernetes 官方提供的 Go 语言客户端库，用于与 Kubernetes API Server 进行交互。它让你可以通过编程的方式创建、更新、删除和查询 Kubernetes 资源（如 Pod、Deployment、Service 等），是开发 Kubernetes 控制器、Operator、自定义调度器或运维工具的核心依赖。</p><p data-pid=\"d_NmdDKK\"><code>client-go</code> 的核心组件主要有：</p><ul><li data-pid=\"n0XM3cyc\"> Clientset：最常用的客户端集合，包含对 core、apps、networking 等 API 访问。<br/> </li><li data-pid=\"5oQ9H42W\"> Informer：监听资源变化，如 add、update、delete，避免频繁轮询。<br/> </li><li data-pid=\"VFUGPsxg\"> Lister：快速从本地缓存读取资源，主要是配合 Informer 使用。<br/> </li><li data-pid=\"sNcOUZxS\"> Workqueue：处理异步任务队列，常用于控制器中<br/> </li><li data-pid=\"CPDtlAP5\"> ...<br/> </li></ul><p data-pid=\"GJeDfYdI\">下面我们举一个简单的例子获取所有 Pod 列表。</p><p data-pid=\"QeZorF0m\">（1）初始化一个项目</p><div class=\"highlight\"><pre><code class=\"language-text\">mkdir k8s-pod-list &amp;&amp; cd k8s-pod-list\ngo mod init k8s-pod-list</code></pre></div><p data-pid=\"402MEiMD\">（2）安装 client-go</p><div class=\"highlight\"><pre><code class=\"language-text\">go get k8s.io/client-go/kubernetes\ngo get k8s.io/client-go/tools/clientcmd\ngo get k8s.io/client-go/rest</code></pre></div><p data-pid=\"fWAEHUPo\">（3）编写代码</p><div class=\"highlight\"><pre><code class=\"language-text\">package main\n\nimport (\n    &#34;context&#34;\n    &#34;fmt&#34;\n    &#34;log&#34;\n    &#34;path/filepath&#34;\n\n    metav1 &#34;k8s.io/apimachinery/pkg/apis/meta/v1&#34;\n    &#34;k8s.io/client-go/kubernetes&#34;\n    &#34;k8s.io/client-go/tools/clientcmd&#34;\n    &#34;k8s.io/client-go/util/homedir&#34;\n)\n\nfunc main() {\n    // 1. 构建 kubeconfig 路径（默认 ~/.kube/config）\n    var kubeconfig string\n    if home := homedir.HomeDir(); home != &#34;&#34; {\n        kubeconfig = filepath.Join(home, &#34;.kube&#34;, &#34;config&#34;)\n    }\n\n    // 2. 加载 kubeconfig 文件，生成配置\n    config, err := clientcmd.BuildConfigFromFlags(&#34;&#34;, kubeconfig)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    // 3. 创建 Kubernetes 客户端\n    clientset, err := kubernetes.NewForConfig(config)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    // 4. 获取所有 Pod\n    pods, err := clientset.CoreV1().Pods(&#34;&#34;).List(context.TODO(), metav1.ListOptions{})\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    // 5. 打印每个 Pod 的命名空间和名称\n    fmt.Printf(&#34;Found %d pods:\\n&#34;, len(pods.Items))\n    for _, pod := range pods.Items {\n        fmt.Printf(&#34;Namespace: %s, Pod: %s\\n&#34;, pod.Namespace, pod.Name)\n    }\n}</code></pre></div><p data-pid=\"4dITtTKh\">（4）运行 <code>go run main.go</code>，输出如下：</p><div class=\"highlight\"><pre><code class=\"language-text\">&gt; go run main.go\nFound 713 pods:\nNamespace: apo, Pod: apo-alertmanager-554fd4bbfc-mjp6q\nNamespace: apo, Pod: apo-altinity-clickhouse-operator-cc87bb785-j9t9q\nNamespace: apo, Pod: apo-backend-594c764b94-nd4zw\nNamespace: apo, Pod: apo-collector-76979647fd-cmgg2\nNamespace: apo, Pod: apo-front-5fbf5f4566-4rdh9\nNamespace: apo, Pod: apo-grafana-57b98b9d59-f9k4h\nNamespace: apo, Pod: apo-jaeger-collector-6d7bbc945d-6p95x\nNamespace: apo, Pod: apo-odigos-instrumentor-8689cd45c6-xgvns</code></pre></div><p data-pid=\"PfwBMnNi\"><code>client-go</code> 是与 Kubernetes 交互的 Go 语言标准工具，它是构建云原生工具的基础，适合用于开发自动化运维系统、Kubernetes 插件、监控工具等。</p><p data-pid=\"0P86nkh9\">本文我们希望的是开发一个 Kubernetes 工具，单纯使用 <code>client-go</code> 略显麻烦，我们还需要使用另外一个 CLI 工具库——Cobra，它可以为我们开发提升很大的效率。</p><h2>Cobra 工具库介绍</h2><p data-pid=\"ppII4ibh\"><code>Cobra</code> 是 Go 语言中最流行的命令行工具库，用于构建功能强大、结构清晰的现代 CLI（Command-Line Interface）应用程序。它被广泛用于许多知名开源项目中，例如：</p><ul><li data-pid=\"0WKKa3tv\"><b>Kubernetes</b> (<code>kubectl</code>)<br/> </li><li data-pid=\"GHtYQvzL\"><b>Helm</b><br/> </li><li data-pid=\"JhJM1RAT\"><b>Docker</b> (<code>docker CLI</code>)<br/> </li></ul><p data-pid=\"UXEQknNx\">它的核心特性有：</p><ul><li data-pid=\"h8u-cvUP\"> Command：支持命令及子命令，如 <code>app server</code>，<code>app config set</code>。<br/> </li><li data-pid=\"6UuHEy0M\"> Flags：支持全局和局部 flag，如 <code>--config</code>，<code>-v</code>。<br/> </li><li data-pid=\"7r3QwvV1\"> Args：命令的参数，一般用来表示操作的对象，比如 <code>kubectl get pod</code>，其中 <code>pod</code> 就是操作的对象。<br/> </li><li data-pid=\"9CE_Kl2-\"> 可以自动生成 help，输入 <code>app --help</code> 自动输出帮助信息。<br/> </li><li data-pid=\"0NyFsQdu\"> 可以 shell 环境下的自动补全。<br/> </li></ul><p data-pid=\"jcAe0muT\">对于 <code>Command</code>，每个命令都是一个 <code>&amp;cobra.Command{}</code>，比如：</p><div class=\"highlight\"><pre><code class=\"language-text\">&amp;cobra.Command{\n    Use:   &#34;hello&#34;,              // 命令用法\n    Short: &#34;简短描述&#34;,\n    Long:  &#34;长描述&#34;,\n    Run: func(cmd *cobra.Command, args []string) {\n        // 执行逻辑\n    },\n}</code></pre></div><p data-pid=\"wFuN4Lif\">而 <code>Flags</code> 分为 <code>全局 Flag</code> 和 <code>局部 Flag</code>，取决你的 Flag 是假如的 <code>rootCmd</code> 还是 其他命令。</p><div class=\"highlight\"><pre><code class=\"language-text\">// 局部 flag\nhelloCmd.Flags().StringVarP(&amp;name, &#34;name&#34;, &#34;n&#34;, &#34;default&#34;, &#34;姓名&#34;)\n\n// 全局 flag（加到 rootCmd）\nrootCmd.PersistentFlags().Bool(&#34;verbose&#34;, false, &#34;启用详细日志&#34;)</code></pre></div><p data-pid=\"BomojI8L\">另外，<code>Flags</code> 支持 <code>String</code>、<code>Bool</code>、<code>Int</code>、<code>Float</code> 类型，如下：</p><ul><li data-pid=\"qN9WREpX\"> String 类型<br/> </li><li data-pid=\"M6wyzVon\"> StringVar(&amp;variable, &#34;flag&#34;, &#34;default&#34;, &#34;description&#34;)，不带缩写<br/> </li><li data-pid=\"gAFNPJu0\"> StringVarP(&amp;variable, &#34;flag&#34;, ”shorthand“, &#34;default&#34;, &#34;description&#34;)，带缩写<br/> </li><li data-pid=\"_32mR8JO\"> StringSliceVar(&amp;variable, &#34;flag&#34;, []string{}, &#34;description&#34;)，可以接手数组，cli可以传入多个flag<br/> </li><li data-pid=\"yuBxAwrf\"> StringVarP(&amp;variable, &#34;flag&#34;, ”shorthand“, []string{}, &#34;description&#34;)<br/> </li><li data-pid=\"Ae294FL3\"> Bool 类型<br/> </li><li data-pid=\"UHzoivhl\"> BoolVar(&amp;variable, &#34;flag&#34;, &#34;default&#34;, &#34;description&#34;)，不带缩写<br/> </li><li data-pid=\"NHOxqCD5\"> BoolVarP(&amp;variable, &#34;flag&#34;, ”shorthand“, &#34;default&#34;, &#34;description&#34;)，带缩写<br/> </li><li data-pid=\"POO0DWlU\"> Int 类型<br/> </li><li data-pid=\"wCS0ZwE1\"> IntVar(&amp;variable, &#34;flag&#34;, &#34;default&#34;, &#34;description&#34;)，不带缩写<br/> </li><li data-pid=\"ZfIjJxaa\"> IntVarP(&amp;variable, &#34;flag&#34;, ”shorthand“, &#34;default&#34;, &#34;description&#34;)，带缩写<br/> </li><li data-pid=\"U_Guz2eB\"> Float 类型<br/> </li><li data-pid=\"Ll84vQyv\"> FloatVar(&amp;variable, &#34;flag&#34;, &#34;default&#34;, &#34;description&#34;)，不带缩写<br/> </li><li data-pid=\"y7DkG7Ii\"> FloatVarP(&amp;variable, &#34;flag&#34;, ”shorthand“, &#34;default&#34;, &#34;description&#34;)，带缩写<br/> </li></ul><p data-pid=\"wY254xr3\">下面我们开发一个最简单的 <code>hello</code>命令。</p><p data-pid=\"LQ0zhnMa\">（1）安装 Cobra</p><div class=\"highlight\"><pre><code class=\"language-text\">go get -u github.com/spf13/cobra/cobra</code></pre></div><p data-pid=\"N8oFFjCN\">（2）初始化项目</p><div class=\"highlight\"><pre><code class=\"language-text\">mkdir hello &amp;&amp; cd hello\ngo mod init hello\ncobra-cli init</code></pre></div><p data-pid=\"BQGDu-Lz\">这会自动生成：</p><ul><li data-pid=\"aQhxNbmh\"><code>cmd/root.go</code> —— 主命令<br/> </li><li data-pid=\"L4xlzwFr\"><code>main.go</code> —— 入口<br/> </li><li data-pid=\"ZDAU722z\"> 自动支持 <code>myapp --help</code><br/> </li></ul><p data-pid=\"UoOxnY2C\">（3）添加子命令</p><div class=\"highlight\"><pre><code class=\"language-text\">cobra-cli add hello</code></pre></div><p data-pid=\"-4OgrPCW\">（4）编辑 <code>cmd/hello.go</code>，添加逻辑</p><div class=\"highlight\"><pre><code class=\"language-text\">package cmd\n\nimport (\n    &#34;fmt&#34;\n    &#34;github.com/spf13/cobra&#34;\n)\n\nvar name string\n\nvar helloCmd = &amp;cobra.Command{\n    Use:   &#34;hello&#34;,\n    Short: &#34;打印问候语&#34;,\n    Long:  `一个简单的命令，用于向某人问好`,\n    Run: func(cmd *cobra.Command, args []string) {\n        if name == &#34;&#34; {\n            name = &#34;World&#34;\n        }\n        fmt.Printf(&#34;Hello, %s!\\n&#34;, name)\n    },\n}\n\nfunc init() {\n    rootCmd.AddCommand(helloCmd)\n    helloCmd.Flags().StringVarP(&amp;name, &#34;name&#34;, &#34;n&#34;, &#34;&#34;, &#34;输入你的名字&#34;)\n}</code></pre></div><p data-pid=\"Rtsni9eM\">（5）运行程序，查看输出。</p><div class=\"highlight\"><pre><code class=\"language-text\">go run main.go hello\n# 输出: Hello, World!\n\ngo run main.go hello --name=Jokerbai\n# 输出: Hello, Jokerbai!\n\ngo run main.go hello -n Bob\n# 输出: Hello, Bob!\n\ngo run main.go hello --help\n# 一个简单的命令，用于向某人问好\n#\n# Usage:\n#  cobra-hello hello [flags]\n#\n# Flags:\n#   -h, --help          help for hello\n#   -n, --name string   输入你的名字</code></pre></div><p data-pid=\"gBje3X0Q\">通过上面简单的示例，我们不难发现通过 <code>Cobra</code>，我们可以快速搭建起命令工具的架子，后续只需要结合业务对这个架子进行装修，省去不少麻烦。</p><h2>开发 Chat K8s 命令行工具</h2><p data-pid=\"LSk6EOPP\">上面我们对本文需要的基础工具进行了简单介绍，接下来我们将进入第一个主题：开发 Chat K8s 命令行工具。</p><p data-pid=\"tt02Xz05\">我们这个工具需要实现的效果是：</p><ul><li data-pid=\"63_yS3Du\"> Command：k8scopilot ask chatgpt 进入交互模式<br/> </li><li data-pid=\"AUiYgeJN\"> 可以进行资源的部署，比如：<br/> </li><li data-pid=\"bXfm7zm1\"> 帮我部署一个 Deploy，镜像是 nginx<br/> </li><li data-pid=\"qWRLOcax\"> 部署一个 Pod，镜像是 nginx<br/> </li><li data-pid=\"t5fUhech\"> 可以查询资源信息，比如：<br/> </li><li data-pid=\"gNwGE45M\"> 查一下 default ns 的 Pod、SVC、Deploy 资源<br/> </li><li data-pid=\"OxdbD9i5\"> 可以删除资源，比如：<br/> </li><li data-pid=\"Kmdo5ygj\"> 删除 default ns 下的 nginx deploy<br/> </li></ul><p data-pid=\"uamBw7SE\">下面我们进入正式的开发。</p><p data-pid=\"QhCzQ6yG\">1.创建一个 <code>k8scopilot</code>目录，使用 <code>cobra-cli</code> 初始化项目</p><div class=\"highlight\"><pre><code class=\"language-text\">mkdir k8scopilot &amp;&amp; cd k8scopilot\ngo mod init\ncobra-cli initr</code></pre></div><p data-pid=\"QeSAcgxi\">2.添加第一个 <code>ask</code> 命令</p><div class=\"highlight\"><pre><code class=\"language-text\">cobra-cli add ask</code></pre></div><p data-pid=\"z79y9j8Q\">3.接着，添加一个 <code>chatgpt</code> 命令，它是 <code>ask</code> 的子命令</p><div class=\"highlight\"><pre><code class=\"language-text\">cobra-cli add chatgpt -p &#34;askCmd&#34;</code></pre></div><p data-pid=\"8tcwm5nN\">4.在 <code>chatgpt</code> 命令中实现一个简单的功能：</p><ul><li data-pid=\"frIVi9UM\"> 当用户执行 <code>k8scopilot ask chatgpt</code> 进入控制台输入<br/> </li><li data-pid=\"50cosIZ-\"> 然后用户可以在控制台中进行对话<br/> </li><li data-pid=\"qM_cQTYM\"> 当用户输入 <code>exit</code> 退出<br/> </li></ul><p data-pid=\"1f5Zw9BF\">（1）增加一个 <code>startChat</code> 方法，用于处理生成对话回复</p><div class=\"highlight\"><pre><code class=\"language-text\">func startChat() {\n scanner := bufio.NewScanner(os.Stdin)\n fmt.Println(&#34;我是 K8S Copilot，你可以向我咨询 K8S 相关问题&#34;)\n\n for {\n  fmt.Print(&#34;&gt; &#34;)\n  if scanner.Scan() {\n   input := scanner.Text()\n   if input == &#34;exit&#34; {\n    fmt.Println(&#34;退出对话&#34;)\n    break\n   }\n   if input == &#34;&#34; {\n    continue\n   }\n   fmt.Println(&#34;你输入的是：&#34;, input)\n  }\n }\n}</code></pre></div><p data-pid=\"hFDv7U1T\">效果如下：</p><div class=\"highlight\"><pre><code class=\"language-text\">&gt; .\\k8scopilot.exe ask chatgpt\n我是 K8S Copilot，你可以向我咨询 K8S 相关问题\n&gt; 部署资源\n你输入的是： 部署资源\n&gt; exit\n退出对话</code></pre></div><p data-pid=\"S6rsQA0S\">（2）封装 <code>OpenAI</code> 客户端，方便后续调用大模型。创建一个 <code>utils</code> 目录，然后创建 <code>openai.go</code> 完成客户端封装。</p><div class=\"highlight\"><pre><code class=\"language-text\">package utils\n\nimport (\n &#34;context&#34;\n &#34;errors&#34;\n &#34;net/http&#34;\n &#34;os&#34;\n &#34;time&#34;\n\n &#34;github.com/sashabaranov/go-openai&#34;\n)\n\nconst defaultBaseURL = &#34;https://vip.apiyi.com/v1&#34;\nconst defaultApiKey = &#34;sk-xxxx&#34;\n\ntype OpenAI struct {\n Client *openai.Client\n ctx    context.Context\n}\n\nfunc NewOpenAI() *OpenAI {\n apiKey := os.Getenv(&#34;OPENAI_API_KEY&#34;)\n if apiKey == &#34;&#34; {\n  apiKey = defaultApiKey\n }\n apiBase := os.Getenv(&#34;OPENAI_API_BASE&#34;)\n if apiBase == &#34;&#34; {\n  apiBase = defaultBaseURL\n }\n config := openai.DefaultConfig(apiKey)\n config.BaseURL = apiBase\n config.HTTPClient = &amp;http.Client{\n  Timeout: 30 * time.Second,\n }\n client := openai.NewClientWithConfig(config)\n\n return &amp;OpenAI{\n  Client: client,\n  ctx:    context.Background(),\n }\n}\n\nfunc (op *OpenAI) SendMessage(prompt string, content string) (string, error) {\n req := openai.ChatCompletionRequest{\n  Model: openai.GPT4oMini,\n  Messages: []openai.ChatCompletionMessage{\n   {\n    Role:    &#34;system&#34;,\n    Content: prompt,\n   },\n   {\n    Role:    &#34;user&#34;,\n    Content: content,\n   },\n  },\n }\n resp, err := op.Client.CreateChatCompletion(op.ctx, req)\n if err != nil {\n  return &#34;&#34;, err\n }\n if len(resp.Choices) == 0 {\n  return &#34;&#34;, errors.New(&#34;no response&#34;)\n }\n return resp.Choices[0].Message.Content, nil\n}</code></pre></div><p data-pid=\"Cs3_YTSI\">我们定义了 <code>NewOpenAI</code> 方法用来初始化 <code>openai</code>，然后再定义了一个 <code>SendMessage</code> 方法用来和 <code>GPT</code> 进行交互。</p><p data-pid=\"2SwouauH\">（3）实现 <code>FunctionCall</code>，在需要根据用户输入执行不同的操作的时候，我们在《大模型入门实战》章节有讲过 <code>FunctionCall</code>，该项目我们将使用其实现。</p><p data-pid=\"9goSXigr\">这里只实现三个功能：</p><ul><li data-pid=\"96lBs5Cf\"> 生成 YAML 清单并部署<br/> </li><li data-pid=\"cYKSQNCP\"> 查询 K8s 资源<br/> </li><li data-pid=\"c411FNxG\"> 删除 K8s 资源<br/> </li></ul><p data-pid=\"t72fxv6N\">在 <code>chatgpt.go</code> 中实现。</p><p data-pid=\"Z95wwH0t\">首先，定义一个工具函数 <code>createTools</code>，用于定义 <code>openai</code> 的工具集。</p><div class=\"highlight\"><pre><code class=\"language-text\">func createTools() []openai.Tool {\n // 用来生成 K8s YAML 并部署资源\n f1 := openai.FunctionDefinition{\n  Name:        &#34;generateAndDeployResource&#34;,\n  Description: &#34;生成 K8s YAML 并部署资源&#34;,\n  Parameters: jsonschema.Definition{\n   Type: jsonschema.Object,\n   Properties: map[string]jsonschema.Definition{\n    &#34;user_input&#34;: {\n     Type:        jsonschema.String,\n     Description: &#34;用户输出的文本内容，要求包含资源类型和镜像&#34;,\n    },\n   },\n   Required: []string{&#34;user_input&#34;}, // 修复：应该是 user_input 而不是 location\n  },\n }\n\n // 用来查询 K8s 资源\n f2 := openai.FunctionDefinition{\n  Name:        &#34;queryResource&#34;,\n  Description: &#34;查询 K8s 资源&#34;,\n  Parameters: jsonschema.Definition{\n   Type: jsonschema.Object,\n   Properties: map[string]jsonschema.Definition{\n    &#34;namespace&#34;: {\n     Type:        jsonschema.String,\n     Description: &#34;资源所在的命名空间&#34;,\n    },\n    &#34;resource_type&#34;: {\n     Type:        jsonschema.String,\n     Description: &#34;K8s 资源标准类型，例如 Pod、Deployment、Service 等&#34;,\n    },\n   },\n   Required: []string{&#34;namespace&#34;, &#34;resource_type&#34;}, // 添加必需参数\n  },\n }\n\n // 用来删除 K8s 资源\n f3 := openai.FunctionDefinition{\n  Name:        &#34;deleteResource&#34;,\n  Description: &#34;删除 K8s 资源&#34;,\n  Parameters: jsonschema.Definition{\n   Type: jsonschema.Object,\n   Properties: map[string]jsonschema.Definition{\n    &#34;namespace&#34;: {\n     Type:        jsonschema.String,\n     Description: &#34;资源所在的命名空间&#34;,\n    },\n    &#34;resource_type&#34;: {\n     Type:        jsonschema.String,\n     Description: &#34;K8s 资源标准类型，例如 Pod、Deployment、Service 等&#34;,\n    },\n    &#34;resource_name&#34;: {\n     Type:        jsonschema.String,\n     Description: &#34;资源名称&#34;,\n    },\n   },\n   Required: []string{&#34;namespace&#34;, &#34;resource_type&#34;, &#34;resource_name&#34;}, // 添加必需参数\n  },\n }\n\n return []openai.Tool{\n  {Type: openai.ToolTypeFunction, Function: &amp;f1},\n  {Type: openai.ToolTypeFunction, Function: &amp;f2},\n  {Type: openai.ToolTypeFunction, Function: &amp;f3},\n }\n}</code></pre></div><p data-pid=\"CGOivjqr\">接着，我们定义 <code>functionCalling</code> 方法，用于将工具注册到大模型以及执行工具调用。</p><div class=\"highlight\"><pre><code class=\"language-text\">func functionCalling(input string, client *utils.OpenAI) string {\n tools := createTools()\n\n dialogue := []openai.ChatCompletionMessage{\n  {Role: openai.ChatMessageRoleUser, Content: input},\n }\n\n // 调用 OpenAI API\n resp, err := client.Client.CreateChatCompletion(context.TODO(),\n  openai.ChatCompletionRequest{\n   Model:    openai.GPT4TurboPreview,\n   Messages: dialogue,\n   Tools:    tools,\n  },\n )\n if err != nil {\n  return fmt.Sprintf(&#34;OpenAI API 调用失败: %v&#34;, err)\n }\n\n // 验证响应\n if len(resp.Choices) == 0 {\n  return &#34;OpenAI 返回了空的响应&#34;\n }\n\n msg := resp.Choices[0].Message\n\n // 如果没有工具调用，直接返回消息内容\n if len(msg.ToolCalls) == 0 {\n  if msg.Content != &#34;&#34; {\n   return msg.Content\n  }\n  return &#34;抱歉，我无法理解您的请求，请提供更具体的信息。&#34;\n }\n\n // 处理多个工具调用（虽然当前逻辑假设只有一个）\n if len(msg.ToolCalls) &gt; 1 {\n  return &#34;抱歉，当前不支持同时执行多个操作，请一次只执行一个操作。&#34;\n }\n\n // 执行工具调用\n toolCall := msg.ToolCalls[0]\n result, err := callFunction(client, toolCall.Function.Name, toolCall.Function.Arguments)\n if err != nil {\n  return fmt.Sprintf(&#34;执行操作失败: %v&#34;, err)\n }\n return result\n}</code></pre></div><p data-pid=\"WDqs6DBl\">在 <code>functionCalling</code> 中，我们调用了 <code>callFunction</code> 方法执行工具调用，下面实现 <code>callFuntion</code> ，它将根据 <code>OpenAI</code> 返回的消息，调用对应的函数。</p><div class=\"highlight\"><pre><code class=\"language-text\">// 根据 OpenAI 返回的消息，调用对应的函数\nfunc callFunction(client *utils.OpenAI, name, arguments string) (string, error) {\n switch name {\n case &#34;generateAndDeployResource&#34;:\n  params := struct {\n   UserInput string `json:&#34;user_input&#34;`\n  }{}\n  if err := json.Unmarshal([]byte(arguments), &amp;params); err != nil {\n   return &#34;&#34;, fmt.Errorf(&#34;解析生成部署资源参数失败: %v&#34;, err)\n  }\n  return generateAndDeployResource(client, params.UserInput)\n\n case &#34;queryResource&#34;:\n  params := struct {\n   Namespace    string `json:&#34;namespace&#34;`\n   ResourceType string `json:&#34;resource_type&#34;`\n  }{}\n  if err := json.Unmarshal([]byte(arguments), &amp;params); err != nil {\n   return &#34;&#34;, fmt.Errorf(&#34;解析查询资源参数失败: %v&#34;, err)\n  }\n  return queryResource(params.Namespace, params.ResourceType)\n\n case &#34;deleteResource&#34;:\n  params := struct {\n   Namespace    string `json:&#34;namespace&#34;`\n   ResourceType string `json:&#34;resource_type&#34;`\n   ResourceName string `json:&#34;resource_name&#34;`\n  }{}\n  if err := json.Unmarshal([]byte(arguments), &amp;params); err != nil {\n   return &#34;&#34;, fmt.Errorf(&#34;解析删除资源参数失败: %v&#34;, err)\n  }\n  return deleteResource(params.Namespace, params.ResourceType, params.ResourceName)\n\n default:\n  return &#34;&#34;, fmt.Errorf(&#34;未知的函数: %s&#34;, name)\n }\n}</code></pre></div><p data-pid=\"oMybgWo0\">接下来，我们需要实现具体的操作方法，它们分别是：</p><ul><li data-pid=\"Glo0y0W6\"> generateAndDeployResource<br/> </li><li data-pid=\"72Pv6HxW\"> queryResource<br/> </li><li data-pid=\"m0vl1K-Z\"> deleteResource<br/> </li></ul><p data-pid=\"nI7fmnGC\">在这之前，我们需要在 <code>utils</code> 中封装 <code>client-go</code>，方便后续调用。</p><div class=\"highlight\"><pre><code class=\"language-text\">// utils/client_go.go\npackage utils\n\nimport (\n &#34;fmt&#34;\n &#34;path/filepath&#34;\n &#34;strings&#34;\n\n &#34;k8s.io/client-go/discovery&#34;\n &#34;k8s.io/client-go/dynamic&#34;\n &#34;k8s.io/client-go/kubernetes&#34;\n &#34;k8s.io/client-go/tools/clientcmd&#34;\n &#34;k8s.io/client-go/util/homedir&#34;\n)\n\n// ClientGo encapsulates both clientset and dynamicClient for Kubernetes operations\ntype ClientGo struct {\n Clientset       *kubernetes.Clientset\n DynamicClient   dynamic.Interface\n DiscoveryClient discovery.DiscoveryInterface\n}\n\n// NewClientGo initializes a new ClientGo instance with the provided kubeconfig path\nfunc NewClientGo(kubeconfig string) (*ClientGo, error) {\n // Handle ~ in the kubeconfig path\n if strings.HasPrefix(kubeconfig, &#34;~&#34;) {\n  homeDir := homedir.HomeDir()\n  kubeconfig = filepath.Join(homeDir, kubeconfig[1:])\n }\n\n // Build the configuration from the kubeconfig file\n config, err := clientcmd.BuildConfigFromFlags(&#34;&#34;, kubeconfig)\n if err != nil {\n  return nil, fmt.Errorf(&#34;failed to build kubeconfig: %w&#34;, err)\n }\n\n // Create the clientset\n clientset, err := kubernetes.NewForConfig(config)\n if err != nil {\n  return nil, fmt.Errorf(&#34;failed to create clientset: %w&#34;, err)\n }\n\n // Create the dynamic client\n dynamicClient, err := dynamic.NewForConfig(config)\n if err != nil {\n  return nil, fmt.Errorf(&#34;failed to create dynamic client: %w&#34;, err)\n }\n\n // Create DiscoveryClient\n discoveryClient, err := discovery.NewDiscoveryClientForConfig(config)\n if err != nil {\n  return nil, fmt.Errorf(&#34;failed to create discovery client: %w&#34;, err)\n }\n\n return &amp;ClientGo{\n  Clientset:       clientset,\n  DynamicClient:   dynamicClient,\n  DiscoveryClient: discoveryClient,\n }, nil\n}</code></pre></div><p data-pid=\"jBn4WWxY\">然后，我们再来实现具体的方法。</p><p data-pid=\"5g5gfmZa\">其中，<code>generateAndDeployResource</code> 是用来生成 YAML 清单以及部署资源的，其逻辑就是调用大模型生成纯净的 K8s YAML 资源，然后使用 <code>Client-go</code> 完成资源部署。</p><div class=\"highlight\"><pre><code class=\"language-text\">// 生成 K8s YAML 并部署资源\nfunc generateAndDeployResource(client *utils.OpenAI, userInput string) (string, error) {\n // 生成 YAML 内容\n yamlContent, err := client.SendMessage(&#34;你现在是一个 K8s 资源生成器，根据用户输入生成 K8s YAML，注意除了 YAML 内容以外不要输出任何内容，此外不要把 YAML 放在 ``` 代码快里&#34;, userInput)\n if err != nil {\n  return &#34;&#34;, fmt.Errorf(&#34;生成 YAML 失败: %v&#34;, err)\n }\n\n // 创建 Kubernetes 客户端\n clientGo, err := utils.NewClientGo(kubeconfig) // kubeconfig 是一个全局 Flag\n if err != nil {\n  return &#34;&#34;, fmt.Errorf(&#34;创建 Kubernetes 客户端失败: %v&#34;, err)\n }\n\n // 获取 API 资源\n resources, err := restmapper.GetAPIGroupResources(clientGo.DiscoveryClient)\n if err != nil {\n  return &#34;&#34;, fmt.Errorf(&#34;获取 API 资源失败: %v&#34;, err)\n }\n\n // 将 YAML 转成 unstructured 对象\n unstructuredObj := &amp;unstructured.Unstructured{}\n _, _, err = scheme.Codecs.UniversalDeserializer().Decode([]byte(yamlContent), nil, unstructuredObj)\n if err != nil {\n  return &#34;&#34;, fmt.Errorf(&#34;解析 YAML 失败: %v&#34;, err)\n }\n\n // 创建 REST mapper\n mapper := restmapper.NewDiscoveryRESTMapper(resources)\n // 从 unstructuredObj 中提取 GVK\n gvk := unstructuredObj.GroupVersionKind()\n // 用 GVK 转 GVR\n mapping, err := mapper.RESTMapping(gvk.GroupKind(), gvk.Version)\n if err != nil {\n  return &#34;&#34;, fmt.Errorf(&#34;映射资源类型失败: %v&#34;, err)\n }\n\n // 设置默认命名空间\n namespace := unstructuredObj.GetNamespace()\n if namespace == &#34;&#34; {\n  namespace = &#34;default&#34;\n }\n\n // 部署资源\n _, err = clientGo.DynamicClient.Resource(mapping.Resource).Namespace(namespace).Create(context.TODO(), unstructuredObj, metav1.CreateOptions{})\n if err != nil {\n  return &#34;&#34;, fmt.Errorf(&#34;部署资源失败: %v&#34;, err)\n }\n\n resourceName := unstructuredObj.GetName()\n resourceKind := unstructuredObj.GetKind()\n return fmt.Sprintf(&#34;✅ 成功部署 %s/%s 到命名空间 %s\\n\\n生成的 YAML:\\n%s&#34;, resourceKind, resourceName, namespace, yamlContent), nil\n}</code></pre></div><p data-pid=\"jz7ILdvQ\">对于 <code>queryResource</code> 是用来查询资源信息的，不同的资源信息有不同的 <code>GVR</code>，如下：</p><div class=\"highlight\"><pre><code class=\"language-text\">// 查询 K8s 资源\nfunc queryResource(namespace, resourceType string) (string, error) {\n // 创建 Kubernetes 客户端\n clientGo, err := utils.NewClientGo(kubeconfig)\n if err != nil {\n  return &#34;&#34;, fmt.Errorf(&#34;创建 Kubernetes 客户端失败: %v&#34;, err)\n }\n\n // 标准化资源类型\n resourceType = strings.ToLower(resourceType)\n var gvr schema.GroupVersionResource\n var displayName string\n\n switch resourceType {\n case &#34;deployment&#34;, &#34;deployments&#34;:\n  gvr = schema.GroupVersionResource{Group: &#34;apps&#34;, Version: &#34;v1&#34;, Resource: &#34;deployments&#34;}\n  displayName = &#34;Deployment&#34;\n case &#34;service&#34;, &#34;services&#34;, &#34;svc&#34;:\n  gvr = schema.GroupVersionResource{Group: &#34;&#34;, Version: &#34;v1&#34;, Resource: &#34;services&#34;}\n  displayName = &#34;Service&#34;\n case &#34;pod&#34;, &#34;pods&#34;:\n  gvr = schema.GroupVersionResource{Group: &#34;&#34;, Version: &#34;v1&#34;, Resource: &#34;pods&#34;}\n  displayName = &#34;Pod&#34;\n case &#34;configmap&#34;, &#34;configmaps&#34;, &#34;cm&#34;:\n  gvr = schema.GroupVersionResource{Group: &#34;&#34;, Version: &#34;v1&#34;, Resource: &#34;configmaps&#34;}\n  displayName = &#34;ConfigMap&#34;\n case &#34;secret&#34;, &#34;secrets&#34;:\n  gvr = schema.GroupVersionResource{Group: &#34;&#34;, Version: &#34;v1&#34;, Resource: &#34;secrets&#34;}\n  displayName = &#34;Secret&#34;\n default:\n  return &#34;&#34;, fmt.Errorf(&#34;不支持的资源类型: %s。支持的类型: deployment, service, pod, configmap, secret&#34;, resourceType)\n }\n\n // 查询资源\n resourceList, err := clientGo.DynamicClient.Resource(gvr).Namespace(namespace).List(context.TODO(), metav1.ListOptions{})\n if err != nil {\n  return &#34;&#34;, fmt.Errorf(&#34;查询资源失败: %v&#34;, err)\n }\n\n // 格式化输出结果\n if len(resourceList.Items) == 0 {\n  return fmt.Sprintf(&#34;在命名空间 &#39;%s&#39; 中未找到任何 %s 资源&#34;, namespace, displayName), nil\n }\n\n result := fmt.Sprintf(&#34;在命名空间 &#39;%s&#39; 中找到 %d 个 %s 资源:\\n\\n&#34;, namespace, len(resourceList.Items), displayName)\n for i, item := range resourceList.Items {\n  result += fmt.Sprintf(&#34;%d. %s\\n&#34;, i+1, item.GetName())\n\n  // 添加一些额外信息\n  if creationTime := item.GetCreationTimestamp(); !creationTime.IsZero() {\n   result += fmt.Sprintf(&#34;   创建时间: %s\\n&#34;, creationTime.Format(&#34;2006-01-02 15:04:05&#34;))\n  }\n  result += &#34;\\n&#34;\n }\n\n return result, nil\n}</code></pre></div><p data-pid=\"6MMw-9nB\">最后，<code>deleteResource</code> 是用来删除资源信息的，和 <code>queryResource</code> 逻辑差不多，如下：</p><div class=\"highlight\"><pre><code class=\"language-text\">// 删除 K8s 资源\nfunc deleteResource(namespace, resourceType, resourceName string) (string, error) {\n // 创建 Kubernetes 客户端\n clientGo, err := utils.NewClientGo(kubeconfig)\n if err != nil {\n  return &#34;&#34;, fmt.Errorf(&#34;创建 Kubernetes 客户端失败: %v&#34;, err)\n }\n\n // 标准化资源类型\n resourceType = strings.ToLower(resourceType)\n var gvr schema.GroupVersionResource\n var displayName string\n\n switch resourceType {\n case &#34;deployment&#34;, &#34;deployments&#34;:\n  gvr = schema.GroupVersionResource{Group: &#34;apps&#34;, Version: &#34;v1&#34;, Resource: &#34;deployments&#34;}\n  displayName = &#34;Deployment&#34;\n case &#34;service&#34;, &#34;services&#34;, &#34;svc&#34;:\n  gvr = schema.GroupVersionResource{Group: &#34;&#34;, Version: &#34;v1&#34;, Resource: &#34;services&#34;}\n  displayName = &#34;Service&#34;\n case &#34;pod&#34;, &#34;pods&#34;:\n  gvr = schema.GroupVersionResource{Group: &#34;&#34;, Version: &#34;v1&#34;, Resource: &#34;pods&#34;}\n  displayName = &#34;Pod&#34;\n case &#34;configmap&#34;, &#34;configmaps&#34;, &#34;cm&#34;:\n  gvr = schema.GroupVersionResource{Group: &#34;&#34;, Version: &#34;v1&#34;, Resource: &#34;configmaps&#34;}\n  displayName = &#34;ConfigMap&#34;\n case &#34;secret&#34;, &#34;secrets&#34;:\n  gvr = schema.GroupVersionResource{Group: &#34;&#34;, Version: &#34;v1&#34;, Resource: &#34;secrets&#34;}\n  displayName = &#34;Secret&#34;\n default:\n  return &#34;&#34;, fmt.Errorf(&#34;不支持的资源类型: %s。支持的类型: deployment, service, pod, configmap, secret&#34;, resourceType)\n }\n\n // 检查资源是否存在\n _, err = clientGo.DynamicClient.Resource(gvr).Namespace(namespace).Get(context.TODO(), resourceName, metav1.GetOptions{})\n if err != nil {\n  return &#34;&#34;, fmt.Errorf(&#34;资源 %s/%s 在命名空间 &#39;%s&#39; 中不存在: %v&#34;, displayName, resourceName, namespace, err)\n }\n\n // 删除资源\n err = clientGo.DynamicClient.Resource(gvr).Namespace(namespace).Delete(context.TODO(), resourceName, metav1.DeleteOptions{})\n if err != nil {\n  return &#34;&#34;, fmt.Errorf(&#34;删除资源失败: %v&#34;, err)\n }\n\n return fmt.Sprintf(&#34;成功删除 %s/%s 从命名空间 &#39;%s&#39;&#34;, displayName, resourceName, namespace), nil\n}</code></pre></div><p data-pid=\"Yrd4HpVK\">（4）我们将 <code>functionCall</code> 和 <code>startChat</code> 结合起来。</p><p data-pid=\"6jPvo5Ug\">首先，增加一个 <code>processInput</code> 方法，主要用来初始化 <code>openai</code>，并将用户输入传递给大模型。</p><div class=\"highlight\"><pre><code class=\"language-text\">func processInput(input string) string {\n // 1. 初始化 openai\n client, err := utils.NewOpenAIClient()\n if err != nil {\n  return err.Error()\n }\n // 2. 封装 utils/openai.go，调用 OpenAI API 得到回复\n // response, err := client.SendMessage(&#34;你好&#34;, input)\n\n // 3. 调用 OpenAI Function calling\n response := functionCalling(input, client)\n return response\n}</code></pre></div><p data-pid=\"5tWTIWfq\">最后，在 <code>startChat</code> 中调用 <code>processInput</code> 即可。</p><div class=\"highlight\"><pre><code class=\"language-text\">func startChat() {\n scanner := bufio.NewScanner(os.Stdin)\n fmt.Println(&#34;我是 K8S Copilot，你可以向我咨询 K8S 相关问题&#34;)\n\n for {\n  fmt.Print(&#34;&gt; &#34;)\n  if scanner.Scan() {\n   input := scanner.Text()\n   if input == &#34;exit&#34; {\n    fmt.Println(&#34;退出对话&#34;)\n    break\n   }\n   if input == &#34;&#34; {\n    continue\n   }\n   response := processInput(input)\n   fmt.Println(response)\n  }\n }\n}</code></pre></div><p data-pid=\"sZylYUnw\">（5）执行效果如下</p><p class=\"ztext-empty-paragraph\"><br/></p><figure data-size=\"normal\"><img src=\"https://pic4.zhimg.com/v2-48bbe28685ce170c4d2573c0da34b9cf_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"877\" data-rawheight=\"218\" data-original-token=\"v2-83b06c863bbb79cc1a52565faa2e64ae\" class=\"origin_image zh-lightbox-thumb\" width=\"877\" data-original=\"https://pic4.zhimg.com/v2-48bbe28685ce170c4d2573c0da34b9cf_r.jpg\"/></figure><p class=\"ztext-empty-paragraph\"><br/></p><h2>总结</h2><p data-pid=\"TwNwBShG\">本文探讨了如何将人工智能技术与 Kubernetes 运维实践相结合，成功构建了一个名为 <code>k8scopilot</code> 的智能命令行助手。通过整合 <code>client-go</code>、<code>Cobra</code> 和 <code>OpenAI</code> 的 <code>Function Calling</code> 等关键技术，我们实现了一个能够理解自然语言指令并执行相应 Kubernetes 操作的 AI Agent。</p><p data-pid=\"qQqksGuO\">我们首先介绍了与 Kubernetes 集群交互的核心工具 <code>client-go</code>，它是所有自动化操作的基石。接着，我们利用 <code>Cobra</code> 库高效地构建了结构清晰、易于扩展的命令行界面。最后，通过 OpenAI 的大语言模型，特别是其 Function Calling 能力，我们将模糊的自然语言转换为精确的、可编程的 API 调用，实现了从“人理解机器命令”到“机器理解人”的范式转变。</p><p data-pid=\"GpNY6DSU\">最后，求关注。如果你还想看更多优质原创文章，欢迎关注我们的公众号「<b>运维开发故事</b>」。</p><hr/><p data-pid=\"P2yAfjQI\">我是 乔克，《运维开发故事》公众号团队中的一员，一线运维农民工，云原生实践者，这里不仅有硬核的技术干货，还有我们对技术的思考和感悟，欢迎关注我们的公众号，期待和你一起成长！</p>",
        "is_labeled": false,
        "visited_count": 12,
        "thumbnails": [
          "https://pica.zhimg.com/v2-b357cd788a24f2dd9d2040e4c40d8b1f.jpg?source=7e7ef6e2&needBackground=1"
        ],
        "favorite_count": 1,
        "article_type": "normal",
        "is_navigator": false,
        "navigator_vote": false,
        "vote_next_step": "vote"
      },
      "brief": "{\"source\": \"TS\", \"type\": \"article\", \"id\": 1941904010639574034}",
      "attached_info": "CooHCLORnKmrzqKuiwEQBxoJMjYyMDY0ODc2IL26m8UGKAAwAEC0A0okChlUU19TT1VSQ0VfV0FSTV9VUF9OT1JNQUwyEgEwGAAgADoASigKHVRTX1NPVVJDRV9XQVJNVVBfUFJFVFJBSU5fSTJJEgEwGAAgADoAYiBmMDc1YmIwMGMyOWY0YzMzNjI1YTU5YmIzNTFhZTBhN3ITMTk0MTkwNDAxMDYzOTU3NDAzNIIBX2h0dHBzOi8vcGljYS56aGltZy5jb20vdjItYjM1N2NkNzg4YTI0ZjJkZDlkMjA0MGU0YzQwZDhiMWYuanBnP3NvdXJjZT03ZTdlZjZlMiZuZWVkQmFja2dyb3VuZD0xqgEJcmVjb21tZW5kwgEgOWZmOWI1ZGM2MTMwNGVlZjRiZGZjNmY3ODc4NjRlNzLyAQoIDBIGTm9ybWFs8gEoCAoSJGM2MzQ0NWFlLTUyMTItNDljNS1hZmZiLTJjMzdhZDVkMzFlY/IBBggLEgI3M4ICAIgCzLzB+YwzkgIgOWZmOWI1ZGM2MTMwNGVlZjRiZGZjNmY3ODc4NjRlNzKaAgDKAhZTaG9ySW50ZXJlc3RXZWlnaHRSdWxlygIVVXNlckxjbkV4aXRXZWlnaHRSdWxlygIYQ29udGVudFdhcm1VcEJyZWFrSW5SdWxl2gIZVFNfU09VUkNFX1dBUk1fVVBfTk9STUFMMugCA/oCC05PUk1BTF9GTE9XigMgNTNkMmRlMWI0YzcwNDZjM2FmZGI4YTgzYTZlMTM0MzaaAw0KAnYyEAAaBW90aGVyqAMM2AMA6gMTcHJldHJhaW5faTJpX3JlY2FsbPoDfRIMVU5LTk9XTl9NT0RFIAAqDU5PX0lNQUdFX01PREU6LQgBEO0GGNoBIiN2Mi04M2IwNmM4NjNiYmI3OWNjMWE1MjU2NWZhYTJlNjRhZTotCAMQgAgYswMiI3YyLWIzNTdjZDc4OGEyNGYyZGQ5ZDIwNDBlNGM0MGQ4YjFmgAQAiAQAkgQGTm9ybWFsmgQBM6AEAKgEALAEALoEAmFpwgQDNDAwyAQA0gQP5o6o6I2Q5bey5pu05paw2AQA8AQA+QQAAAAAxiuEP4EFAAAAAAAAAACJBeDrRuzUVNk/kgUAmgUDZGZ0ogUDZGZ0sgUBMbkFAAAAAAAAAADQBQDgBQDoBQDwBUmQBgCgBrgDqAYBkgIuCgkyNjIwNjQ4NzYSEzE5NDE5MDQwMTA2Mzk1NzQwMzQYByIKSU1BR0VfVEVYVA==",
      "action_card": false
    },
    {
      "id": "437_1755822710.589",
      "type": "feed",
      "offset": 437,
      "verb": "TOPIC_ACKNOWLEDGED_ANSWER",
      "created_time": 1755822710,
      "updated_time": 1755822710,
      "target": {
        "id": "3496577509",
        "type": "answer",
        "url": "https://api.zhihu.com/answers/3496577509",
        "author": {
          "id": "c82b2e8dbc50b28139542b6fa18ffda3",
          "url": "https://api.zhihu.com/people/c82b2e8dbc50b28139542b6fa18ffda3",
          "user_type": "people",
          "url_token": "chen-guo-qiang-42",
          "name": "Terry陈",
          "headline": "商业智能、数据分析、路漫漫其修远兮。。",
          "avatar_url": "https://picx.zhimg.com/50/v2-763c4c9f4a932986f38bb486c1e7a44c_l.jpg?source=b6762063",
          "is_org": false,
          "gender": 1,
          "followers_count": 2039,
          "is_following": false,
          "is_followed": false
        },
        "created_time": 1715565894,
        "updated_time": 1715565962,
        "voteup_count": 71,
        "thanks_count": 5,
        "comment_count": 5,
        "is_copyable": true,
        "question": {
          "id": "496872666",
          "type": "question",
          "url": "https://api.zhihu.com/questions/496872666",
          "author": {
            "id": "f3c8fb6fc0ea3bd342ddf306828d5e03",
            "url": "https://api.zhihu.com/people/f3c8fb6fc0ea3bd342ddf306828d5e03",
            "user_type": "people",
            "url_token": "xin-yu-26-84",
            "name": "心宇",
            "headline": "BI分析师",
            "avatar_url": "https://pic1.zhimg.com/50/v2-abed1a8c04700ba7d72b45195223e0ff_l.jpg?source=b6762063",
            "is_org": false,
            "gender": -1,
            "followers_count": 6,
            "is_following": false,
            "is_followed": false
          },
          "title": "该用开源BI还是商用BI？",
          "created": 1636105650,
          "answer_count": 0,
          "follower_count": 0,
          "comment_count": 0,
          "bound_topic_ids": [
            99,
            3074,
            4846,
            14441,
            63708
          ],
          "is_following": false,
          "excerpt": "",
          "relationship": {
            "is_author": false
          },
          "detail": "",
          "question_type": "normal"
        },
        "thumbnail": "https://picx.zhimg.com/50/v2-99ec3b05fd121c547bf35fe2d306b8bf_720w.jpg?source=b6762063",
        "excerpt": "用开源的比较多，开源的国外有Superset,Metabase,Redash，国内有润乾报表的润乾开源BI，都用的比较多 Superset由Airbnb贡献的轻量级BI产品，目前在GitHub上有3万多颗星，其受欢迎程度可见一斑。Superset提供了Dashboard和多维分析两大类功能，后者可以将制作的结果发布到Dashboard上也可以单独使用。   数据源方面，Superset支持CSV、MySQL、Oracle、Redshift、Drill、Hive、Impala、Elasticsearch等27种数据源，并深度支持Druid…",
        "excerpt_new": "用开源的比较多，开源的国外有Superset,Metabase,Redash，国内有润乾报表的润乾开源BI，都用的比较多 Superset由Airbnb贡献的轻量级BI产品，目前在GitHub上有3万多颗星，其受欢迎程度可见一斑。Superset提供了Dashboard和多维分析两大类功能，后者可以将制作的结果发布到Dashboard上也可以单独使用。   数据源方面，Superset支持CSV、MySQL、Oracle、Redshift、Drill、Hive、Impala、Elasticsearch等27种数据源，并深度支持Druid…",
        "preview_type": "default",
        "preview_text": "",
        "reshipment_settings": "allowed",
        "content": "<p data-pid=\"q-oh5aWd\">用开源的比较多，开源的国外有Superset,Metabase,Redash，国内有润乾报表的润乾开源BI，都用的比较多</p><h2>Superset</h2><p data-pid=\"HbZZn8BO\">由Airbnb贡献的轻量级BI产品，目前在GitHub上有3万多颗星，其受欢迎程度可见一斑。Superset提供了Dashboard和多维分析两大类功能，后者可以将制作的结果发布到Dashboard上也可以单独使用。</p><p class=\"ztext-empty-paragraph\"><br/></p><figure data-size=\"normal\"><img src=\"https://pic1.zhimg.com/v2-8758685bea92cb32ae578909a87c6a62_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1268\" data-rawheight=\"1154\" data-original-token=\"v2-c1eb50adf204483472399065a38d90a2\" data-default-watermark-src=\"https://pic1.zhimg.com/v2-db5cab8dffd466aef5584d5b83fe9b6e_b.jpg\" class=\"origin_image zh-lightbox-thumb\" width=\"1268\" data-original=\"https://pic1.zhimg.com/v2-8758685bea92cb32ae578909a87c6a62_r.jpg\"/></figure><p class=\"ztext-empty-paragraph\"><br/></p><p data-pid=\"nKy6rMh9\">数据源方面，Superset支持CSV、MySQL、Oracle、Redshift、Drill、Hive、Impala、Elasticsearch等27种数据源，并深度支持Druid。</p><p data-pid=\"DF1gg5Av\">Superset语义层建模（被称为Table）时只能基于单表，多表关联要事先逻辑化成视图再使用，这点有点别扭。在Table里要显示地将字段标记成可分组、可过滤，指定聚合方式（计数、求和等），页面在使用时需要选择Group by（并没有叫做维度）、Metrics和Filter进行查询。</p><p class=\"ztext-empty-paragraph\"><br/></p><figure data-size=\"normal\"><img src=\"https://pica.zhimg.com/v2-ba9f9d1e1ede930ba73e09d329a5e582_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1174\" data-rawheight=\"386\" data-original-token=\"v2-75c9d6e8f74889db0693bdb4ba3d27a8\" data-default-watermark-src=\"https://pic4.zhimg.com/v2-d78c7fdfec50d8cb2c439c09cecb009d_b.jpg\" class=\"origin_image zh-lightbox-thumb\" width=\"1174\" data-original=\"https://pica.zhimg.com/v2-ba9f9d1e1ede930ba73e09d329a5e582_r.jpg\"/></figure><p class=\"ztext-empty-paragraph\"><br/></p><p data-pid=\"Cx3sHV3N\">Superset可以在多个时间维度上观察，商业分析中的很多问题都是与时间密切相关的。Superset 有 4 种专门针对时间序列的图表，使用这些图表时，你需要指定一个字段为时间维度，之后就可以对时间维度做丰富的操作。</p><p data-pid=\"m7kVXKAP\">Ø 从不同时间粒度去查看你关心的指标（小时/日/周/月/季度/年）</p><p data-pid=\"-zDKhqDx\">Ø 对时间序列做移动平均，比如看一个指标的 7 日平均线</p><p data-pid=\"el6-Cesv\">Ø 可以对时间序列做偏移，再做对比，比如把本周的销售业绩与上周同期放在一张图表中对比</p><p data-pid=\"H9WSeJFQ\">Ø 不在图表上显示指标的绝对值，而是显示它随着时间变化的增长速度</p><p data-pid=\"r64ZplSp\">Superset还提供了直接使用SQL查询生成图表的方式（SQL Lab）来强化临时分析，方便数据分析师编写SQL查询数据。</p><p data-pid=\"OsMUptN-\">Superset的可视化效果非常好，直接支持了几十种图形，从前面的截图中可以看到可视化效果很棒。重要的是，它还提供了图形扩展支持，通过开发插件还可以对接任意可视化库，如ECharts、AntV、HighCharts、VX和D3，这点对用户非常实用。</p><p data-pid=\"LMOH2rwx\">文档方面，Superset表现比较糟糕，写的过于简单，虽然在安装与快速入门方面提供了很完整的文档，但在具体功能的介绍方面文档严重缺失。就算有些功能有文档，文档的结构也很混乱，所以大部分功能只能自己去尝试。</p><p data-pid=\"zu22Qwe6\">Superset作为一个完整的BI系统，除了Dashboard和多维分析还包括调度和邮件报表，以及系统管理和权限控制等平台管理功能。综合来看，Superset作为大厂开源的BI产品还是非常值得一用。</p><p class=\"ztext-empty-paragraph\"><br/></p><h2>Metabase</h2><p data-pid=\"U48G9-GJ\">Metabase 目前在 GitHub 上受欢迎程度仅次于 Superset，Metabase 也是一个完整的 BI 平台，但在设计理念上与 Superset 大不相同。Metabase 非常注重非技术人员（如产品经理、市场运营人员）在使用这个工具时的体验，让他们能自由地探索数据，回答自己的问题。而在 Superset 里，非技术人员基本上只能看预先建好的 Dashboard，不懂 SQL 或是数据库结构的他们，很难自己去摸索。</p><p data-pid=\"wdxiD8D9\">Metabase 采用“问问题”的方式实现一步步数据探索，探索的结果可以保存并发布为 Dashboard。对于复杂问题还提供了 Native query 允许用户编写 SQL 或 native query。</p><p class=\"ztext-empty-paragraph\"><br/></p><figure data-size=\"normal\"><img src=\"https://pic4.zhimg.com/v2-10412cc89a8d7c98f676d77eecc25005_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1270\" data-rawheight=\"671\" data-original-token=\"v2-d42e8d0a8a7cfde9135f904f1b4ae643\" data-default-watermark-src=\"https://picx.zhimg.com/v2-34a081c10a1da39c7a8c05bb904a82a5_b.jpg\" class=\"origin_image zh-lightbox-thumb\" width=\"1270\" data-original=\"https://pic4.zhimg.com/v2-10412cc89a8d7c98f676d77eecc25005_r.jpg\"/></figure><p class=\"ztext-empty-paragraph\"><br/></p><p data-pid=\"7B3BhM-4\">数据源方面，Metabase 支持 Redshift、Druid、Google BigQuery、MongoDB、MySQL、PG 等 15 种数据源。</p><p data-pid=\"jPYhmiao\">Metabase 社区版的文档写的简单到让你不知所措的地步，表现十分糟糕。好在这个产品使用起来不难（本身定位就是给业务用户使用的）。</p><h2>Redash</h2><p data-pid=\"PqPvRU_w\">如果说 Superset 和 Metabase 是构建一个 BI 平台，那 Redash 目标就是更纯粹地做好数据查询结果的可视化。Redash 支持很多种数据源，除了最常用的 SQL 数据库，也支持 MongoDB, Elasticsearch, Google Spreadsheet 甚至是一个 JSON 文件。目前 Redash 支持超过 35 种 SQL 和 NoSQL 数据源。</p><p class=\"ztext-empty-paragraph\"><br/></p><figure data-size=\"normal\"><img src=\"https://pic4.zhimg.com/v2-68bdb2610ba405ef05d27906e35f8a69_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1200\" data-rawheight=\"675\" data-original-token=\"v2-3ae78260959d5ea6112a7a77403df1ac\" data-default-watermark-src=\"https://pic4.zhimg.com/v2-4c5d69f302a131b9c853d337a7222ecf_b.jpg\" class=\"origin_image zh-lightbox-thumb\" width=\"1200\" data-original=\"https://pic4.zhimg.com/v2-68bdb2610ba405ef05d27906e35f8a69_r.jpg\"/></figure><p class=\"ztext-empty-paragraph\"><br/></p><p data-pid=\"RictXEqH\">它不需要像 Superset 那样在创建图表前先定义表和指标，而是可以非常直观地将一个 SQL 查询的结果可视化，这使得它上手很简易。或者说 Redash 仅仅实现了 Superset 中 SQL Lab 的功能，但却把这个功能做到了极致。</p><p data-pid=\"Bt4pHFbo\">Redash 有两个非常实用的功能，Query Snippet 与 Query Parameters。</p><p data-pid=\"k7HHA31T\">Query Snippet 很好地解决了查询片段的复用问题。做数据报表时经常要用到十分复杂的 SQL 语句，这些语句中肯定有一些片段是可以在多个查询中复用的。在 Redash 中我们可以将这些片段定义成 Snippet，之后方便地复用。</p><p data-pid=\"cNukvZ_1\">Query Parameters 可以为查询添加可定制参数，让这个图表变得更灵活。比如一个移动应用的日活指标，我可能有时要按 iOS/Android 切分，有时要按地域切分，或是按新老用户切分。在 Superset 的 Dashboard 上要做三个表图。Redash 里我可以把查询的 groupby 做为一个参数，这样就可以在一张图上搞定。用的时候，运营人员可以在图表上方的一个下拉框里选择切分的方式，非常直观好用。</p><p data-pid=\"MInaqwqc\">Redash 的 Dashboard 可以通过命名来进行分组，Dashboard 的名字可以有一个前缀并以冒号结尾，前缀相同的 Dashboard 就会自动被分为一组。例如“ Growth: Daily ”，“ Growth: Weekly ”这两个 Dashboard 都会被分到“ Growth ”组下。</p><p data-pid=\"aVKGt_yI\">Redash 在文档方面做得很好，除了快速入门教程以外，每一个功能模块都有文档且条理清晰。</p><p data-pid=\"x75QdSq-\">当然 Redash 也有自己的不足之处，它的可视化种类比 Superset 逊色不少（不过其实也够用了）。另外，由于它只是纯粹地把数据查询结果可视化，所以也没有 Superset 里那些对时间维度上的聚合与对比的操作。</p><h2>润乾开源BI</h2><p data-pid=\"Z1JvpXHP\">润乾开源BI多维分析功能与 Superset 类似，通过在页面上拖拽维度和指标进行数据查询，同时可以进行切片和旋转等操作。润乾报表允许用户直接基于文件分析，也可以编写 SQL 进行数据查询生成图表，同时为了保证性能还可以使用自有的私有存储格式。</p><figure data-size=\"normal\"><img src=\"https://pic3.zhimg.com/v2-116a6be16f664df83c9fa74e90a5a20c_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1626\" data-rawheight=\"816\" data-original-token=\"v2-359186d48d0b3f9dea19c0956ee87080\" data-default-watermark-src=\"https://pic3.zhimg.com/v2-ce67b8846c5b086bd57a16e9c3674198_b.jpg\" class=\"origin_image zh-lightbox-thumb\" width=\"1626\" data-original=\"https://pic3.zhimg.com/v2-116a6be16f664df83c9fa74e90a5a20c_r.jpg\"/></figure><figure data-size=\"normal\"><img src=\"https://pica.zhimg.com/v2-8726ae507f785671bf7be785f3e3fd2a_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1600\" data-rawheight=\"900\" data-original-token=\"v2-5335292f7f0685ee5c9776962f64a3e2\" data-default-watermark-src=\"https://pic1.zhimg.com/v2-4d5a1236d1f035f9280bc5811ffc9c06_b.jpg\" class=\"origin_image zh-lightbox-thumb\" width=\"1600\" data-original=\"https://pica.zhimg.com/v2-8726ae507f785671bf7be785f3e3fd2a_r.jpg\"/></figure><figure data-size=\"normal\"><img src=\"https://picx.zhimg.com/v2-fd5732802abadb6175deaf089fb831e3_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1911\" data-rawheight=\"1021\" data-original-token=\"v2-6effa3c8dffe2d47c22dcc72abb38bab\" data-default-watermark-src=\"https://picx.zhimg.com/v2-1b2202cd28f5f120d2903d17a1259873_b.jpg\" class=\"origin_image zh-lightbox-thumb\" width=\"1911\" data-original=\"https://picx.zhimg.com/v2-fd5732802abadb6175deaf089fb831e3_r.jpg\"/></figure><p data-pid=\"Oazd9Qsu\">在语义层建模中，<b>润乾BI支持多表关联（JOIN）</b>。特别地，在润乾报表中需要将维度显示制定成一个表，如果没有对应的表则需要建立虚拟表，这样做的好处是前端查询分析界面可以很方便地实现多表实时关联查询，而<b>不必每次都必须基于一个（物理或逻辑）宽表</b>。</p><p class=\"ztext-empty-paragraph\"><br/></p><figure data-size=\"normal\"><img src=\"https://pic4.zhimg.com/v2-63b3f07a1a172b02137f26d3a85346bf_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1632\" data-rawheight=\"828\" data-original-token=\"v2-bf9a5f14a42d6ec9ec15a3332eee8558\" data-default-watermark-src=\"https://pica.zhimg.com/v2-6cd882742ffef02fc49e2986f55e535a_b.jpg\" class=\"origin_image zh-lightbox-thumb\" width=\"1632\" data-original=\"https://pic4.zhimg.com/v2-63b3f07a1a172b02137f26d3a85346bf_r.jpg\"/></figure><figure data-size=\"normal\"><img src=\"https://pic4.zhimg.com/v2-531252c9f3375ca7c8ac36d16180bda5_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1600\" data-rawheight=\"900\" data-original-token=\"v2-4b23dd753a2adcc0fe4d78b5eeadcf43\" data-default-watermark-src=\"https://pica.zhimg.com/v2-3f01f75ab55cdd181d5faa2524f5102e_b.jpg\" class=\"origin_image zh-lightbox-thumb\" width=\"1600\" data-original=\"https://pic4.zhimg.com/v2-531252c9f3375ca7c8ac36d16180bda5_r.jpg\"/></figure><p data-pid=\"3mBeOEGy\">可以通过多维分析拖拽图表来组织 Dashboard，根据指定（或自定义）布局生成，同时可以使用全局参数进行数据过滤分析。</p><p class=\"ztext-empty-paragraph\"><br/></p><figure data-size=\"normal\"><img src=\"https://pic4.zhimg.com/v2-7c40105726c4dd550391eb47e58f4e03_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1964\" data-rawheight=\"1279\" data-original-token=\"v2-a3eb3ecbe1f0b3e1d5588a2648c2e797\" data-default-watermark-src=\"https://picx.zhimg.com/v2-793b40efeb9a5cd55124f28d396d484f_b.jpg\" class=\"origin_image zh-lightbox-thumb\" width=\"1964\" data-original=\"https://pic4.zhimg.com/v2-7c40105726c4dd550391eb47e58f4e03_r.jpg\"/></figure><figure data-size=\"normal\"><img src=\"https://pic3.zhimg.com/v2-8b33f49f1490d076e411261bd045e6a0_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1600\" data-rawheight=\"900\" data-original-token=\"v2-2d9ad95025defd008d9ae0e450cbc8f0\" data-default-watermark-src=\"https://pic2.zhimg.com/v2-eff16d517cec5f1d5a883a8e0d154d15_b.jpg\" class=\"origin_image zh-lightbox-thumb\" width=\"1600\" data-original=\"https://pic3.zhimg.com/v2-8b33f49f1490d076e411261bd045e6a0_r.jpg\"/></figure><p data-pid=\"mrU1O2Mf\">润乾BI的另外一个优势是<b>复杂报表的处理能力</b>。</p><p data-pid=\"6tPB_L3_\">我们知道，国内的报表具备很强的本土特征，润乾报表最初是为实现复杂报表而设计的报表工具，是目前主流产品（含商业）中做的最早也是实现得最好的一个。</p><p class=\"ztext-empty-paragraph\"><br/></p><figure data-size=\"normal\"><img src=\"https://pic4.zhimg.com/v2-60e52aaf00c2916cc38c524fa001adab_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1651\" data-rawheight=\"772\" data-original-token=\"v2-76fd3b038ea0b2bb903780c1c910d015\" data-default-watermark-src=\"https://pic2.zhimg.com/v2-285c9012af1e9ce24c439825286bd49f_b.jpg\" class=\"origin_image zh-lightbox-thumb\" width=\"1651\" data-original=\"https://pic4.zhimg.com/v2-60e52aaf00c2916cc38c524fa001adab_r.jpg\"/></figure><p class=\"ztext-empty-paragraph\"><br/></p><p data-pid=\"mZSdSNb2\">在这方面，无论使用上面提到的任意一款工具都无法很好满足。</p><p data-pid=\"qtNTC7ok\">润乾报表的定位跟 Redash 很像，都希望提供便捷的方式让用户迅速得到分析结果。同时也提供了一个轻量级的管理平台（报表中心）包括资源管理、权限控制以及邮件订阅等功能。</p><p data-pid=\"DciC8Bc4\">润乾报表提供了 BI 平台的同时也支持按模块集成，可以将产品中各个模块根据需要单独集成到已有的项目中，这对已有平台系统的用户非常方便。</p><p data-pid=\"k4BmYyq1\">需要注意的是，润乾报表并非所有功能都开源，目前开源的部分包括：多维分析前端界面、报表中心和 Dashboard。如果需要使用基础报表、多维分析服务器等部分则需要付费，不过价格并不高。</p><p class=\"ztext-empty-paragraph\"><br/></p><h2>总结</h2><p data-pid=\"fRZfI0bP\">开源BI和商用BI的选择，差不多一直是对半分的局面，现在有了润乾BI这类的国产化的开源BI后，用户的选择就更倾向开源一些了，因为分析功能完整好用，中文页面好改造，好集成，又符合国产信创，安可等标准，而且能顺带把固定，复杂报表的需求也一起解决了，确实没必要选几十万的商用的了 </p>",
        "relationship": {
          "is_thanked": false,
          "is_nothelp": false,
          "voting": 0
        },
        "is_labeled": false,
        "visited_count": 8539,
        "thumbnails": [
          "https://picx.zhimg.com/50/v2-99ec3b05fd121c547bf35fe2d306b8bf_720w.jpg?source=b6762063",
          "https://pic1.zhimg.com/50/v2-07b3d8b0f75f24f69dd265adadea72fd_720w.jpg?source=b6762063",
          "https://pic1.zhimg.com/50/v2-4a2af604c7bb3c29ce37c42779893896_720w.jpg?source=b6762063",
          "https://pic1.zhimg.com/50/v2-253f4d355f091ca1b5ac9654124e8859_720w.jpg?source=b6762063",
          "https://pic1.zhimg.com/50/v2-8ce26fbbc4d476d305cf728d5911693f_720w.jpg?source=b6762063",
          "https://pica.zhimg.com/50/v2-d424e0b62b5fcc0a9d2a5c9789a8f454_720w.jpg?source=b6762063",
          "https://pic1.zhimg.com/50/v2-741415c438e75f809aceabc3ec5aeea5_720w.jpg?source=b6762063",
          "https://pic1.zhimg.com/50/v2-19343e6f346f6b151a1f4b0216cabd71_720w.jpg?source=b6762063",
          "https://picx.zhimg.com/50/v2-09a32d0c0a787be1737c3fd779a1e5f1_720w.jpg?source=b6762063",
          "https://pica.zhimg.com/50/v2-1a8a2d2e966c65d1d32c51bc662fa3f6_720w.jpg?source=b6762063",
          "https://picx.zhimg.com/50/v2-664ea7992a02061da4a92d0767b4a9a4_720w.jpg?source=b6762063"
        ],
        "favorite_count": 318,
        "answer_type": "normal",
        "is_navigator": false,
        "navigator_vote": false,
        "vote_next_step": "vote"
      },
      "brief": "{\"source\": \"TS\", \"type\": \"answer\", \"id\": 3496577509}",
      "attached_info": "CuUKCLORnKmrzqKuiwEQBBoJNjY1ODEzNzAxIMbqhbIGKEcwBUC1A0pCCi1UU19TT1VSQ0VfVFdPVE9XRVJfTVVMVElfU0NFTkVfVjFfUkVDQUxMX1RFWFQSATAYACAAOgp7InJhdyI6IiJ9Wgg3MjY5NzQwOWIgZjA3NWJiMDBjMjlmNGMzMzYyNWE1OWJiMzUxYWUwYTdyCjM0OTY1Nzc1MDmKAQk0OTY4NzI2NjaqAQlyZWNvbW1lbmTCASBjODJiMmU4ZGJjNTBiMjgxMzk1NDJiNmZhMThmZmRhM/IBCggMEgZOb3JtYWzyASgIChIkYTIzNTZlMjUtYTgyOC00ZDA3LTg3MTItZmRhYzZkNjc2Yzg28gEGCAsSAjczggIAiALMvMH5jDOSAiBjODJiMmU4ZGJjNTBiMjgxMzk1NDJiNmZhMThmZmRhM5oCAMoCFUxlc3NTaW1pbGFyV2VpZ2h0UnVsZcoCFlNob3JJbnRlcmVzdFdlaWdodFJ1bGXKAhVVc2VyTGNuRXhpdFdlaWdodFJ1bGXKAhdUZXN0ZWRBbmRXb3JrV2VpZ2h0UnVsZcoCHEJheWVzRmlyc3RMZXZlbElzb2xhdGlvblJ1bGXKAhVRdWVzdGlvbklzb2xhdGlvblJ1bGXaAi1UU19TT1VSQ0VfVFdPVE9XRVJfTVVMVElfU0NFTkVfVjFfUkVDQUxMX1RFWFToAgP6AgtOT1JNQUxfRkxPV4oDIDUzZDJkZTFiNGM3MDQ2YzNhZmRiOGE4M2E2ZTEzNDM2mgMNCgJ2MhAAGgVvdGhlcqgD20LYAwDqAxV0ZXh0RmVlZFR3b1Rvd2VyVjFBbGz6A9MEEgxVTktOT1dOX01PREUgACoNTk9fSU1BR0VfTU9ERTotCAIQ9AkYggkiI3YyLWMxZWI1MGFkZjIwNDQ4MzQ3MjM5OTA2NWEzOGQ5MGEyOi0IAhCWCRiCAyIjdjItNzVjOWQ2ZThmNzQ4ODlkYjA2OTNiZGI0YmEzZDI3YTg6LQgCEPYJGJ8FIiN2Mi1kNDJlOGQwYThhN2NmZGU5MTM1ZjkwNGYxYjRhZTY0MzotCAIQsAkYowUiI3YyLTNhZTc4MjYwOTU5ZDVlYTYxMTJhN2E3NzQwM2RmMWFjOi0IAhDaDBiwBiIjdjItMzU5MTg2ZDQ4ZDBiM2Y5ZGVhMTljMDk1NmVlODcwODA6LQgDEMAMGIQHIiN2Mi01MzM1MjkyZjdmMDY4NWVlNWM5Nzc2OTYyZjY0YTNlMjotCAIQ9w4Y/QciI3YyLTZlZmZhM2M4ZGZmZTJkNDdjMjJkY2M3MmFiYjM4YmFiOi0IAhDgDBi8BiIjdjItYmY5YTVmMTRhNDJkNmVjOWVjMTVhMzMzMmVlZTg1NTg6LQgDEMAMGIQHIiN2Mi00YjIzZGQ3NTNhMmFkY2MwZmU0ZDc4YjVlZWFkY2Y0MzotCAMQrA8Y/wkiI3YyLWEzZWIzZWNiZTFmMGIzZTFkNTU4OGEyNjQ4YzJlNzk3Oi0IAxDADBiEByIjdjItMmQ5YWQ5NTAyNWRlZmQwMDhkOWFlMGU0NTBjYmM4ZjA6LQgCEPMMGIQGIiN2Mi03NmZkM2IwMzhlYTBiMmJiOTAzNzgwYzFjOTEwZDAxNYAEAIgEAJIEBk5vcm1hbJoEATOgBACoBACwBAC6BAJhacIEAzQwMMgEANIED+aOqOiNkOW3suabtOaWsNgEAPAEAPkEAAAAICnOqj+BBQAAAAAAAAAAiQXg60bs1FTZP5IFAJoFA2RmdKIFA2RmdLIFATG5BQAAAAAAAAAA0AUA4AUA6AUA8AVJkAYAoAa5A6gGAJICJQoJNjY1ODEzNzAxEgozNDk2NTc3NTA5GAQiCklNQUdFX1RFWFQ=",
      "action_card": false
    }
  ],
  "paging": {
    "is_end": false,
    "is_start": false,
    "next": "https://www.zhihu.com/api/v3/feed/topstory/recommend?action=down&ad_interval=-10&after_id=437&desktop=true&end_offset=441&page_number=74&session_token=f075bb00c29f4c33625a59bb351ae0a7",
    "previous": "https://www.zhihu.com/api/v3/feed/topstory/recommend?action=pull&ad_interval=-10&before_id=437&desktop=true&end_offset=441&page_number=74&session_token=f075bb00c29f4c33625a59bb351ae0a7",
    "totals": 0
  },
  "fresh_text": "推荐已更新"
}