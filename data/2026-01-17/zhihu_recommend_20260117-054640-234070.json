{
  "data": [
    {
      "id": "48_1768600007.150",
      "type": "feed",
      "offset": 48,
      "verb": "TOPIC_ACKNOWLEDGED_ARTICLE",
      "created_time": 1768600007,
      "updated_time": 1768600007,
      "target": {
        "url": "https://api.zhihu.com/articles/1995226469203452091",
        "author": {
          "user_type": "people",
          "avatar_url": "https://pica.zhimg.com/50/v2-abed1a8c04700ba7d72b45195223e0ff_l.jpg?source=b6762063",
          "gender": 1,
          "is_following": false,
          "is_followed": false,
          "id": "9d5086458b8719e8f5e0d700cb63f862",
          "url": "https://api.zhihu.com/people/9d5086458b8719e8f5e0d700cb63f862",
          "headline": "æ°´æ³¢ä¸å…´",
          "is_org": false,
          "followers_count": 16,
          "url_token": "xu-yan-qing-6-76",
          "name": "æ¸…é£å¾æ¥"
        },
        "title": "luaæºç å­¦ä¹ ï¼ˆday7ï¼‰",
        "excerpt_new": "ğŸ“‹ æ–‡æ¡£å¯¼èˆªå¼•è¨€ ç¬¬ä¸€éƒ¨åˆ†ï¼šè¯­å¥è§£ææ¶æ„æ¦‚è§ˆ ç¬¬äºŒéƒ¨åˆ†ï¼šæ¡ä»¶æ§åˆ¶è¯­å¥ ç¬¬ä¸‰éƒ¨åˆ†ï¼šå¾ªç¯æ§åˆ¶è¯­å¥ ç¬¬å››éƒ¨åˆ†ï¼šèµ‹å€¼ä¸å‡½æ•°è°ƒç”¨ ç¬¬äº”éƒ¨åˆ†ï¼šä½œç”¨åŸŸç®¡ç† ç¬¬å…­éƒ¨åˆ†ï¼šè·³è½¬è¯­å¥å¤„ç† ç¬¬ä¸ƒéƒ¨åˆ†ï¼šé”™è¯¯æ¢å¤æœºåˆ¶ ç¬¬å…«éƒ¨åˆ†ï¼šå®è·µä¸è°ƒè¯• é™„å½• ğŸ¯ å¼•è¨€æ–‡æ¡£å®šä½æœ¬æ–‡æ¡£æ˜¯å¯¹ Lua 5.1.5 é€’å½’ä¸‹é™è§£æå™¨ä¸­ è¯­å¥è§£æç³»ç»Ÿçš„æ·±åº¦ä¸“é¢˜åˆ†æã€‚è¯­å¥è§£ææ˜¯ç¼–è¯‘å™¨å‰ç«¯çš„æ ¸å¿ƒç»„æˆéƒ¨åˆ†ï¼Œè´Ÿè´£å°†ç¨‹åºçš„æ§åˆ¶æµç»“æ„è½¬æ¢ä¸ºå¯æ‰§è¡Œçš„å­—èŠ‚ç æŒ‡ä»¤ã€‚æˆ‘ä»¬å°†æ·±å…¥æ¢è®¨ Lua å¦‚ä½•å¤„ç†å„ç§â€¦",
        "preview_type": "default",
        "favorite_count": 5,
        "is_navigator": false,
        "vote_next_step": "vote",
        "created": 1768479941,
        "voting": 0,
        "comment_count": 0,
        "linkbox": {
          "category": "",
          "pic": "",
          "title": "",
          "url": ""
        },
        "excerpt": "ğŸ“‹ æ–‡æ¡£å¯¼èˆªå¼•è¨€ ç¬¬ä¸€éƒ¨åˆ†ï¼šè¯­å¥è§£ææ¶æ„æ¦‚è§ˆ ç¬¬äºŒéƒ¨åˆ†ï¼šæ¡ä»¶æ§åˆ¶è¯­å¥ ç¬¬ä¸‰éƒ¨åˆ†ï¼šå¾ªç¯æ§åˆ¶è¯­å¥ ç¬¬å››éƒ¨åˆ†ï¼šèµ‹å€¼ä¸å‡½æ•°è°ƒç”¨ ç¬¬äº”éƒ¨åˆ†ï¼šä½œç”¨åŸŸç®¡ç† ç¬¬å…­éƒ¨åˆ†ï¼šè·³è½¬è¯­å¥å¤„ç† ç¬¬ä¸ƒéƒ¨åˆ†ï¼šé”™è¯¯æ¢å¤æœºåˆ¶ ç¬¬å…«éƒ¨åˆ†ï¼šå®è·µä¸è°ƒè¯• é™„å½• ğŸ¯ å¼•è¨€æ–‡æ¡£å®šä½æœ¬æ–‡æ¡£æ˜¯å¯¹ Lua 5.1.5 é€’å½’ä¸‹é™è§£æå™¨ä¸­ è¯­å¥è§£æç³»ç»Ÿçš„æ·±åº¦ä¸“é¢˜åˆ†æã€‚è¯­å¥è§£ææ˜¯ç¼–è¯‘å™¨å‰ç«¯çš„æ ¸å¿ƒç»„æˆéƒ¨åˆ†ï¼Œè´Ÿè´£å°†ç¨‹åºçš„æ§åˆ¶æµç»“æ„è½¬æ¢ä¸ºå¯æ‰§è¡Œçš„å­—èŠ‚ç æŒ‡ä»¤ã€‚æˆ‘ä»¬å°†æ·±å…¥æ¢è®¨ Lua å¦‚ä½•å¤„ç†å„ç§â€¦",
        "is_labeled": false,
        "article_type": "normal",
        "id": "1995226469203452091",
        "comment_permission": "all",
        "updated": 1768541629,
        "visited_count": 66,
        "navigator_vote": false,
        "type": "article",
        "voteup_count": 0,
        "preview_text": "",
        "content": "<h3>ğŸ“‹ æ–‡æ¡£å¯¼èˆª</h3><ul><li data-pid=\"t6JDtx60\"><a href=\"https://zhuanlan.zhihu.com/p/1995226469203452091/edit#%E5%BC%95%E8%A8%80\" class=\"internal\" target=\"_blank\">å¼•è¨€</a></li><li data-pid=\"kegiZEIB\"><a href=\"https://zhuanlan.zhihu.com/p/1995226469203452091/edit#%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86%E8%AF%AD%E5%8F%A5%E8%A7%A3%E6%9E%90%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88\" class=\"internal\" target=\"_blank\">ç¬¬ä¸€éƒ¨åˆ†ï¼šè¯­å¥è§£ææ¶æ„æ¦‚è§ˆ</a></li><li data-pid=\"sPDdrgoR\"><a href=\"https://zhuanlan.zhihu.com/p/1995226469203452091/edit#%E7%AC%AC%E4%BA%8C%E9%83%A8%E5%88%86%E6%9D%A1%E4%BB%B6%E6%8E%A7%E5%88%B6%E8%AF%AD%E5%8F%A5\" class=\"internal\" target=\"_blank\">ç¬¬äºŒéƒ¨åˆ†ï¼šæ¡ä»¶æ§åˆ¶è¯­å¥</a></li><li data-pid=\"b7OaTbtH\"><a href=\"https://zhuanlan.zhihu.com/p/1995226469203452091/edit#%E7%AC%AC%E4%B8%89%E9%83%A8%E5%88%86%E5%BE%AA%E7%8E%AF%E6%8E%A7%E5%88%B6%E8%AF%AD%E5%8F%A5\" class=\"internal\" target=\"_blank\">ç¬¬ä¸‰éƒ¨åˆ†ï¼šå¾ªç¯æ§åˆ¶è¯­å¥</a></li><li data-pid=\"zxpmtvHN\"><a href=\"https://zhuanlan.zhihu.com/p/1995226469203452091/edit#%E7%AC%AC%E5%9B%9B%E9%83%A8%E5%88%86%E8%B5%8B%E5%80%BC%E4%B8%8E%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8\" class=\"internal\" target=\"_blank\">ç¬¬å››éƒ¨åˆ†ï¼šèµ‹å€¼ä¸å‡½æ•°è°ƒç”¨</a></li><li data-pid=\"ag0IirFf\"><a href=\"https://zhuanlan.zhihu.com/p/1995226469203452091/edit#%E7%AC%AC%E4%BA%94%E9%83%A8%E5%88%86%E4%BD%9C%E7%94%A8%E5%9F%9F%E7%AE%A1%E7%90%86\" class=\"internal\" target=\"_blank\">ç¬¬äº”éƒ¨åˆ†ï¼šä½œç”¨åŸŸç®¡ç†</a></li><li data-pid=\"cH6gro0p\"><a href=\"https://zhuanlan.zhihu.com/p/1995226469203452091/edit#%E7%AC%AC%E5%85%AD%E9%83%A8%E5%88%86%E8%B7%B3%E8%BD%AC%E8%AF%AD%E5%8F%A5%E5%A4%84%E7%90%86\" class=\"internal\" target=\"_blank\">ç¬¬å…­éƒ¨åˆ†ï¼šè·³è½¬è¯­å¥å¤„ç†</a></li><li data-pid=\"PCwbgiiK\"><a href=\"https://zhuanlan.zhihu.com/p/1995226469203452091/edit#%E7%AC%AC%E4%B8%83%E9%83%A8%E5%88%86%E9%94%99%E8%AF%AF%E6%81%A2%E5%A4%8D%E6%9C%BA%E5%88%B6\" class=\"internal\" target=\"_blank\">ç¬¬ä¸ƒéƒ¨åˆ†ï¼šé”™è¯¯æ¢å¤æœºåˆ¶</a></li><li data-pid=\"GyRpmtxE\"><a href=\"https://zhuanlan.zhihu.com/p/1995226469203452091/edit#%E7%AC%AC%E5%85%AB%E9%83%A8%E5%88%86%E5%AE%9E%E8%B7%B5%E4%B8%8E%E8%B0%83%E8%AF%95\" class=\"internal\" target=\"_blank\">ç¬¬å…«éƒ¨åˆ†ï¼šå®è·µä¸è°ƒè¯•</a></li><li data-pid=\"gsW92RiW\"><a href=\"https://zhuanlan.zhihu.com/p/1995226469203452091/edit#%E9%99%84%E5%BD%95\" class=\"internal\" target=\"_blank\">é™„å½•</a></li></ul><hr/><h3>ğŸ¯ å¼•è¨€</h3><h3>æ–‡æ¡£å®šä½</h3><p data-pid=\"C48_kjty\">æœ¬æ–‡æ¡£æ˜¯å¯¹ Lua 5.1.5 é€’å½’ä¸‹é™è§£æå™¨ä¸­<b>è¯­å¥è§£æç³»ç»Ÿ</b>çš„æ·±åº¦ä¸“é¢˜åˆ†æã€‚è¯­å¥è§£ææ˜¯ç¼–è¯‘å™¨å‰ç«¯çš„æ ¸å¿ƒç»„æˆéƒ¨åˆ†ï¼Œè´Ÿè´£å°†ç¨‹åºçš„æ§åˆ¶æµç»“æ„è½¬æ¢ä¸ºå¯æ‰§è¡Œçš„å­—èŠ‚ç æŒ‡ä»¤ã€‚æˆ‘ä»¬å°†æ·±å…¥æ¢è®¨ Lua å¦‚ä½•å¤„ç†å„ç§è¯­å¥ç±»å‹ï¼Œä»¥åŠå®ƒä»¬å¦‚ä½•ä¸ä»£ç ç”Ÿæˆå™¨ååŒå·¥ä½œã€‚</p><h3>ä¸ºä»€ä¹ˆéœ€è¦è¿™ä»½æ–‡æ¡£ï¼Ÿ</h3><p data-pid=\"m8JNN8Mq\">åœ¨å­¦ä¹  Lua è§£æå™¨çš„è¯­å¥å¤„ç†æ—¶ï¼Œå¼€å‘è€…ç»å¸¸é‡åˆ°ä»¥ä¸‹å›°æƒ‘ï¼š</p><p data-pid=\"dHgXVwLS\">â“ <b>é—®é¢˜1</b>ï¼šå¦‚ä½•åŒºåˆ†èµ‹å€¼è¯­å¥å’Œå‡½æ•°è°ƒç”¨ï¼Ÿ<br/>â“ <b>é—®é¢˜2</b>ï¼šif-elseif-else é“¾çš„è·³è½¬æ˜¯å¦‚ä½•ç®¡ç†å’Œå›å¡«çš„ï¼Ÿ<br/>â“ <b>é—®é¢˜3</b>ï¼šå¾ªç¯è¯­å¥çš„ break å¦‚ä½•è·³è½¬åˆ°æ­£ç¡®çš„ä½ç½®ï¼Ÿ<br/>â“ <b>é—®é¢˜4</b>ï¼šå—ä½œç”¨åŸŸå¦‚ä½•å½±å“å˜é‡çš„ç”Ÿå‘½å‘¨æœŸï¼Ÿ<br/>â“ <b>é—®é¢˜5</b>ï¼šrepeat-until ä¸ºä»€ä¹ˆèƒ½åœ¨æ¡ä»¶ä¸­è®¿é—®å¾ªç¯ä½“çš„å˜é‡ï¼Ÿ</p><p data-pid=\"KQZt-Vp6\">æœ¬æ–‡æ¡£å°†<b>ç³»ç»Ÿè§£ç­”</b>è¿™äº›é—®é¢˜ï¼Œå¹¶æä¾›ï¼š</p><p data-pid=\"BKL-E5xf\">âœ… è¯¦ç»†çš„è¯­å¥è§£ææµç¨‹åˆ†æ<br/>âœ… å®Œæ•´çš„æºç é€è¡Œæ³¨é‡Š<br/>âœ… å¯è§†åŒ–çš„æ§åˆ¶æµæ„å»ºè¿‡ç¨‹<br/>âœ… è·³è½¬é“¾è¡¨ç®¡ç†çš„æ·±å…¥è®²è§£<br/>âœ… å®é™…çš„è°ƒè¯•æŠ€å·§å’Œæ‰©å±•æ–¹æ³•</p><h3>é˜…è¯»å»ºè®®</h3><p data-pid=\"cUTAyhDF\"><b>é€‚åˆè¯»è€…</b>ï¼š</p><ul><li data-pid=\"N3nkB8qm\">å·²ç†è§£è¡¨è¾¾å¼è§£ææœºåˆ¶ï¼Œå¸Œæœ›æŒæ¡è¯­å¥è§£æ</li><li data-pid=\"44j_Z7Iz\">æ­£åœ¨å®ç°æ”¯æŒå¤æ‚æ§åˆ¶æµçš„è§£æå™¨</li><li data-pid=\"ZYIcACC-\">éœ€è¦è°ƒè¯•è¯­å¥è§£æç›¸å…³é—®é¢˜</li><li data-pid=\"8ug3bqg3\">æƒ³è¦ç†è§£ Lua æ§åˆ¶æµçš„å­—èŠ‚ç ç”Ÿæˆ</li></ul><p data-pid=\"vRXc-spF\"><b>é˜…è¯»è·¯çº¿</b>ï¼š</p><ol><li data-pid=\"7U3q9qyO\"><b>å¿«é€Ÿç†è§£å‹</b>ï¼šé˜…è¯»ç¬¬ä¸€ã€äºŒéƒ¨åˆ†ï¼ŒæŒæ¡æ ¸å¿ƒæ¶æ„</li><li data-pid=\"nZM6jp8J\"><b>æ·±å…¥å­¦ä¹ å‹</b>ï¼šå®Œæ•´é˜…è¯»ï¼Œé…åˆæºç å®è·µ</li><li data-pid=\"gIXvs2Zl\"><b>é—®é¢˜é©±åŠ¨å‹</b>ï¼šç›´æ¥è·³è½¬åˆ°ç›¸å…³è¯­å¥ç±»å‹çš„ç« èŠ‚</li></ol><h3>æ–‡æ¡£ç»“æ„è¯´æ˜</h3><p data-pid=\"3sN7uhOT\">æœ¬æ–‡æ¡£æŒ‰ç…§è¯­å¥ç±»å‹åˆ†ç« èŠ‚ï¼Œæ¯ä¸ªç« èŠ‚åŒ…å«ï¼š</p><ul><li data-pid=\"1JCKOe7w\"><b>è¯­æ³•è§„åˆ™</b>ï¼šBNF å½¢å¼çš„æ–‡æ³•å®šä¹‰</li><li data-pid=\"ns5RPs_T\"><b>å®ç°åˆ†æ</b>ï¼šæºç è¯¦ç»†æ³¨é‡Šå’Œè§£è¯»</li><li data-pid=\"RH7xr0z4\"><b>æ‰§è¡Œè·Ÿè¸ª</b>ï¼šé€æ­¥çš„è§£æè¿‡ç¨‹æ¼”ç¤º</li><li data-pid=\"b4-BnZP9\"><b>å­—èŠ‚ç ç”Ÿæˆ</b>ï¼šå®é™…ç”Ÿæˆçš„æŒ‡ä»¤åºåˆ—</li><li data-pid=\"Z6v_42ec\"><b>æ§åˆ¶æµå›¾</b>ï¼šå¯è§†åŒ–çš„è·³è½¬å…³ç³»</li></ul><hr/><h3>ç¬¬ä¸€éƒ¨åˆ†ï¼šè¯­å¥è§£ææ¶æ„æ¦‚è§ˆ</h3><h3>1.1 è¯­å¥åˆ†ç±»ä½“ç³»</h3><p data-pid=\"54yg9f--\">Lua çš„è¯­å¥ç³»ç»Ÿå¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ å¤§ç±»ï¼š</p><h3>è¯­å¥åˆ†ç±»è¡¨</h3><table data-draft-node=\"block\" data-draft-type=\"table\" data-size=\"normal\" data-row-style=\"normal\"><tbody><tr><th>ç±»åˆ«</th><th>è¯­å¥</th><th>å…³é”®ç‰¹æ€§</th><th>å¤æ‚åº¦</th></tr><tr><td>æ§åˆ¶æµ</td><td>if, while, repeat, for</td><td>æ¡ä»¶è·³è½¬ã€å¾ªç¯</td><td>é«˜</td></tr><tr><td>èµ‹å€¼</td><td>å˜é‡èµ‹å€¼ã€å¤šé‡èµ‹å€¼</td><td>å·¦å€¼è¯†åˆ«ã€ç±»å‹æ¨æ–­</td><td>ä¸­</td></tr><tr><td>å‡½æ•°ç›¸å…³</td><td>å‡½æ•°è°ƒç”¨ã€è¿”å›è¯­å¥</td><td>å‚æ•°å¤„ç†ã€è¿”å›å€¼</td><td>ä¸­</td></tr><tr><td>ä½œç”¨åŸŸ</td><td>do-end, local</td><td>å˜é‡ç”Ÿå‘½å‘¨æœŸ</td><td>ä¸­</td></tr><tr><td>è·³è½¬</td><td>break, return</td><td>è·³è½¬é“¾è¡¨ç®¡ç†</td><td>ä½</td></tr><tr><td>å…¶ä»–</td><td>ç©ºè¯­å¥ ;</td><td>å ä½ç¬¦</td><td>ä½</td></tr></tbody></table><h3>å®Œæ•´çš„ BNF æ–‡æ³•</h3><div class=\"highlight\"><pre><code class=\"language-text\">chunk ::= {stat [&#39;;&#39;]}\n\nstat ::= \n    | &#39;;&#39;                                          -- ç©ºè¯­å¥\n    | varlist &#39;=&#39; explist                          -- èµ‹å€¼\n    | functioncall                                 -- å‡½æ•°è°ƒç”¨\n    | &#39;do&#39; block &#39;end&#39;                             -- doå—\n    | &#39;while&#39; exp &#39;do&#39; block &#39;end&#39;                 -- whileå¾ªç¯\n    | &#39;repeat&#39; block &#39;until&#39; exp                   -- repeatå¾ªç¯\n    | &#39;if&#39; exp &#39;then&#39; block \n      {&#39;elseif&#39; exp &#39;then&#39; block} [&#39;else&#39; block] &#39;end&#39;  -- ifè¯­å¥\n    | &#39;for&#39; NAME &#39;=&#39; exp &#39;,&#39; exp [&#39;,&#39; exp] &#39;do&#39; block &#39;end&#39;  -- æ•°å€¼for\n    | &#39;for&#39; namelist &#39;in&#39; explist &#39;do&#39; block &#39;end&#39; -- é€šç”¨for\n    | &#39;function&#39; funcname funcbody                 -- å‡½æ•°å®šä¹‰\n    | &#39;local&#39; &#39;function&#39; NAME funcbody             -- å±€éƒ¨å‡½æ•°\n    | &#39;local&#39; namelist [&#39;=&#39; explist]               -- å±€éƒ¨å˜é‡\n    | &#39;return&#39; [explist]                           -- è¿”å›è¯­å¥\n    | &#39;break&#39;                                      -- è·³å‡ºå¾ªç¯\n\nblock ::= chunk\n\nvarlist ::= var {&#39;,&#39; var}\nvar ::= NAME | prefixexp &#39;[&#39; exp &#39;]&#39; | prefixexp &#39;.&#39; NAME\n\nnamelist ::= NAME {&#39;,&#39; NAME}\nexplist ::= {exp &#39;,&#39; } exp</code></pre></div><h3>1.2 è¯­å¥åˆ†å‘æœºåˆ¶</h3><h3>æ ¸å¿ƒå‡½æ•°ï¼šstatement()</h3><p data-pid=\"__tuqf2B\">Lua ä½¿ç”¨å•ä¸€çš„åˆ†å‘å‡½æ•°å¤„ç†æ‰€æœ‰è¯­å¥ç±»å‹ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">// lparser.c\nstatic void statement(LexState *ls) {\n    int line = ls-&gt;linenumber;  // ä¿å­˜è¡Œå·ï¼ˆç”¨äºé”™è¯¯æŠ¥å‘Šï¼‰\n    \n    enterlevel(ls);  // é˜²æ­¢æ ˆæº¢å‡º\n    \n    switch (ls-&gt;t.token) {\n        case &#39;;&#39;: {  // ç©ºè¯­å¥\n            luaX_next(ls);  // ç›´æ¥è·³è¿‡\n            break;\n        }\n        \n        case TK_IF: {  // if è¯­å¥\n            ifstat(ls, line);\n            break;\n        }\n        \n        case TK_WHILE: {  // while å¾ªç¯\n            whilestat(ls, line);\n            break;\n        }\n        \n        case TK_DO: {  // do å—\n            luaX_next(ls);  // è·³è¿‡ &#39;do&#39;\n            block(ls);\n            check_match(ls, TK_END, TK_DO, line);\n            break;\n        }\n        \n        case TK_FOR: {  // for å¾ªç¯ï¼ˆæ•°å€¼æˆ–é€šç”¨ï¼‰\n            forstat(ls, line);\n            break;\n        }\n        \n        case TK_REPEAT: {  // repeat å¾ªç¯\n            repeatstat(ls, line);\n            break;\n        }\n        \n        case TK_FUNCTION: {  // å‡½æ•°å®šä¹‰\n            funcstat(ls, line);\n            break;\n        }\n        \n        case TK_LOCAL: {  // å±€éƒ¨å£°æ˜\n            luaX_next(ls);  // è·³è¿‡ &#39;local&#39;\n            if (testnext(ls, TK_FUNCTION))  // local function\n                localfunc(ls);\n            else\n                localstat(ls);\n            break;\n        }\n        \n        case TK_RETURN: {  // è¿”å›è¯­å¥\n            retstat(ls);\n            break;\n        }\n        \n        case TK_BREAK: {  // break è¯­å¥\n            luaX_next(ls);  // è·³è¿‡ &#39;break&#39;\n            breakstat(ls);\n            break;\n        }\n        \n        default: {  // èµ‹å€¼æˆ–å‡½æ•°è°ƒç”¨\n            // æœ€å¤æ‚çš„æƒ…å†µï¼šéœ€è¦å‰çœ‹æ‰èƒ½ç¡®å®š\n            exprstat(ls);\n            break;\n        }\n    }\n    \n    // ç¡®ä¿å•ä¸ªè¯­å¥ä¸ä¼šäº§ç”Ÿè¿‡å¤šçš„æŒ‚èµ·å€¼\n    lua_assert(ls-&gt;fs-&gt;f-&gt;maxstacksize &gt;= ls-&gt;fs-&gt;freereg &amp;&amp;\n               ls-&gt;fs-&gt;freereg &gt;= ls-&gt;fs-&gt;nactvar);\n    ls-&gt;fs-&gt;freereg = ls-&gt;fs-&gt;nactvar;  // é‡Šæ”¾ä¸´æ—¶å¯„å­˜å™¨\n    \n    leavelevel(ls);\n}</code></pre></div><h3>å…³é”®è®¾è®¡ç‰¹ç‚¹</h3><p data-pid=\"6MKq7Qz5\"><b>1. LL(1) ç‰¹æ€§</b></p><p data-pid=\"fWj745Qd\">é€šè¿‡ç¬¬ä¸€ä¸ª token å°±èƒ½ç¡®å®šè¯­å¥ç±»å‹ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">// æŸ¥çœ‹ç¬¬ä¸€ä¸ª token å³å¯åˆ†å‘\nswitch (ls-&gt;t.token) {\n    case TK_IF:     â†’ if è¯­å¥\n    case TK_WHILE:  â†’ while å¾ªç¯\n    case TK_FOR:    â†’ for å¾ªç¯\n    // ...\n    default:        â†’ èµ‹å€¼æˆ–å‡½æ•°è°ƒç”¨ï¼ˆéœ€è¿›ä¸€æ­¥åˆ¤æ–­ï¼‰\n}</code></pre></div><p data-pid=\"hlin_Ydl\"><b>2. é”™è¯¯ä¿¡æ¯ä¿å­˜</b></p><div class=\"highlight\"><pre><code class=\"language-text\">int line = ls-&gt;linenumber;  // ä¿å­˜è¯­å¥å¼€å§‹çš„è¡Œå·\n// åç»­å¯ä»¥æŠ¥å‘Š: &#34;expected &#39;end&#39; (to close &#39;if&#39; at line X)&#34;</code></pre></div><p data-pid=\"HPK7ioH5\"><b>3. æ ˆæº¢å‡ºä¿æŠ¤</b></p><div class=\"highlight\"><pre><code class=\"language-text\">enterlevel(ls);  // è¿›å…¥\n// ... å¤„ç†è¯­å¥\nleavelevel(ls);  // ç¦»å¼€</code></pre></div><p data-pid=\"kZlg6DEM\">é˜²æ­¢æ¶æ„æˆ–é”™è¯¯çš„ä»£ç å¯¼è‡´é€’å½’è¿‡æ·±ã€‚</p><p data-pid=\"tbrbWOsd\"><b>4. å¯„å­˜å™¨ç®¡ç†</b></p><div class=\"highlight\"><pre><code class=\"language-text\">// è¯­å¥ç»“æŸåé‡Šæ”¾æ‰€æœ‰ä¸´æ—¶å¯„å­˜å™¨\nls-&gt;fs-&gt;freereg = ls-&gt;fs-&gt;nactvar;</code></pre></div><p data-pid=\"c7Tf1FFP\">ç¡®ä¿æ¯æ¡è¯­å¥éƒ½ä»â€å¹²å‡€â€çš„å¯„å­˜å™¨çŠ¶æ€å¼€å§‹ã€‚</p><h3>1.3 å—çš„æ¦‚å¿µä¸ç®¡ç†</h3><h3>ä»€ä¹ˆæ˜¯å—ï¼ˆBlockï¼‰ï¼Ÿ</h3><p data-pid=\"tVBxYSYX\">åœ¨ Lua ä¸­ï¼Œ<b>å—</b>æ˜¯è¯­å¥çš„é›†åˆï¼Œä¹Ÿæ˜¯<b>ä½œç”¨åŸŸçš„åŸºæœ¬å•ä½</b>ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">-- å‡½æ•°ä½“æ˜¯ä¸€ä¸ªå—\nfunction f()\n    local x = 1  -- x çš„ä½œç”¨åŸŸï¼šæ•´ä¸ªå‡½æ•°å—\nend\n\n-- do-end åˆ›å»ºæ˜¾å¼å—\ndo\n    local y = 2  -- y çš„ä½œç”¨åŸŸï¼šdo-end å—\nend\n-- y åœ¨è¿™é‡Œä¸å¯è§\n\n-- æ§åˆ¶ç»“æ„è‡ªå¸¦å—\nif condition then\n    local z = 3  -- z çš„ä½œç”¨åŸŸï¼šthen å—\nend\n-- z åœ¨è¿™é‡Œä¸å¯è§</code></pre></div><h3>BlockCnt ç»“æ„å›é¡¾</h3><div class=\"highlight\"><pre><code class=\"language-text\">typedef struct BlockCnt {\n    struct BlockCnt *previous;  // å¤–å±‚å—ï¼ˆå½¢æˆæ ˆï¼‰\n    int breaklist;              // break è·³è½¬é“¾è¡¨å¤´\n    lu_byte nactvar;            // å—å¼€å§‹æ—¶çš„æ´»è·ƒå˜é‡æ•°\n    lu_byte upval;              // æ˜¯å¦æœ‰å˜é‡è¢«æ•è·ï¼ˆæˆä¸º upvalueï¼‰\n    lu_byte isbreakable;        // æ˜¯å¦å…è®¸ break\n} BlockCnt;</code></pre></div><h3>å—æ“ä½œè¯¦è§£</h3><p data-pid=\"xWWsrVy9\"><b>è¿›å…¥å—</b>ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">static void enterblock(FuncState *fs, BlockCnt *bl, lu_byte isbreakable) {\n    bl-&gt;breaklist = NO_JUMP;         // åˆå§‹åŒ–è·³è½¬é“¾è¡¨\n    bl-&gt;isbreakable = isbreakable;   // è®¾ç½®æ˜¯å¦å¯ break\n    bl-&gt;nactvar = fs-&gt;nactvar;       // è®°å½•å½“å‰æ´»è·ƒå˜é‡æ•°\n    bl-&gt;upval = 0;                   // åˆå§‹åŒ– upvalue æ ‡è®°\n    bl-&gt;previous = fs-&gt;bl;           // é“¾æ¥åˆ°å¤–å±‚å—\n    fs-&gt;bl = bl;                     // è®¾ä¸ºå½“å‰å—\n}</code></pre></div><p data-pid=\"OtGckLJn\"><b>ç¦»å¼€å—</b>ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">static void leaveblock(FuncState *fs) {\n    BlockCnt *bl = fs-&gt;bl;\n    fs-&gt;bl = bl-&gt;previous;  // æ¢å¤å¤–å±‚å—\n    \n    // ç§»é™¤å—å†…å®šä¹‰çš„å±€éƒ¨å˜é‡\n    removevars(fs-&gt;ls, bl-&gt;nactvar);\n    \n    // å¦‚æœæœ‰ upvalueï¼Œç”Ÿæˆ CLOSE æŒ‡ä»¤\n    if (bl-&gt;upval)\n        luaK_codeABC(fs, OP_CLOSE, bl-&gt;nactvar, 0, 0);\n    \n    // å¦‚æœæ˜¯å¯ break çš„å—ï¼Œå›å¡« break è·³è½¬\n    lua_assert(!bl-&gt;isbreakable || bl-&gt;previous);\n    lua_assert(bl-&gt;nactvar == fs-&gt;nactvar);\n    \n    // æ¢å¤ç©ºé—²å¯„å­˜å™¨æŒ‡é’ˆ\n    fs-&gt;freereg = fs-&gt;nactvar;\n    \n    // å›å¡«æ‰€æœ‰ break è·³è½¬åˆ°å½“å‰ä½ç½®\n    luaK_patchtohere(fs, bl-&gt;breaklist);\n}</code></pre></div><h3>å—çš„åµŒå¥—ç¤ºä¾‹</h3><div class=\"highlight\"><pre><code class=\"language-text\">function outer()           -- å—1ï¼šå‡½æ•°å—\n    local a = 1\n    \n    if condition then      -- å—2ï¼šif å—\n        local b = 2\n        \n        while true do      -- å—3ï¼šwhile å—ï¼ˆå¯ breakï¼‰\n            local c = 3\n            \n            do             -- å—4ï¼šæ˜¾å¼å—\n                local d = 4\n            end  -- d ç¦»å¼€ä½œç”¨åŸŸ\n            \n            if x then break end\n        end  -- c ç¦»å¼€ä½œç”¨åŸŸ\n        \n    end  -- b ç¦»å¼€ä½œç”¨åŸŸ\n    \nend  -- a ç¦»å¼€ä½œç”¨åŸŸ</code></pre></div><p data-pid=\"5Zco2CLB\"><b>å—æ ˆæ¼”å˜</b>ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">è¿›å…¥ outer:    å—1 â†’ NULL\nè¿›å…¥ if:       å—2 â†’ å—1 â†’ NULL\nè¿›å…¥ while:    å—3 â†’ å—2 â†’ å—1 â†’ NULL\nè¿›å…¥ do:       å—4 â†’ å—3 â†’ å—2 â†’ å—1 â†’ NULL\nç¦»å¼€ do:       å—3 â†’ å—2 â†’ å—1 â†’ NULL\nç¦»å¼€ while:    å—2 â†’ å—1 â†’ NULL\nç¦»å¼€ if:       å—1 â†’ NULL\nç¦»å¼€ outer:    NULL</code></pre></div><h3>1.4 è·³è½¬é“¾è¡¨ç®¡ç†æ¦‚è¿°</h3><h3>ä¸ºä»€ä¹ˆéœ€è¦è·³è½¬é“¾è¡¨ï¼Ÿ</h3><p data-pid=\"0X1pjZWv\">åœ¨è§£ææ—¶ï¼Œè®¸å¤šè·³è½¬çš„ç›®æ ‡ä½ç½®åœ¨ç”Ÿæˆè·³è½¬æŒ‡ä»¤æ—¶<b>å°šæœªç¡®å®š</b>ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">if condition then\n    -- ç”Ÿæˆæ¡ä»¶è·³è½¬ï¼šJMP [?]ï¼ˆç›®æ ‡æœªçŸ¥ï¼‰\n    block1\nelse\n    -- ç°åœ¨æ‰çŸ¥é“ä¸Šé¢çš„è·³è½¬åº”è¯¥åˆ°è¿™é‡Œ\n    block2\nend\n-- è¿™é‡Œæ˜¯æ‰€æœ‰åˆ†æ”¯çš„æ±‡åˆç‚¹</code></pre></div><h3>è·³è½¬é“¾è¡¨çš„æ•°æ®ç»“æ„</h3><p data-pid=\"Xr2oOlll\">Lua ä½¿ç”¨å·§å¦™çš„è®¾è®¡ï¼š<b>å°†è·³è½¬é“¾è¡¨ç¼–ç åœ¨æŒ‡ä»¤æœ¬èº«</b>ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">// JMP æŒ‡ä»¤æ ¼å¼ï¼šsBx å­—æ®µè¡¨ç¤ºè·³è½¬åç§»\n\n// æœªå›å¡«æ—¶ï¼šsBx å­˜å‚¨ä¸‹ä¸€ä¸ªè·³è½¬æŒ‡ä»¤çš„ç›¸å¯¹ä½ç½®\n// ä¾‹å¦‚ï¼š\næŒ‡ä»¤[5]:  JMP sBx=7   // è¡¨ç¤ºä¸‹ä¸€ä¸ªè·³è½¬åœ¨ 5+7=12\næŒ‡ä»¤[12]: JMP sBx=6   // è¡¨ç¤ºä¸‹ä¸€ä¸ªè·³è½¬åœ¨ 12+6=18\næŒ‡ä»¤[18]: JMP sBx=-1  // NO_JUMPï¼Œé“¾è¡¨ç»“æŸ\n\n// å›å¡«åï¼šsBx å­˜å‚¨å®é™…çš„è·³è½¬ç›®æ ‡\næŒ‡ä»¤[5]:  JMP sBx=15  // è·³è½¬åˆ°ä½ç½® 5+15=20\næŒ‡ä»¤[12]: JMP sBx=8   // è·³è½¬åˆ°ä½ç½® 12+8=20\næŒ‡ä»¤[18]: JMP sBx=2   // è·³è½¬åˆ°ä½ç½® 18+2=20</code></pre></div><h3>å…³é”®æ“ä½œ</h3><p data-pid=\"efACcF61\"><b>1. ç”Ÿæˆè·³è½¬å¹¶åŠ å…¥é“¾è¡¨</b></p><div class=\"highlight\"><pre><code class=\"language-text\">int luaK_jump(FuncState *fs) {\n    int jpc = fs-&gt;jpc;  // ä¿å­˜æ—§é“¾è¡¨å¤´\n    int j;\n    \n    fs-&gt;jpc = NO_JUMP;  // æ¸…ç©ºï¼ˆå°†åœ¨ä¸‹æ¬¡ä½¿ç”¨ï¼‰\n    \n    // ç”Ÿæˆ JMP æŒ‡ä»¤ï¼Œç›®æ ‡æš‚æ—¶æœªçŸ¥\n    j = luaK_codeAsBx(fs, OP_JMP, 0, NO_JUMP);\n    \n    // è¿æ¥åˆ°é“¾è¡¨\n    luaK_concat(fs, &amp;j, jpc);\n    \n    return j;  // è¿”å›é“¾è¡¨å¤´\n}</code></pre></div><p data-pid=\"0-tH5ems\"><b>2. å›å¡«é“¾è¡¨åˆ°æŒ‡å®šä½ç½®</b></p><div class=\"highlight\"><pre><code class=\"language-text\">void luaK_patchlist(FuncState *fs, int list, int target) {\n    if (target == fs-&gt;pc)\n        luaK_patchtohere(fs, list);\n    else {\n        // éå†é“¾è¡¨ï¼Œé€ä¸ªå›å¡«\n        while (list != NO_JUMP) {\n            int next = getjump(fs, list);    // è·å–ä¸‹ä¸€ä¸ª\n            fixjump(fs, list, target);       // ä¿®æ­£å½“å‰è·³è½¬\n            list = next;                     // ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ª\n        }\n    }\n}</code></pre></div><p data-pid=\"x5tQ8sR8\"><b>3. åˆå¹¶ä¸¤ä¸ªè·³è½¬é“¾è¡¨</b></p><div class=\"highlight\"><pre><code class=\"language-text\">void luaK_concat(FuncState *fs, int *l1, int l2) {\n    if (l2 == NO_JUMP) return;  // l2 ä¸ºç©ºï¼Œæ— éœ€æ“ä½œ\n    \n    if (*l1 == NO_JUMP)\n        *l1 = l2;  // l1 ä¸ºç©ºï¼Œç›´æ¥èµ‹å€¼\n    else {\n        int list = *l1;\n        int next;\n        \n        // æ‰¾åˆ° l1 çš„æœ«å°¾\n        while ((next = getjump(fs, list)) != NO_JUMP)\n            list = next;\n        \n        // è¿æ¥ l2\n        fixjump(fs, list, l2);\n    }\n}</code></pre></div><p data-pid=\"qNRVb5Qi\">è¿™äº›æœºåˆ¶å°†åœ¨åç»­ç« èŠ‚çš„å…·ä½“è¯­å¥è§£æä¸­è¯¦ç»†å±•å¼€ã€‚</p><hr/><h3>ç¬¬äºŒéƒ¨åˆ†ï¼šæ¡ä»¶æ§åˆ¶è¯­å¥</h3><h3>2.1 if è¯­å¥å®Œæ•´è§£æ</h3><h3>è¯­æ³•ç»“æ„</h3><div class=\"highlight\"><pre><code class=\"language-text\">ifstat ::= &#39;if&#39; exp &#39;then&#39; block \n           {&#39;elseif&#39; exp &#39;then&#39; block} \n           [&#39;else&#39; block] \n           &#39;end&#39;</code></pre></div><h3>æ ¸å¿ƒéš¾ç‚¹</h3><p data-pid=\"t7HbdjP4\">if è¯­å¥çš„è§£ææ¶‰åŠä¸‰ä¸ªå…³é”®é—®é¢˜ï¼š</p><ol><li data-pid=\"7lhboek8\"><b>å¤šåˆ†æ”¯ç®¡ç†</b>ï¼šå¦‚ä½•å¤„ç† if-elseif-elseif-â€¦-else é“¾ï¼Ÿ</li><li data-pid=\"G4fGb94o\"><b>è·³è½¬å›å¡«</b>ï¼šæ¯ä¸ªåˆ†æ”¯ç»“æŸåå¦‚ä½•è·³è½¬åˆ°æ­£ç¡®ä½ç½®ï¼Ÿ</li><li data-pid=\"95UEHUdP\"><b>æ¡ä»¶ä»£ç ç”Ÿæˆ</b>ï¼šå¦‚ä½•ç”Ÿæˆé«˜æ•ˆçš„æ¡ä»¶æµ‹è¯•å’Œè·³è½¬ï¼Ÿ</li></ol><h3>å®Œæ•´å®ç°ä»£ç </h3><div class=\"highlight\"><pre><code class=\"language-text\">static void ifstat(LexState *ls, int line) {\n    // IF cond THEN block {ELSEIF cond THEN block} [ELSE block] END\n    \n    FuncState *fs = ls-&gt;fs;\n    int flist;          // å‡è·³è½¬é“¾è¡¨ï¼ˆæ¡ä»¶ä¸ºå‡æ—¶çš„è·³è½¬ï¼‰\n    int escapelist = NO_JUMP;  // é€ƒé€¸è·³è½¬é“¾è¡¨ï¼ˆè·³å‡ºæ•´ä¸ªifè¯­å¥ï¼‰\n    \n    // ========== ç¬¬ä¸€é˜¶æ®µï¼šå¤„ç† IF åˆ†æ”¯ ==========\n    flist = test_then_block(ls);  // è¿”å›å‡è·³è½¬é“¾è¡¨\n    \n    // ========== ç¬¬äºŒé˜¶æ®µï¼šå¤„ç† ELSEIF åˆ†æ”¯é“¾ ==========\n    while (ls-&gt;t.token == TK_ELSEIF) {\n        // åœ¨è¿›å…¥ä¸‹ä¸€ä¸ª elseif å‰ï¼Œç”Ÿæˆè·³è½¬æŒ‡ä»¤è·³è¿‡åç»­åˆ†æ”¯\n        luaK_concat(fs, &amp;escapelist, luaK_jump(fs));\n        \n        // å›å¡«ä¸Šä¸€ä¸ªåˆ†æ”¯çš„å‡è·³è½¬åˆ°å½“å‰ä½ç½®\n        luaK_patchtohere(fs, flist);\n        \n        // å¤„ç† elseif åˆ†æ”¯\n        flist = test_then_block(ls);\n    }\n    \n    // ========== ç¬¬ä¸‰é˜¶æ®µï¼šå¤„ç† ELSE åˆ†æ”¯ï¼ˆå¯é€‰ï¼‰==========\n    if (testnext(ls, TK_ELSE)) {\n        // ç”Ÿæˆè·³è½¬æŒ‡ä»¤è·³è¿‡ else å—\n        luaK_concat(fs, &amp;escapelist, luaK_jump(fs));\n        \n        // å›å¡«å‡è·³è½¬åˆ° else å—å¼€å§‹\n        luaK_patchtohere(fs, flist);\n        \n        // è§£æ else å—\n        block(ls);\n    }\n    else {\n        // æ²¡æœ‰ elseï¼šå‡è·³è½¬ç›´æ¥åˆ° if è¯­å¥ç»“æŸ\n        luaK_concat(fs, &amp;escapelist, flist);\n    }\n    \n    // ========== ç¬¬å››é˜¶æ®µï¼šå›å¡«æ‰€æœ‰é€ƒé€¸è·³è½¬ ==========\n    luaK_patchtohere(fs, escapelist);\n    \n    // æ£€æŸ¥åŒ¹é…çš„ END\n    check_match(ls, TK_END, TK_IF, line);\n}</code></pre></div><h3>test_then_block è¾…åŠ©å‡½æ•°</h3><div class=\"highlight\"><pre><code class=\"language-text\">static int test_then_block(LexState *ls) {\n    // è§£æ &#39;exp THEN block&#39;ï¼Œè¿”å›å‡è·³è½¬é“¾è¡¨\n    \n    int condexit;  // æ¡ä»¶ä¸ºå‡æ—¶çš„è·³è½¬\n    \n    luaX_next(ls);  // è·³è¿‡ &#39;if&#39; æˆ– &#39;elseif&#39;\n    \n    // è§£ææ¡ä»¶è¡¨è¾¾å¼\n    expdesc v;\n    expr(ls, &amp;v);\n    \n    // æ£€æŸ¥ &#39;then&#39; å…³é”®å­—\n    check(ls, TK_THEN);\n    \n    // ç”Ÿæˆæ¡ä»¶è·³è½¬ï¼šä¸ºå‡æ—¶è·³è½¬\n    condexit = luaK_goiffalse(ls-&gt;fs, &amp;v);\n    \n    // è§£æ then å—\n    enterblock(ls-&gt;fs, &amp;bl, 0);  // é breakable å—\n    block(ls);\n    leaveblock(ls-&gt;fs);\n    \n    // è¿”å›å‡è·³è½¬é“¾è¡¨å¤´\n    return condexit;\n}</code></pre></div><h3>2.2 if è¯­å¥æ‰§è¡Œè¿‡ç¨‹å¯è§†åŒ–</h3><h3>ç¤ºä¾‹ä»£ç </h3><div class=\"highlight\"><pre><code class=\"language-text\">if a &gt; 10 then\n    print(&#34;large&#34;)\nelseif a &gt; 5 then\n    print(&#34;medium&#34;)\nelseif a &gt; 0 then\n    print(&#34;small&#34;)\nelse\n    print(&#34;non-positive&#34;)\nend\nprint(&#34;done&#34;)</code></pre></div><h3>è§£æè¿‡ç¨‹è¯¦ç»†è·Ÿè¸ª</h3><div class=\"highlight\"><pre><code class=\"language-text\">â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\nå¼€å§‹è§£æ if è¯­å¥\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nåˆå§‹çŠ¶æ€:\n  escapelist = NO_JUMP\n  flist = NO_JUMP\n\nã€é˜¶æ®µ1ã€‘è§£æ IF åˆ†æ”¯\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nè°ƒç”¨: test_then_block(ls)\n\næ­¥éª¤1.1: è§£ææ¡ä»¶ &#39;a &gt; 10&#39;\n  ç”Ÿæˆ: LT 0 K(10) R(a)    ; æµ‹è¯• a &gt; 10\n  \næ­¥éª¤1.2: ç”Ÿæˆå‡è·³è½¬\n  ç”Ÿæˆ: JMP [?]  â† pc=1\n  condexit = 1\n  \næ­¥éª¤1.3: è§£æ then å—\n  ç”Ÿæˆ: GETGLOBAL R(0) K(&#34;print&#34;)\n  ç”Ÿæˆ: LOADK R(1) K(&#34;large&#34;)\n  ç”Ÿæˆ: CALL R(0) 2 1      ; print(&#34;large&#34;)\n  å½“å‰ pc = 5\n  \nè¿”å›: flist = 1 (å‡è·³è½¬é“¾è¡¨å¤´)\n\nã€é˜¶æ®µ2ã€‘å¤„ç†ç¬¬ä¸€ä¸ª ELSEIF\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\næ­¥éª¤2.1: ç”Ÿæˆé€ƒé€¸è·³è½¬ï¼ˆè·³è¿‡åç»­åˆ†æ”¯ï¼‰\n  ç”Ÿæˆ: JMP [?]  â† pc=5\n  escapelist = 5\n  \næ­¥éª¤2.2: å›å¡«ä¸Šä¸€ä¸ªå‡è·³è½¬\n  luaK_patchtohere(fs, flist=1)\n  ä¿®æ­£: æŒ‡ä»¤[1] çš„ sBxï¼Œä½¿å…¶è·³è½¬åˆ° pc=6\n  \næ­¥éª¤2.3: è°ƒç”¨ test_then_block(ls)\n  è§£ææ¡ä»¶ &#39;a &gt; 5&#39;\n  ç”Ÿæˆ: LT 0 K(5) R(a)     ; æµ‹è¯• a &gt; 5  â† pc=6\n  ç”Ÿæˆ: JMP [?]  â† pc=7\n  è§£æ then å—\n  ç”Ÿæˆ: print(&#34;medium&#34;)\n  å½“å‰ pc = 11\n  \nè¿”å›: flist = 7\n\nã€é˜¶æ®µ3ã€‘å¤„ç†ç¬¬äºŒä¸ª ELSEIF\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\næ­¥éª¤3.1: ç”Ÿæˆé€ƒé€¸è·³è½¬\n  ç”Ÿæˆ: JMP [?]  â† pc=11\n  è¿æ¥: escapelist = 11 â†’ 5\n  \næ­¥éª¤3.2: å›å¡«å‡è·³è½¬\n  luaK_patchtohere(fs, flist=7)\n  ä¿®æ­£: æŒ‡ä»¤[7] è·³è½¬åˆ° pc=12\n  \næ­¥éª¤3.3: å¤„ç† &#39;a &gt; 0&#39; åˆ†æ”¯\n  ç”Ÿæˆ: LT 0 K(0) R(a)     ; æµ‹è¯• a &gt; 0  â† pc=12\n  ç”Ÿæˆ: JMP [?]  â† pc=13\n  ç”Ÿæˆ: print(&#34;small&#34;)\n  å½“å‰ pc = 17\n  \nè¿”å›: flist = 13\n\nã€é˜¶æ®µ4ã€‘å¤„ç† ELSE åˆ†æ”¯\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\næ­¥éª¤4.1: ç”Ÿæˆé€ƒé€¸è·³è½¬\n  ç”Ÿæˆ: JMP [?]  â† pc=17\n  è¿æ¥: escapelist = 17 â†’ 11 â†’ 5\n  \næ­¥éª¤4.2: å›å¡«å‡è·³è½¬\n  luaK_patchtohere(fs, flist=13)\n  ä¿®æ­£: æŒ‡ä»¤[13] è·³è½¬åˆ° pc=18\n  \næ­¥éª¤4.3: è§£æ else å—\n  ç”Ÿæˆ: print(&#34;non-positive&#34;)  â† pc=18\n  å½“å‰ pc = 22\n\nã€é˜¶æ®µ5ã€‘å›å¡«æ‰€æœ‰é€ƒé€¸è·³è½¬\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nluaK_patchtohere(fs, escapelist)\nç›®æ ‡ä½ç½®: pc=22\n\néå†é“¾è¡¨:\n  æŒ‡ä»¤[17]: JMP â†’ ä¿®æ­£ä¸ºè·³è½¬åˆ° pc=22\n  æŒ‡ä»¤[11]: JMP â†’ ä¿®æ­£ä¸ºè·³è½¬åˆ° pc=22\n  æŒ‡ä»¤[5]:  JMP â†’ ä¿®æ­£ä¸ºè·³è½¬åˆ° pc=22\n\nã€ç»“æŸã€‘\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</code></pre></div><h3>ç”Ÿæˆçš„æœ€ç»ˆå­—èŠ‚ç </h3><div class=\"highlight\"><pre><code class=\"language-text\">; if a &gt; 10 then\n0   LT        0 K(10) R(a)\n1   JMP       5              ; å‡åˆ™è·³åˆ° elseif\n2   GETGLOBAL R(0) K(&#34;print&#34;)\n3   LOADK     R(1) K(&#34;large&#34;)\n4   CALL      R(0) 2 1\n5   JMP       22             ; è·³å‡º if è¯­å¥\n\n; elseif a &gt; 5 then\n6   LT        0 K(5) R(a)\n7   JMP       11             ; å‡åˆ™è·³åˆ°ä¸‹ä¸€ä¸ª elseif\n8   GETGLOBAL R(0) K(&#34;print&#34;)\n9   LOADK     R(1) K(&#34;medium&#34;)\n10  CALL      R(0) 2 1\n11  JMP       22             ; è·³å‡º if è¯­å¥\n\n; elseif a &gt; 0 then\n12  LT        0 K(0) R(a)\n13  JMP       18             ; å‡åˆ™è·³åˆ° else\n14  GETGLOBAL R(0) K(&#34;print&#34;)\n15  LOADK     R(1) K(&#34;small&#34;)\n16  CALL      R(0) 2 1\n17  JMP       22             ; è·³å‡º if è¯­å¥\n\n; else\n18  GETGLOBAL R(0) K(&#34;print&#34;)\n19  LOADK     R(1) K(&#34;non-positive&#34;)\n20  CALL      R(0) 2 1\n\n; end\n22  ; if è¯­å¥ç»“æŸï¼Œç»§ç»­åç»­ä»£ç \n22  GETGLOBAL R(0) K(&#34;print&#34;)\n23  LOADK     R(1) K(&#34;done&#34;)\n24  CALL      R(0) 2 1</code></pre></div><h3>æ§åˆ¶æµå›¾</h3><div class=\"highlight\"><pre><code class=\"language-text\">å¼€å§‹\n                 â”‚\n         â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”\n         â”‚  æµ‹è¯• a &gt; 10  â”‚\n         â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜\n          çœŸâ”‚       â”‚å‡\n             â”‚       â”‚\n      â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”   â”‚\n      â”‚print    â”‚   â”‚\n      â”‚&#34;large&#34;  â”‚   â”‚\n      â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   â”‚\n         â”‚          â”‚\n         â”‚    â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”\n         â”‚    â”‚æµ‹è¯• a &gt; 5 â”‚\n         â”‚    â””â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”˜\n         â”‚    çœŸâ”‚    â”‚å‡\n         â”‚       â”‚    â”‚\n         â”‚ â”Œâ”€â”€â”€â”€â”€â–¼â”  â”‚\n         â”‚ â”‚print â”‚  â”‚\n         â”‚ â”‚&#34;med&#34; â”‚  â”‚\n         â”‚ â””â”€â”€â”¬â”€â”€â”€â”˜  â”‚\n         â”‚    â”‚      â”‚\n         â”‚    â”‚  â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”\n         â”‚    â”‚  â”‚æµ‹è¯•a &gt; 0â”‚\n         â”‚    â”‚  â””â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”˜\n         â”‚    â”‚ çœŸâ”‚   â”‚å‡\n         â”‚    â”‚    â”‚   â”‚\n         â”‚    â”‚ â”Œâ”€â”€â–¼â” â”‚\n         â”‚    â”‚ â”‚prnâ”‚ â”‚\n         â”‚    â”‚ â”‚&#34;sm&#34;â”‚ â”‚\n         â”‚    â”‚ â””â”€â”¬â”€â”˜ â”‚\n         â”‚    â”‚   â”‚   â”‚\n         â”‚    â”‚   â”‚  â”Œâ–¼â”€â”€â”€â”€â”€â”\n         â”‚    â”‚   â”‚  â”‚print â”‚\n         â”‚    â”‚   â”‚  â”‚&#34;non&#34; â”‚\n         â”‚    â”‚   â”‚  â””â”¬â”€â”€â”€â”€â”€â”˜\n         â””â”€â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”\n                 â”‚\n            print(&#34;done&#34;)\n                 â”‚\n                ç»“æŸ</code></pre></div><hr/><h3>ç¬¬ä¸‰éƒ¨åˆ†ï¼šå¾ªç¯æ§åˆ¶è¯­å¥</h3><h3>3.1 while å¾ªç¯è§£æ</h3><h3>è¯­æ³•ç»“æ„</h3><div class=\"highlight\"><pre><code class=\"language-text\">whilestat ::= &#39;while&#39; exp &#39;do&#39; block &#39;end&#39;</code></pre></div><h3>æ ¸å¿ƒç‰¹ç‚¹</h3><p data-pid=\"q_BgOzT5\">while å¾ªç¯æ˜¯æœ€åŸºç¡€çš„å¾ªç¯ç»“æ„ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p><ol><li data-pid=\"2pCHAMLB\"><b>å‰æµ‹è¯•å¾ªç¯</b>ï¼šå…ˆæµ‹è¯•æ¡ä»¶ï¼Œå†æ‰§è¡Œå¾ªç¯ä½“</li><li data-pid=\"gLPv56fL\"><b>å¯ä¸­æ–­æ€§</b>ï¼šæ”¯æŒ break è¯­å¥è·³å‡ºå¾ªç¯</li><li data-pid=\"892Zet9h\"><b>å›è·³æœºåˆ¶</b>ï¼šå¾ªç¯ä½“ç»“æŸåè·³å›æ¡ä»¶æµ‹è¯•</li></ol><h3>å®Œæ•´å®ç°ä»£ç </h3><div class=\"highlight\"><pre><code class=\"language-text\">static void whilestat(LexState *ls, int line) {\n    // WHILE exp DO block END\n    \n    FuncState *fs = ls-&gt;fs;\n    int whileinit;   // å¾ªç¯å¼€å§‹ä½ç½®ï¼ˆæ¡ä»¶æµ‹è¯•ä½ç½®ï¼‰\n    int condexit;    // æ¡ä»¶ä¸ºå‡æ—¶çš„è·³è½¬\n    BlockCnt bl;     // å¾ªç¯å—æ§åˆ¶\n    \n    luaX_next(ls);  // è·³è¿‡ &#39;while&#39;\n    \n    // ========== ç¬¬ä¸€æ­¥ï¼šè®°å½•å¾ªç¯å¼€å§‹ä½ç½® ==========\n    whileinit = luaK_getlabel(fs);\n    \n    // ========== ç¬¬äºŒæ­¥ï¼šè§£æå’Œç”Ÿæˆæ¡ä»¶æµ‹è¯• ==========\n    expdesc v;\n    expr(ls, &amp;v);  // è§£ææ¡ä»¶è¡¨è¾¾å¼\n    \n    check(ls, TK_DO);  // æ£€æŸ¥ &#39;do&#39; å…³é”®å­—\n    \n    // ç”Ÿæˆæ¡ä»¶è·³è½¬ï¼šå‡æ—¶è·³å‡ºå¾ªç¯\n    condexit = luaK_goiffalse(fs, &amp;v);\n    \n    // ========== ç¬¬ä¸‰æ­¥ï¼šè¿›å…¥å¾ªç¯ä½“å— ==========\n    enterblock(fs, &amp;bl, 1);  // 1 è¡¨ç¤º breakableï¼ˆå¯ breakï¼‰\n    \n    // ========== ç¬¬å››æ­¥ï¼šè§£æå¾ªç¯ä½“ ==========\n    block(ls);\n    \n    // ========== ç¬¬äº”æ­¥ï¼šç”Ÿæˆå›è·³æŒ‡ä»¤ ==========\n    // è·³å›å¾ªç¯å¼€å§‹ä½ç½®ï¼ˆæ¡ä»¶æµ‹è¯•ï¼‰\n    luaK_patchlist(fs, luaK_jump(fs), whileinit);\n    \n    // ========== ç¬¬å…­æ­¥ï¼šæ£€æŸ¥ç»“æŸæ ‡è®° ==========\n    check_match(ls, TK_END, TK_WHILE, line);\n    \n    // ========== ç¬¬ä¸ƒæ­¥ï¼šç¦»å¼€å—å¹¶å›å¡«è·³è½¬ ==========\n    leaveblock(fs);  // ä¼šè‡ªåŠ¨å›å¡«æ‰€æœ‰ break è·³è½¬\n    \n    // ========== ç¬¬å…«æ­¥ï¼šå›å¡«æ¡ä»¶å‡è·³è½¬ ==========\n    luaK_patchtohere(fs, condexit);  // å‡æ—¶è·³åˆ°è¿™é‡Œï¼ˆå¾ªç¯ç»“æŸï¼‰\n}</code></pre></div><h3>æ‰§è¡Œè¿‡ç¨‹å¯è§†åŒ–</h3><p data-pid=\"nqgfbx-i\"><b>ç¤ºä¾‹ä»£ç </b>ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">local i = 0\nwhile i &lt; 10 do\n    print(i)\n    if i == 5 then\n        break\n    end\n    i = i + 1\nend\nprint(&#34;done&#34;)</code></pre></div><p data-pid=\"pL1r0zm0\"><b>è§£æè¿‡ç¨‹</b>ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\nè§£æ while å¾ªç¯\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\næ­¥éª¤1: åˆå§‹åŒ–\n  è·³è¿‡ &#39;while&#39;\n  whileinit = pc=1  ; è®°å½•å¾ªç¯å¼€å§‹ä½ç½®\n\næ­¥éª¤2: è§£ææ¡ä»¶ &#39;i &lt; 10&#39;\n  ç”Ÿæˆ: LT 1 R(i) K(10)    ; pc=1, æµ‹è¯• i &lt; 10\n  \næ­¥éª¤3: ç”Ÿæˆæ¡ä»¶è·³è½¬\n  ç”Ÿæˆ: JMP [?]             ; pc=2, å‡æ—¶è·³å‡º\n  condexit = 2\n\næ­¥éª¤4: è¿›å…¥å¾ªç¯ä½“å—\n  enterblock(fs, &amp;bl, 1)    ; breakable = 1\n  bl.breaklist = NO_JUMP\n\næ­¥éª¤5: è§£æå¾ªç¯ä½“\n  5.1: è§£æ print(i)\n    ç”Ÿæˆ: GETGLOBAL R(0) K(&#34;print&#34;)\n    ç”Ÿæˆ: MOVE R(1) R(i)\n    ç”Ÿæˆ: CALL R(0) 2 1\n  \n  5.2: è§£æ if i == 5 then break end\n    ç”Ÿæˆ: EQ 1 R(i) K(5)    ; æµ‹è¯• i == 5\n    ç”Ÿæˆ: JMP [skip_break]   ; ä¸ç­‰äºåˆ™è·³è¿‡break\n    ç”Ÿæˆ: JMP [?]            ; pc=8, break è·³è½¬\n    æ›´æ–°: bl.breaklist = 8   ; åŠ å…¥ break é“¾è¡¨\n  \n  5.3: è§£æ i = i + 1\n    ç”Ÿæˆ: ADD R(i) R(i) K(1)\n\næ­¥éª¤6: ç”Ÿæˆå›è·³æŒ‡ä»¤\n  ç”Ÿæˆ: JMP -8              ; pc=10, è·³å› pc=1\n\næ­¥éª¤7: ç¦»å¼€å—\n  leaveblock(fs)\n  å›å¡«: bl.breaklist (8) â†’ pc=11\n\næ­¥éª¤8: å›å¡«æ¡ä»¶å‡è·³è½¬\n  å›å¡«: condexit (2) â†’ pc=11\n\næ­¥éª¤9: ç»§ç»­åç»­ä»£ç \n  ç”Ÿæˆ: print(&#34;done&#34;)\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</code></pre></div><h3>ç”Ÿæˆçš„å­—èŠ‚ç </h3><div class=\"highlight\"><pre><code class=\"language-text\">0   LOADK     R(0) 0        ; i = 0\n\n; while å¾ªç¯å¼€å§‹\n1   LT        1 R(0) K(10)  ; æ¡ä»¶ï¼ši &lt; 10\n2   JMP       11            ; å‡åˆ™è·³å‡ºå¾ªç¯\n\n; å¾ªç¯ä½“\n3   GETGLOBAL R(1) K(&#34;print&#34;)\n4   MOVE      R(2) R(0)     ; å‚æ•°ï¼ši\n5   CALL      R(1) 2 1      ; print(i)\n\n6   EQ        1 R(0) K(5)   ; æµ‹è¯• i == 5\n7   JMP       9             ; ä¸ç­‰åˆ™è·³è¿‡ break\n8   JMP       11            ; breakï¼šè·³å‡ºå¾ªç¯\n\n9   ADD       R(0) R(0) K(1) ; i = i + 1\n10  JMP       1             ; è·³å›æ¡ä»¶æµ‹è¯•\n\n; while å¾ªç¯ç»“æŸ\n11  GETGLOBAL R(1) K(&#34;print&#34;)\n12  LOADK     R(2) K(&#34;done&#34;)\n13  CALL      R(1) 2 1</code></pre></div><h3>æ§åˆ¶æµå›¾</h3><div class=\"highlight\"><pre><code class=\"language-text\">å¼€å§‹\n          â”‚\n     â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”\n     â”‚ i = 0   â”‚\n     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜\n          â”‚\n     â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”  â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n     â”‚i &lt; 10?  â”‚            â”‚\n     â””â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”˜            â”‚\n    çœŸâ”‚    â”‚å‡              â”‚\n      â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚\n      â”‚             â”‚       â”‚\n â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”        â”‚       â”‚\n â”‚print(i) â”‚        â”‚       â”‚\n â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜        â”‚       â”‚\n      â”‚             â”‚       â”‚\n â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”        â”‚       â”‚\n â”‚i == 5?  â”‚        â”‚       â”‚\n â””â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”˜        â”‚       â”‚\nçœŸ â”‚    â”‚å‡         â”‚       â”‚\n   â”‚    â”‚           â”‚       â”‚\nbreak  â”Œâ–¼â”€â”€â”€â”€â”€â”€â”    â”‚       â”‚\n   â”‚   â”‚i=i+1  â”‚    â”‚       â”‚\n   â”‚   â””â”¬â”€â”€â”€â”€â”€â”€â”˜    â”‚       â”‚\n   â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚\n   â”‚                        â”‚\n   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                            â”‚\n                       print(&#34;done&#34;)\n                            â”‚\n                          ç»“æŸ</code></pre></div><h3>3.2 repeat-until å¾ªç¯è§£æ</h3><h3>è¯­æ³•ç»“æ„</h3><div class=\"highlight\"><pre><code class=\"language-text\">repeatstat ::= &#39;repeat&#39; block &#39;until&#39; exp</code></pre></div><h3>æ ¸å¿ƒç‰¹ç‚¹</h3><p data-pid=\"LFpsDPRd\">repeat-until ä¸ while æœ‰é‡è¦åŒºåˆ«ï¼š</p><ol><li data-pid=\"R53859cS\"><b>åæµ‹è¯•å¾ªç¯</b>ï¼šå…ˆæ‰§è¡Œå¾ªç¯ä½“ï¼Œå†æµ‹è¯•æ¡ä»¶</li><li data-pid=\"MS2JOB4K\"><b>ä½œç”¨åŸŸç‰¹æ®Šæ€§</b>ï¼šæ¡ä»¶è¡¨è¾¾å¼å¯ä»¥è®¿é—®å¾ªç¯ä½“ä¸­å®šä¹‰çš„å±€éƒ¨å˜é‡</li><li data-pid=\"ASs4isZE\"><b>æ¡ä»¶åè½¬</b>ï¼šä¸ºçœŸæ—¶è·³å‡ºï¼ˆä¸ while ç›¸åï¼‰</li></ol><h3>å®Œæ•´å®ç°ä»£ç </h3><div class=\"highlight\"><pre><code class=\"language-text\">static void repeatstat(LexState *ls, int line) {\n    // REPEAT block UNTIL exp\n    \n    int condexit;\n    FuncState *fs = ls-&gt;fs;\n    int repeat_init = luaK_getlabel(fs);  // å¾ªç¯ä½“å¼€å§‹ä½ç½®\n    BlockCnt bl1, bl2;  // ä¸¤å±‚å—ï¼\n    \n    // ========== ç¬¬ä¸€æ­¥ï¼šè¿›å…¥å¤–å±‚å— ==========\n    // å¤–å±‚å—ï¼šç”¨äº break ç®¡ç†\n    enterblock(fs, &amp;bl1, 1);  // breakable = 1\n    \n    // ========== ç¬¬äºŒæ­¥ï¼šè¿›å…¥å†…å±‚å— ==========\n    // å†…å±‚å—ï¼šç”¨äºå±€éƒ¨å˜é‡ä½œç”¨åŸŸ\n    enterblock(fs, &amp;bl2, 0);  // breakable = 0\n    \n    luaX_next(ls);  // è·³è¿‡ &#39;repeat&#39;\n    \n    // ========== ç¬¬ä¸‰æ­¥ï¼šè§£æå¾ªç¯ä½“ ==========\n    chunk(ls);  // æ³¨æ„ï¼šä½¿ç”¨ chunk è€Œä¸æ˜¯ block\n    \n    // æ£€æŸ¥ &#39;until&#39; å…³é”®å­—\n    check_match(ls, TK_UNTIL, TK_REPEAT, line);\n    \n    // ========== ç¬¬å››æ­¥ï¼šè§£ææ¡ä»¶è¡¨è¾¾å¼ ==========\n    // å…³é”®ï¼šæ¡ä»¶åœ¨å†…å±‚å—çš„ä½œç”¨åŸŸå†…è§£æ\n    expdesc v;\n    cond(ls, &amp;v);  // è§£ææ¡ä»¶\n    \n    // ========== ç¬¬äº”æ­¥ï¼šç”Ÿæˆæ¡ä»¶è·³è½¬ ==========\n    // å¦‚æœæ¡ä»¶ä¸ºå‡ï¼Œè·³å›å¾ªç¯å¼€å§‹\n    // ï¼ˆæ³¨æ„ï¼šrepeat æ˜¯&#34;ä¸ºçœŸæ—¶è·³å‡º&#34;ï¼‰\n    if (bl2.upval) {\n        // å¦‚æœæœ‰ upvalueï¼Œéœ€è¦å…ˆå…³é—­\n        luaK_patchtohere(fs, luaK_jump(fs));\n        luaK_codeABC(fs, OP_CLOSE, bl2.nactvar, 0, 0);\n        condexit = luaK_goiffalse(fs, &amp;v);  // å‡æ—¶å›è·³\n    }\n    else {\n        condexit = luaK_goiffalse(fs, &amp;v);  // å‡æ—¶å›è·³\n    }\n    \n    // ========== ç¬¬å…­æ­¥ï¼šç¦»å¼€å†…å±‚å— ==========\n    leaveblock(fs);  // å†…å±‚å—ç»“æŸï¼Œå±€éƒ¨å˜é‡å¤±æ•ˆ\n    \n    // ========== ç¬¬ä¸ƒæ­¥ï¼šå›å¡«å‡è·³è½¬ ==========\n    luaK_patchlist(fs, condexit, repeat_init);  // å‡æ—¶è·³å›å¼€å§‹\n    \n    // ========== ç¬¬å…«æ­¥ï¼šç¦»å¼€å¤–å±‚å— ==========\n    leaveblock(fs);  // å›å¡«æ‰€æœ‰ break è·³è½¬\n}</code></pre></div><h3>åŒå±‚å—ç»“æ„è¯¦è§£</h3><p data-pid=\"7-u3WWsF\"><b>ä¸ºä»€ä¹ˆéœ€è¦ä¸¤å±‚å—ï¼Ÿ</b></p><div class=\"highlight\"><pre><code class=\"language-text\">repeat\n    local x = 10      -- å®šä¹‰åœ¨å¾ªç¯ä½“å†…\nuntil x &gt; 5           -- ä½†åœ¨æ¡ä»¶ä¸­å¯ä»¥è®¿é—®ï¼</code></pre></div><p data-pid=\"yqPi6jvu\"><b>å—ç»“æ„</b>ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">å¤–å±‚å—ï¼ˆbreakableï¼‰\n  â”œâ”€ ç®¡ç† break è·³è½¬\n  â””â”€ å†…å±‚å—ï¼ˆé breakableï¼‰\n      â”œâ”€ ç®¡ç†å±€éƒ¨å˜é‡ä½œç”¨åŸŸ\n      â””â”€ å»¶ä¼¸åˆ° until æ¡ä»¶</code></pre></div><h3>æ‰§è¡Œè¿‡ç¨‹å¯è§†åŒ–</h3><p data-pid=\"OmZ_tM4u\"><b>ç¤ºä¾‹ä»£ç </b>ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">local i = 0\nrepeat\n    local square = i * i\n    print(square)\n    i = i + 1\nuntil i &gt; 5 or square &gt; 20\nprint(&#34;done&#34;)</code></pre></div><p data-pid=\"uv4uclOs\"><b>è§£æè¿‡ç¨‹</b>ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\nè§£æ repeat å¾ªç¯\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\næ­¥éª¤1: åˆå§‹åŒ–\n  repeat_init = pc=1  ; è®°å½•å¾ªç¯ä½“å¼€å§‹ä½ç½®\n\næ­¥éª¤2: è¿›å…¥å¤–å±‚å—\n  enterblock(fs, &amp;bl1, 1)  ; breakable\n  bl1.nactvar = 1  ; i å·²ç»å®šä¹‰\n\næ­¥éª¤3: è¿›å…¥å†…å±‚å—\n  enterblock(fs, &amp;bl2, 0)  ; é breakable\n  bl2.nactvar = 1\n\næ­¥éª¤4: è§£æå¾ªç¯ä½“\n  4.1: å®šä¹‰å±€éƒ¨å˜é‡ square\n    ç”Ÿæˆ: MUL R(1) R(0) R(0)  ; square = i * i\n    bl2.nactvar = 2  ; ç°åœ¨æœ‰ i å’Œ square\n  \n  4.2: è§£æ print(square)\n    ç”Ÿæˆ: GETGLOBAL R(2) K(&#34;print&#34;)\n    ç”Ÿæˆ: MOVE R(3) R(1)\n    ç”Ÿæˆ: CALL R(2) 2 1\n  \n  4.3: è§£æ i = i + 1\n    ç”Ÿæˆ: ADD R(0) R(0) K(1)  ; i = i + 1\n\næ­¥éª¤5: è§£ææ¡ä»¶ &#39;i &gt; 5 or square &gt; 20&#39;\n  æ³¨æ„ï¼šsquare ä»åœ¨ä½œç”¨åŸŸå†…ï¼\n  \n  5.1: è§£æ &#39;i &gt; 5&#39;\n    ç”Ÿæˆ: LT 0 K(5) R(0)      ; æµ‹è¯• i &gt; 5\n    ç”Ÿæˆ: JMP [skip_or]        ; çœŸåˆ™è·³è¿‡ or çš„å³è¾¹\n  \n  5.2: è§£æ &#39;square &gt; 20&#39;\n    ç”Ÿæˆ: LT 0 K(20) R(1)     ; æµ‹è¯• square &gt; 20\n  \n  5.3: ç”Ÿæˆæ¡ä»¶è·³è½¬\n    ç”Ÿæˆ: JMP [?]              ; condexit\n    \næ­¥éª¤6: å›å¡«å‡è·³è½¬\n  luaK_patchlist(condexit, repeat_init=1)\n  å‡æ—¶è·³å›å¾ªç¯å¼€å§‹\n\næ­¥éª¤7: ç¦»å¼€å†…å±‚å—\n  leaveblock(fs)\n  ç§»é™¤ squareï¼ˆnactvar ä» 2 é™åˆ° 1ï¼‰\n\næ­¥éª¤8: ç¦»å¼€å¤–å±‚å—\n  leaveblock(fs)\n  å›å¡«ä»»ä½• break è·³è½¬ï¼ˆå¦‚æœæœ‰ï¼‰\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</code></pre></div><h3>ç”Ÿæˆçš„å­—èŠ‚ç </h3><div class=\"highlight\"><pre><code class=\"language-text\">0   LOADK     R(0) 0         ; i = 0\n\n; repeat å¾ªç¯å¼€å§‹\n1   MUL       R(1) R(0) R(0) ; square = i * i\n2   GETGLOBAL R(2) K(&#34;print&#34;)\n3   MOVE      R(3) R(1)      ; å‚æ•°ï¼šsquare\n4   CALL      R(2) 2 1       ; print(square)\n5   ADD       R(0) R(0) K(1) ; i = i + 1\n\n; until æ¡ä»¶æµ‹è¯•\n6   LT        0 K(5) R(0)    ; i &gt; 5?\n7   JMP       9              ; çœŸåˆ™è·³è¿‡åç»­æµ‹è¯•\n8   LT        0 K(20) R(1)   ; square &gt; 20?\n\n; æ¡ä»¶ä¸ºå‡æ—¶å›è·³\n9   JMP       1              ; å‡åˆ™è·³å›å¾ªç¯å¼€å§‹\n\n; repeat å¾ªç¯ç»“æŸ\n10  GETGLOBAL R(2) K(&#34;print&#34;)\n11  LOADK     R(3) K(&#34;done&#34;)\n12  CALL      R(2) 2 1</code></pre></div><h3>å…³é”®è®¾è®¡å†³ç­–</h3><p data-pid=\"_XNg_BB_\"><b>é—®é¢˜</b>ï¼šä¸ºä»€ä¹ˆæ¡ä»¶å¯ä»¥è®¿é—®å¾ªç¯ä½“çš„å±€éƒ¨å˜é‡ï¼Ÿ</p><p data-pid=\"1fqGk2gh\"><b>ç­”æ¡ˆ</b>ï¼šLua çš„è®¾è®¡å“²å­¦</p><div class=\"highlight\"><pre><code class=\"language-text\">-- è¿™æ˜¯åˆæ³•çš„ Lua ä»£ç \nrepeat\n    local answer = read_input()\nuntil answer == &#34;yes&#34;  -- å¯ä»¥è®¿é—® answer</code></pre></div><p data-pid=\"CL7FoeOf\"><b>å®ç°æœºåˆ¶</b>ï¼š</p><ol><li data-pid=\"kCVkGeEG\">å†…å±‚å—åŒ…å«å¾ªç¯ä½“å’Œæ¡ä»¶</li><li data-pid=\"B3YyGf7G\">å±€éƒ¨å˜é‡åœ¨å†…å±‚å—ä½œç”¨åŸŸå†…</li><li data-pid=\"YLHJ9Xti\">æ¡ä»¶è§£æå®Œåæ‰ç¦»å¼€å†…å±‚å—</li></ol><h3>3.3 for å¾ªç¯è§£æ</h3><h3>ä¸¤ç§ for å¾ªç¯</h3><p data-pid=\"nZ1Jx8_C\">Lua æœ‰ä¸¤ç§ for å¾ªç¯ï¼š</p><ol><li data-pid=\"wg0UXHIX\"><b>æ•°å€¼ for</b>ï¼š<code>for i = 1, 10, 2 do ... end</code></li><li data-pid=\"g2C3V8rt\"><b>é€šç”¨ for</b>ï¼š<code>for k, v in pairs(t) do ... end</code></li></ol><h3>3.3.1 æ•°å€¼ for å¾ªç¯</h3><p data-pid=\"WIVruNj2\"><b>è¯­æ³•ç»“æ„</b>ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">fornum ::= &#39;for&#39; NAME &#39;=&#39; exp &#39;,&#39; exp [&#39;,&#39; exp] &#39;do&#39; block &#39;end&#39;</code></pre></div><p data-pid=\"Y7AWRTCT\"><b>å®ç°ä»£ç </b>ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">static void fornum(LexState *ls, TString *varname, int line) {\n    // FOR NAME = init, limit [, step] DO block END\n    \n    FuncState *fs = ls-&gt;fs;\n    int base = fs-&gt;freereg;  // å¾ªç¯å˜é‡çš„å¯„å­˜å™¨åŸºå€\n    \n    // ========== ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºå†…éƒ¨å¾ªç¯å˜é‡ ==========\n    // Lua ä¸ºæ•°å€¼ for åˆ›å»º 4 ä¸ªå†…éƒ¨å˜é‡ï¼š\n    // (for index), (for limit), (for step), var\n    \n    new_localvarliteral(ls, &#34;(for index)&#34;, 0);  // å†…éƒ¨ç´¢å¼•\n    new_localvarliteral(ls, &#34;(for limit)&#34;, 1);  // å†…éƒ¨é™åˆ¶\n    new_localvarliteral(ls, &#34;(for step)&#34;, 2);   // å†…éƒ¨æ­¥é•¿\n    new_localvar(ls, varname, 3);               // ç”¨æˆ·å˜é‡\n    \n    // ========== ç¬¬äºŒæ­¥ï¼šè§£æåˆå§‹åŒ–è¡¨è¾¾å¼ ==========\n    check(ls, &#39;=&#39;);\n    exp1(ls);  // è§£æ init\n    \n    check(ls, &#39;,&#39;);\n    exp1(ls);  // è§£æ limit\n    \n    if (testnext(ls, &#39;,&#39;))\n        exp1(ls);  // è§£æ stepï¼ˆå¯é€‰ï¼‰\n    else {\n        // é»˜è®¤æ­¥é•¿ä¸º 1\n        luaK_codeABx(fs, OP_LOADK, fs-&gt;freereg, luaK_numberK(fs, 1));\n        luaK_reserveregs(fs, 1);\n    }\n    \n    // ========== ç¬¬ä¸‰æ­¥ï¼šç”Ÿæˆ FORPREP æŒ‡ä»¤ ==========\n    // FORPREP æ‰§è¡Œåˆå§‹åŒ–å¹¶è·³åˆ°å¾ªç¯ç»“æŸ\n    int prep_jump = luaK_codeAsBx(fs, OP_FORPREP, base, NO_JUMP);\n    \n    // ========== ç¬¬å››æ­¥ï¼šè¿›å…¥å¾ªç¯ä½“å— ==========\n    check(ls, TK_DO);\n    \n    BlockCnt bl;\n    enterblock(fs, &amp;bl, 0);  // æ³¨æ„ï¼šfor å¾ªç¯ä¸ç›´æ¥æ”¯æŒ break\n                              // break ç”±å¤–å±‚è¯­å¥å¤„ç†\n    \n    // æ¿€æ´»æ‰€æœ‰å˜é‡ï¼ˆåŒ…æ‹¬ç”¨æˆ·å˜é‡ï¼‰\n    adjustlocalvars(ls, 4);\n    \n    luaK_reserveregs(fs, 1);  // ä¸ºå¾ªç¯å˜é‡é¢„ç•™ç©ºé—´\n    \n    // ========== ç¬¬äº”æ­¥ï¼šè§£æå¾ªç¯ä½“ ==========\n    block(ls);\n    \n    // ========== ç¬¬å…­æ­¥ï¼šç”Ÿæˆ FORLOOP æŒ‡ä»¤ ==========\n    leaveblock(fs);\n    \n    // FORLOOP é€’å¢ç´¢å¼•å¹¶åˆ¤æ–­æ˜¯å¦ç»§ç»­å¾ªç¯\n    luaK_patchtohere(fs, prep_jump);  // å›å¡« FORPREP çš„è·³è½¬\n    int loop_end = luaK_codeAsBx(fs, OP_FORLOOP, base, NO_JUMP);\n    luaK_fixline(fs, line);\n    \n    // å›å¡« FORLOOP çš„è·³è½¬ç›®æ ‡ï¼ˆå›åˆ°å¾ªç¯ä½“å¼€å§‹ï¼‰\n    luaK_patchlist(fs, loop_end, prep_jump + 1);\n}</code></pre></div><p data-pid=\"5uo-NCUv\"><b>æ•°å€¼ for çš„æ‰§è¡Œæµç¨‹</b>ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">åˆå§‹åŒ–: (index)=init-step, (limit)=limit, (step)=step\n\nFORPREP:\n  index = index + step\n  if (step&gt;0 and index&gt;limit) or (step&lt;0 and index&lt;limit) then\n    è·³åˆ°å¾ªç¯ç»“æŸ\n  end\n  var = index  ; è®¾ç½®ç”¨æˆ·å˜é‡\n\nå¾ªç¯ä½“:\n  ... ç”¨æˆ·ä»£ç  ...\n\nFORLOOP:\n  index = index + step\n  if (step&gt;0 and index&lt;=limit) or (step&lt;0 and index&gt;=limit) then\n    var = index\n    è·³å›å¾ªç¯ä½“å¼€å§‹\n  end\n\nå¾ªç¯ç»“æŸ</code></pre></div><p data-pid=\"pzbtgLKL\"><b>ç¤ºä¾‹</b>ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">for i = 1, 10, 2 do\n    print(i)\nend</code></pre></div><p data-pid=\"7R30MqcB\"><b>ç”Ÿæˆçš„å­—èŠ‚ç </b>ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">0   LOADK     R(0) 1         ; (for index) = 1\n1   LOADK     R(1) 10        ; (for limit) = 10\n2   LOADK     R(2) 2         ; (for step) = 2\n3   FORPREP   R(0) 7         ; åˆå§‹åŒ–ï¼Œè·³åˆ°ç»“æŸ\n4   GETGLOBAL R(4) K(&#34;print&#34;)\n5   MOVE      R(5) R(3)      ; R(3) = i\n6   CALL      R(4) 2 1\n7   FORLOOP   R(0) 4         ; é€’å¢å¹¶è·³å›\n8   ; å¾ªç¯ç»“æŸ</code></pre></div><h3>3.3.2 é€šç”¨ for å¾ªç¯</h3><p data-pid=\"d_T64euQ\"><b>è¯­æ³•ç»“æ„</b>ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">forlist ::= &#39;for&#39; namelist &#39;in&#39; explist &#39;do&#39; block &#39;end&#39;</code></pre></div><p data-pid=\"CgS5Gp20\"><b>ç‰¹ç‚¹</b>ï¼š</p><ul><li data-pid=\"nn1GjN27\">ä½¿ç”¨è¿­ä»£å™¨åè®®</li><li data-pid=\"RfpZMuCi\">æ”¯æŒå¤šä¸ªå¾ªç¯å˜é‡</li><li data-pid=\"k5yIEfTH\">å†…éƒ¨ä½¿ç”¨ 3 ä¸ªçŠ¶æ€å˜é‡</li></ul><p data-pid=\"2x-8maE1\"><b>ç¤ºä¾‹</b>ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">for k, v in pairs(t) do\n    print(k, v)\nend</code></pre></div><p data-pid=\"C4R7MIXE\"><b>å†…éƒ¨å˜é‡</b>ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">(for generator)  -- è¿­ä»£å™¨å‡½æ•°\n(for state)      -- çŠ¶æ€å˜é‡\n(for control)    -- æ§åˆ¶å˜é‡\nk, v             -- ç”¨æˆ·å˜é‡</code></pre></div><p data-pid=\"gX7G0K8M\"><b>æ‰§è¡Œæµç¨‹</b>ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">åˆå§‹åŒ–:\n  generator, state, control = explist\n\nå¾ªç¯:\n  var1, var2, ... = generator(state, control)\n  control = var1\n  if control == nil then break end\n  ... å¾ªç¯ä½“ ...\n  è·³å›å¾ªç¯å¼€å§‹</code></pre></div><h3>3.4 å¾ªç¯è¯­å¥å¯¹æ¯”æ€»ç»“</h3><h3>ä¸‰ç§å¾ªç¯çš„ç‰¹ç‚¹å¯¹æ¯”</h3><table data-draft-node=\"block\" data-draft-type=\"table\" data-size=\"normal\" data-row-style=\"normal\"><tbody><tr><th>ç‰¹æ€§</th><th>while</th><th>repeat-until</th><th>for</th></tr><tr><td>æµ‹è¯•æ—¶æœº</td><td>å‰æµ‹è¯•</td><td>åæµ‹è¯•</td><td>è‡ªåŠ¨ç®¡ç†</td></tr><tr><td>æœ€å°‘æ‰§è¡Œ</td><td>0 æ¬¡</td><td>1 æ¬¡</td><td>0 æ¬¡</td></tr><tr><td>æ¡ä»¶ä½œç”¨åŸŸ</td><td>å¤–éƒ¨</td><td>å¾ªç¯ä½“å†…</td><td>è‡ªåŠ¨</td></tr><tr><td>break æ”¯æŒ</td><td>âœ“</td><td>âœ“</td><td>âœ“</td></tr><tr><td>continue</td><td>âœ—</td><td>âœ—</td><td>âœ—</td></tr><tr><td>ä½¿ç”¨åœºæ™¯</td><td>é€šç”¨</td><td>è‡³å°‘æ‰§è¡Œä¸€æ¬¡</td><td>éå†åºåˆ—</td></tr></tbody></table><h3>æ§åˆ¶æµå¯¹æ¯”</h3><p data-pid=\"gXV8tYUL\"><b>while</b>ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">â”Œâ”€â†’ æµ‹è¯•æ¡ä»¶ â”€â”€å‡â†’ ç»“æŸ\n    â”‚      â”‚çœŸ\n    â”‚      â†“\n    â”‚   å¾ªç¯ä½“\n    â”‚      â”‚\n    â””â”€â”€â”€â”€â”€â”€â”˜</code></pre></div><p data-pid=\"iMDkawH4\"><b>repeat</b>ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">â”Œâ”€â†’ å¾ªç¯ä½“\n    â”‚      â”‚\n    â”‚   æµ‹è¯•æ¡ä»¶ â”€â”€çœŸâ†’ ç»“æŸ\n    â”‚      â”‚å‡\n    â””â”€â”€â”€â”€â”€â”€â”˜</code></pre></div><p data-pid=\"CoHe-77-\"><b>for</b>ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">åˆå§‹åŒ–\n       â”‚\n    â”Œâ”€â†’ FORPREP/TFORLOOP\n    â”‚      â”‚\n    â”‚   å¾ªç¯ä½“\n    â”‚      â”‚\n    â””â”€â”€ FORLOOP/TFORCALL\n       â”‚\n    ç»“æŸ</code></pre></div><h3>å­—èŠ‚ç æŒ‡ä»¤å¯¹æ¯”</h3><table data-draft-node=\"block\" data-draft-type=\"table\" data-size=\"normal\" data-row-style=\"normal\"><tbody><tr><th>å¾ªç¯ç±»å‹</th><th>æ¡ä»¶æµ‹è¯•</th><th>å›è·³æ–¹å¼</th><th>ç‰¹æ®ŠæŒ‡ä»¤</th></tr><tr><td>while</td><td>æ¡ä»¶è¡¨è¾¾å¼ + TEST</td><td>JMP</td><td>æ— </td></tr><tr><td>repeat</td><td>æ¡ä»¶è¡¨è¾¾å¼ + TEST</td><td>JMP</td><td>æ— </td></tr><tr><td>æ•°å€¼ for</td><td>å†…ç½®</td><td>å†…ç½®</td><td>FORPREP, FORLOOP</td></tr><tr><td>é€šç”¨ for</td><td>å†…ç½®</td><td>å†…ç½®</td><td>TFORLOOP, TFORCALL</td></tr></tbody></table><hr/><h3>ç¬¬å››éƒ¨åˆ†ï¼šèµ‹å€¼ä¸å‡½æ•°è°ƒç”¨</h3><h3>4.1 åŒºåˆ†èµ‹å€¼å’Œå‡½æ•°è°ƒç”¨çš„æŒ‘æˆ˜</h3><h3>é—®é¢˜çš„æœ¬è´¨</h3><p data-pid=\"2_aKDuZn\">åœ¨ Lua ä¸­ï¼Œèµ‹å€¼è¯­å¥å’Œå‡½æ•°è°ƒç”¨åœ¨è¯­æ³•ä¸Šæœ‰é‡å ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">a = 1           -- èµ‹å€¼\na()             -- å‡½æ•°è°ƒç”¨\na.b = 2         -- è¡¨å­—æ®µèµ‹å€¼\na.b()           -- æ–¹æ³•è°ƒç”¨\na[i] = 3        -- ç´¢å¼•èµ‹å€¼\na, b = 1, 2     -- å¤šé‡èµ‹å€¼\nf(x)            -- å‡½æ•°è°ƒç”¨</code></pre></div><p data-pid=\"9x5CSdre\"><b>æ ¸å¿ƒé—®é¢˜</b>ï¼š<b>å¦‚ä½•é€šè¿‡å‰çœ‹ç¡®å®šæ˜¯èµ‹å€¼è¿˜æ˜¯è°ƒç”¨ï¼Ÿ</b></p><h3>LL(1) çš„å›°å¢ƒ</h3><p data-pid=\"c8Xt4_Vr\">ç®€å•çš„ LL(1) æ— æ³•åŒºåˆ†ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">è¯­å¥å¼€å§‹éƒ½æ˜¯ NAME:\n  NAME ...\n    â†’ èµ‹å€¼ï¼Ÿ\n    â†’ å‡½æ•°è°ƒç”¨ï¼Ÿ\n    â†’ éœ€è¦çœ‹åç»­ token</code></pre></div><h3>Lua çš„è§£å†³æ–¹æ¡ˆ</h3><p data-pid=\"5oTBiGhS\">ä½¿ç”¨ <b>exprstat</b> å‡½æ•°ç»Ÿä¸€å¤„ç†ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">static void exprstat(LexState *ls) {\n    // èµ‹å€¼æˆ–å‡½æ•°è°ƒç”¨\n    FuncState *fs = ls-&gt;fs;\n    struct LHS_assign v;\n    \n    // ç¬¬ä¸€æ­¥ï¼šè§£æä¸»è¡¨è¾¾å¼\n    primaryexp(ls, &amp;v.v);\n    \n    // ç¬¬äºŒæ­¥ï¼šæ ¹æ®åç»­ token åˆ¤æ–­\n    if (v.v.k == VCALL) {  // å‡½æ•°è°ƒç”¨\n        SETARG_C(getcode(fs, &amp;v.v), 1);  // è°ƒæ•´è°ƒç”¨å‚æ•°\n    }\n    else {  // èµ‹å€¼\n        v.prev = NULL;\n        assignment(ls, &amp;v, 1);\n    }\n}</code></pre></div><h3>4.2 èµ‹å€¼è¯­å¥å®Œæ•´è§£æ</h3><h3>è¯­æ³•ç»“æ„</h3><div class=\"highlight\"><pre><code class=\"language-text\">assignment ::= varlist &#39;=&#39; explist\nvarlist    ::= var {&#39;,&#39; var}\nexplist    ::= exp {&#39;,&#39; exp}\nvar        ::= NAME | prefixexp &#39;[&#39; exp &#39;]&#39; | prefixexp &#39;.&#39; NAME</code></pre></div><h3>æ ¸å¿ƒéš¾ç‚¹</h3><ol><li data-pid=\"z9Z7p20d\"><b>å¤šé‡èµ‹å€¼</b>ï¼š<code>a, b, c = 1, 2, 3</code></li><li data-pid=\"bBBKYMdq\"><b>å·¦å€¼è¯†åˆ«</b>ï¼šåŒºåˆ†å˜é‡ã€è¡¨å­—æ®µã€è¡¨ç´¢å¼•</li><li data-pid=\"Dh-KmkUV\"><b>å³å€¼æ•°é‡è°ƒæ•´</b>ï¼šå¤„ç†å³å€¼å¤šäºæˆ–å°‘äºå·¦å€¼çš„æƒ…å†µ</li><li data-pid=\"9yun0Al6\"><b>ä»å³åˆ°å·¦èµ‹å€¼</b>ï¼šé¿å…è¦†ç›–é—®é¢˜</li></ol><h3>LHS_assign ç»“æ„</h3><p data-pid=\"rPABB-iP\">ç”¨äºæ„å»ºå·¦å€¼é“¾è¡¨ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">struct LHS_assign {\n    struct LHS_assign *prev;  // å‰ä¸€ä¸ªå·¦å€¼ï¼ˆé“¾è¡¨ï¼‰\n    expdesc v;                // å½“å‰å·¦å€¼çš„è¡¨è¾¾å¼æè¿°ç¬¦\n};</code></pre></div><h3>å®Œæ•´å®ç°ä»£ç </h3><div class=\"highlight\"><pre><code class=\"language-text\">static void assignment(LexState *ls, struct LHS_assign *lh, int nvars) {\n    // é€’å½’è§£æèµ‹å€¼é“¾\n    \n    expdesc e;\n    \n    // ========== ç¬¬ä¸€æ­¥ï¼šæ£€æŸ¥æ˜¯å¦æœ‰æ›´å¤šå·¦å€¼ ==========\n    check_condition(ls, VLOCAL &lt;= lh-&gt;v.k &amp;&amp; lh-&gt;v.k &lt;= VINDEXED,\n                    &#34;syntax error&#34;);\n    \n    if (testnext(ls, &#39;,&#39;)) {  // æœ‰æ›´å¤šå·¦å€¼\n        // é€’å½’æ„å»ºå·¦å€¼é“¾è¡¨\n        struct LHS_assign nv;\n        nv.prev = lh;\n        \n        // è§£æä¸‹ä¸€ä¸ªå·¦å€¼\n        primaryexp(ls, &amp;nv.v);\n        \n        // æ£€æŸ¥æ˜¯å¦æ˜¯æœ‰æ•ˆçš„å·¦å€¼\n        if (nv.v.k == VLOCAL)\n            check_conflict(ls, lh, &amp;nv.v);  // æ£€æŸ¥å†²çª\n        \n        // æ›´æ–°å˜é‡è®¡æ•°\n        luaY_checklimit(fs, nvars, LUAI_MAXCCALLS/2,\n                       &#34;variables in assignment&#34;);\n        \n        // é€’å½’å¤„ç†\n        assignment(ls, &amp;nv, nvars+1);\n    }\n    else {  // æ²¡æœ‰æ›´å¤šå·¦å€¼\n        // ========== ç¬¬äºŒæ­¥ï¼šè§£æå³å€¼è¡¨è¾¾å¼åˆ—è¡¨ ==========\n        int nexps;\n        \n        check(ls, &#39;=&#39;);  // æ£€æŸ¥ &#39;=&#39; ç¬¦å·\n        \n        nexps = explist1(ls, &amp;e);  // è§£æå³å€¼åˆ—è¡¨\n        \n        // ========== ç¬¬ä¸‰æ­¥ï¼šè°ƒæ•´å³å€¼æ•°é‡ ==========\n        if (nexps != nvars) {\n            adjust_assign(ls, nvars, nexps, &amp;e);\n            if (nexps &gt; nvars)\n                ls-&gt;fs-&gt;freereg -= nexps - nvars;  // ä¸¢å¼ƒå¤šä½™çš„å€¼\n        }\n        else {\n            // æ•°é‡åŒ¹é…ï¼šå°†æœ€åä¸€ä¸ªè¡¨è¾¾å¼ç§»åˆ°å³å€¼ä½ç½®\n            luaK_setoneret(ls-&gt;fs, &amp;e);\n            luaK_storevar(ls-&gt;fs, &amp;lh-&gt;v, &amp;e);\n            return;  // é¿å…é»˜è®¤å¤„ç†\n        }\n    }\n    \n    // ========== ç¬¬å››æ­¥ï¼šåˆå§‹åŒ–æœ€åä¸€ä¸ªå·¦å€¼ ==========\n    init_exp(&amp;e, VNONRELOC, ls-&gt;fs-&gt;freereg-1);\n    \n    // ========== ç¬¬äº”æ­¥ï¼šå­˜å‚¨åˆ°å½“å‰å·¦å€¼ ==========\n    luaK_storevar(ls-&gt;fs, &amp;lh-&gt;v, &amp;e);\n}</code></pre></div><h3>æ‰§è¡Œè¿‡ç¨‹å¯è§†åŒ–</h3><p data-pid=\"SgFHMB1m\"><b>ç¤ºä¾‹ä»£ç </b>ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">a, b, c = 1, 2, 3</code></pre></div><p data-pid=\"KOUyzVjA\"><b>è§£æè¿‡ç¨‹</b>ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\nè§£æå¤šé‡èµ‹å€¼: a, b, c = 1, 2, 3\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\næ­¥éª¤1: è§£æç¬¬ä¸€ä¸ªå·¦å€¼ &#39;a&#39;\n  primaryexp(ls, &amp;lh.v)\n  lh.v = {k=VLOCAL, info=0}  ; a åœ¨å¯„å­˜å™¨ 0\n  lh.prev = NULL\n\næ­¥éª¤2: é‡åˆ° &#39;,&#39;ï¼Œæœ‰æ›´å¤šå·¦å€¼\n  åˆ›å»ºæ–°èŠ‚ç‚¹: nv\n  nv.prev = lh\n  \næ­¥éª¤3: è§£æç¬¬äºŒä¸ªå·¦å€¼ &#39;b&#39;\n  primaryexp(ls, &amp;nv.v)\n  nv.v = {k=VLOCAL, info=1}  ; b åœ¨å¯„å­˜å™¨ 1\n  \næ­¥éª¤4: é‡åˆ° &#39;,&#39;ï¼Œç»§ç»­é€’å½’\n  åˆ›å»ºæ–°èŠ‚ç‚¹: nv2\n  nv2.prev = nv\n  \næ­¥éª¤5: è§£æç¬¬ä¸‰ä¸ªå·¦å€¼ &#39;c&#39;\n  primaryexp(ls, &amp;nv2.v)\n  nv2.v = {k=VLOCAL, info=2}  ; c åœ¨å¯„å­˜å™¨ 2\n\næ­¥éª¤6: é‡åˆ° &#39;=&#39;ï¼Œè§£æå³å€¼\n  explist1(ls, &amp;e)\n  \n  6.1: è§£æ &#39;1&#39;\n    e = {k=VKNUM, nval=1}\n    nexps = 1\n  \n  6.2: é‡åˆ° &#39;,&#39;ï¼Œç»§ç»­\n    è§£æ &#39;2&#39;\n    ç”Ÿæˆ: LOADK R(3) K(2)\n    nexps = 2\n  \n  6.3: é‡åˆ° &#39;,&#39;ï¼Œç»§ç»­\n    è§£æ &#39;3&#39;\n    ç”Ÿæˆ: LOADK R(4) K(3)\n    nexps = 3\n\næ­¥éª¤7: è°ƒæ•´æ•°é‡\n  nvars = 3, nexps = 3\n  æ•°é‡åŒ¹é…ï¼Œæ— éœ€è°ƒæ•´\n\næ­¥éª¤8: ä»å³åˆ°å·¦èµ‹å€¼\n  8.1: å­˜å‚¨åˆ° c (å¯„å­˜å™¨ 2)\n    ç”Ÿæˆ: MOVE R(2) R(4)  ; c = 3\n  \n  8.2: å­˜å‚¨åˆ° b (å¯„å­˜å™¨ 1)\n    ç”Ÿæˆ: MOVE R(1) R(3)  ; b = 2\n  \n  8.3: å­˜å‚¨åˆ° a (å¯„å­˜å™¨ 0)\n    ç”Ÿæˆ: LOADK R(0) K(1)  ; a = 1\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</code></pre></div><h3>æ•°é‡ä¸åŒ¹é…çš„å¤„ç†</h3><p data-pid=\"vZ0xmSb7\"><b>æƒ…å†µ1ï¼šå³å€¼å¤šäºå·¦å€¼</b></p><div class=\"highlight\"><pre><code class=\"language-text\">a, b = 1, 2, 3  -- 3 è¢«ä¸¢å¼ƒ</code></pre></div><p data-pid=\"rQisa_KI\"><b>å¤„ç†</b>ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">if (nexps &gt; nvars)\n    ls-&gt;fs-&gt;freereg -= nexps - nvars;  // é‡Šæ”¾å¤šä½™çš„å¯„å­˜å™¨</code></pre></div><p data-pid=\"gjfYKCaT\"><b>æƒ…å†µ2ï¼šå³å€¼å°‘äºå·¦å€¼</b></p><div class=\"highlight\"><pre><code class=\"language-text\">a, b, c = 1, 2  -- c è¢«èµ‹å€¼ä¸º nil</code></pre></div><p data-pid=\"okhovqqh\"><b>å¤„ç†</b>ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">// adjust_assign ç”Ÿæˆ LOADNIL æŒ‡ä»¤å¡«å……ç¼ºå¤±çš„å€¼\nadjust_assign(ls, nvars, nexps, &amp;e);</code></pre></div><p data-pid=\"qXKwiZNs\"><b>æƒ…å†µ3ï¼šå‡½æ•°è¿”å›å¤šå€¼</b></p><div class=\"highlight\"><pre><code class=\"language-text\">a, b, c = f()  -- f è¿”å›å¤šä¸ªå€¼</code></pre></div><p data-pid=\"3mo4CnOn\"><b>å¤„ç†</b>ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">// æœ€åä¸€ä¸ªè¡¨è¾¾å¼å¦‚æœæ˜¯å‡½æ•°è°ƒç”¨ï¼Œè®¾ç½®ä¸ºè¿”å› nvars ä¸ªå€¼\nif (hasmultret(e.k)) {\n    luaK_setreturns(fs, &amp;e, nvars - nexps + 1);\n}</code></pre></div><h3>4.3 è¡¨å­—æ®µèµ‹å€¼</h3><h3>ç‰¹æ®Šæƒ…å†µ</h3><div class=\"highlight\"><pre><code class=\"language-text\">t[key] = value      -- ç´¢å¼•èµ‹å€¼\nt.field = value     -- å­—æ®µèµ‹å€¼ï¼ˆè¯­æ³•ç³–ï¼‰\nt[f()] = g()        -- å¤æ‚è¡¨è¾¾å¼</code></pre></div><h3>ç”Ÿæˆçš„å­—èŠ‚ç </h3><div class=\"highlight\"><pre><code class=\"language-text\">t[1] = 42\nSETTABLE R(t) K(1) K(42)  ; t[1] = 42\nt.x = 10\nSETTABLE R(t) K(&#34;x&#34;) K(10)  ; t[&#34;x&#34;] = 10</code></pre></div><h3>4.4 å‡½æ•°è°ƒç”¨å¤„ç†</h3><h3>è°ƒç”¨å½¢å¼</h3><p data-pid=\"p4Oa0mTO\">Lua æ”¯æŒå¤šç§å‡½æ•°è°ƒç”¨è¯­æ³•ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">f()              -- æ ‡å‡†å½¢å¼\nf(a, b)          -- å¸¦å‚æ•°\nf &#34;string&#34;       -- å­—ç¬¦ä¸²å‚æ•°ï¼ˆè¯­æ³•ç³–ï¼‰\nf {x=1}          -- è¡¨å‚æ•°ï¼ˆè¯­æ³•ç³–ï¼‰\nobj:method(a)    -- æ–¹æ³•è°ƒç”¨ï¼ˆè¯­æ³•ç³–ï¼‰</code></pre></div><h3>å®ç°ä»£ç </h3><div class=\"highlight\"><pre><code class=\"language-text\">static void funcargs(LexState *ls, expdesc *f) {\n    FuncState *fs = ls-&gt;fs;\n    expdesc args;\n    int base, nparams;\n    int line = ls-&gt;linenumber;\n    \n    switch (ls-&gt;t.token) {\n        case &#39;(&#39;: {  // f(...)\n            // æ£€æŸ¥æ¢è¡Œæ­§ä¹‰\n            if (line != ls-&gt;lastline)\n                luaX_syntaxerror(ls,\n                    &#34;ambiguous syntax (function call x new statement)&#34;);\n            \n            luaX_next(ls);\n            \n            if (ls-&gt;t.token == &#39;)&#39;)  // æ— å‚æ•°\n                args.k = VVOID;\n            else {\n                explist1(ls, &amp;args);\n                luaK_setmultret(fs, &amp;args);\n            }\n            \n            check_match(ls, &#39;)&#39;, &#39;(&#39;, line);\n            break;\n        }\n        \n        case &#39;{&#39;: {  // f{...}\n            constructor(ls, &amp;args);\n            break;\n        }\n        \n        case TK_STRING: {  // f&#34;...&#34;\n            codestring(ls, &amp;args, ls-&gt;t.seminfo.ts);\n            luaX_next(ls);\n            break;\n        }\n        \n        default: {\n            luaX_syntaxerror(ls, &#34;function arguments expected&#34;);\n            return;\n        }\n    }\n    \n    // ç¡®ä¿å‡½æ•°åœ¨å¯„å­˜å™¨ä¸­\n    lua_assert(f-&gt;k == VNONRELOC);\n    base = f-&gt;u.s.info;  // å‡½æ•°æ‰€åœ¨å¯„å­˜å™¨\n    \n    // è®¡ç®—å‚æ•°æ•°é‡\n    if (hasmultret(args.k))\n        nparams = LUA_MULTRET;\n    else {\n        if (args.k != VVOID)\n            luaK_exp2nextreg(fs, &amp;args);\n        nparams = fs-&gt;freereg - (base+1);\n    }\n    \n    // ç”Ÿæˆ CALL æŒ‡ä»¤\n    init_exp(f, VCALL, luaK_codeABC(fs, OP_CALL, base, nparams+1, 2));\n    \n    luaK_fixline(fs, line);\n    fs-&gt;freereg = base+1;  // é‡Šæ”¾å‚æ•°å¯„å­˜å™¨\n}</code></pre></div><h3>å¤šè¿”å›å€¼å¤„ç†</h3><p data-pid=\"XJpi8ag_\"><b>é—®é¢˜åœºæ™¯</b>ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">a, b = f(), g()     -- f è¿”å›å¤šå€¼\nx = f()             -- åªè¦ç¬¬ä¸€ä¸ªè¿”å›å€¼\nprint(f())          -- ä½¿ç”¨æ‰€æœ‰è¿”å›å€¼</code></pre></div><p data-pid=\"b4GmVrJ9\"><b>è§£å†³æ–¹æ¡ˆ</b>ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">// CALL æŒ‡ä»¤çš„ C å‚æ•°ï¼š\n// C = 1: ä¸éœ€è¦è¿”å›å€¼\n// C = 2: éœ€è¦ 1 ä¸ªè¿”å›å€¼\n// C = n+1: éœ€è¦ n ä¸ªè¿”å›å€¼\n// C = 0: éœ€è¦æ‰€æœ‰è¿”å›å€¼ï¼ˆLUA_MULTRETï¼‰\n\n// ç¤ºä¾‹ï¼š\nCALL R(0) 1 2    ; R(0) = f()ï¼Œ1ä¸ªè¿”å›å€¼\nCALL R(0) 1 0    ; R(0..top) = f()ï¼Œæ‰€æœ‰è¿”å›å€¼</code></pre></div><hr/><h3>ç¬¬äº”éƒ¨åˆ†ï¼šä½œç”¨åŸŸç®¡ç†</h3><h3>5.1 å±€éƒ¨å˜é‡çš„ç”Ÿå‘½å‘¨æœŸ</h3><h3>å˜é‡çŠ¶æ€</h3><p data-pid=\"w7B2HEMo\">å±€éƒ¨å˜é‡ç»å†ä¸‰ä¸ªçŠ¶æ€ï¼š</p><ol><li data-pid=\"b_Le5p-W\"><b>å£°æ˜</b>ï¼š<code>local x</code></li><li data-pid=\"wnLliqjz\"><b>æ¿€æ´»</b>ï¼šèµ‹åˆå€¼åå¯ç”¨</li><li data-pid=\"TALDBcTq\"><b>å¤±æ•ˆ</b>ï¼šç¦»å¼€ä½œç”¨åŸŸ</li></ol><h3>å®ç°æœºåˆ¶</h3><div class=\"highlight\"><pre><code class=\"language-text\">// æ³¨å†Œå±€éƒ¨å˜é‡ï¼ˆå£°æ˜ä½†æœªæ¿€æ´»ï¼‰\nstatic int registerlocalvar(LexState *ls, TString *varname) {\n    FuncState *fs = ls-&gt;fs;\n    Proto *f = fs-&gt;f;\n    int oldsize = f-&gt;sizelocvars;\n    \n    // æ‰©å±•å±€éƒ¨å˜é‡æ•°ç»„\n    luaM_growvector(ls-&gt;L, f-&gt;locvars, fs-&gt;nlocvars, f-&gt;sizelocvars,\n                    LocVar, SHRT_MAX, &#34;too many local variables&#34;);\n    \n    // è®°å½•å˜é‡ä¿¡æ¯\n    while (oldsize &lt; f-&gt;sizelocvars)\n        f-&gt;locvars[oldsize++].varname = NULL;\n    \n    f-&gt;locvars[fs-&gt;nlocvars].varname = varname;\n    \n    luaC_objbarrier(ls-&gt;L, f, varname);\n    \n    return fs-&gt;nlocvars++;\n}\n\n// åˆ›å»ºæ–°çš„å±€éƒ¨å˜é‡\nstatic void new_localvar(LexState *ls, TString *name, int n) {\n    FuncState *fs = ls-&gt;fs;\n    \n    luaY_checklimit(fs, fs-&gt;nactvar+n+1, LUAI_MAXVARS, &#34;local variables&#34;);\n    \n    fs-&gt;actvar[fs-&gt;nactvar+n] = cast(unsigned short, registerlocalvar(ls, name));\n}\n\n// æ¿€æ´»å±€éƒ¨å˜é‡\nstatic void adjustlocalvars(LexState *ls, int nvars) {\n    FuncState *fs = ls-&gt;fs;\n    \n    fs-&gt;nactvar = cast_byte(fs-&gt;nactvar + nvars);\n    \n    // è®°å½•å˜é‡çš„èµ·å§‹ pc\n    for (; nvars; nvars--) {\n        getlocvar(fs, fs-&gt;nactvar - nvars).startpc = fs-&gt;pc;\n    }\n}\n\n// ç§»é™¤å±€éƒ¨å˜é‡\nstatic void removevars(LexState *ls, int tolevel) {\n    FuncState *fs = ls-&gt;fs;\n    \n    // è®°å½•å˜é‡çš„ç»“æŸ pc\n    while (fs-&gt;nactvar &gt; tolevel)\n        getlocvar(fs, --fs-&gt;nactvar).endpc = fs-&gt;pc;\n}</code></pre></div><h3>5.2 å±€éƒ¨å˜é‡å£°æ˜</h3><h3>è¯­æ³•è§„åˆ™</h3><div class=\"highlight\"><pre><code class=\"language-text\">localstat ::= &#39;local&#39; namelist [&#39;=&#39; explist]</code></pre></div><h3>å®ç°ä»£ç </h3><div class=\"highlight\"><pre><code class=\"language-text\">static void localstat(LexState *ls) {\n    // LOCAL namelist [&#39;=&#39; explist]\n    \n    int nvars = 0;\n    int nexps;\n    expdesc e;\n    \n    // ========== ç¬¬ä¸€æ­¥ï¼šè§£æå˜é‡ååˆ—è¡¨ ==========\n    do {\n        new_localvar(ls, str_checkname(ls), nvars++);\n    } while (testnext(ls, &#39;,&#39;));\n    \n    // ========== ç¬¬äºŒæ­¥ï¼šè§£æåˆå§‹åŒ–è¡¨è¾¾å¼ ==========\n    if (testnext(ls, &#39;=&#39;))\n        nexps = explist1(ls, &amp;e);\n    else {\n        e.k = VVOID;\n        nexps = 0;\n    }\n    \n    // ========== ç¬¬ä¸‰æ­¥ï¼šè°ƒæ•´æ•°é‡å¹¶èµ‹å€¼ ==========\n    adjust_assign(ls, nvars, nexps, &amp;e);\n    \n    // ========== ç¬¬å››æ­¥ï¼šæ¿€æ´»å˜é‡ ==========\n    adjustlocalvars(ls, nvars);\n}</code></pre></div><h3>ç¤ºä¾‹</h3><div class=\"highlight\"><pre><code class=\"language-text\">local a, b, c = 1, 2</code></pre></div><p data-pid=\"yT1b0xYl\"><b>è¿‡ç¨‹</b>ï¼š</p><ol><li data-pid=\"ugNUI-Y1\">æ³¨å†Œ a, b, cï¼ˆæœªæ¿€æ´»ï¼‰</li><li data-pid=\"tM7Fn1B5\">è§£æå³å€¼ <code>1, 2</code></li><li data-pid=\"lmuBTW6k\">è°ƒæ•´ï¼šc èµ‹å€¼ä¸º nil</li><li data-pid=\"Pr-3NsZy\">æ¿€æ´»æ‰€æœ‰å˜é‡</li></ol><h3>5.3 upvalue æœºåˆ¶</h3><h3>ä»€ä¹ˆæ˜¯ upvalueï¼Ÿ</h3><p data-pid=\"zq6fPVhu\">upvalue æ˜¯<b>è¢«å†…å±‚å‡½æ•°æ•è·çš„å¤–å±‚å±€éƒ¨å˜é‡</b>ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">function outer()\n    local x = 1\n    \n    local function inner()\n        print(x)  -- x æ˜¯ inner çš„ upvalue\n    end\n    \n    return inner\nend</code></pre></div><h3>upvalue çš„çŠ¶æ€</h3><ol><li data-pid=\"9LMTw0pQ\"><b>Open upvalue</b>ï¼šå¤–å±‚å˜é‡ä»åœ¨æ ˆä¸Š</li><li data-pid=\"hYDTs17W\"><b>Closed upvalue</b>ï¼šå¤–å±‚å˜é‡å·²ç§»åˆ°å †ä¸Š</li></ol><h3>æŸ¥æ‰¾ upvalue</h3><div class=\"highlight\"><pre><code class=\"language-text\">static int searchupvalue(FuncState *fs, TString *name) {\n    int i;\n    upvaldesc *up = fs-&gt;f-&gt;upvalues;\n    \n    // åœ¨å½“å‰å‡½æ•°çš„ upvalue åˆ—è¡¨ä¸­æŸ¥æ‰¾\n    for (i = 0; i &lt; fs-&gt;nups; i++) {\n        if (up[i].name == name)\n            return i;\n    }\n    \n    return -1;  // æœªæ‰¾åˆ°\n}</code></pre></div><h3>åˆ›å»º upvalue</h3><div class=\"highlight\"><pre><code class=\"language-text\">static int newupvalue(FuncState *fs, TString *name, expdesc *v) {\n    Proto *f = fs-&gt;f;\n    int oldsize = f-&gt;sizeupvalues;\n    \n    luaY_checklimit(fs, fs-&gt;nups + 1, LUAI_MAXUPVALUES, &#34;upvalues&#34;);\n    \n    // æ‰©å±• upvalue æ•°ç»„\n    luaM_growvector(fs-&gt;L, f-&gt;upvalues, fs-&gt;nups, f-&gt;sizeupvalues,\n                    upvaldesc, LUAI_MAXUPVALUES, &#34;&#34;);\n    \n    while (oldsize &lt; f-&gt;sizeupvalues)\n        f-&gt;upvalues[oldsize++].name = NULL;\n    \n    // è®¾ç½® upvalue ä¿¡æ¯\n    f-&gt;upvalues[fs-&gt;nups].instack = (v-&gt;k == VLOCAL);\n    f-&gt;upvalues[fs-&gt;nups].idx = cast_byte(v-&gt;u.s.info);\n    f-&gt;upvalues[fs-&gt;nups].name = name;\n    \n    luaC_objbarrier(fs-&gt;L, f, name);\n    \n    return fs-&gt;nups++;\n}</code></pre></div><h3>5.4 ä½œç”¨åŸŸåµŒå¥—</h3><h3>å—ä½œç”¨åŸŸ</h3><div class=\"highlight\"><pre><code class=\"language-text\">do\n    local x = 1\n    do\n        local x = 2  -- é®è”½å¤–å±‚çš„ x\n        print(x)     -- è¾“å‡º 2\n    end\n    print(x)         -- è¾“å‡º 1\nend</code></pre></div><h3>å˜é‡æŸ¥æ‰¾é¡ºåº</h3><ol><li data-pid=\"7_qxjpsb\">å½“å‰å—çš„å±€éƒ¨å˜é‡</li><li data-pid=\"uqlZEIi2\">å¤–å±‚å—çš„å±€éƒ¨å˜é‡ï¼ˆæˆä¸º upvalueï¼‰</li><li data-pid=\"2qVNlq6o\">å…¨å±€å˜é‡</li></ol><div class=\"highlight\"><pre><code class=\"language-text\">static void singlevar(LexState *ls, expdesc *var) {\n    TString *varname = str_checkname(ls);\n    FuncState *fs = ls-&gt;fs;\n    \n    if (singlevaraux(fs, varname, var, 1) == VGLOBAL)\n        var-&gt;u.s.info = luaK_stringK(fs, varname);\n}\n\nstatic int singlevaraux(FuncState *fs, TString *n, expdesc *var, int base) {\n    if (fs == NULL) {  // åˆ°è¾¾æœ€å¤–å±‚\n        init_exp(var, VGLOBAL, 0);\n        return VGLOBAL;\n    }\n    else {\n        int v = searchvar(fs, n);  // åœ¨å½“å‰å‡½æ•°æŸ¥æ‰¾\n        if (v &gt;= 0) {\n            init_exp(var, VLOCAL, v);\n            if (!base)\n                markupval(fs, v);  // æ ‡è®°ä¸º upvalue\n            return VLOCAL;\n        }\n        else {  // åœ¨å¤–å±‚å‡½æ•°æŸ¥æ‰¾\n            if (singlevaraux(fs-&gt;prev, n, var, 0) == VGLOBAL)\n                return VGLOBAL;\n            \n            var-&gt;u.s.info = indexupvalue(fs, n, var);\n            var-&gt;k = VUPVAL;\n            return VUPVAL;\n        }\n    }\n}</code></pre></div><hr/><h3>ç¬¬å…­éƒ¨åˆ†ï¼šè·³è½¬è¯­å¥å¤„ç†</h3><h3>6.1 break è¯­å¥</h3><h3>è¯­æ³•è§„åˆ™</h3><div class=\"highlight\"><pre><code class=\"language-text\">breakstat ::= &#39;break&#39;</code></pre></div><h3>å®ç°ä»£ç </h3><div class=\"highlight\"><pre><code class=\"language-text\">static void breakstat(LexState *ls) {\n    FuncState *fs = ls-&gt;fs;\n    BlockCnt *bl = fs-&gt;bl;\n    int upval = 0;\n    \n    // ========== ç¬¬ä¸€æ­¥ï¼šæŸ¥æ‰¾å¯ break çš„å— ==========\n    while (bl &amp;&amp; !bl-&gt;isbreakable) {\n        upval |= bl-&gt;upval;  // è®°å½•æ˜¯å¦æœ‰ upvalue\n        bl = bl-&gt;previous;\n    }\n    \n    // ========== ç¬¬äºŒæ­¥ï¼šæ£€æŸ¥åˆæ³•æ€§ ==========\n    if (!bl)\n        luaX_syntaxerror(ls, &#34;no loop to break&#34;);\n    \n    // ========== ç¬¬ä¸‰æ­¥ï¼šå…³é—­ upvalueï¼ˆå¦‚æœéœ€è¦ï¼‰==========\n    if (upval)\n        luaK_codeABC(fs, OP_CLOSE, bl-&gt;nactvar, 0, 0);\n    \n    // ========== ç¬¬å››æ­¥ï¼šç”Ÿæˆè·³è½¬å¹¶åŠ å…¥é“¾è¡¨ ==========\n    luaK_concat(fs, &amp;bl-&gt;breaklist, luaK_jump(fs));\n}</code></pre></div><h3>å…³é”®ç‚¹</h3><p data-pid=\"Lz0ibND2\"><b>1. æŸ¥æ‰¾ç›®æ ‡å—</b></p><p data-pid=\"MJpXdbzQ\">break å¿…é¡»åœ¨å¾ªç¯å†…ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">if x then\n    break  -- é”™è¯¯ï¼šä¸åœ¨å¾ªç¯å†…\nend\n\nwhile true do\n    if x then\n        break  -- æ­£ç¡®\n    end\nend</code></pre></div><p data-pid=\"wenYywZm\"><b>2. upvalue å¤„ç†</b></p><p data-pid=\"tL2SNJQI\">å¦‚æœ break è·¨è¶Šäº†æœ‰ upvalue çš„å—ï¼Œéœ€è¦å…³é—­ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">while true do\n    local x = 1\n    local function f()\n        return x  -- x æ˜¯ upvalue\n    end\n    if condition then\n        break  -- éœ€è¦å…³é—­ x\n    end\nend</code></pre></div><h3>6.2 return è¯­å¥</h3><h3>è¯­æ³•è§„åˆ™</h3><div class=\"highlight\"><pre><code class=\"language-text\">retstat ::= &#39;return&#39; [explist] [&#39;;&#39;]</code></pre></div><h3>å®ç°ä»£ç </h3><div class=\"highlight\"><pre><code class=\"language-text\">static void retstat(LexState *ls) {\n    FuncState *fs = ls-&gt;fs;\n    expdesc e;\n    int first, nret;  // ç¬¬ä¸€ä¸ªè¿”å›å€¼çš„å¯„å­˜å™¨ï¼Œè¿”å›å€¼æ•°é‡\n    \n    luaX_next(ls);  // è·³è¿‡ &#39;return&#39;\n    \n    // ========== ç¬¬ä¸€æ­¥ï¼šè§£æè¿”å›å€¼è¡¨è¾¾å¼ ==========\n    if (block_follow(ls-&gt;t.token) || ls-&gt;t.token == &#39;;&#39;)\n        first = nret = 0;  // æ— è¿”å›å€¼\n    else {\n        nret = explist1(ls, &amp;e);  // è§£æè¡¨è¾¾å¼åˆ—è¡¨\n        \n        if (hasmultret(e.k)) {\n            // æœ€åä¸€ä¸ªè¡¨è¾¾å¼è¿”å›å¤šå€¼\n            luaK_setmultret(fs, &amp;e);\n            \n            if (e.k == VCALL &amp;&amp; nret == 1) {\n                // å°¾è°ƒç”¨ä¼˜åŒ–\n                SET_OPCODE(getcode(fs,&amp;e), OP_TAILCALL);\n                lua_assert(GETARG_A(getcode(fs,&amp;e)) == fs-&gt;nactvar);\n            }\n            \n            first = fs-&gt;nactvar;\n            nret = LUA_MULTRET;\n        }\n        else {\n            if (nret == 1)\n                first = luaK_exp2anyreg(fs, &amp;e);\n            else {\n                luaK_exp2nextreg(fs, &amp;e);\n                first = fs-&gt;nactvar;\n                lua_assert(nret == fs-&gt;freereg - first);\n            }\n        }\n    }\n    \n    // ========== ç¬¬äºŒæ­¥ï¼šç”Ÿæˆ RETURN æŒ‡ä»¤ ==========\n    luaK_ret(fs, first, nret);\n}</code></pre></div><h3>å°¾è°ƒç”¨ä¼˜åŒ–</h3><p data-pid=\"sdTcrhMP\"><b>æ¡ä»¶</b>ï¼š</p><ul><li data-pid=\"C5o7TKIp\">return è¯­å¥çš„æœ€åä¸€ä¸ªè¡¨è¾¾å¼æ˜¯å‡½æ•°è°ƒç”¨</li><li data-pid=\"vzVxKRB2\">æ²¡æœ‰å…¶ä»–è¿”å›å€¼</li><li data-pid=\"tz4HchUA\">å‡½æ•°è°ƒç”¨çš„ç»“æœç›´æ¥è¿”å›</li></ul><p data-pid=\"LAP3HGwm\"><b>ç¤ºä¾‹</b>ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">function f(n)\n    if n == 0 then\n        return 1\n    else\n        return f(n-1)  -- å°¾è°ƒç”¨\n    end\nend</code></pre></div><p data-pid=\"YYcfIWo3\"><b>å­—èŠ‚ç </b>ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">; return f(n-1)\nTAILCALL R(0) 2 0   ; è€Œä¸æ˜¯ CALL + RETURN</code></pre></div><hr/><h3>ç¬¬ä¸ƒéƒ¨åˆ†ï¼šé”™è¯¯æ¢å¤æœºåˆ¶</h3><h3>7.1 é”™è¯¯æ£€æµ‹</h3><p data-pid=\"Y7nXCaZm\">Lua è§£æå™¨é‡‡ç”¨<b>å¿«é€Ÿå¤±è´¥</b>ç­–ç•¥ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">static void check(LexState *ls, int c) {\n    if (ls-&gt;t.token != c)\n        error_expected(ls, c);\n    luaX_next(ls);\n}\n\nstatic void check_match(LexState *ls, int what, int who, int where) {\n    if (!testnext(ls, what)) {\n        if (where == ls-&gt;linenumber)\n            error_expected(ls, what);\n        else {\n            luaX_syntaxerror(ls, luaO_pushfstring(ls-&gt;L,\n                &#34;%s expected (to close %s at line %d)&#34;,\n                luaX_token2str(ls, what),\n                luaX_token2str(ls, who),\n                where));\n        }\n    }\n}</code></pre></div><h3>7.2 é”™è¯¯ä¿¡æ¯</h3><h3>ç±»å‹</h3><ol><li data-pid=\"jJcqZhKM\"><b>æœŸæœ› token é”™è¯¯</b></li><li data-pid=\"71kp3_6x\"><b>é…å¯¹é”™è¯¯</b></li><li data-pid=\"qMbi5slt\"><b>è¯­ä¹‰é”™è¯¯</b></li></ol><h3>ç¤ºä¾‹</h3><div class=\"highlight\"><pre><code class=\"language-text\">if x then\n    print(&#34;hello&#34;)\nesle  -- æ‹¼å†™é”™è¯¯\n    print(&#34;world&#34;)\nend</code></pre></div><p data-pid=\"_wLRgBiA\"><b>è¾“å‡º</b>ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">lua: test.lua:3: &#39;end&#39; expected (to close &#39;if&#39; at line 1) near &#39;esle&#39;</code></pre></div><hr/><h3>ç¬¬å…«éƒ¨åˆ†ï¼šå®è·µä¸è°ƒè¯•</h3><h3>8.1 è°ƒè¯•æŠ€å·§</h3><h3>æ·»åŠ è·Ÿè¸ªæ—¥å¿—</h3><div class=\"highlight\"><pre><code class=\"language-text\">#define DEBUG_STATEMENT 1\n\n#if DEBUG_STATEMENT\n#define TRACE_STMT(msg) \\\n    fprintf(stderr, &#34;[%d] %s\\n&#34;, ls-&gt;linenumber, msg)\n#else\n#define TRACE_STMT(msg)\n#endif\n\nstatic void ifstat(LexState *ls, int line) {\n    TRACE_STMT(&#34;Enter ifstat&#34;);\n    // ...\n    TRACE_STMT(&#34;Leave ifstat&#34;);\n}</code></pre></div><h3>ä½¿ç”¨ GDB</h3><div class=\"highlight\"><pre><code class=\"language-text\"># è®¾ç½®æ–­ç‚¹\n(gdb) break ifstat\n(gdb) break whilestat\n\n# è¿è¡Œ\n(gdb) run test.lua\n\n# æŸ¥çœ‹è·³è½¬é“¾è¡¨\n(gdb) print fs-&gt;bl-&gt;breaklist\n(gdb) print escapelist\n\n# æŸ¥çœ‹å­—èŠ‚ç \n(gdb) call luaU_print(fs-&gt;f, 1)</code></pre></div><h3>8.2 å¸¸è§é—®é¢˜</h3><p data-pid=\"rcrDJsTQ\"><b>é—®é¢˜1ï¼šbreak åœ¨é”™è¯¯ä½ç½®</b></p><div class=\"highlight\"><pre><code class=\"language-text\">for i = 1, 10 do\n    if x then\n        do\n            break  -- åº”è¯¥è·³å‡º forï¼Œä¸æ˜¯ do\n        end\n    end\nend</code></pre></div><p data-pid=\"u2MgL-vB\"><b>è§£å†³</b>ï¼šç¡®ä¿ break æ‰¾åˆ°æ­£ç¡®çš„ breakable å—ã€‚</p><p data-pid=\"jvfRp0Q4\"><b>é—®é¢˜2ï¼šå˜é‡ä½œç”¨åŸŸé”™è¯¯</b></p><div class=\"highlight\"><pre><code class=\"language-text\">repeat\n    local x = 1\nuntil x &gt; 0  -- x åº”è¯¥å¯è§</code></pre></div><p data-pid=\"R10-eIFh\"><b>è§£å†³</b>ï¼šä½¿ç”¨åŒå±‚å—ç»“æ„ã€‚</p><hr/><h3>é™„å½•</h3><h3>A. è¯­å¥ç±»å‹é€ŸæŸ¥è¡¨</h3><table data-draft-node=\"block\" data-draft-type=\"table\" data-size=\"normal\" data-row-style=\"normal\"><tbody><tr><th>è¯­å¥</th><th>å…³é”®å­—</th><th>å—ç±»å‹</th><th>Breakable</th><th>ç‰¹æ®Šæ€§</th></tr><tr><td>if</td><td>if/elseif/else</td><td>æ™®é€š</td><td>âœ—</td><td>å¤šåˆ†æ”¯</td></tr><tr><td>while</td><td>while/do</td><td>å¾ªç¯</td><td>âœ“</td><td>å‰æµ‹è¯•</td></tr><tr><td>repeat</td><td>repeat/until</td><td>å¾ªç¯</td><td>âœ“</td><td>åæµ‹è¯•ï¼ŒåŒå±‚å—</td></tr><tr><td>for(æ•°å€¼)</td><td>for/do</td><td>å¾ªç¯</td><td>âœ“</td><td>å†…éƒ¨å˜é‡</td></tr><tr><td>for(é€šç”¨)</td><td>for/in/do</td><td>å¾ªç¯</td><td>âœ“</td><td>è¿­ä»£å™¨</td></tr><tr><td>do</td><td>do/end</td><td>æ™®é€š</td><td>âœ—</td><td>æ˜¾å¼ä½œç”¨åŸŸ</td></tr></tbody></table><h3>B. å­—èŠ‚ç æŒ‡ä»¤å‚è€ƒ</h3><table data-draft-node=\"block\" data-draft-type=\"table\" data-size=\"normal\" data-row-style=\"normal\"><tbody><tr><th>æŒ‡ä»¤</th><th>å‚æ•°</th><th>è¯´æ˜</th></tr><tr><td>JMP</td><td>sBx</td><td>æ— æ¡ä»¶è·³è½¬</td></tr><tr><td>TEST</td><td>A, C</td><td>æµ‹è¯• R(A)ï¼ŒC=1 ä¸ºçœŸè·³è½¬</td></tr><tr><td>FORPREP</td><td>A, sBx</td><td>æ•°å€¼ for åˆå§‹åŒ–</td></tr><tr><td>FORLOOP</td><td>A, sBx</td><td>æ•°å€¼ for å¾ªç¯</td></tr><tr><td>TFORLOOP</td><td>A, C</td><td>é€šç”¨ for å¾ªç¯</td></tr><tr><td>CALL</td><td>A, B, C</td><td>å‡½æ•°è°ƒç”¨</td></tr><tr><td>TAILCALL</td><td>A, B, C</td><td>å°¾è°ƒç”¨</td></tr><tr><td>RETURN</td><td>A, B</td><td>è¿”å›</td></tr><tr><td>CLOSE</td><td>A</td><td>å…³é—­ upvalue</td></tr></tbody></table><h3>C. å‚è€ƒèµ„æº</h3><ul><li data-pid=\"MPBDJc5T\"><a href=\"https://link.zhihu.com/?target=https%3A//www.lua.org/manual/5.1/\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">Lua 5.1 å‚è€ƒæ‰‹å†Œ</a></li><li data-pid=\"WbzTcZYk\"><a href=\"https://link.zhihu.com/?target=https%3A//www.lua.org/source/5.1/\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">Lua æºç </a></li><li data-pid=\"OKdlMZJ1\"><a href=\"https://link.zhihu.com/?target=https%3A//www.lua.org/doc/jucs05.pdf\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\">The Implementation of Lua 5.0</a></li></ul><h3>D. æœ¯è¯­è¡¨</h3><table data-draft-node=\"block\" data-draft-type=\"table\" data-size=\"normal\" data-row-style=\"normal\"><tbody><tr><th>æœ¯è¯­</th><th>è‹±æ–‡</th><th>è¯´æ˜</th></tr><tr><td>å—</td><td>Block</td><td>ä½œç”¨åŸŸå•ä½</td></tr><tr><td>è·³è½¬é“¾è¡¨</td><td>Jump List</td><td>å¾…å›å¡«çš„è·³è½¬</td></tr><tr><td>å›å¡«</td><td>Backpatching</td><td>ä¿®æ­£è·³è½¬ç›®æ ‡</td></tr><tr><td>upvalue</td><td>-</td><td>è¢«æ•è·çš„å¤–å±‚å˜é‡</td></tr><tr><td>å°¾è°ƒç”¨</td><td>Tail Call</td><td>ä¼˜åŒ–çš„é€’å½’è°ƒç”¨</td></tr></tbody></table><hr/><h3>æ€»ç»“</h3><p data-pid=\"95SznMB_\">æœ¬æ–‡æ¡£æ·±å…¥å‰–æäº† Lua 5.1.5 çš„è¯­å¥è§£æç³»ç»Ÿï¼Œæ¶µç›–äº†ï¼š</p><p data-pid=\"VjkXmkep\">âœ… <b>æ¶æ„è®¾è®¡</b>ï¼šè¯­å¥åˆ†å‘ã€å—ç®¡ç†ã€è·³è½¬é“¾è¡¨<br/>âœ… <b>æ§åˆ¶æµ</b>ï¼šifã€whileã€repeatã€for çš„å®Œæ•´å®ç°<br/>âœ… <b>èµ‹å€¼ç³»ç»Ÿ</b>ï¼šå¤šé‡èµ‹å€¼ã€å·¦å€¼è¯†åˆ«ã€æ•°é‡è°ƒæ•´<br/>âœ… <b>ä½œç”¨åŸŸ</b>ï¼šå±€éƒ¨å˜é‡ã€upvalueã€åµŒå¥—ä½œç”¨åŸŸ<br/>âœ… <b>è·³è½¬è¯­å¥</b>ï¼šbreakã€returnã€å°¾è°ƒç”¨ä¼˜åŒ–<br/>âœ… <b>å®è·µæŠ€å·§</b>ï¼šè°ƒè¯•æ–¹æ³•ã€å¸¸è§é—®é¢˜</p><p data-pid=\"OT72jfko\">é€šè¿‡æœ¬æ–‡æ¡£ï¼Œæ‚¨åº”è¯¥èƒ½å¤Ÿï¼š</p><ol><li data-pid=\"4u66oDdy\">ç†è§£ Lua è¯­å¥è§£æçš„æ•´ä½“æ¶æ„</li><li data-pid=\"eN7l_fRB\">æŒæ¡å„ç±»è¯­å¥çš„è§£ææµç¨‹å’Œä»£ç ç”Ÿæˆ</li><li data-pid=\"eZQCSTNy\">ç†è§£è·³è½¬é“¾è¡¨å’Œå›å¡«æœºåˆ¶</li><li data-pid=\"367dLmJK\">è°ƒè¯•å’Œæ‰©å±• Lua è§£æå™¨</li></ol><p data-pid=\"1ocxVjez\"><b>ä¸‹ä¸€æ­¥å­¦ä¹ </b>ï¼š</p><ul><li data-pid=\"X3r_xZnt\">æ·±å…¥ç ”ç©¶ä»£ç ç”Ÿæˆå™¨ï¼ˆlcode.cï¼‰</li><li data-pid=\"VmwtNy2w\">å­¦ä¹ è™šæ‹ŸæœºæŒ‡ä»¤æ‰§è¡Œï¼ˆlvm.cï¼‰</li><li data-pid=\"dSTyUoVn\">ç ”ç©¶ä¼˜åŒ–æŠ€æœ¯å’Œæ€§èƒ½è°ƒä¼˜</li></ul><p data-pid=\"NPyoRZ5M\">æ„Ÿè°¢é˜…è¯»ï¼</p>",
        "allow_segment_interaction": true
      },
      "brief": "{\"source\": \"TS\", \"type\": \"article\", \"id\": 1995226469203452091}",
      "attached_info": "CsYFCNX3q7PPnMfysAEQBxoJMjY5MDc2MzM5IMW5o8sGKAAwAEAwSiMKGFRTX1NPVVJDRV9XQVJNX1VQX0JPT1NUMhIBMBgAIAA6AGIgZmI3NDRlMjkxODEwYzczYzgzNjIwNGRhOTJkNDAwZDJyEzE5OTUyMjY0NjkyMDM0NTIwOTGqAQlyZWNvbW1lbmTCASA5ZDUwODY0NThiODcxOWU4ZjVlMGQ3MDBjYjYzZjg2MvIBCggMEgZOb3JtYWzyASgIChIkZDgyMDI2ZjctNGZjMC00NzYzLTk1ODItMzc3YmU2NzAzNjNl8gEFCAsSATmCAgCIAqnimca8M5ICIDlkNTA4NjQ1OGI4NzE5ZThmNWUwZDcwMGNiNjNmODYymgIAygIWU2hvckludGVyZXN0V2VpZ2h0UnVsZcoCFkFjdGlvblNob3JJbnRlcmVzdFJ1bGXKAhtJbnRlcmFjdGlvblNob3JJbnRlcmVzdFJ1bGXKAhhQZXJpb2RJbnRlcmVzdFdlaWdodFJ1bGXaAhhUU19TT1VSQ0VfV0FSTV9VUF9CT09TVDLoAgP6AgtOT1JNQUxfRkxPV4oDIDgwNWY4ODBkMDUyOTQ4YzFhNzUzMThhOTczODFhYzllmgMNCgJ2MhAAGgVvdGhlcqgDQtgDAOoDH3dhcm11cFR3b1Rvd2VyVGV4dEJvb3N0UmVjYWxsZXL6Ax8SDFVOS05PV05fTU9ERSAAKg1OT19JTUFHRV9NT0RFgAQAiAQAkgQGTm9ybWFsmgQBM6AEAKgEALAEALoEAmFpwgQDNDAwyAQA0gQP5o6o6I2Q5bey5pu05paw2AQA8AQA+QQAAADgeCV9P4EFAAAAAAAAAACJBWJtLDlG07M/kgUAmgUDZGZ0ogUDZGZ0sgUBMbkFAAAAAAAAAADQBQDgBQDoBQDwBQmQBgCgBjKoBgGSAi4KCTI2OTA3NjMzORITMTk5NTIyNjQ2OTIwMzQ1MjA5MRgHIgpJTUFHRV9URVhU",
      "action_card": false
    },
    {
      "id": "49_1768600007.199",
      "type": "feed",
      "offset": 49,
      "verb": "TOPIC_ACKNOWLEDGED_ANSWER",
      "created_time": 1768600007,
      "updated_time": 1768600007,
      "target": {
        "id": "1994484696491524382",
        "preview_type": "default",
        "reshipment_settings": "allowed",
        "answer_type": "normal",
        "navigator_vote": false,
        "type": "answer",
        "url": "https://api.zhihu.com/answers/1994484696491524382",
        "thanks_count": 156,
        "comment_count": 543,
        "question": {
          "created": 1768037575,
          "answer_count": 0,
          "type": "question",
          "title": "ä¸ºä»€ä¹ˆä¼Šæœ—ä¸èƒ½å®è¡Œæœé²œä¸€æ ·çš„é“è¡€ç»Ÿå†¶ï¼Ÿ",
          "excerpt": "",
          "detail": "",
          "question_type": "normal",
          "comment_count": 16,
          "bound_topic_ids": [
            5560,
            96657,
            103812
          ],
          "id": "1993374751473832430",
          "follower_count": 0,
          "is_following": false,
          "relationship": {
            "is_author": false
          },
          "url": "https://api.zhihu.com/questions/1993374751473832430",
          "author": {
            "url": "https://api.zhihu.com/people/df15e205107398f9915edea6ae474184",
            "user_type": "people",
            "url_token": "80-12-79-20-71",
            "name": "ç‰¹é‡Œç‰¹çš„çªçª",
            "headline": "",
            "avatar_url": "https://picx.zhimg.com/50/v2-bf2ee2f98feebc6ba040f1ed4e5ca3cc_l.jpg?source=b6762063",
            "followers_count": 751,
            "id": "df15e205107398f9915edea6ae474184",
            "is_org": false,
            "gender": 1,
            "is_following": false,
            "is_followed": false
          }
        },
        "relationship": {
          "voting": 0,
          "is_thanked": false,
          "is_nothelp": false
        },
        "allow_segment_interaction": true,
        "segment_infos": [
          {
            "pid": "s5T54QL2",
            "text": "å†·çŸ¥è¯†ï¼Œæœé²œäººè¶Šå¢ƒæ¥ä¸­å›½æ˜¯ä¼šè¢«é£è¿”çš„ï¼Œä½†æ˜¯å¹¿å¤§çš„äººæ°‘ç¾¤ä¼—çœ‹ä¸å¾—è¿™ç‚¹ï¼Œç°åœ¨çš„æ–¹æ³•æ˜¯ï¼Œå¦‚æœä½ é‡è§äº†è¯­è¨€ä¸é€šçš„æœé²œäººæ°‘ï¼Œæœ€å¥½çš„åŠæ³•ä¸æ˜¯æ‰¾è­¦å¯Ÿï¼Œæ˜¯æ‰¾æ•™ä¼šï¼ŒéŸ©å›½äººåœ¨é è¿‘æœé²œçš„å„å¤©ä¸»æ•™ä¼šéƒ½æœ‰ç‚¹å­ï¼Œä½ ç›´æ¥é¢†ç€äººè·Ÿäººå®¶è¯´ï¼Œä»–ä»¬è‡ªæœ‰åŠæ³•ï¼Œæœ€åæ˜¯è½¬è’™å¤æˆ–è€…é¦™æ¸¯å›éŸ©å›½ï¼Œæ˜ç™½äº†å§ï¼Œæœé²œäººç°åœ¨çš„åœ°ä½ç±»ä¼¼äºç¾å›½å—åŒ—æˆ˜äº‰å‰çš„é»‘å¥´ï¼Œæ»¡åœ°éƒ½æ˜¯ç™½äººå¥´éš¶ä¸»ï¼Œå¾—é åŒæƒ…è€…ç»„å»ºçš„â€œåœ°ä¸‹é“è·¯â€ç»„ç»‡æ­æ•‘",
            "marks": [
              {
                "start_index": 129,
                "end_index": 179,
                "seg_info": {
                  "seg_ids": [
                    "1995587677882451247"
                  ],
                  "is_like": false,
                  "like_count": 23,
                  "comment_count": 0,
                  "my_comment_count": 0,
                  "is_span": false
                }
              }
            ]
          },
          {
            "pid": "3-VhX7dF",
            "text": "æˆ‘è®°å¾—çŸ¥ä¹ä¸Šè¿˜æœ‰äº²å†è€…ï¼Œé‚£çœ‹æ¥ä¸æ˜¯å†·çŸ¥è¯†ï¼Œåªæ˜¯å¤§ä¼—å¹³æ—¶ä¸æ€ä¹ˆå…³æ³¨è€Œå·²",
            "marks": [
              {
                "start_index": 0,
                "end_index": 34,
                "seg_info": {
                  "seg_ids": [
                    "1995364381622554978"
                  ],
                  "is_like": false,
                  "like_count": 34,
                  "comment_count": 0,
                  "my_comment_count": 0,
                  "is_span": false
                }
              }
            ]
          }
        ],
        "is_labeled": false,
        "preview_text": "",
        "visited_count": 273342,
        "is_copyable": true,
        "content": "<p data-pid=\"s5T54QL2\">å†·çŸ¥è¯†ï¼Œæœé²œäººè¶Šå¢ƒæ¥ä¸­å›½æ˜¯ä¼šè¢«é£è¿”çš„ï¼Œä½†æ˜¯å¹¿å¤§çš„äººæ°‘ç¾¤ä¼—çœ‹ä¸å¾—è¿™ç‚¹ï¼Œç°åœ¨çš„æ–¹æ³•æ˜¯ï¼Œå¦‚æœä½ é‡è§äº†è¯­è¨€ä¸é€šçš„æœé²œäººæ°‘ï¼Œæœ€å¥½çš„åŠæ³•ä¸æ˜¯æ‰¾è­¦å¯Ÿï¼Œæ˜¯æ‰¾æ•™ä¼šï¼ŒéŸ©å›½äººåœ¨é è¿‘æœé²œçš„å„å¤©ä¸»æ•™ä¼šéƒ½æœ‰ç‚¹å­ï¼Œä½ ç›´æ¥é¢†ç€äººè·Ÿäººå®¶è¯´ï¼Œä»–ä»¬è‡ªæœ‰åŠæ³•ï¼Œæœ€åæ˜¯è½¬è’™å¤æˆ–è€…é¦™æ¸¯å›éŸ©å›½ï¼Œæ˜ç™½äº†å§ï¼Œæœé²œäººç°åœ¨çš„åœ°ä½ç±»ä¼¼äºç¾å›½å—åŒ—æˆ˜äº‰å‰çš„é»‘å¥´ï¼Œæ»¡åœ°éƒ½æ˜¯ç™½äººå¥´éš¶ä¸»ï¼Œå¾—é åŒæƒ…è€…ç»„å»ºçš„â€œåœ°ä¸‹é“è·¯â€ç»„ç»‡æ­æ•‘</p><hr/><p data-pid=\"3-VhX7dF\">æˆ‘è®°å¾—çŸ¥ä¹ä¸Šè¿˜æœ‰äº²å†è€…ï¼Œé‚£çœ‹æ¥ä¸æ˜¯å†·çŸ¥è¯†ï¼Œåªæ˜¯å¤§ä¼—å¹³æ—¶ä¸æ€ä¹ˆå…³æ³¨è€Œå·²</p>",
        "vote_next_step": "vote",
        "voteup_count": 5007,
        "excerpt": "å†·çŸ¥è¯†ï¼Œæœé²œäººè¶Šå¢ƒæ¥ä¸­å›½æ˜¯ä¼šè¢«é£è¿”çš„ï¼Œä½†æ˜¯å¹¿å¤§çš„äººæ°‘ç¾¤ä¼—çœ‹ä¸å¾—è¿™ç‚¹ï¼Œç°åœ¨çš„æ–¹æ³•æ˜¯ï¼Œå¦‚æœä½ é‡è§äº†è¯­è¨€ä¸é€šçš„æœé²œäººæ°‘ï¼Œæœ€å¥½çš„åŠæ³•ä¸æ˜¯æ‰¾è­¦å¯Ÿï¼Œæ˜¯æ‰¾æ•™ä¼šï¼ŒéŸ©å›½äººåœ¨é è¿‘æœé²œçš„å„å¤©ä¸»æ•™ä¼šéƒ½æœ‰ç‚¹å­ï¼Œä½ ç›´æ¥é¢†ç€äººè·Ÿäººå®¶è¯´ï¼Œä»–ä»¬è‡ªæœ‰åŠæ³•ï¼Œæœ€åæ˜¯è½¬è’™å¤æˆ–è€…é¦™æ¸¯å›éŸ©å›½ï¼Œæ˜ç™½äº†å§ï¼Œæœé²œäººç°åœ¨çš„åœ°ä½ç±»ä¼¼äºç¾å›½å—åŒ—æˆ˜äº‰å‰çš„é»‘å¥´ï¼Œæ»¡åœ°éƒ½æ˜¯ç™½äººå¥´éš¶ä¸»ï¼Œå¾—é åŒæƒ…è€…ç»„å»ºçš„â€œåœ°ä¸‹é“è·¯â€ç»„ç»‡æ­æ•‘ æˆ‘è®°å¾—çŸ¥ä¹ä¸Šè¿˜æœ‰äº²å†è€…ï¼Œé‚£çœ‹æ¥ä¸æ˜¯å†·çŸ¥â€¦",
        "author": {
          "is_followed": false,
          "id": "43a7f4c31ba08af75161575328ebe52c",
          "url_token": "liang-yao-peng-20",
          "headline": "",
          "avatar_url": "https://picx.zhimg.com/50/v2-0b755b094dd99cf33c6b7fda0336ef39_l.jpg?source=b6762063",
          "is_org": false,
          "gender": 1,
          "followers_count": 445,
          "url": "https://api.zhihu.com/people/43a7f4c31ba08af75161575328ebe52c",
          "user_type": "people",
          "name": "å¸Œè…Šå¥¶",
          "is_following": false
        },
        "created_time": 1768302207,
        "updated_time": 1768302207,
        "excerpt_new": "å†·çŸ¥è¯†ï¼Œæœé²œäººè¶Šå¢ƒæ¥ä¸­å›½æ˜¯ä¼šè¢«é£è¿”çš„ï¼Œä½†æ˜¯å¹¿å¤§çš„äººæ°‘ç¾¤ä¼—çœ‹ä¸å¾—è¿™ç‚¹ï¼Œç°åœ¨çš„æ–¹æ³•æ˜¯ï¼Œå¦‚æœä½ é‡è§äº†è¯­è¨€ä¸é€šçš„æœé²œäººæ°‘ï¼Œæœ€å¥½çš„åŠæ³•ä¸æ˜¯æ‰¾è­¦å¯Ÿï¼Œæ˜¯æ‰¾æ•™ä¼šï¼ŒéŸ©å›½äººåœ¨é è¿‘æœé²œçš„å„å¤©ä¸»æ•™ä¼šéƒ½æœ‰ç‚¹å­ï¼Œä½ ç›´æ¥é¢†ç€äººè·Ÿäººå®¶è¯´ï¼Œä»–ä»¬è‡ªæœ‰åŠæ³•ï¼Œæœ€åæ˜¯è½¬è’™å¤æˆ–è€…é¦™æ¸¯å›éŸ©å›½ï¼Œæ˜ç™½äº†å§ï¼Œæœé²œäººç°åœ¨çš„åœ°ä½ç±»ä¼¼äºç¾å›½å—åŒ—æˆ˜äº‰å‰çš„é»‘å¥´ï¼Œæ»¡åœ°éƒ½æ˜¯ç™½äººå¥´éš¶ä¸»ï¼Œå¾—é åŒæƒ…è€…ç»„å»ºçš„â€œåœ°ä¸‹é“è·¯â€ç»„ç»‡æ­æ•‘ æˆ‘è®°å¾—çŸ¥ä¹ä¸Šè¿˜æœ‰äº²å†è€…ï¼Œé‚£çœ‹æ¥ä¸æ˜¯å†·çŸ¥â€¦",
        "favorite_count": 496,
        "is_navigator": false
      },
      "brief": "{\"source\": \"TS\", \"type\": \"answer\", \"id\": 1994484696491524382}",
      "attached_info": "CqcGCNX3q7PPnMfysAEQBBoJNzY1MjY3ODI3IP/MmMsGKI8nMJ8EQDFKKAoTVFNfU09VUkNFX0ZFRURSRV9WNRIBMBgAIAA6CnsicmF3IjoiIn1KMQomVFNfU09VUkNFX1RFWFRfTVVMVElWSUVXX0dDRl9VU0VSQ0ZfVjESATAYACAAOgBKKAodVFNfU09VUkNFX05FQVJMSU5FX0NPTlRFTlRfVjISATAYACAAOgBaCTExODAyMjgxNmIgZmI3NDRlMjkxODEwYzczYzgzNjIwNGRhOTJkNDAwZDJyEzE5OTQ0ODQ2OTY0OTE1MjQzODKKARMxOTkzMzc0NzUxNDczODMyNDMwqgEJcmVjb21tZW5kwgEgNDNhN2Y0YzMxYmEwOGFmNzUxNjE1NzUzMjhlYmU1MmPyAQoIDBIGTm9ybWFs8gEoCAoSJDllNWY3YTg5LWY1NGMtNGMwNS05Njk2LTEyMjdjMTZhMmVjZfIBBQgLEgE5ggIAiAKq4pnGvDOSAiA0M2E3ZjRjMzFiYTA4YWY3NTE2MTU3NTMyOGViZTUyY5oCAMoCFlNob3JJbnRlcmVzdFdlaWdodFJ1bGXKAhhQZXJpb2RJbnRlcmVzdFdlaWdodFJ1bGXKAhlVbmZyaWVuZGxpbmVzc1dlaWdodFJ1bGUx2gITVFNfU09VUkNFX0ZFRURSRV9WNegCAvoCC05PUk1BTF9GTE9XigMgODA1Zjg4MGQwNTI5NDhjMWE3NTMxOGE5NzM4MWFjOWWaAw0KAnYyEAAaBW90aGVyqAO+1xDYAwDqAxlmZWVkcmVXYXJtU3VjY2Vzc1JlY2FsbGVy+gMfEgxVTktOT1dOX01PREUgACoNTk9fSU1BR0VfTU9ERYAEAIgEAJIEBk5vcm1hbJoEATKgBACoBACwBAC6BAJhacIEAzQwMMgEANIED+aOqOiNkOW3suabtOaWsNgEAPAEAPkEAAAAgAEntT+BBQAAAAAAAAAAiQVibSw5RtOzP5IFAJoFA2RmdKIFA2RmdLIFATG5BQAAAAAAAAAA0AUA4AUA6AUA8AUJkAYAoAYzqAYDkgIuCgk3NjUyNjc4MjcSEzE5OTQ0ODQ2OTY0OTE1MjQzODIYBCIKSU1BR0VfVEVYVA==",
      "action_card": false
    },
    {
      "id": "50_1768600007.881",
      "type": "feed",
      "offset": 50,
      "verb": "TOPIC_ACKNOWLEDGED_ANSWER",
      "created_time": 1768600007,
      "updated_time": 1768600007,
      "target": {
        "relationship": {
          "is_thanked": false,
          "is_nothelp": false,
          "voting": 0
        },
        "is_labeled": false,
        "voteup_count": 945,
        "thanks_count": 68,
        "excerpt_new": "ä½ å¿ƒé‡ŒçœŸæ­£æƒ³ç­‰çš„å¹¶ä¸æ˜¯è´µäººï¼Œè€Œæ˜¯å¥´æ‰â€”â€”æ˜¯ä¸€ä¸ªèƒ½æ›¿ä½ æ‰›ä¸‹æ‰€æœ‰å› æœï¼Œè¿˜å¯¹ä½ æ„Ÿæ©æˆ´å¾·çš„å¹»æƒ³ã€‚ èƒ½æ— é™æ»¡è¶³ä½ çš„ï¼Œåªæœ‰ä½ è‡ªå·±ã€‚ä½ éœ€è¦ç›´é¢ä¸€ä¸ªæœ€åŸºæœ¬ã€ä¹Ÿæœ€æ— æ³•å›é¿çš„ç°å®ï¼šä½ çš„æ„è¯†ï¼Œä»…ä»…åªæ –æ¯åœ¨ä½ çš„èº«ä½“é‡Œã€‚è¿™æ˜¯ä¸€ä¸ªç®€å•åˆ°è¿‘ä¹æ®‹é…·çš„äº‹å®ã€‚ æ— è®ºä½ å’Œæœ‹å‹å¤šä¹ˆäº²å¯†ï¼Œå’Œçˆ±äººå¦‚ä½•æ°´ä¹³äº¤èï¼Œå½“ä½ æ„Ÿåˆ°ç–¼ç—›æ—¶ï¼Œæ˜¯ä½ åœ¨ç–¼ã€‚ å½“ä½ è¢«å·¨å¤§çš„æ‚²ä¼¤å‡»ä¸­æ—¶ï¼Œæ˜¯ä½ åœ¨æ‰¿å—é‚£ä»½å¿ƒç¢ã€‚ å½“ä½ åœ¨æ·±å¤œè¢«ç„¦è™‘å’Œææƒ§åå™¬æ—¶ï¼Œæ˜¯ä½ ä¸€ä¸ªäººåœ¨æ— è¾¹çš„é»‘æš—é‡Œå›šæ¸¡ã€‚â€¦",
        "preview_type": "default",
        "author": {
          "name": "æ‰¶ç–",
          "gender": 0,
          "id": "01bf9bcb86b1cb203a60ab47b33fc021",
          "url": "https://api.zhihu.com/people/01bf9bcb86b1cb203a60ab47b33fc021",
          "user_type": "people",
          "url_token": "38-18-91-37",
          "headline": "è®°å½•ï¼Œæ˜¯ä¸€ç§å¯¹ç—›è‹¦çš„å‰¥ç¦»ã€‚",
          "avatar_url": "https://picx.zhimg.com/50/v2-62ea69052b741f62f9936cecf2fed415_l.jpg?source=b6762063",
          "is_org": false,
          "followers_count": 7993,
          "is_following": false,
          "is_followed": false
        },
        "vote_next_step": "vote",
        "is_copyable": false,
        "question": {
          "title": "å¦‚ä½•ç†è§£â€œåªæœ‰è‡ªå·±å¯ä»¥æ•‘è‡ªå·±â€ï¼Ÿ",
          "comment_count": 6,
          "question_type": "normal",
          "id": "441909821",
          "url": "https://api.zhihu.com/questions/441909821",
          "author": {
            "is_following": false,
            "is_followed": false,
            "user_type": "people",
            "url_token": "rayshi-shi-yao",
            "name": "æ˜Ÿæ˜Ÿæœˆäº®ç¡äº†å˜›",
            "headline": "",
            "is_org": false,
            "gender": -1,
            "id": "bd9e5ffdabdf8542da754a9d2ec502df",
            "url": "https://api.zhihu.com/people/bd9e5ffdabdf8542da754a9d2ec502df",
            "avatar_url": "https://picx.zhimg.com/50/v2-abed1a8c04700ba7d72b45195223e0ff_l.jpg?source=b6762063",
            "followers_count": 1
          },
          "created": 1611930810,
          "relationship": {
            "is_author": false
          },
          "detail": "",
          "type": "question",
          "follower_count": 0,
          "is_following": false,
          "answer_count": 0,
          "bound_topic_ids": [
            404,
            478
          ],
          "excerpt": ""
        },
        "allow_segment_interaction": true,
        "id": "1974815854668555887",
        "updated_time": 1763613372,
        "excerpt": "ä½ å¿ƒé‡ŒçœŸæ­£æƒ³ç­‰çš„å¹¶ä¸æ˜¯è´µäººï¼Œè€Œæ˜¯å¥´æ‰â€”â€”æ˜¯ä¸€ä¸ªèƒ½æ›¿ä½ æ‰›ä¸‹æ‰€æœ‰å› æœï¼Œè¿˜å¯¹ä½ æ„Ÿæ©æˆ´å¾·çš„å¹»æƒ³ã€‚ èƒ½æ— é™æ»¡è¶³ä½ çš„ï¼Œåªæœ‰ä½ è‡ªå·±ã€‚ä½ éœ€è¦ç›´é¢ä¸€ä¸ªæœ€åŸºæœ¬ã€ä¹Ÿæœ€æ— æ³•å›é¿çš„ç°å®ï¼šä½ çš„æ„è¯†ï¼Œä»…ä»…åªæ –æ¯åœ¨ä½ çš„èº«ä½“é‡Œã€‚è¿™æ˜¯ä¸€ä¸ªç®€å•åˆ°è¿‘ä¹æ®‹é…·çš„äº‹å®ã€‚ æ— è®ºä½ å’Œæœ‹å‹å¤šä¹ˆäº²å¯†ï¼Œå’Œçˆ±äººå¦‚ä½•æ°´ä¹³äº¤èï¼Œå½“ä½ æ„Ÿåˆ°ç–¼ç—›æ—¶ï¼Œæ˜¯ä½ åœ¨ç–¼ã€‚ å½“ä½ è¢«å·¨å¤§çš„æ‚²ä¼¤å‡»ä¸­æ—¶ï¼Œæ˜¯ä½ åœ¨æ‰¿å—é‚£ä»½å¿ƒç¢ã€‚ å½“ä½ åœ¨æ·±å¤œè¢«ç„¦è™‘å’Œææƒ§åå™¬æ—¶ï¼Œæ˜¯ä½ ä¸€ä¸ªäººåœ¨æ— è¾¹çš„é»‘æš—é‡Œå›šæ¸¡ã€‚â€¦",
        "visited_count": 41179,
        "segment_infos": [
          {
            "pid": "aKPM-CQl",
            "text": "å½“ä½ åœæ­¢åšä¸€ä¸ªå‘½è¿çš„â€œå—å®³è€…â€ï¼Œä½ æ‰å¼€å§‹æˆä¸ºä¸€ä¸ªç”Ÿæ´»çš„â€œæ‰¿æ‹…è€…â€ã€‚",
            "marks": [
              {
                "start_index": 0,
                "end_index": 33,
                "seg_info": {
                  "seg_ids": [
                    "1975933527439729179"
                  ],
                  "is_like": false,
                  "like_count": 6,
                  "comment_count": 0,
                  "my_comment_count": 0,
                  "is_span": false
                }
              }
            ]
          },
          {
            "pid": "9jE_sQgn",
            "text": "å½“ä¸€ä»¶äº‹è®©ä½ æŒç»­ç—›è‹¦ï¼Œä½ ä¸ä¼šå†ä»…ä»…å› ä¸ºå¤–ç•Œçš„è¯„ä»·æˆ–æœŸå¾…è€Œå‹‰å¼ºå¿è€ï¼Œä½ ä¼šæ‰¿è®¤ï¼šæ˜¯çš„ï¼Œæˆ‘å¾ˆç—›è‹¦ï¼Œæˆ‘éœ€è¦æ”¹å˜ã€‚",
            "marks": [
              {
                "start_index": 0,
                "end_index": 51,
                "seg_info": {
                  "seg_ids": [
                    "1995644616507152031"
                  ],
                  "is_like": false,
                  "like_count": 3,
                  "comment_count": 0,
                  "my_comment_count": 0,
                  "is_span": false
                }
              }
            ]
          },
          {
            "pid": "U_1wtpJY",
            "text": "ä½ ä¸å†æŠŠå¤–ç•Œçš„å¸®åŠ©è§†ä¸ºç†æ‰€å½“ç„¶çš„æ‹¯æ•‘ï¼Œè€Œæ˜¯å¿ƒæ€€æ„Ÿæ¿€åœ°å°†å…¶è§†ä¸ºåŒè¡Œè·¯ä¸Šçš„æ‰¶æŒã€‚",
            "marks": [
              {
                "start_index": 0,
                "end_index": 38,
                "seg_info": {
                  "seg_ids": [
                    "1975913776705450787"
                  ],
                  "is_like": false,
                  "like_count": 3,
                  "comment_count": 0,
                  "my_comment_count": 0,
                  "is_span": false
                }
              }
            ]
          },
          {
            "pid": "wsDafUPZ",
            "text": "ä½ ä¸äººçš„å…³ç³»ï¼Œä»â€œä¾èµ–ä¸ç´¢å–â€ï¼Œå˜æˆäº†â€œç‹¬ç«‹ä¸è”ç»“â€ã€‚",
            "marks": [
              {
                "start_index": 0,
                "end_index": 27,
                "seg_info": {
                  "seg_ids": [
                    "1975913793826608365"
                  ],
                  "is_like": false,
                  "like_count": 3,
                  "comment_count": 0,
                  "my_comment_count": 0,
                  "is_span": false
                }
              }
            ]
          },
          {
            "pid": "8joLvPWd",
            "text": "è¿™ç§è‡ªç”±ï¼Œæºäºä½ æ·±çŸ¥ï¼Œæ— è®ºå¤„å¢ƒå¦‚ä½•å˜åŒ–ï¼Œä½ éƒ½æ²¡æœ‰æ”¾å¼ƒè‡ªå·±ï¼Œä½ éƒ½ä¿æœ‰ç€é€‰æ‹©å¦‚ä½•åº”å¯¹çš„æœ€ç»ˆæƒåŠ›ã€‚",
            "marks": [
              {
                "start_index": 0,
                "end_index": 46,
                "seg_info": {
                  "seg_ids": [
                    "1992218766176712298"
                  ],
                  "is_like": false,
                  "like_count": 4,
                  "comment_count": 0,
                  "my_comment_count": 0,
                  "is_span": false
                }
              }
            ]
          },
          {
            "pid": "VfSrbJHW",
            "text": "å®ƒå‘Šè¯‰ä½ ï¼Œä½ å°±æ˜¯è‡ªå·±è¿™åœºäººç”Ÿçš„åˆ›é€ è€…ã€å®ˆæŠ¤è€…ï¼Œä¹Ÿæ˜¯å®ƒæœ€ç»ˆçš„è´£ä»»äººã€‚",
            "marks": [
              {
                "start_index": 1,
                "end_index": 33,
                "seg_info": {
                  "seg_ids": [
                    "1975663636979660784"
                  ],
                  "is_like": false,
                  "like_count": 4,
                  "comment_count": 0,
                  "my_comment_count": 0,
                  "is_span": false
                }
              }
            ]
          }
        ],
        "type": "answer",
        "navigator_vote": false,
        "content": "<p data-pid=\"w6suK4xf\"><b>ä½ å¿ƒé‡ŒçœŸæ­£æƒ³ç­‰çš„å¹¶ä¸æ˜¯è´µäººï¼Œè€Œæ˜¯å¥´æ‰â€”â€”æ˜¯ä¸€ä¸ªèƒ½æ›¿ä½ æ‰›ä¸‹æ‰€æœ‰å› æœï¼Œè¿˜å¯¹ä½ æ„Ÿæ©æˆ´å¾·çš„å¹»æƒ³ã€‚</b></p><p data-pid=\"y12t23Xm\"><b>èƒ½æ— é™æ»¡è¶³ä½ çš„ï¼Œåªæœ‰ä½ è‡ªå·±ã€‚</b></p><h2>ä½ éœ€è¦ç›´é¢ä¸€ä¸ªæœ€åŸºæœ¬ã€ä¹Ÿæœ€æ— æ³•å›é¿çš„ç°å®ï¼šä½ çš„æ„è¯†ï¼Œä»…ä»…åªæ –æ¯åœ¨ä½ çš„èº«ä½“é‡Œã€‚</h2><p data-pid=\"6w0DuJUj\">è¿™æ˜¯ä¸€ä¸ªç®€å•åˆ°è¿‘ä¹æ®‹é…·çš„äº‹å®ã€‚</p><p data-pid=\"1HX_lCm3\">æ— è®ºä½ å’Œæœ‹å‹å¤šä¹ˆäº²å¯†ï¼Œå’Œçˆ±äººå¦‚ä½•æ°´ä¹³äº¤èï¼Œå½“ä½ æ„Ÿåˆ°ç–¼ç—›æ—¶ï¼Œæ˜¯ä½ åœ¨ç–¼ã€‚</p><p data-pid=\"QcmwiT5U\">å½“ä½ è¢«å·¨å¤§çš„æ‚²ä¼¤å‡»ä¸­æ—¶ï¼Œæ˜¯ä½ åœ¨æ‰¿å—é‚£ä»½å¿ƒç¢ã€‚</p><p data-pid=\"x6jY73Mq\">å½“ä½ åœ¨æ·±å¤œè¢«ç„¦è™‘å’Œææƒ§åå™¬æ—¶ï¼Œæ˜¯ä½ ä¸€ä¸ªäººåœ¨æ— è¾¹çš„é»‘æš—é‡Œå›šæ¸¡ã€‚</p><p data-pid=\"kRWOYS2G\">è¿™ä»½ç‹¬ä¸€æ— äºŒçš„ã€å±äºä½ çš„ä¸»è§‚ä½“éªŒï¼Œæ„å»ºäº†ä¸€ä¸ªä»»ä½•äººéƒ½æ— æ³•çœŸæ­£æ¶‰è¶³çš„ç§äººé¢†åŸŸã€‚</p><p data-pid=\"TGh16l2_\">åˆ«äººå¯ä»¥çŒœæµ‹ï¼Œå¯ä»¥åŒæƒ…ï¼Œå¯ä»¥å°½åŠ›å®‰æ…°ã€‚</p><p data-pid=\"hD0XBolY\">ä½†ä»–ä»¬æ°¸è¿œæ— æ³•â€œæ·±å…¥â€ä½ çš„ç—›è‹¦ï¼Œæ›¿ä½ æ‰¿å—é‚£ä»½å…·ä½“çš„é‡é‡ã€‚</p><p data-pid=\"6rOTfxMr\">æ­£æ˜¯è¿™ç§ä½“éªŒçš„ç»å¯¹ç§äººæ€§ï¼Œå†³å®šäº†æ•‘èµçš„è¿‡ç¨‹ï¼Œå¿…é¡»ç”±ä½ å»äº²è‡ªç»å†ã€‚</p><p data-pid=\"J1T29tGo\">çœŸæ­£çš„æ•‘èµå…¥å£ï¼Œå¯¹å¤–äººä»æ¥éƒ½æ˜¯å°ä½çš„ã€‚</p><p data-pid=\"DEFc5PpZ\">èƒ½å¤Ÿå°†å…¶æ‰“å¼€çš„ï¼Œä¹Ÿä»…ä½ ä¸€äººã€‚</p><h2>é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬æ€»æ˜¯ä¸‹æ„è¯†åœ°æ¸´æœ›ä¸€ä¸ªæ‹¯æ•‘è€…ï¼Ÿ</h2><p data-pid=\"1CAM78O_\">å› ä¸ºè¿™ç§æ¸´æœ›ï¼Œæ·±æ¤äºæˆ‘ä»¬çš„äººæ€§æ·±å¤„ã€‚</p><p data-pid=\"R75kd7tE\"><b>å®ƒå¦‚åŒä¸€ç§æœ¬èƒ½ï¼Œè®©æˆ‘ä»¬åœ¨è„†å¼±æ—¶ï¼ŒæœŸç›¼ä¸€ä¸ªæ›´å¼ºå¤§çš„åŠ›é‡æ¥æ¥ç®¡ä¸€åˆ‡ï¼ŒæŠŠæˆ‘ä»¬æ‹‰å‡ºæ³¥æ½­ã€‚</b></p><p data-pid=\"av-DN2UG\">æˆ‘ä»¬æ¸´æœ›ä¸€ä¸ªå®Œç¾çš„ä¼´ä¾£ï¼Œæ¥å¡«è¡¥å†…å¿ƒçš„ç©ºæ´ï¼Œæ²»æ„ˆæ‰€æœ‰çš„ä¸å®‰ã€‚</p><p data-pid=\"qbb1qPe_\">æˆ‘ä»¬æœŸç›¼ä¸€ä¸ªå…¨èƒ½çš„é¢†å¯¼è€…ï¼Œä¸ºæˆ‘ä»¬æŒ‡æ˜æ–¹å‘ï¼Œæ‰«æ¸…å‰è·¯çš„æ‰€æœ‰éšœç¢ã€‚</p><p data-pid=\"6vuA8sMq\">æˆ‘ä»¬ç”šè‡³å¹»æƒ³å‘½è¿çš„æŸç§æ©èµï¼Œèƒ½ç¬é—´æ‰­è½¬ä¸å ªçš„ç°çŠ¶ã€‚</p><p data-pid=\"Mvzv5ZTt\">è¿™ç§æ¸´æœ›æœ¬èº«å¹¶ä¸å¯è€»ï¼Œå®ƒæºäºæˆ‘ä»¬å¯¹å®‰å…¨å’Œè”ç»“çš„æ·±å±‚éœ€æ±‚ã€‚</p><p data-pid=\"TROjZX8u\"><b>ä½†é—®é¢˜åœ¨äºï¼Œå½“æˆ‘ä»¬æŠŠè¿™ç§æ¸´æœ›å½“ä½œå”¯ä¸€çš„æŒ‡æœ›æ—¶ï¼Œæˆ‘ä»¬å°±äº¤å‡ºäº†è‡ªå·±æœ€å®è´µçš„ä¸œè¥¿â€”â€”äººç”Ÿçš„ä¸»åŠ¨æƒã€‚</b></p><p data-pid=\"jodbVxSt\"><b>æˆ‘ä»¬æŠŠè‡ªå·±äººç”Ÿçš„æ–¹å‘æƒï¼Œäº¤åˆ°äº†åˆ«äººçš„æ‰‹ä¸­ï¼Œç„¶åå¼€å§‹ç¥ˆç¥·å¯¹æ–¹æ˜¯ä¸ªæŠ€æœ¯å¨´ç†Ÿã€æ°¸ä¸è¿·è·¯çš„å¸æœºã€‚</b></p><p data-pid=\"wJRgZ5XW\"><b>è¿™ç§æ‰˜ä»˜ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€åœºé‡å¤§åšå¼ˆï¼Œåšçš„æ˜¯å¯¹æ–¹çš„æ„æ„¿ã€èƒ½åŠ›å’Œæ°¸ä¸ç¼ºå¸­çš„è¿æ°”ã€‚</b></p><p data-pid=\"WB-9pbwQ\"><b>è€Œç”Ÿæ´»æ— æ•°æ¬¡åœ°å‘Šè¯‰æˆ‘ä»¬ï¼Œè¿™ç§åšå¼ˆï¼Œèƒœç®—å®åœ¨æ¸ºèŒ«ã€‚</b></p><h2>è‡³äºé‚£äº›å¤–éƒ¨çš„å¸®åŠ©ï¼Œå…¶æœ¬è´¨åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p data-pid=\"EJTa7Gj-\">äº‹å®æ˜¯ï¼šé‚£äº›æ¥è‡ªä»–äººçš„å–„æ„ã€æ”¯æŒå’Œå¸®åŠ©ï¼Œç¡®å®æå…¶å®è´µï¼Œå®ƒä»¬æ˜¯é»‘æš—ä¸­çš„ç«å…‰ï¼Œæ˜¯ä¸¥å¯’é‡Œçš„æ¸©æš–ã€‚</p><p data-pid=\"qb2taN4i\"><b>ä½†æ˜¯ï¼Œå®ƒä»¬æ— æ³•æ›¿ä»£ä½ è¡Œèµ°ã€‚</b></p><p data-pid=\"BqSoXOG6\">åˆ«äººé€’æ¥çš„é£Ÿç‰©ï¼Œéœ€è¦ä½ è‡ªå·±å’€åš¼åå’½ï¼Œæ‰èƒ½è½¬åŒ–ä¸ºèƒ½é‡ã€‚</p><p data-pid=\"wW34og65\">åˆ«äººæŒ‡å‡ºçš„é“è·¯ï¼Œéœ€è¦ä½ è‡ªå·±è¿ˆå¼€åŒè…¿ï¼Œæ‰èƒ½æŠµè¾¾ç»ˆç‚¹ã€‚</p><p data-pid=\"2XHesO3P\">åˆ«äººæä¾›çš„æ€è·¯å’Œæ–¹æ³•ï¼Œéœ€è¦ä½ ç”¨è‡ªå·±çš„å¤§è„‘å»ç†è§£ã€æ¶ˆåŒ–ï¼Œå¹¶ä»˜è¯¸å®è·µï¼Œæ‰èƒ½å†…åŒ–æˆä½ çš„èƒ½åŠ›ã€‚</p><p data-pid=\"nUeX3S-S\">è¿™æ˜¯ä¸€ä¸ªå‚¬åŒ–ååº”çš„è¿‡ç¨‹ï¼Œè€Œä¸æ˜¯è¡¨é¢ä¸Šçš„ç®€å•å åŠ ã€‚</p><p data-pid=\"9yQaKws1\"><b>å¤–éƒ¨çš„æ´åŠ©æ˜¯ååº”ç‰©ï¼Œè€Œä½ è¿™ä¸ªâ€œä¸»ä½“â€ï¼Œæ‰æ˜¯å†³å®šååº”èƒ½å¦å‘ç”Ÿã€å¦‚ä½•å‘ç”Ÿå‚¬åŒ–çš„æœ€å…³é”®æ€§å› ç´ ã€‚</b></p><p data-pid=\"6T-uebeW\"><b>æ²¡æœ‰ä½ çš„è¿™ç§è‡ªæˆ‘å‚¬åŒ–ï¼Œå†å¤šçš„ååº”ç‰©å †ç§¯åœ¨ä¸€èµ·ï¼Œä¹Ÿäº§ç”Ÿä¸äº†ç”Ÿå‘½çš„èœ•å˜ã€‚</b></p><h2>äºæ˜¯ï¼Œé—®é¢˜å°±æ¥åˆ°äº†æœ€ä¸ºæ ¸å¿ƒçš„éƒ¨åˆ†ï¼šâ€œæ•‘è‡ªå·±â€åˆ°åº•æ„å‘³ç€ä»€ä¹ˆï¼Ÿ</h2><p data-pid=\"vbXSZVeY\">å®ƒç»ä¸åªæ˜¯ä¸€å¥è½»é£˜é£˜çš„åŠ±å¿—å‹é¸¡æ±¤ã€‚</p><p data-pid=\"G0T38vM1\"><b>è€Œæ˜¯ä¸€ä¸ªæ²‰é‡ã€å…·ä½“è€ŒæŒç»­çš„è¿‡ç¨‹ã€‚</b></p><p data-pid=\"k2K6d8KH\"><b>å®ƒæ„å‘³ç€ï¼Œä½ åœæ­¢äº†å¯¹å¤–çš„ç´¢æ±‚ä¸æŠ±æ€¨ï¼Œå¼€å§‹å†·é™åœ°å›æœ›è‡ªèº«ã€‚</b></p><p data-pid=\"Hjj5Mrzd\">ä½ ä¸å†é—®ï¼šä¸ºä»€ä¹ˆä»–ä»¬ä¸èƒ½å¸®æˆ‘æ›´å¤šï¼Ÿ</p><p data-pid=\"R2LRHczF\">è€Œæ˜¯å¼€å§‹é—®ï¼šåœ¨ç°æœ‰çš„æ¡ä»¶ä¸‹ï¼Œæˆ‘èƒ½ä¸ºè‡ªå·±åšäº›ä»€ä¹ˆï¼Ÿ</p><p data-pid=\"e0t0Ujhi\">è¿™ç§æ€ç»´è§†è§’çš„è½¬æ¢ï¼Œæ‰æ˜¯åŠ›é‡æ„Ÿçš„çœŸæ­£æ¥æºã€‚</p><p data-pid=\"aKPM-CQl\"><b>å½“ä½ åœæ­¢åšä¸€ä¸ªå‘½è¿çš„â€œå—å®³è€…â€ï¼Œä½ æ‰å¼€å§‹æˆä¸ºä¸€ä¸ªç”Ÿæ´»çš„â€œæ‰¿æ‹…è€…â€ã€‚</b></p><p data-pid=\"ciYzXLvX\"><b>å®ƒæ„å‘³ç€ï¼Œä½ å¼€å§‹å°Šé‡å¹¶ä¿¡ä»»è‡ªå·±é‚£ä»½æœ€ç›´æ¥çš„æ„Ÿå—å’Œåˆ¤æ–­ã€‚</b></p><p data-pid=\"9jE_sQgn\">å½“ä¸€ä»¶äº‹è®©ä½ æŒç»­ç—›è‹¦ï¼Œä½ ä¸ä¼šå†ä»…ä»…å› ä¸ºå¤–ç•Œçš„è¯„ä»·æˆ–æœŸå¾…è€Œå‹‰å¼ºå¿è€ï¼Œä½ ä¼šæ‰¿è®¤ï¼šæ˜¯çš„ï¼Œæˆ‘å¾ˆç—›è‹¦ï¼Œæˆ‘éœ€è¦æ”¹å˜ã€‚</p><p data-pid=\"TQxSPxGg\"><b>ä½ å¼€å§‹å€¾å¬å†…å¿ƒçœŸå®çš„å£°éŸ³ï¼Œå¹¶æ•¢äºä¾æ®å®ƒæ¥åšå‡ºé€‰æ‹©ã€‚</b></p><p data-pid=\"_dATAToq\"><b>å®ƒæ›´æ„å‘³ç€ï¼Œä½ æ„¿æ„æ¥çº³â€œè¿‡ç¨‹â€çš„ç¼“æ…¢ä¸è‰°è¾›ã€‚</b></p><p data-pid=\"xJ865VkP\">ä½ ä¸å†å¥¢æœ›ä¸€è¹´è€Œå°±çš„å¥‡è¿¹ï¼Œè€Œæ˜¯æ¥å—äº†â€œç—…å»å¦‚æŠ½ä¸â€çš„å¸¸æ€ã€‚</p><p data-pid=\"y5n3_pAr\">ä½ ä¼šä¸ºæ¯ä¸€æ¬¡å¾®å°çš„è¿›æ­¥è‚¯å®šè‡ªå·±ï¼Œä¹Ÿèƒ½åœ¨æ¯ä¸€æ¬¡è·Œå€’åï¼Œä¸å…¨ç›˜å¦å®šè‡ªå·±ã€‚</p><p data-pid=\"kzN5cO6g\">åªæ˜¯çˆ¬èµ·æ¥ï¼Œæ‹æ‹åœŸï¼Œç»§ç»­å‰è¡Œã€‚</p><p data-pid=\"FgsOgqrg\">è¿™ä»½è€å¿ƒï¼Œæ˜¯å¯¹è‡ªå·±æœ€å¤§çš„æ…ˆæ‚²ã€‚</p><h2>æœ€ç»ˆï¼Œå½“ä½ çœŸæ­£èµ°åœ¨â€œè‡ªæ•‘â€çš„è·¯ä¸Šæ—¶ï¼Œä½ ä¼šå‘ç°ä¸€ç§å¥‡å¦™çš„è½¬å˜ã€‚</h2><p data-pid=\"U_1wtpJY\">ä½ ä¸å†æŠŠå¤–ç•Œçš„å¸®åŠ©è§†ä¸ºç†æ‰€å½“ç„¶çš„æ‹¯æ•‘ï¼Œè€Œæ˜¯å¿ƒæ€€æ„Ÿæ¿€åœ°å°†å…¶è§†ä¸ºåŒè¡Œè·¯ä¸Šçš„æ‰¶æŒã€‚</p><p data-pid=\"wsDafUPZ\">ä½ ä¸äººçš„å…³ç³»ï¼Œä»â€œä¾èµ–ä¸ç´¢å–â€ï¼Œå˜æˆäº†â€œç‹¬ç«‹ä¸è”ç»“â€ã€‚</p><p data-pid=\"FHQbfkrS\">ä½ ä¸å†æ˜¯ä¸€ä¸ªè„†å¼±çš„ç´¢å–è€…ï¼Œè€Œæ˜¯ä¸€ä¸ªæœ‰åŠ›é‡çš„åŒè¡Œè€…ã€‚</p><p data-pid=\"Myz87fI3\">ä½ å¼€å§‹ä½“ä¼šåˆ°ä¸€ç§æ·±åˆ»çš„è‡ªç”±ã€‚</p><p data-pid=\"8joLvPWd\"><b>è¿™ç§è‡ªç”±ï¼Œæºäºä½ æ·±çŸ¥ï¼Œæ— è®ºå¤„å¢ƒå¦‚ä½•å˜åŒ–ï¼Œä½ éƒ½æ²¡æœ‰æ”¾å¼ƒè‡ªå·±ï¼Œä½ éƒ½ä¿æœ‰ç€é€‰æ‹©å¦‚ä½•åº”å¯¹çš„æœ€ç»ˆæƒåŠ›ã€‚</b></p><p data-pid=\"3LXNlX5d\"><b>ä½ çš„å®‰å…¨æ„Ÿï¼Œä¸å†å¯„æ‰˜äºä»–äººå˜å¹»è«æµ‹çš„æ€åº¦ï¼Œå’Œå¤–å¢ƒæ— å¸¸çš„æµè½¬ä¹‹ä¸Šã€‚</b></p><p data-pid=\"HMBvpbEN\"><b>è€Œæ˜¯æ ¹æ¤äºä½ è‡ªèº«åº”å¯¹å˜åŒ–ã€ç©¿è¿‡ä½è°·çš„èƒ½åŠ›ä¸ä¿¡å¿ƒä¹‹ä¸­ã€‚</b></p><h2>â€œåªæœ‰è‡ªå·±å¯ä»¥æ•‘è‡ªå·±â€ï¼Œå®ƒå¹¶ä¸æ˜¯åœ¨å®£æ‰¬ä¸€ç§æ‚²å£®çš„å­¤ç‹¬ï¼Œè€Œæ˜¯åœ¨é™ˆè¿°ä¸€ç§å…³äºå°Šä¸¥å’ŒåŠ›é‡çš„çœŸç›¸ã€‚</h2><p data-pid=\"QcYECvaQ\">å®ƒæŠŠä½ ä»å¯¹å¤–ç•Œçš„è™šå‡æœŸå¾…ä¸­å«é†’ï¼Œå°†ä½ æ‹‰å›åˆ°è‡ªèº«â€”â€”è¿™ä¸ªå”¯ä¸€çœŸå®ã€ä¹Ÿæœ€å…·æœ‰åˆ›é€ åŠ›çš„åŸç‚¹ã€‚</p><p data-pid=\"VfSrbJHW\"><b>å®ƒå‘Šè¯‰ä½ ï¼Œä½ å°±æ˜¯è‡ªå·±è¿™åœºäººç”Ÿçš„åˆ›é€ è€…ã€å®ˆæŠ¤è€…ï¼Œä¹Ÿæ˜¯å®ƒæœ€ç»ˆçš„è´£ä»»äººã€‚</b></p><p data-pid=\"3ZMNmNst\"><b>è„šä¸‹çš„è·¯åšå®ä¸å¦ï¼Œè·¯ä¸Šçš„é£æ™¯ç¹è£ä¸å¦ï¼Œå…¶æ ¹åŸºï¼Œéƒ½æ·±åŸ‹äºä½ çš„æ¯ä¸€ä¸ªå¿µå¤´ã€æ¯ä¸€æ¬¡é€‰æ‹©ã€æ¯ä¸€åˆ†åšæŒä¹‹ä¸­ã€‚</b></p><p data-pid=\"f3l3Egs1\">è®¤è¯†åˆ°è¿™ä¸€ç‚¹ï¼Œæˆ–è®¸æ˜¯äººç”Ÿä¸­æœ€è‰°éš¾çš„ä¸€ä»¶äº‹ï¼Œä½†ä¹Ÿæ— ç–‘æ˜¯å¸¦æ¥æœ€æ·±åˆ»åŠ›é‡çš„ä¸€ä»¶äº‹ã€‚</p><p data-pid=\"iHXAtf3u\">å®ƒæ„å‘³ç€ä½ å½»åº•æ¥å—äº†ç”Ÿå‘½çš„å­¤ç‹¬ä¸å°Šä¸¥ï¼Œç„¶åï¼Œå¸¦ç€è¿™ä»½æ¸…é†’çš„è®¤çŸ¥ï¼Œè½¬èº«æ›´åŠ çœŸè¯šã€æ›´æœ‰åŠ›é‡åœ°æŠ•å…¥ç”Ÿæ´»ã€‚</p><p data-pid=\"ZJ7rlIPL\">å»çˆ±ï¼Œå»åˆ›é€ ï¼Œå»æˆä¸ºè‡ªå·±çš„å…‰ã€‚</p>",
        "created_time": 1763612790,
        "favorite_count": 1387,
        "is_navigator": false,
        "reshipment_settings": "disallowed",
        "preview_text": "",
        "comment_count": 67,
        "answer_type": "normal",
        "url": "https://api.zhihu.com/answers/1974815854668555887"
      },
      "brief": "{\"source\": \"TS\", \"type\": \"answer\", \"id\": 1974815854668555887}",
      "attached_info": "CvkFCNX3q7PPnMfysAEQBBoJNzU3MzgwNDU5IPaw+sgGKLEHMENAMkogChVUU19TT1VSQ0VfVEhFTUVfTUVSR0USATAYACAAOgBKKAodVFNfU09VUkNFX05FQVJMSU5FX0NPTlRFTlRfVjISATAYACAAOgBaCDYwNDgwMTA5YiBmYjc0NGUyOTE4MTBjNzNjODM2MjA0ZGE5MmQ0MDBkMnITMTk3NDgxNTg1NDY2ODU1NTg4N4oBCTQ0MTkwOTgyMaoBCXJlY29tbWVuZMIBIDAxYmY5YmNiODZiMWNiMjAzYTYwYWI0N2IzM2ZjMDIx8gEKCAwSBk5vcm1hbPIBKAgKEiRmOTU5NmUzNi05NDNmLTQ2MTItOGYzZC0yYzIyY2ZlMDU1NzbyAQUICxIBOYICAIgCquKZxrwzkgIgMDFiZjliY2I4NmIxY2IyMDNhNjBhYjQ3YjMzZmMwMjGaAgDKAhZTaG9ySW50ZXJlc3RXZWlnaHRSdWxlygIYUGVyaW9kSW50ZXJlc3RXZWlnaHRSdWxlygIUQ29udGVudEFnZVdlaWdodFJ1bGXKAhdUZXN0ZWRBbmRXb3JrV2VpZ2h0UnVsZdoCFVRTX1NPVVJDRV9USEVNRV9NRVJHRegCA/oCC05PUk1BTF9GTE9XigMgODA1Zjg4MGQwNTI5NDhjMWE3NTMxOGE5NzM4MWFjOWWaAw0KAnYyEAAaBW90aGVyqAPbwQLYAwDqAxtUaGVtZU1lcmdlTmV3VjFQb29sUmVjYWxsZXL6Ax8SDFVOS05PV05fTU9ERSAAKg1OT19JTUFHRV9NT0RFgAQAiAQAkgQGTm9ybWFsmgQBM6AEAKgEALAEALoEAmFpwgQDNDAwyAQA0gQP5o6o6I2Q5bey5pu05paw2AQA8AQA+QQAAADATDScP4EFAAAAAAAAAACJBWJtLDlG07M/kgUAmgUDZGZ0ogUDZGZ0sgUBMbkFAAAAAAAAAADQBQDgBQDoBQDwBQmQBgCgBjSoBgCSAi4KCTc1NzM4MDQ1ORITMTk3NDgxNTg1NDY2ODU1NTg4NxgEIgpJTUFHRV9URVhU",
      "action_card": false
    },
    {
      "id": "51_1768600007.675",
      "type": "feed",
      "offset": 51,
      "verb": "TOPIC_ACKNOWLEDGED_ANSWER",
      "created_time": 1768600007,
      "updated_time": 1768600007,
      "target": {
        "relationship": {
          "voting": 0,
          "is_thanked": false,
          "is_nothelp": false
        },
        "navigator_vote": false,
        "id": "1982850293264819322",
        "thumbnail": "https://pic1.zhimg.com/50/v2-239f3ad45a7b10fe2d248c2f86d8d0f6_720w.jpg?source=b6762063",
        "reshipment_settings": "allowed",
        "excerpt": "ï¼Ÿï¼Ÿï¼Ÿï¼Ÿè¿™ä¹ˆçœ‹ä¸èµ·Claude codeå—ï¼Ÿ å¤§å®¶å¯ä»¥å»çœ‹ä¸€ä¸‹GLMæœ€æ–°çš„å…¬ä¼—å·å°±çŸ¥é“å®ƒæœ‰å¤šå¼ºå•¦ï¼Œä¸€å¥è¯å°±å¯ä»¥ç›´æ¥ä½“éªŒåˆ°ç°åœ¨éå¸¸ç«çš„è±†åŒ…æ‰‹æœºã€‚   å¦‚æœæ²¡æœ‰Claudeè´¦å·çš„ï¼Œå¯ä»¥å»ä¸€äº›ä¸­è½¬ç«™ä½“éªŒå•Šï¼Œæ¯”å¦‚å…è´¹anyrouterï¼Œå¦‚æœè¿™ä¸ªä¸ç¨³å®šï¼Œå°±å»å¾ˆç«çš„0011.aiã€‚ 0011.aiè¿™ä¸ªæœ‰ä¸€æ—¥å¥—é¤ï¼Œå®Œå…¨å¤Ÿå°è¯•ä½¿ç”¨ã€‚0011.aiï¼šhttps://0011.ai/i/0011",
        "preview_type": "default",
        "thumbnails": [
          "https://picx.zhimg.com/50/v2-239f3ad45a7b10fe2d248c2f86d8d0f6_720w.jpg?source=b6762063"
        ],
        "vote_next_step": "vote",
        "comment_count": 0,
        "excerpt_new": "ï¼Ÿï¼Ÿï¼Ÿï¼Ÿè¿™ä¹ˆçœ‹ä¸èµ·Claude codeå—ï¼Ÿ å¤§å®¶å¯ä»¥å»çœ‹ä¸€ä¸‹GLMæœ€æ–°çš„å…¬ä¼—å·å°±çŸ¥é“å®ƒæœ‰å¤šå¼ºå•¦ï¼Œä¸€å¥è¯å°±å¯ä»¥ç›´æ¥ä½“éªŒåˆ°ç°åœ¨éå¸¸ç«çš„è±†åŒ…æ‰‹æœºã€‚   å¦‚æœæ²¡æœ‰Claudeè´¦å·çš„ï¼Œå¯ä»¥å»ä¸€äº›ä¸­è½¬ç«™ä½“éªŒå•Šï¼Œæ¯”å¦‚å…è´¹anyrouterï¼Œå¦‚æœè¿™ä¸ªä¸ç¨³å®šï¼Œå°±å»å¾ˆç«çš„0011.aiã€‚ 0011.aiè¿™ä¸ªæœ‰ä¸€æ—¥å¥—é¤ï¼Œå®Œå…¨å¤Ÿå°è¯•ä½¿ç”¨ã€‚0011.aiï¼šhttps://0011.ai/i/0011",
        "favorite_count": 46,
        "allow_segment_interaction": true,
        "author": {
          "headline": "åŒåâ€œAIå·¥å…·å¯¼èˆªç«™â€ï¼Œè·Ÿä¸Šæ—¶ä»£çš„è„šæ­¥ ",
          "is_following": false,
          "id": "a9bb5f989de6c74cbe23357e3883b33b",
          "user_type": "people",
          "name": "AIå·¥å…·å¯¼èˆªç«™",
          "avatar_url": "https://pic1.zhimg.com/50/v2-e8180ddac47e86680b6f406419b09765_l.jpg?source=b6762063",
          "is_org": false,
          "gender": 1,
          "followers_count": 96,
          "is_followed": false,
          "url": "https://api.zhihu.com/people/a9bb5f989de6c74cbe23357e3883b33b",
          "url_token": "52bdke"
        },
        "content": "<p data-pid=\"0Bhw9Vrk\">ï¼Ÿï¼Ÿï¼Ÿï¼Ÿè¿™ä¹ˆçœ‹ä¸èµ·Claude codeå—ï¼Ÿ<br/><br/>å¤§å®¶å¯ä»¥å»çœ‹ä¸€ä¸‹GLMæœ€æ–°çš„å…¬ä¼—å·å°±çŸ¥é“å®ƒæœ‰å¤šå¼ºå•¦ï¼Œä¸€å¥è¯å°±å¯ä»¥ç›´æ¥ä½“éªŒåˆ°ç°åœ¨éå¸¸ç«çš„è±†åŒ…æ‰‹æœºã€‚</p><figure data-size=\"normal\"><img src=\"https://pic4.zhimg.com/v2-de6c88772822a58041437a004f74cf65_1440w.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1330\" data-rawheight=\"806\" data-original-token=\"v2-239f3ad45a7b10fe2d248c2f86d8d0f6\" class=\"origin_image zh-lightbox-thumb\" width=\"1330\" data-original=\"https://pic4.zhimg.com/v2-de6c88772822a58041437a004f74cf65_r.jpg\"/></figure><p data-pid=\"zXnIkHNp\">å¦‚æœæ²¡æœ‰Claudeè´¦å·çš„ï¼Œå¯ä»¥å»ä¸€äº›ä¸­è½¬ç«™ä½“éªŒå•Šï¼Œæ¯”å¦‚å…è´¹anyrouterï¼Œå¦‚æœè¿™ä¸ªä¸ç¨³å®šï¼Œå°±å»å¾ˆç«çš„0011.aiã€‚<br/><br/>0011.aiè¿™ä¸ªæœ‰ä¸€æ—¥å¥—é¤ï¼Œå®Œå…¨å¤Ÿå°è¯•ä½¿ç”¨ã€‚</p><div class=\"highlight\"><pre><code class=\"language-text\">0011.aiï¼šhttps://0011.ai/i/0011</code></pre></div><p></p>",
        "thanks_count": 0,
        "preview_text": "",
        "is_labeled": false,
        "is_navigator": false,
        "url": "https://api.zhihu.com/answers/1982850293264819322",
        "updated_time": 1765528349,
        "created_time": 1765528349,
        "visited_count": 4344,
        "is_copyable": true,
        "question": {
          "question_type": "normal",
          "id": "1946791222762014096",
          "title": "Claude Codeã€Cursorã€TRAEï¼Œç©¶ç«Ÿè°æœ€å¼ºï¼Ÿ",
          "answer_count": 0,
          "detail": "",
          "created": 1756931197,
          "follower_count": 0,
          "comment_count": 1,
          "type": "question",
          "url": "https://api.zhihu.com/questions/1946791222762014096",
          "author": {
            "headline": "",
            "followers_count": 9,
            "is_following": false,
            "is_followed": false,
            "id": "52983107de9a75adaefa874c53b49fe9",
            "url": "https://api.zhihu.com/people/52983107de9a75adaefa874c53b49fe9",
            "url_token": "tang-wang-67-34",
            "is_org": false,
            "gender": 1,
            "user_type": "people",
            "name": "Swift Tang",
            "avatar_url": "https://picx.zhimg.com/50/v2-cfe1eaba18be4eccb01a9316a4e40f8d_l.jpg?source=b6762063"
          },
          "is_following": false,
          "excerpt": "",
          "relationship": {
            "is_author": false
          }
        },
        "answer_type": "normal",
        "type": "answer",
        "voteup_count": 8
      },
      "brief": "{\"source\": \"TS\", \"type\": \"answer\", \"id\": 1982850293264819322}",
      "attached_info": "CoAGCNX3q7PPnMfysAEQBBoJNzYwNzQxNDI1IJ2m78kGKAgwAEAzSigKHVRTX1NPVVJDRV9ORUFSTElORV9DT05URU5UX1YyEgEwGAAgADoAWgkxMTY0NjIxNDliIGZiNzQ0ZTI5MTgxMGM3M2M4MzYyMDRkYTkyZDQwMGQychMxOTgyODUwMjkzMjY0ODE5MzIyigETMTk0Njc5MTIyMjc2MjAxNDA5NqoBCXJlY29tbWVuZMIBIGE5YmI1Zjk4OWRlNmM3NGNiZTIzMzU3ZTM4ODNiMzNi8gEKCAwSBk5vcm1hbPIBKAgKEiQ0ODE1MjMzNC1mZjA5LTRiZmYtOWJlMy05YTdlMmM0YzIxY2PyAQUICxIBOYICAIgCquKZxrwzkgIgYTliYjVmOTg5ZGU2Yzc0Y2JlMjMzNTdlMzg4M2IzM2KaAgDKAhZTaG9ySW50ZXJlc3RXZWlnaHRSdWxlygIbSW50ZXJhY3Rpb25TaG9ySW50ZXJlc3RSdWxlygIYUGVyaW9kSW50ZXJlc3RXZWlnaHRSdWxlygIXVGVzdGVkQW5kV29ya1dlaWdodFJ1bGXaAh1UU19TT1VSQ0VfTkVBUkxJTkVfQ09OVEVOVF9WMugCAvoCC05PUk1BTF9GTE9XigMgODA1Zjg4MGQwNTI5NDhjMWE3NTMxOGE5NzM4MWFjOWWaAw0KAnYyEAAaBW90aGVyqAP4IdgDAPoDThIMVU5LTk9XTl9NT0RFIAAqDU5PX0lNQUdFX01PREU6LQgCELIKGKYGIiN2Mi0yMzlmM2FkNDVhN2IxMGZlMmQyNDhjMmY4NmQ4ZDBmNoAEAIgEAJIEBk5vcm1hbJoEATKgBACoBACwBAC6BAJhacIEAzQwMMgEANIED+aOqOiNkOW3suabtOaWsNgEAPAEAPkEAAAAINdHpz+BBQAAAAAAAAAAiQVibSw5RtOzP5IFAJoFA2RmdKIFA2RmdLIFATG5BQAAAAAAAAAA0AUA4AUA6AUA8AUJkAYAoAY1qAYAkgIuCgk3NjA3NDE0MjUSEzE5ODI4NTAyOTMyNjQ4MTkzMjIYBCIKSU1BR0VfVEVYVA==",
      "action_card": false
    },
    {
      "id": "52_1768600007.215",
      "type": "feed",
      "offset": 52,
      "verb": "TOPIC_ACKNOWLEDGED_ANSWER",
      "created_time": 1768600007,
      "updated_time": 1768600007,
      "target": {
        "vote_next_step": "vote",
        "created_time": 1768541782,
        "excerpt": "é¦–è¦çš„åŸºçŸ³æ˜¯æ¸…æ™°çš„è‡ªæˆ‘è®¤çŸ¥ä¸åšå®šçš„ä»·å€¼å†…æ ¸ã€‚ ä¸å†…è€—çš„äººå¯¹è‡ªå·±æœ‰è¿‘ä¹â€œå®¢è§‚â€çš„å®¡è§†ï¼Œä»–ä»¬äº†è§£è‡ªå·±çš„ä¼˜åŠ¿ä¸å±€é™ï¼Œå¦‚åŒç†Ÿæ‚‰å·¥å…·çš„æ€§èƒ½ä¸è¾¹ç•Œã€‚ è¿™ç§äº†è§£ä¸æ˜¯é€šè¿‡åå¤çš„è‡ªæˆ‘æ€€ç–‘ä¸æ‰¹åˆ¤è·å¾—ï¼Œè€Œæ˜¯åœ¨è¡ŒåŠ¨ä¸åé¦ˆä¸­ä¸æ–­æ ¡å‡†çš„ç¨³å®šåœ°å›¾ã€‚       ä»–ä»¬å†…å¿ƒæœ‰ä¸€åº§ä¸æ˜“åŠ¨æ‘‡çš„ç¯å¡”ï¼Œå³è‡ªå·±çš„æ ¸å¿ƒä»·å€¼è§‚ä¸ç›®æ ‡ã€‚ é€‰æ‹©ä¸å†³ç­–ä¸æ˜¯åœ¨å¤–ç•Œå–§åš£çš„æ„è§æµ·æ´‹ä¸­éšæ³¢é€æµï¼Œè€Œæ˜¯åŸºäºå†…å¿ƒçš„åæ ‡è¿›è¡Œå¯¼èˆªã€‚ å½“å¤–ç•Œè¯„ä»·ä¸å†…åœ¨æ ‡å‡†å†²çªæ—¶ï¼Œä»–ä»¬æ›´å€¾å‘äºè†å¬å¹¶â€¦",
        "comment_count": 0,
        "is_copyable": false,
        "reshipment_settings": "disallowed",
        "answer_type": "normal",
        "url": "https://api.zhihu.com/answers/1995489547446949242",
        "updated_time": 1768541782,
        "type": "answer",
        "favorite_count": 7,
        "thanks_count": 3,
        "question": {
          "author": {
            "is_following": false,
            "id": "a0bcb162b44ae32bdc2025f4bab8895e",
            "url": "https://api.zhihu.com/people/a0bcb162b44ae32bdc2025f4bab8895e",
            "gender": -1,
            "followers_count": 44,
            "avatar_url": "https://picx.zhimg.com/50/v2-6887607548265176e000d5c02a8c53e6_l.jpg?source=b6762063",
            "is_org": false,
            "is_followed": false,
            "user_type": "people",
            "url_token": "7-25-91-18",
            "name": "ä¸æ³°å‹’",
            "headline": ""
          },
          "title": "ä¸å†…è€—çš„äººè„‘å­é‡Œæ˜¯è¿™ä¹ˆæƒ³çš„ï¼Œä»–ä»¬çš„å¿ƒæ€å’Œæ€ç»´æ¨¡å¼æœ‰å“ªäº›ç‰¹ç‚¹ï¼Ÿ",
          "answer_count": 0,
          "relationship": {
            "is_author": false
          },
          "comment_count": 0,
          "excerpt": "",
          "detail": "",
          "question_type": "normal",
          "id": "1995454453453714582",
          "created": 1768533415,
          "bound_topic_ids": [
            404,
            6588,
            6831,
            26553,
            2578235
          ],
          "is_following": false,
          "type": "question",
          "url": "https://api.zhihu.com/questions/1995454453453714582",
          "follower_count": 0
        },
        "visited_count": 34,
        "excerpt_new": "é¦–è¦çš„åŸºçŸ³æ˜¯æ¸…æ™°çš„è‡ªæˆ‘è®¤çŸ¥ä¸åšå®šçš„ä»·å€¼å†…æ ¸ã€‚ ä¸å†…è€—çš„äººå¯¹è‡ªå·±æœ‰è¿‘ä¹â€œå®¢è§‚â€çš„å®¡è§†ï¼Œä»–ä»¬äº†è§£è‡ªå·±çš„ä¼˜åŠ¿ä¸å±€é™ï¼Œå¦‚åŒç†Ÿæ‚‰å·¥å…·çš„æ€§èƒ½ä¸è¾¹ç•Œã€‚ è¿™ç§äº†è§£ä¸æ˜¯é€šè¿‡åå¤çš„è‡ªæˆ‘æ€€ç–‘ä¸æ‰¹åˆ¤è·å¾—ï¼Œè€Œæ˜¯åœ¨è¡ŒåŠ¨ä¸åé¦ˆä¸­ä¸æ–­æ ¡å‡†çš„ç¨³å®šåœ°å›¾ã€‚       ä»–ä»¬å†…å¿ƒæœ‰ä¸€åº§ä¸æ˜“åŠ¨æ‘‡çš„ç¯å¡”ï¼Œå³è‡ªå·±çš„æ ¸å¿ƒä»·å€¼è§‚ä¸ç›®æ ‡ã€‚ é€‰æ‹©ä¸å†³ç­–ä¸æ˜¯åœ¨å¤–ç•Œå–§åš£çš„æ„è§æµ·æ´‹ä¸­éšæ³¢é€æµï¼Œè€Œæ˜¯åŸºäºå†…å¿ƒçš„åæ ‡è¿›è¡Œå¯¼èˆªã€‚ å½“å¤–ç•Œè¯„ä»·ä¸å†…åœ¨æ ‡å‡†å†²çªæ—¶ï¼Œä»–ä»¬æ›´å€¾å‘äºè†å¬å¹¶â€¦",
        "is_labeled": false,
        "preview_text": "",
        "content": "<p data-pid=\"wTnPhfXS\">é¦–è¦çš„åŸºçŸ³æ˜¯æ¸…æ™°çš„è‡ªæˆ‘è®¤çŸ¥ä¸åšå®šçš„ä»·å€¼å†…æ ¸ã€‚</p><p data-pid=\"l5ZqO-iD\">ä¸å†…è€—çš„äººå¯¹è‡ªå·±æœ‰è¿‘ä¹â€œå®¢è§‚â€çš„å®¡è§†ï¼Œä»–ä»¬äº†è§£è‡ªå·±çš„ä¼˜åŠ¿ä¸å±€é™ï¼Œå¦‚åŒç†Ÿæ‚‰å·¥å…·çš„æ€§èƒ½ä¸è¾¹ç•Œã€‚</p><p data-pid=\"k0DprK1y\">è¿™ç§äº†è§£ä¸æ˜¯é€šè¿‡åå¤çš„è‡ªæˆ‘æ€€ç–‘ä¸æ‰¹åˆ¤è·å¾—ï¼Œè€Œæ˜¯åœ¨è¡ŒåŠ¨ä¸åé¦ˆä¸­ä¸æ–­æ ¡å‡†çš„ç¨³å®šåœ°å›¾ã€‚</p><figure data-size=\"normal\"><img src=\"https://pic4.zhimg.com/v2-e189fdbf264937d3a5a75db114248e55_1440w.jpg\" data-rawwidth=\"1080\" data-rawheight=\"1053\" data-size=\"normal\" data-original-token=\"v2-d0bb829984b169ba9a6aa7ac9afa4521\" class=\"origin_image zh-lightbox-thumb\" width=\"1080\" data-original=\"https://pic4.zhimg.com/v2-e189fdbf264937d3a5a75db114248e55_r.jpg\"/></figure><p class=\"ztext-empty-paragraph\"><br/></p><figure data-size=\"normal\"><img src=\"https://pic4.zhimg.com/v2-21bd3642016c5556f4067a94f3d7a51d_1440w.jpg\" data-rawwidth=\"1080\" data-rawheight=\"1457\" data-size=\"normal\" data-original-token=\"v2-a827294b4f752552d0d734a832d89348\" class=\"origin_image zh-lightbox-thumb\" width=\"1080\" data-original=\"https://pic4.zhimg.com/v2-21bd3642016c5556f4067a94f3d7a51d_r.jpg\"/></figure><p class=\"ztext-empty-paragraph\"><br/></p><figure data-size=\"normal\"><img src=\"https://pica.zhimg.com/v2-e025a26c8dc06ac83259bea419933af6_1440w.jpg\" data-rawwidth=\"1080\" data-rawheight=\"1388\" data-size=\"normal\" data-original-token=\"v2-6bc6d34c6031559d395d43295e3819df\" class=\"origin_image zh-lightbox-thumb\" width=\"1080\" data-original=\"https://pica.zhimg.com/v2-e025a26c8dc06ac83259bea419933af6_r.jpg\"/></figure><p data-pid=\"NoF9atJv\">ä»–ä»¬å†…å¿ƒæœ‰ä¸€åº§ä¸æ˜“åŠ¨æ‘‡çš„ç¯å¡”ï¼Œå³è‡ªå·±çš„æ ¸å¿ƒä»·å€¼è§‚ä¸ç›®æ ‡ã€‚</p><p data-pid=\"LQC5LL1D\">é€‰æ‹©ä¸å†³ç­–ä¸æ˜¯åœ¨å¤–ç•Œå–§åš£çš„æ„è§æµ·æ´‹ä¸­éšæ³¢é€æµï¼Œè€Œæ˜¯åŸºäºå†…å¿ƒçš„åæ ‡è¿›è¡Œå¯¼èˆªã€‚</p><p data-pid=\"uj2PgVOe\">å½“å¤–ç•Œè¯„ä»·ä¸å†…åœ¨æ ‡å‡†å†²çªæ—¶ï¼Œä»–ä»¬æ›´å€¾å‘äºè†å¬å¹¶ä¿¡ä»»åè€…ï¼Œå› æ­¤é¿å…äº†å› è¿åˆä»–äººè€Œå¯¼è‡´çš„å·¨å¤§èƒ½é‡è€—æ•£ã€‚</p><p data-pid=\"MGkLyQdV\">ä»–ä»¬æ¥çº³è‡ªå·±çš„ä¸å®Œç¾ï¼Œè§†ç¼ºç‚¹ä¸ºç‰¹è´¨çš„ä¸€éƒ¨åˆ†æˆ–å¯æ”¹è¿›çš„èŒƒç•´ï¼Œè€Œéç”¨äºè‡ªæˆ‘æ”»å‡»çš„æ­¦å™¨ã€‚</p><p data-pid=\"oG3oepxJ\">è¿™ç§â€œå¦‚å…¶æ‰€æ˜¯â€çš„æ¥çº³ï¼Œçœå»äº†æ— æ•°åœ¨â€œç†æƒ³æˆ‘â€ä¸â€œç°å®æˆ‘â€ä¹‹é—´å¾’åŠ³çš„æ’•æ‰¯ã€‚</p><p data-pid=\"x7lOGNzK\">å…¶æ¬¡ï¼Œä»–ä»¬çš„æ€ç»´å…·æœ‰å¼ºçƒˆçš„ç°å®å¯¼å‘ä¸è¡ŒåŠ¨è‡ªè§‰ã€‚</p><p data-pid=\"kUdn46Gw\">å†…è€—å¸¸æºäºå¯¹è¿‡å»æ— å°½çš„æ‚”æ¨æˆ–å¯¹æœªæ¥æ— è¾¹çš„å¿§è™‘ï¼Œæ€ç»´åœ¨è™šå¦„çš„æ—¶ç©ºä¸­å¾’åŠ³æ‰“è½¬ã€‚</p><p data-pid=\"gtseT-ic\">è€Œä¸å†…è€—çš„äººï¼Œå…¶æ€ç»´é”šç‚¹ç‰¢ç‰¢é’‰åœ¨â€œæ­¤åˆ»â€ä¸â€œæ­¤åœ°â€ã€‚</p><p data-pid=\"rMOWxSev\">ä»–ä»¬æ“…é•¿å°†æ¨¡ç³Šçš„ç„¦è™‘ã€åºå¤§çš„é—®é¢˜ï¼Œè½¬åŒ–ä¸ºå…·ä½“ã€å¯æ“ä½œçš„è¡ŒåŠ¨æ­¥éª¤ã€‚</p><p data-pid=\"VC-tb_Ow\">é¢å¯¹å›°å¢ƒï¼Œä¸»å¯¼æ€§çš„æ€ç»´æ¨¡å¼æ˜¯â€œç°åœ¨æˆ‘èƒ½åšäº›ä»€ä¹ˆï¼Ÿå“ªæ€•åªæ˜¯ä¸€å°æ­¥â€ï¼Œè€Œéâ€œä¸ºä»€ä¹ˆæ˜¯æˆ‘ï¼Ÿâ€â€œå¦‚æœå½“åˆâ€¦â€¦å°±å¥½äº†â€ã€‚</p><p data-pid=\"do5kA6CW\">è¿™ç§æ€ç»´åˆ‡æ¢ï¼Œå¦‚åŒå°†å¼¥æ¼«çš„é›¾æ°”å‡ç»“ä¸ºå¯è§¦ç¢°çš„æ°´æ»´ã€‚</p><p data-pid=\"fiq0prrC\">ä»–ä»¬ç†è§£ï¼Œæƒ…ç»ªå¾ˆå¤šæ—¶å€™æ˜¯è¡ŒåŠ¨çš„å‰¯äº§å“ï¼Œè€Œéè¡ŒåŠ¨çš„å‰æã€‚</p><p data-pid=\"s0KWcUvu\">å› æ­¤ï¼Œä¸è¿‡åº¦å’€åš¼æ„Ÿå—ï¼Œä¸ç­‰å¾…â€œæœ‰æ„Ÿè§‰â€å†å¼€å§‹ï¼Œè€Œæ˜¯é€šè¿‡å¯åŠ¨è¡ŒåŠ¨æœ¬èº«ï¼Œæ¥åˆ›é€ æ–°çš„ä½“éªŒä¸æƒ…ç»ªè½¨è¿¹ã€‚</p><p data-pid=\"J29Hc17y\">å¯¹äºæ— æ³•æ§åˆ¶ä¹‹äº‹ï¼Œå¦‚ä»–äººçœ‹æ³•ã€å·²æˆå®šå±€çš„è¿‡å»ï¼Œä»–ä»¬èƒ½è¾ƒå¿«åœ°è¯†åˆ«å¹¶åˆ’å®šå¿ƒç†è¾¹ç•Œï¼Œé€‰æ‹©æ¥çº³æˆ–æç½®ï¼Œè€ŒéæŒç»­æŠ•å…¥æ— æ•ˆçš„å…³æ³¨ã€‚</p><p></p>",
        "navigator_vote": false,
        "author": {
          "url": "https://api.zhihu.com/people/010d26d363afc0fcb37a26a87725b787",
          "user_type": "people",
          "name": "å½©è‰²çš„ç…¤çƒ",
          "avatar_url": "https://picx.zhimg.com/50/v2-8f9d8db79a0ae547f43024203c8c9c07_l.jpg?source=b6762063",
          "gender": -1,
          "followers_count": 800,
          "is_followed": false,
          "id": "010d26d363afc0fcb37a26a87725b787",
          "headline": "ç”¨ç»˜ç”»è®²æ•…äº‹ï¼Œç”¨æ•…äº‹è®²ç»˜ç”»ã€‚",
          "is_org": false,
          "is_following": false,
          "url_token": "tan-a-wen-92"
        },
        "thumbnail": "https://picx.zhimg.com/50/v2-d0bb829984b169ba9a6aa7ac9afa4521_720w.jpg?source=b6762063",
        "preview_type": "default",
        "relationship": {
          "is_thanked": false,
          "is_nothelp": false,
          "voting": 0
        },
        "thumbnails": [
          "https://picx.zhimg.com/50/v2-d0bb829984b169ba9a6aa7ac9afa4521_720w.jpg?source=b6762063",
          "https://pic1.zhimg.com/50/v2-a827294b4f752552d0d734a832d89348_720w.jpg?source=b6762063",
          "https://picx.zhimg.com/50/v2-6bc6d34c6031559d395d43295e3819df_720w.jpg?source=b6762063"
        ],
        "is_navigator": false,
        "allow_segment_interaction": true,
        "id": "1995489547446949242",
        "voteup_count": 5
      },
      "brief": "{\"source\": \"TS\", \"type\": \"answer\", \"id\": 1995489547446949242}",
      "attached_info": "CqIHCNX3q7PPnMfysAEQBBoJNzY1NjYwOTU1INacp8sGKAUwAEA0SiQKGVRTX1NPVVJDRV9XQVJNX1VQX05PUk1BTDISATAYACAAOgBKLAohVFNfU09VUkNFX1dBUk1VUF9aSElfRklORVRVTkVfSTJJEgEwGAAgADoAWgkxMTgwODQ1MjJiIGZiNzQ0ZTI5MTgxMGM3M2M4MzYyMDRkYTkyZDQwMGQychMxOTk1NDg5NTQ3NDQ2OTQ5MjQyigETMTk5NTQ1NDQ1MzQ1MzcxNDU4MqoBCXJlY29tbWVuZMIBIDAxMGQyNmQzNjNhZmMwZmNiMzdhMjZhODc3MjViNzg38gEKCAwSBk5vcm1hbPIBKAgKEiQ1ZTk2NDdmOC01ZjcxLTQwNjktODhmYS0yM2Q5NGNjYzBlOWLyAQUICxIBOYICAIgCquKZxrwzkgIgMDEwZDI2ZDM2M2FmYzBmY2IzN2EyNmE4NzcyNWI3ODeaAgDKAhZTaG9ySW50ZXJlc3RXZWlnaHRSdWxlygIbSW50ZXJhY3Rpb25TaG9ySW50ZXJlc3RSdWxlygIYUGVyaW9kSW50ZXJlc3RXZWlnaHRSdWxlygIYQ29udGVudFdhcm1VcEJyZWFrSW5SdWxl2gIZVFNfU09VUkNFX1dBUk1fVVBfTk9STUFMMugCBPoCC05PUk1BTF9GTE9XigMgODA1Zjg4MGQwNTI5NDhjMWE3NTMxOGE5NzM4MWFjOWWaAw0KAnYyEAAaBW90aGVyqAMi2AMA6gMaYWlfemhpX2ZpbmV0dW5yX2kyaV9yZWNhbGz6A6wBEgxVTktOT1dOX01PREUgACoNTk9fSU1BR0VfTU9ERTotCAMQuAgYnQgiI3YyLWQwYmI4Mjk5ODRiMTY5YmE5YTZhYTdhYzlhZmE0NTIxOi0IAxC4CBixCyIjdjItYTgyNzI5NGI0Zjc1MjU1MmQwZDczNGE4MzJkODkzNDg6LQgDELgIGOwKIiN2Mi02YmM2ZDM0YzYwMzE1NTlkMzk1ZDQzMjk1ZTM4MTlkZoAEAIgEAJIEBk5vcm1hbJoEATSgBACoBACwBAC6BAJhacIEAzQwMMgEANIED+aOqOiNkOW3suabtOaWsNgEAPAEAPkEAAAAYFKViT+BBQAAAAAAAAAAiQVibSw5RtOzP5IFAJoFA2RmdKIFA2RmdLIFATG5BQAAAAAAAAAA0AUA4AUA6AUA8AUJkAYAoAY2qAYBkgIuCgk3NjU2NjA5NTUSEzE5OTU0ODk1NDc0NDY5NDkyNDIYBCIKSU1BR0VfVEVYVA==",
      "action_card": false
    },
    {
      "id": "53_1768600007.432",
      "type": "feed",
      "offset": 53,
      "verb": "TOPIC_ACKNOWLEDGED_ANSWER",
      "created_time": 1768600007,
      "updated_time": 1768600007,
      "target": {
        "voteup_count": 366,
        "thanks_count": 46,
        "is_copyable": true,
        "question": {
          "created": 1626774524,
          "bound_topic_ids": [
            707,
            3541,
            23412
          ],
          "is_following": false,
          "detail": "",
          "id": "473479018",
          "type": "question",
          "author": {
            "id": "fa919734224a6c78b5b168b5fe586049",
            "user_type": "organization",
            "name": "é˜¿é‡Œäº‘å¼€å‘è€…",
            "headline": "é˜¿é‡Œçš„æŠ€æœ¯åˆ›æ–°å‡åœ¨æ­¤å‘ˆç°",
            "avatar_url": "https://picx.zhimg.com/50/v2-1d701f79d418cbcb2d7e991d9862aff6_l.jpg?source=b6762063",
            "badge": [
              {
                "type": "identity_org",
                "description": "å·²è®¤è¯æœºæ„å·"
              }
            ],
            "url": "https://api.zhihu.com/people/fa919734224a6c78b5b168b5fe586049",
            "url_token": "a-li-ji-zhu",
            "is_org": true,
            "gender": -1,
            "followers_count": 188382,
            "is_following": false,
            "is_followed": false
          },
          "question_type": "normal",
          "url": "https://api.zhihu.com/questions/473479018",
          "answer_count": 0,
          "excerpt": "",
          "relationship": {
            "is_author": false
          },
          "title": "çº¿ä¸Šæ•…éšœå¦‚ä½•å¿«é€Ÿæ’æŸ¥ï¼Ÿ",
          "follower_count": 0,
          "comment_count": 1
        },
        "excerpt_new": "å‰å‡ å¤©å‡Œæ™¨2ç‚¹ï¼Œæˆ‘åˆè¢«ç›‘æ§æŠ¥è­¦ç»™åµé†’äº†ã€‚æœåŠ¡å™¨CPUé£™åˆ°90%ï¼Œä½†æ˜¯topçœ‹äº†åŠå¤©ä¹Ÿæ‰¾ä¸åˆ°ç½ªé­ç¥¸é¦–ã€‚è¿™ç§æ—¶å€™ï¼Œå°±å¾—è¯·å‡ºæˆ‘ä»¬è¿ç»´äººå‘˜çš„ä¸¤å¤§æ³•å®äº†â€”â€”straceå’Œftraceã€‚ è¯´å®è¯ï¼Œåˆšå¼€å§‹æ¥è§¦è¿™ä¸¤ä¸ªå·¥å…·çš„æ—¶å€™ï¼Œæˆ‘ä¹Ÿæ˜¯ä¸€è„¸æ‡µé€¼ã€‚ä»€ä¹ˆç³»ç»Ÿè°ƒç”¨ã€å†…æ ¸è·Ÿè¸ªï¼Œå¬èµ·æ¥å°±å¾ˆé«˜å¤§ä¸Šçš„æ ·å­ã€‚ä½†æ˜¯ç”¨å¤šäº†ä½ å°±ä¼šå‘ç°ï¼Œè¿™ç©æ„å„¿ç®€ç›´å°±æ˜¯æ’æŸ¥é—®é¢˜çš„ç¥å™¨ï¼ä»Šå¤©å°±è·Ÿå¤§å®¶åˆ†äº«ä¸€ä¸‹æˆ‘è¿™äº›å¹´ç”¨ä¸‹æ¥çš„ä¸€äº›å¿ƒå¾—ã€‚ å…ˆè¯´è¯´ç³»ç»Ÿè°ƒç”¨è¿™ä¸ªä¸œè¥¿ä½ å¯èƒ½ä¼šé—®ï¼Œç³»ç»Ÿè°ƒç”¨åˆ°â€¦",
        "relationship": {
          "is_nothelp": false,
          "voting": 0,
          "is_thanked": false
        },
        "is_navigator": false,
        "updated_time": 1749978415,
        "type": "answer",
        "created_time": 1749978415,
        "comment_count": 30,
        "excerpt": "å‰å‡ å¤©å‡Œæ™¨2ç‚¹ï¼Œæˆ‘åˆè¢«ç›‘æ§æŠ¥è­¦ç»™åµé†’äº†ã€‚æœåŠ¡å™¨CPUé£™åˆ°90%ï¼Œä½†æ˜¯topçœ‹äº†åŠå¤©ä¹Ÿæ‰¾ä¸åˆ°ç½ªé­ç¥¸é¦–ã€‚è¿™ç§æ—¶å€™ï¼Œå°±å¾—è¯·å‡ºæˆ‘ä»¬è¿ç»´äººå‘˜çš„ä¸¤å¤§æ³•å®äº†â€”â€”straceå’Œftraceã€‚ è¯´å®è¯ï¼Œåˆšå¼€å§‹æ¥è§¦è¿™ä¸¤ä¸ªå·¥å…·çš„æ—¶å€™ï¼Œæˆ‘ä¹Ÿæ˜¯ä¸€è„¸æ‡µé€¼ã€‚ä»€ä¹ˆç³»ç»Ÿè°ƒç”¨ã€å†…æ ¸è·Ÿè¸ªï¼Œå¬èµ·æ¥å°±å¾ˆé«˜å¤§ä¸Šçš„æ ·å­ã€‚ä½†æ˜¯ç”¨å¤šäº†ä½ å°±ä¼šå‘ç°ï¼Œè¿™ç©æ„å„¿ç®€ç›´å°±æ˜¯æ’æŸ¥é—®é¢˜çš„ç¥å™¨ï¼ä»Šå¤©å°±è·Ÿå¤§å®¶åˆ†äº«ä¸€ä¸‹æˆ‘è¿™äº›å¹´ç”¨ä¸‹æ¥çš„ä¸€äº›å¿ƒå¾—ã€‚ å…ˆè¯´è¯´ç³»ç»Ÿè°ƒç”¨è¿™ä¸ªä¸œè¥¿ä½ å¯èƒ½ä¼šé—®ï¼Œç³»ç»Ÿè°ƒç”¨åˆ°â€¦",
        "reshipment_settings": "allowed",
        "content": "<p data-pid=\"raTiWcwG\">å‰å‡ å¤©å‡Œæ™¨2ç‚¹ï¼Œæˆ‘åˆè¢«ç›‘æ§æŠ¥è­¦ç»™åµé†’äº†ã€‚æœåŠ¡å™¨CPUé£™åˆ°90%ï¼Œä½†æ˜¯topçœ‹äº†åŠå¤©ä¹Ÿæ‰¾ä¸åˆ°ç½ªé­ç¥¸é¦–ã€‚è¿™ç§æ—¶å€™ï¼Œå°±å¾—è¯·å‡ºæˆ‘ä»¬è¿ç»´äººå‘˜çš„ä¸¤å¤§æ³•å®äº†â€”â€”straceå’Œftraceã€‚</p><p data-pid=\"VecLrApt\">è¯´å®è¯ï¼Œåˆšå¼€å§‹æ¥è§¦è¿™ä¸¤ä¸ªå·¥å…·çš„æ—¶å€™ï¼Œæˆ‘ä¹Ÿæ˜¯ä¸€è„¸æ‡µé€¼ã€‚ä»€ä¹ˆç³»ç»Ÿè°ƒç”¨ã€å†…æ ¸è·Ÿè¸ªï¼Œå¬èµ·æ¥å°±å¾ˆé«˜å¤§ä¸Šçš„æ ·å­ã€‚ä½†æ˜¯ç”¨å¤šäº†ä½ å°±ä¼šå‘ç°ï¼Œè¿™ç©æ„å„¿ç®€ç›´å°±æ˜¯æ’æŸ¥é—®é¢˜çš„ç¥å™¨ï¼ä»Šå¤©å°±è·Ÿå¤§å®¶åˆ†äº«ä¸€ä¸‹æˆ‘è¿™äº›å¹´ç”¨ä¸‹æ¥çš„ä¸€äº›å¿ƒå¾—ã€‚</p><h2><b>å…ˆè¯´è¯´ç³»ç»Ÿè°ƒç”¨è¿™ä¸ªä¸œè¥¿</b></h2><p data-pid=\"aItzPjKT\">ä½ å¯èƒ½ä¼šé—®ï¼Œç³»ç»Ÿè°ƒç”¨åˆ°åº•æ˜¯ä¸ªå•¥ï¼Ÿç®€å•æ¥è¯´ï¼Œå°±æ˜¯åº”ç”¨ç¨‹åºæƒ³è¦å¹²ç‚¹ä»€ä¹ˆäº‹æƒ…çš„æ—¶å€™ï¼Œå¿…é¡»è¦é€šè¿‡å†…æ ¸æ¥å®Œæˆã€‚æ¯”å¦‚ä½ çš„ç¨‹åºè¦è¯»ä¸ªæ–‡ä»¶ï¼Œè¦å‘ä¸ªç½‘ç»œè¯·æ±‚ï¼Œè¦åˆ†é…ç‚¹å†…å­˜ï¼Œè¿™äº›éƒ½å¾—é€šè¿‡ç³»ç»Ÿè°ƒç”¨æ¥å®ç°ã€‚</p><p data-pid=\"YSdQ1x0Q\">å°±åƒä½ åœ¨å®¶é‡Œæƒ³åƒå¤–å–ï¼Œä½ ä¸èƒ½ç›´æ¥è·‘åˆ°é¤å…åå¨å»ç‚’èœå§ï¼Ÿä½ å¾—é€šè¿‡å¤–å–å¹³å°ä¸‹å•ï¼Œç„¶åå¹³å°å¸®ä½ å¤„ç†ã€‚ç³»ç»Ÿè°ƒç”¨å°±æ˜¯è¿™ä¸ª&#34;å¤–å–å¹³å°&#34;ï¼Œåº”ç”¨ç¨‹åºå°±æ˜¯ä½ ï¼Œå†…æ ¸å°±æ˜¯åå¨ã€‚</p><p data-pid=\"QR--xe2V\">æˆ‘è®°å¾—åˆšå·¥ä½œé‚£ä¼šå„¿ï¼Œæœ‰ä¸ªåŒäº‹æ€»æ˜¯è¯´&#34;ç¨‹åºè·‘å¾—æ…¢ï¼Œè‚¯å®šæ˜¯ä»£ç å†™å¾—çƒ‚&#34;ã€‚åæ¥ç”¨straceä¸€çœ‹ï¼Œå¥½å®¶ä¼™ï¼Œç¨‹åºæ¯ç§’é’Ÿè°ƒç”¨äº†å‡ ä¸‡æ¬¡writeç³»ç»Ÿè°ƒç”¨ï¼Œæ¯æ¬¡åªå†™ä¸€ä¸ªå­—èŠ‚ï¼è¿™ä¸æ˜¯å‘çˆ¹å—ï¼Ÿ</p><h2><b>straceï¼šç³»ç»Ÿè°ƒç”¨çš„&#34;å·çª¥ç‹‚&#34;</b></h2><p data-pid=\"H_pvOBgL\">straceè¿™ä¸ªå·¥å…·ï¼Œè¯´ç™½äº†å°±æ˜¯ä¸ª&#34;å·çª¥ç‹‚&#34;ï¼Œä¸“é—¨ç›‘è§†ç¨‹åºéƒ½è°ƒç”¨äº†å“ªäº›ç³»ç»Ÿè°ƒç”¨ã€‚</p><h3><b>åŸºæœ¬ç”¨æ³•å¾ˆç®€å•</b></h3><p data-pid=\"2FkmBmW6\">æœ€ç®€å•çš„ç”¨æ³•å°±æ˜¯ç›´æ¥åœ¨å‘½ä»¤å‰é¢åŠ ä¸ªstraceï¼š</p><div class=\"highlight\"><pre><code class=\"language-bash\">strace ls /tmp</code></pre></div><p data-pid=\"yCkg84DJ\">ç„¶åä½ å°±ä¼šçœ‹åˆ°ä¸€å †è¾“å‡ºï¼Œå¯†å¯†éº»éº»çš„ï¼Œç¬¬ä¸€æ¬¡çœ‹è‚¯å®šä¼šè¢«å“åˆ°ã€‚ä¸è¿‡åˆ«æ…Œï¼Œæˆ‘ä»¬æ…¢æ…¢æ¥åˆ†æã€‚</p><p data-pid=\"pR_kiG0N\">å¦‚æœä½ æƒ³è·Ÿè¸ªä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ï¼Œç”¨-på‚æ•°ï¼š</p><div class=\"highlight\"><pre><code class=\"language-bash\">strace -p <span class=\"m\">1234</span></code></pre></div><p data-pid=\"M8myYTOR\">è¿™é‡Œ1234æ˜¯è¿›ç¨‹IDï¼Œä½ å¯ä»¥é€šè¿‡pså‘½ä»¤æ‰¾åˆ°ã€‚</p><h3><b>è¾“å‡ºå†…å®¹æ€ä¹ˆçœ‹</b></h3><p data-pid=\"SyWtVjGQ\">straceçš„è¾“å‡ºæ ¼å¼åŸºæœ¬æ˜¯è¿™æ ·çš„ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">ç³»ç»Ÿè°ƒç”¨å(å‚æ•°1, å‚æ•°2, ...) = è¿”å›å€¼</code></pre></div><p data-pid=\"Yr0EBnNV\">æ¯”å¦‚ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">open(&#34;/etc/passwd&#34;, O_RDONLY) = 3\nread(3, &#34;root:x:0:0:root:/root:/bin/bash\\n&#34;..., 4096) = 1024\nclose(3) = 0</code></pre></div><p data-pid=\"YhmeTHu_\">è¿™ä¸‰è¡Œå°±æ˜¯ä¸€ä¸ªå®Œæ•´çš„æ–‡ä»¶è¯»å–è¿‡ç¨‹ï¼š</p><ul><li data-pid=\"SfrLVje-\">openæ‰“å¼€æ–‡ä»¶ï¼Œè¿”å›æ–‡ä»¶æè¿°ç¬¦3</li><li data-pid=\"5qnMI8eM\">readä»æ–‡ä»¶æè¿°ç¬¦3è¯»å–æ•°æ®ï¼Œè¯»äº†1024å­—èŠ‚</li><li data-pid=\"SneX0t__\">closeå…³é—­æ–‡ä»¶æè¿°ç¬¦3</li></ul><p data-pid=\"J7P4rgKj\">æœ‰æ—¶å€™ä½ è¿˜ä¼šçœ‹åˆ°ä¸€äº›é”™è¯¯ï¼Œæ¯”å¦‚ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\">open(&#34;/tmp/nonexistent&#34;, O_RDONLY) = -1 ENOENT (No such file or directory)</code></pre></div><p data-pid=\"AElqGXl1\">è¿™å°±æ˜¯è¯´æ–‡ä»¶ä¸å­˜åœ¨ï¼Œopenè°ƒç”¨å¤±è´¥äº†ã€‚</p><h3><b>å®ç”¨å‚æ•°ç»„åˆ</b></h3><p data-pid=\"kNEFFYg7\">æˆ‘å¹³æ—¶ç”¨å¾—æœ€å¤šçš„å‡ ä¸ªå‚æ•°ç»„åˆï¼š</p><p data-pid=\"F24sXI_B\"><b>åªçœ‹æ–‡ä»¶æ“ä½œï¼š</b></p><div class=\"highlight\"><pre><code class=\"language-bash\">strace -e <span class=\"nv\">trace</span><span class=\"o\">=</span>file ls /tmp</code></pre></div><p data-pid=\"3rFwQZHx\"><b>åªçœ‹ç½‘ç»œæ“ä½œï¼š</b></p><div class=\"highlight\"><pre><code class=\"language-bash\">strace -e <span class=\"nv\">trace</span><span class=\"o\">=</span>network curl baidu.com</code></pre></div><p data-pid=\"PZIgoo0t\"><b>ç»Ÿè®¡ç³»ç»Ÿè°ƒç”¨æ¬¡æ•°å’Œè€—æ—¶ï¼š</b></p><div class=\"highlight\"><pre><code class=\"language-bash\">strace -c ls /tmp</code></pre></div><p data-pid=\"Ha2YBtFR\">è¿™ä¸ª-cå‚æ•°ç‰¹åˆ«æœ‰ç”¨ï¼Œèƒ½ç»™ä½ ä¸€ä¸ªç»Ÿè®¡æŠ¥å‘Šï¼Œå‘Šè¯‰ä½ å“ªä¸ªç³»ç»Ÿè°ƒç”¨ç”¨å¾—æœ€å¤šï¼Œå“ªä¸ªæœ€è€—æ—¶ã€‚</p><p data-pid=\"6gtPWUK4\"><b>è¾“å‡ºåˆ°æ–‡ä»¶ï¼š</b></p><div class=\"highlight\"><pre><code class=\"language-bash\">strace -o trace.log -p <span class=\"m\">1234</span></code></pre></div><p data-pid=\"iYQQxx1s\">çº¿ä¸Šç¯å¢ƒå»ºè®®éƒ½è¾“å‡ºåˆ°æ–‡ä»¶ï¼Œä¸ç„¶å±å¹•åˆ·å¾—ä½ çœ¼èŠ±ç¼­ä¹±ã€‚</p><h3><b>çœŸå®æ¡ˆä¾‹åˆ†äº«</b></h3><p data-pid=\"wjUn8vyD\">å»å¹´æœ‰ä¸ªJavaåº”ç”¨å¯åŠ¨ç‰¹åˆ«æ…¢ï¼Œç”¨æˆ·éƒ½æŠ•è¯‰äº†ã€‚å¼€å‘è¯´ä»£ç æ²¡é—®é¢˜ï¼Œæˆ‘å°±ç”¨straceè·Ÿè¸ªäº†ä¸€ä¸‹å¯åŠ¨è¿‡ç¨‹ï¼š</p><div class=\"highlight\"><pre><code class=\"language-bash\">strace -f -o startup.log java -jar myapp.jar</code></pre></div><p data-pid=\"T3wek38J\">è¿™é‡Œ-få‚æ•°å¾ˆé‡è¦ï¼Œå¯ä»¥è·Ÿè¸ªå­è¿›ç¨‹ã€‚ç»“æœå‘ç°è¿™ä¸ªåº”ç”¨å¯åŠ¨çš„æ—¶å€™ï¼Œç–¯ç‹‚åœ°åœ¨è¯»å–/dev/randomï¼Œæ¯æ¬¡è¯»å–éƒ½è¦ç­‰å¥½å‡ ç§’ã€‚åŸæ¥æ˜¯æŸä¸ªåŠ å¯†åº“çš„é…ç½®æœ‰é—®é¢˜ï¼Œæ”¹æˆ/dev/urandomå°±å¥½äº†ã€‚</p><h2><b>ftraceï¼šå†…æ ¸çº§åˆ«çš„&#34;é€è§†é•œ&#34;</b></h2><p data-pid=\"kfj8LSxV\">å¦‚æœè¯´straceæ˜¯åº”ç”¨å±‚çš„ç›‘æ§ï¼Œé‚£ftraceå°±æ˜¯å†…æ ¸å±‚çš„é€è§†é•œäº†ã€‚å®ƒèƒ½è®©ä½ çœ‹åˆ°å†…æ ¸å†…éƒ¨å‘ç”Ÿäº†ä»€ä¹ˆï¼ŒåŒ…æ‹¬å‡½æ•°è°ƒç”¨å…³ç³»ã€æ‰§è¡Œæ—¶é—´ç­‰ç­‰ã€‚</p><h3><b>ftraceçš„å·¥ä½œåŸç†</b></h3><p data-pid=\"VO96XuHn\">ftraceæ˜¯Linuxå†…æ ¸è‡ªå¸¦çš„è·Ÿè¸ªæ¡†æ¶ï¼Œé€šè¿‡debugfsæ–‡ä»¶ç³»ç»Ÿæ¥æ“ä½œã€‚è¯´ç™½äº†å°±æ˜¯å†…æ ¸åœ¨å…³é”®ä½ç½®åŸ‹äº†å¾ˆå¤š&#34;æ¢é’ˆ&#34;ï¼Œä½ å¯ä»¥é€‰æ‹©æ€§åœ°å¼€å¯è¿™äº›æ¢é’ˆæ¥æ”¶é›†ä¿¡æ¯ã€‚</p><h3><b>åŸºæœ¬æ“ä½œæ­¥éª¤</b></h3><p data-pid=\"NTaLHwsG\">ftraceçš„æ“ä½œéƒ½æ˜¯é€šè¿‡/sys/kernel/debug/tracingç›®å½•ä¸‹çš„æ–‡ä»¶æ¥å®Œæˆçš„ã€‚</p><p data-pid=\"DcanqG1A\"><b>é¦–å…ˆæ£€æŸ¥ftraceæ˜¯å¦å¯ç”¨ï¼š</b></p><div class=\"highlight\"><pre><code class=\"language-bash\">ls /sys/kernel/debug/tracing/</code></pre></div><p data-pid=\"iSco3G3c\">å¦‚æœçœ‹ä¸åˆ°è¿™ä¸ªç›®å½•ï¼Œå¯èƒ½éœ€è¦æŒ‚è½½debugfsï¼š</p><div class=\"highlight\"><pre><code class=\"language-bash\">mount -t debugfs debugfs /sys/kernel/debug</code></pre></div><p data-pid=\"IuoI57Sx\"><b>æŸ¥çœ‹å¯ç”¨çš„è·Ÿè¸ªå™¨ï¼š</b></p><div class=\"highlight\"><pre><code class=\"language-bash\">cat /sys/kernel/debug/tracing/available_tracers</code></pre></div><p data-pid=\"CYzZupdh\">ä½ ä¼šçœ‹åˆ°functionã€function_graphã€nopç­‰é€‰é¡¹ã€‚</p><p data-pid=\"IWgMuwYr\"><b>å¯ç”¨å‡½æ•°è·Ÿè¸ªï¼š</b></p><div class=\"highlight\"><pre><code class=\"language-bash\"><span class=\"nb\">echo</span> <span class=\"k\">function</span> &gt; /sys/kernel/debug/tracing/current_tracer\n<span class=\"nb\">echo</span> <span class=\"m\">1</span> &gt; /sys/kernel/debug/tracing/tracing_on</code></pre></div><p data-pid=\"voo1FZKD\"><b>æŸ¥çœ‹è·Ÿè¸ªç»“æœï¼š</b></p><div class=\"highlight\"><pre><code class=\"language-bash\">cat /sys/kernel/debug/tracing/trace</code></pre></div><p data-pid=\"RfzvSvKq\"><b>åœæ­¢è·Ÿè¸ªï¼š</b></p><div class=\"highlight\"><pre><code class=\"language-bash\"><span class=\"nb\">echo</span> <span class=\"m\">0</span> &gt; /sys/kernel/debug/tracing/tracing_on</code></pre></div><h3><b>è¾“å‡ºå†…å®¹è§£è¯»</b></h3><p data-pid=\"U6gkA2XY\">ftraceçš„è¾“å‡ºæ ¼å¼å¤§æ¦‚æ˜¯è¿™æ ·ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\"># tracer: function\n#\n# entries-in-buffer/entries-written: 140080/250280   #P:4\n#\n#                              _-----=&gt; irqs-off\n#                             / _----=&gt; need-resched\n#                            | / _---=&gt; hardirq/softirq\n#                            || / _--=&gt; preempt-depth\n#                            ||| /     delay\n#           TASK-PID   CPU#  ||||    TIMESTAMP  FUNCTION\n#              | |       |   ||||       |         |\n            bash-1994  [000] .... 12345.678901: sys_read &lt;-system_call_fastpath\n            bash-1994  [000] .... 12345.678902: vfs_read &lt;-sys_read</code></pre></div><p data-pid=\"P0PcR1B8\">è¿™é‡Œé¢ä¿¡æ¯é‡å¾ˆå¤§ï¼š</p><ul><li data-pid=\"EM1tUCrJ\">TASK-PIDï¼šè¿›ç¨‹åå’Œè¿›ç¨‹ID</li><li data-pid=\"AwwdFzfc\">CPU#ï¼šåœ¨å“ªä¸ªCPUæ ¸å¿ƒä¸Šæ‰§è¡Œ</li><li data-pid=\"iWFhzRta\">TIMESTAMPï¼šæ—¶é—´æˆ³</li><li data-pid=\"oc0xXc98\">FUNCTIONï¼šè°ƒç”¨çš„å‡½æ•°å</li></ul><p data-pid=\"aKuWh-ae\">é‚£äº›ç‚¹å’Œå­—æ¯è¡¨ç¤ºç³»ç»ŸçŠ¶æ€ï¼Œæ¯”å¦‚ä¸­æ–­æ˜¯å¦å…³é—­ã€æ˜¯å¦éœ€è¦é‡æ–°è°ƒåº¦ç­‰ç­‰ã€‚</p><h3><b>function_graphè·Ÿè¸ªå™¨</b></h3><p data-pid=\"Jq2fj4qn\">æˆ‘ä¸ªäººæ¯”è¾ƒå–œæ¬¢ç”¨function_graphè·Ÿè¸ªå™¨ï¼Œå®ƒèƒ½æ˜¾ç¤ºå‡½æ•°çš„è°ƒç”¨å…³ç³»å’Œæ‰§è¡Œæ—¶é—´ï¼š</p><div class=\"highlight\"><pre><code class=\"language-bash\"><span class=\"nb\">echo</span> function_graph &gt; /sys/kernel/debug/tracing/current_tracer\n<span class=\"nb\">echo</span> <span class=\"m\">1</span> &gt; /sys/kernel/debug/tracing/tracing_on\n<span class=\"c1\"># è¿è¡Œä½ è¦è·Ÿè¸ªçš„ç¨‹åº</span>\n<span class=\"nb\">echo</span> <span class=\"m\">0</span> &gt; /sys/kernel/debug/tracing/tracing_on\ncat /sys/kernel/debug/tracing/trace</code></pre></div><p data-pid=\"IszccKQ9\">è¾“å‡ºä¼šæ˜¯è¿™æ ·çš„ï¼š</p><div class=\"highlight\"><pre><code class=\"language-text\"> 0)               |  sys_read() {\n 0)   0.632 us    |    fget_light();\n 0)               |    vfs_read() {\n 0)   0.112 us    |      rw_verify_area();\n 0)   0.887 us    |      ext4_file_read();\n 0)   2.221 us    |    }\n 0)   3.005 us    |  }</code></pre></div><p data-pid=\"ts6fydTN\">è¿™æ ·å°±èƒ½æ¸…æ¥šåœ°çœ‹åˆ°å‡½æ•°è°ƒç”¨çš„å±‚æ¬¡å…³ç³»å’Œæ¯ä¸ªå‡½æ•°çš„æ‰§è¡Œæ—¶é—´ã€‚</p><h3><b>è¿‡æ»¤å’Œé™åˆ¶</b></h3><p data-pid=\"OXBbaCn5\">ftraceçš„è¾“å‡ºé€šå¸¸ä¼šéå¸¸å¤šï¼Œä½ éœ€è¦å­¦ä¼šè¿‡æ»¤ã€‚æ¯”å¦‚åªè·Ÿè¸ªç‰¹å®šçš„å‡½æ•°ï¼š</p><div class=\"highlight\"><pre><code class=\"language-bash\"><span class=\"nb\">echo</span> <span class=\"s1\">&#39;sys_read sys_write&#39;</span> &gt; /sys/kernel/debug/tracing/set_ftrace_filter</code></pre></div><p data-pid=\"rru2PR-P\">æˆ–è€…åªè·Ÿè¸ªç‰¹å®šè¿›ç¨‹ï¼š</p><div class=\"highlight\"><pre><code class=\"language-bash\"><span class=\"nb\">echo</span> <span class=\"m\">1234</span> &gt; /sys/kernel/debug/tracing/set_ftrace_pid</code></pre></div><h2><b>å®æˆ˜æŠ€å·§å’Œæ³¨æ„äº‹é¡¹</b></h2><p data-pid=\"CcTV21F0\">ç”¨äº†è¿™ä¹ˆå¤šå¹´ï¼Œæˆ‘æ€»ç»“äº†ä¸€äº›å®æˆ˜ç»éªŒã€‚</p><p data-pid=\"YR_UJzo2\"><b>æ€§èƒ½å½±å“è¦è€ƒè™‘</b> straceå’Œftraceéƒ½ä¼šå¯¹æ€§èƒ½äº§ç”Ÿå½±å“ï¼Œç‰¹åˆ«æ˜¯ftraceã€‚çº¿ä¸Šç¯å¢ƒä½¿ç”¨çš„æ—¶å€™ä¸€å®šè¦å°å¿ƒï¼Œæœ€å¥½åœ¨ä¸šåŠ¡ä½å³°æœŸæ“ä½œã€‚æˆ‘è§è¿‡æœ‰åŒäº‹åœ¨ç”Ÿäº§ç¯å¢ƒå¼€å¯äº†å…¨é‡ftraceè·Ÿè¸ªï¼Œç›´æ¥æŠŠæœåŠ¡å™¨æå®•æœºäº†ã€‚</p><p data-pid=\"45D0E2I-\"><b>æ—¥å¿—æ–‡ä»¶ä¼šå¾ˆå¤§</b> ç‰¹åˆ«æ˜¯ftraceï¼Œè¾“å‡ºé‡å¯èƒ½éå¸¸å¤§ã€‚è®°å¾—è®¾ç½®å¥½æ—¥å¿—è½®è½¬ï¼Œæˆ–è€…åŠæ—¶æ¸…ç†ã€‚æœ‰ä¸€æ¬¡æˆ‘å¿˜è®°å…³é—­ftraceï¼Œç»“æœ/var/logè¢«æ’‘çˆ†äº†ã€‚</p><p data-pid=\"oeqX8ZN3\"><b>ç»“åˆå…¶ä»–å·¥å…·ä½¿ç”¨</b> straceå’Œftraceæœ€å¥½é…åˆå…¶ä»–å·¥å…·ä¸€èµ·ç”¨ã€‚æ¯”å¦‚å…ˆç”¨topã€iotopæ‰¾åˆ°å¯ç–‘è¿›ç¨‹ï¼Œå†ç”¨straceè¯¦ç»†åˆ†æã€‚æˆ–è€…ç”¨perfé…åˆftraceåšæ€§èƒ½åˆ†æã€‚</p><p data-pid=\"ld5MnnnA\"><b>å­¦ä¼šçœ‹å…³é”®ä¿¡æ¯</b> è¾“å‡ºä¿¡æ¯å¤ªå¤šçš„æ—¶å€™ï¼Œè¦å­¦ä¼šæŠ“é‡ç‚¹ã€‚æ¯”å¦‚çœ‹ç³»ç»Ÿè°ƒç”¨çš„è¿”å›å€¼ã€æ‰§è¡Œæ—¶é—´ã€è°ƒç”¨é¢‘ç‡ç­‰ã€‚é”™è¯¯ä¿¡æ¯ç‰¹åˆ«è¦å…³æ³¨ï¼Œå¾€å¾€é—®é¢˜å°±è—åœ¨é‚£é‡Œã€‚</p><p data-pid=\"0NYISVBi\">æˆ‘è®°å¾—æœ‰æ¬¡æ’æŸ¥ä¸€ä¸ªç½‘ç»œé—®é¢˜ï¼Œstraceæ˜¾ç¤ºconnectç³»ç»Ÿè°ƒç”¨ä¸€ç›´è¿”å›ETIMEDOUTï¼Œä½†æ˜¯å¼€å‘åšæŒè¯´ç½‘ç»œæ²¡é—®é¢˜ã€‚åæ¥å‘ç°æ˜¯é˜²ç«å¢™è§„åˆ™æœ‰é—®é¢˜ï¼Œç‰¹å®šç«¯å£è¢«å±è”½äº†ã€‚</p><h2><b>ä¸€äº›é«˜çº§ç”¨æ³•</b></h2><p data-pid=\"y4kWRpSa\"><b>å¤šè¿›ç¨‹è·Ÿè¸ª</b></p><div class=\"highlight\"><pre><code class=\"language-bash\">strace -f -p <span class=\"m\">1234</span></code></pre></div><p data-pid=\"dclVlWSW\">-få‚æ•°å¯ä»¥è·Ÿè¸ªå­è¿›ç¨‹ï¼Œå¯¹äºå¤šè¿›ç¨‹åº”ç”¨å¾ˆæœ‰ç”¨ã€‚</p><p data-pid=\"QLJjE0RB\"><b>æ—¶é—´æˆ³æ˜¾ç¤º</b></p><div class=\"highlight\"><pre><code class=\"language-bash\">strace -t -p <span class=\"m\">1234</span></code></pre></div><p data-pid=\"yGHqmNxO\">-tæ˜¾ç¤ºæ—¶é—´æˆ³ï¼Œ-ttæ˜¾ç¤ºå¾®ç§’çº§æ—¶é—´æˆ³ï¼Œæ’æŸ¥æ€§èƒ½é—®é¢˜çš„æ—¶å€™ç‰¹åˆ«æœ‰ç”¨ã€‚</p><p data-pid=\"515WyONo\"><b>ç³»ç»Ÿè°ƒç”¨ç»Ÿè®¡</b></p><div class=\"highlight\"><pre><code class=\"language-bash\">strace -c -p <span class=\"m\">1234</span></code></pre></div><p data-pid=\"h5YxGfO7\">è¿è¡Œä¸€æ®µæ—¶é—´åæŒ‰Ctrl+Cï¼Œä¼šæ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯ï¼Œå‘Šè¯‰ä½ å“ªäº›ç³»ç»Ÿè°ƒç”¨æœ€é¢‘ç¹ã€æœ€è€—æ—¶ã€‚</p><p data-pid=\"P1E87GMb\"><b>è‡ªå®šä¹‰ftraceè„šæœ¬</b> æˆ‘å†™äº†ä¸ªç®€å•çš„è„šæœ¬æ¥è‡ªåŠ¨åŒ–ftraceæ“ä½œï¼š</p><div class=\"highlight\"><pre><code class=\"language-bash\"><span class=\"cp\">#!/bin/bash\n</span><span class=\"cp\"></span><span class=\"nv\">TRACE_DIR</span><span class=\"o\">=</span><span class=\"s2\">&#34;/sys/kernel/debug/tracing&#34;</span>\n\n<span class=\"c1\"># æ¸…ç†ä¹‹å‰çš„è·Ÿè¸ª</span>\n<span class=\"nb\">echo</span> <span class=\"m\">0</span> &gt; <span class=\"nv\">$TRACE_DIR</span>/tracing_on\n<span class=\"nb\">echo</span> &gt; <span class=\"nv\">$TRACE_DIR</span>/trace\n\n<span class=\"c1\"># è®¾ç½®è·Ÿè¸ªå™¨</span>\n<span class=\"nb\">echo</span> function_graph &gt; <span class=\"nv\">$TRACE_DIR</span>/current_tracer\n\n<span class=\"c1\"># è®¾ç½®è¿‡æ»¤å™¨</span>\n<span class=\"nb\">echo</span> <span class=\"nv\">$1</span> &gt; <span class=\"nv\">$TRACE_DIR</span>/set_ftrace_pid\n\n<span class=\"c1\"># å¼€å§‹è·Ÿè¸ª</span>\n<span class=\"nb\">echo</span> <span class=\"m\">1</span> &gt; <span class=\"nv\">$TRACE_DIR</span>/tracing_on\n\n<span class=\"nb\">echo</span> <span class=\"s2\">&#34;æ­£åœ¨è·Ÿè¸ªè¿›ç¨‹ </span><span class=\"nv\">$1</span><span class=\"s2\">ï¼ŒæŒ‰å›è½¦é”®åœæ­¢...&#34;</span>\n<span class=\"nb\">read</span>\n\n<span class=\"c1\"># åœæ­¢è·Ÿè¸ª</span>\n<span class=\"nb\">echo</span> <span class=\"m\">0</span> &gt; <span class=\"nv\">$TRACE_DIR</span>/tracing_on\n\n<span class=\"c1\"># æ˜¾ç¤ºç»“æœ</span>\ncat <span class=\"nv\">$TRACE_DIR</span>/trace</code></pre></div><p data-pid=\"oiVOX3Wz\">ç”¨æ³•å°±æ˜¯ <code>./trace.sh 1234</code>ï¼Œæ¯”æ‰‹åŠ¨æ“ä½œæ–¹ä¾¿å¤šäº†ã€‚</p><h2><b>è¸©è¿‡çš„å‘å’Œç»éªŒæ•™è®­</b></h2><p data-pid=\"5nSDcx_a\">è¯´èµ·æ¥éƒ½æ˜¯æ³ªå•Šã€‚åˆšå¼€å§‹ç”¨è¿™äº›å·¥å…·çš„æ—¶å€™ï¼Œæˆ‘è¸©äº†ä¸å°‘å‘ã€‚</p><p data-pid=\"gwjwoe8q\">æœ‰ä¸€æ¬¡ç”¨straceè·Ÿè¸ªä¸€ä¸ªæ•°æ®åº“è¿›ç¨‹ï¼Œç»“æœå‘ç°æ€§èƒ½ä¸‹é™äº†50%ï¼åŸæ¥straceå¯¹I/Oå¯†é›†å‹åº”ç”¨çš„å½±å“ç‰¹åˆ«å¤§ã€‚åæ¥æˆ‘å­¦ä¼šäº†ç”¨-eå‚æ•°åªè·Ÿè¸ªç‰¹å®šçš„ç³»ç»Ÿè°ƒç”¨ï¼Œå½±å“å°±å°å¤šäº†ã€‚</p><p data-pid=\"5rAFbqlv\">è¿˜æœ‰ä¸€æ¬¡ï¼Œæˆ‘åœ¨ç”Ÿäº§ç¯å¢ƒç”¨ftraceè·Ÿè¸ªå†…æ ¸å‡½æ•°ï¼Œç»“æœå¿˜è®°è®¾ç½®è¿‡æ»¤å™¨ï¼ŒæŠŠæ‰€æœ‰å†…æ ¸å‡½æ•°è°ƒç”¨éƒ½è®°å½•ä¸‹æ¥äº†ã€‚å‡ åˆ†é’Ÿå°±äº§ç”Ÿäº†å‡ ä¸ªGBçš„æ—¥å¿—ï¼Œå·®ç‚¹æŠŠç£ç›˜æ’‘çˆ†ã€‚ä»é‚£ä»¥åï¼Œæˆ‘éƒ½ä¼šå…ˆè®¾ç½®å¥½è¿‡æ»¤æ¡ä»¶å†å¼€å¯è·Ÿè¸ªã€‚</p><p data-pid=\"-Uhhz2sP\">æœ€å‘çš„ä¸€æ¬¡æ˜¯ï¼Œæˆ‘ç”¨straceè·Ÿè¸ªä¸€ä¸ªå¤šçº¿ç¨‹ç¨‹åºï¼Œä½†æ˜¯å¿˜è®°åŠ -få‚æ•°ï¼Œåªçœ‹åˆ°äº†ä¸»çº¿ç¨‹çš„ç³»ç»Ÿè°ƒç”¨ã€‚æŠ˜è…¾äº†åŠå¤©æ‰å‘ç°é—®é¢˜å‡ºåœ¨å­çº¿ç¨‹ä¸Šã€‚</p><h2><b>ä¸å…¶ä»–å·¥å…·çš„é…åˆ</b></h2><p data-pid=\"nAEZOCLj\">è¿™ä¸¤ä¸ªå·¥å…·è™½ç„¶å¼ºå¤§ï¼Œä½†æ˜¯å•ç‹¬ä½¿ç”¨æœ‰æ—¶å€™è¿˜ä¸å¤Ÿã€‚æˆ‘é€šå¸¸ä¼šé…åˆå…¶ä»–å·¥å…·ä¸€èµ·ç”¨ï¼š</p><p data-pid=\"u7jEY03Z\"><b>é…åˆlsofæŸ¥çœ‹æ–‡ä»¶æè¿°ç¬¦</b> straceæ˜¾ç¤ºç¨‹åºåœ¨æ“ä½œæ–‡ä»¶æè¿°ç¬¦3ï¼Œä½†æ˜¯ä½ ä¸çŸ¥é“è¿™æ˜¯ä»€ä¹ˆæ–‡ä»¶ï¼Œè¿™æ—¶å€™ç”¨lsofå°±èƒ½çœ‹åˆ°ï¼š</p><div class=\"highlight\"><pre><code class=\"language-bash\">lsof -p <span class=\"m\">1234</span></code></pre></div><p data-pid=\"Tw8CQcRB\"><b>é…åˆnetstatæŸ¥çœ‹ç½‘ç»œè¿æ¥</b> çœ‹åˆ°ç¨‹åºåœ¨è¿›è¡Œç½‘ç»œæ“ä½œï¼Œä½†ä¸çŸ¥é“è¿æ¥çŠ¶æ€ï¼Œnetstatèƒ½å¸®ä½ ï¼š</p><div class=\"highlight\"><pre><code class=\"language-bash\">netstat -anp <span class=\"p\">|</span> grep <span class=\"m\">1234</span></code></pre></div><p data-pid=\"oJJwX76h\"><b>é…åˆperfåšæ€§èƒ½åˆ†æ</b> ftraceå‘Šè¯‰ä½ å“ªä¸ªå‡½æ•°è°ƒç”¨é¢‘ç¹ï¼Œperfèƒ½å‘Šè¯‰ä½ CPUæ—¶é—´éƒ½èŠ±åœ¨å“ªé‡Œäº†ï¼š</p><div class=\"highlight\"><pre><code class=\"language-bash\">perf top -p <span class=\"m\">1234</span></code></pre></div><h2><b>ä¸€äº›å®ç”¨çš„è¿‡æ»¤æŠ€å·§</b></h2><p data-pid=\"7uNBYyE0\">è¾“å‡ºå¤ªå¤šçš„æ—¶å€™ï¼Œå­¦ä¼šè¿‡æ»¤å¾ˆé‡è¦ã€‚</p><p data-pid=\"JV-N6Mew\"><b>straceè¿‡æ»¤ç¤ºä¾‹ï¼š</b></p><div class=\"highlight\"><pre><code class=\"language-bash\"><span class=\"c1\"># åªçœ‹æ–‡ä»¶æ“ä½œ</span>\nstrace -e <span class=\"nv\">trace</span><span class=\"o\">=</span>file,desc ls\n\n<span class=\"c1\"># åªçœ‹ç½‘ç»œæ“ä½œ</span>\nstrace -e <span class=\"nv\">trace</span><span class=\"o\">=</span>network wget baidu.com\n\n<span class=\"c1\"># æ’é™¤æŸäº›ç³»ç»Ÿè°ƒç”¨</span>\nstrace -e <span class=\"nv\">trace</span><span class=\"o\">=</span>!write,read ls</code></pre></div><p data-pid=\"VLdyOcWr\"><b>ftraceè¿‡æ»¤ç¤ºä¾‹ï¼š</b></p><div class=\"highlight\"><pre><code class=\"language-bash\"><span class=\"c1\"># åªè·Ÿè¸ªç‰¹å®šå‡½æ•°</span>\n<span class=\"nb\">echo</span> <span class=\"s1\">&#39;vfs_*&#39;</span> &gt; /sys/kernel/debug/tracing/set_ftrace_filter\n\n<span class=\"c1\"># æ’é™¤æŸäº›å‡½æ•°</span>\n<span class=\"nb\">echo</span> <span class=\"s1\">&#39;!schedule*&#39;</span> &gt; /sys/kernel/debug/tracing/set_ftrace_notrace</code></pre></div><h2><b>è°ƒè¯•æŠ€å·§åˆ†äº«</b></h2><p data-pid=\"f-Vm5upV\">å¤šå¹´çš„ç»éªŒå‘Šè¯‰æˆ‘ï¼Œç”¨è¿™äº›å·¥å…·è°ƒè¯•é—®é¢˜æœ‰ä¸€äº›å¥—è·¯ã€‚</p><p data-pid=\"M60ppyAV\"><b>å…ˆç”¨straceæ‰¾åˆ°å¼‚å¸¸çš„ç³»ç»Ÿè°ƒç”¨</b> æ¯”å¦‚ç¨‹åºå¡ä½äº†ï¼Œå…ˆçœ‹çœ‹æ˜¯ä¸æ˜¯æŸä¸ªç³»ç»Ÿè°ƒç”¨é˜»å¡äº†ã€‚å¦‚æœæ˜¯ç½‘ç»œé—®é¢˜ï¼Œé€šå¸¸ä¼šçœ‹åˆ°connectæˆ–è€…readè°ƒç”¨é•¿æ—¶é—´ä¸è¿”å›ã€‚</p><p data-pid=\"_XbZ5nBm\"><b>å†ç”¨ftraceæ·±å…¥å†…æ ¸å±‚é¢</b> å¦‚æœstraceæ²¡æ‰¾åˆ°é—®é¢˜ï¼Œå¯èƒ½é—®é¢˜åœ¨å†…æ ¸å±‚é¢ã€‚è¿™æ—¶å€™ç”¨ftraceè·Ÿè¸ªç›¸å…³çš„å†…æ ¸å‡½æ•°ï¼Œçœ‹çœ‹æ˜¯ä¸æ˜¯å†…æ ¸å“ªé‡Œå‡ºäº†é—®é¢˜ã€‚</p><p data-pid=\"RRGWyEvJ\"><b>ç»“åˆæ—¶é—´æˆ³åˆ†ææ€§èƒ½</b> ç”¨-tå‚æ•°æ˜¾ç¤ºæ—¶é—´æˆ³ï¼Œçœ‹çœ‹å“ªäº›æ“ä½œè€—æ—¶æ¯”è¾ƒé•¿ã€‚æœ‰æ—¶å€™ä¸€ä¸ªç®€å•çš„æ–‡ä»¶è¯»å–æ“ä½œè€—æ—¶å‡ ç§’é’Ÿï¼Œé‚£è‚¯å®šæœ‰é—®é¢˜ã€‚</p><p data-pid=\"8py64wWB\">æˆ‘è®°å¾—æœ‰æ¬¡æ’æŸ¥ä¸€ä¸ªç¨‹åºå¯åŠ¨æ…¢çš„é—®é¢˜ï¼Œstraceæ˜¾ç¤ºç¨‹åºåœ¨è¯»å–æŸä¸ªé…ç½®æ–‡ä»¶çš„æ—¶å€™ç‰¹åˆ«æ…¢ã€‚è¿›ä¸€æ­¥åˆ†æå‘ç°ï¼Œè¿™ä¸ªæ–‡ä»¶åœ¨NFSæŒ‚è½½çš„ç›®å½•ä¸‹ï¼Œè€ŒNFSæœåŠ¡å™¨å“åº”å¾ˆæ…¢ã€‚æ¢åˆ°æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿåï¼Œå¯åŠ¨æ—¶é—´ä»30ç§’ç¼©çŸ­åˆ°3ç§’ã€‚</p><h2><b>æ€»ç»“</b></h2><p data-pid=\"kfNy0sDz\">straceå’Œftraceç¡®å®æ˜¯æ’æŸ¥é—®é¢˜çš„åˆ©å™¨ï¼Œä½†æ˜¯éœ€è¦ä¸€å®šçš„å­¦ä¹ æˆæœ¬ã€‚æˆ‘çš„å»ºè®®æ˜¯ï¼š</p><p data-pid=\"u-ndAwpe\">ä»straceå¼€å§‹å­¦èµ·ï¼Œç›¸å¯¹ç®€å•ä¸€äº›ã€‚å¤šåœ¨æµ‹è¯•ç¯å¢ƒç»ƒä¹ ï¼Œç†Ÿæ‚‰å„ç§å‚æ•°çš„ç”¨æ³•ã€‚å­¦ä¼šçœ‹å…³é”®ä¿¡æ¯ï¼Œä¸è¦è¢«å¤§é‡çš„è¾“å‡ºå“åˆ°ã€‚çº¿ä¸Šä½¿ç”¨è¦è°¨æ…ï¼Œæ³¨æ„æ€§èƒ½å½±å“ã€‚æœ€å¥½ç»“åˆå…¶ä»–å·¥å…·ä¸€èµ·ä½¿ç”¨ï¼Œæ•ˆæœä¼šæ›´å¥½ã€‚</p><p data-pid=\"8GR2gaOk\">æœ€é‡è¦çš„æ˜¯ï¼Œå·¥å…·åªæ˜¯æ‰‹æ®µï¼Œå…³é”®è¿˜æ˜¯è¦ç†è§£ç³»ç»Ÿçš„å·¥ä½œåŸç†ã€‚å½“ä½ å¯¹Linuxç³»ç»Ÿè°ƒç”¨ã€å†…æ ¸æœºåˆ¶æœ‰äº†æ›´æ·±å…¥çš„ç†è§£ï¼Œè¿™äº›å·¥å…·æ‰èƒ½çœŸæ­£å‘æŒ¥å¨åŠ›ã€‚</p><p data-pid=\"DlF2zFEC\">è¯´å®è¯ï¼ŒæŒæ¡äº†è¿™ä¸¤ä¸ªå·¥å…·ä¹‹åï¼Œæˆ‘è§£å†³é—®é¢˜çš„æ•ˆç‡æé«˜äº†ä¸å°‘ã€‚ä»¥å‰é‡åˆ°å¥‡æ€ªçš„é—®é¢˜ï¼Œåªèƒ½é çŒœæµ‹å’Œè¯•é”™ã€‚ç°åœ¨èƒ½ç›´æ¥çœ‹åˆ°ç¨‹åºåœ¨åšä»€ä¹ˆï¼Œé—®é¢˜å¾€å¾€å¾ˆå¿«å°±èƒ½å®šä½åˆ°ã€‚</p><p data-pid=\"K2miDeI1\">å½“ç„¶ï¼Œå­¦ä¹ è¿™äº›å·¥å…·ä¹Ÿä¸æ˜¯ä¸€è¹´è€Œå°±çš„ã€‚æˆ‘ç”¨äº†å¥½å‡ å¹´æ‰ç®—æ¯”è¾ƒç†Ÿç»ƒï¼ŒæœŸé—´ä¹Ÿè¸©äº†ä¸å°‘å‘ã€‚ä½†æ˜¯ä¸€æ—¦æŒæ¡äº†ï¼Œä½ ä¼šå‘ç°è¿™äº›æŠ•å…¥éƒ½æ˜¯å€¼å¾—çš„ã€‚</p><p data-pid=\"RfPVG_Y_\">å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¸®åˆ°å¤§å®¶ã€‚å¦‚æœä½ åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°ä»€ä¹ˆé—®é¢˜ï¼Œæˆ–è€…æœ‰ä»€ä¹ˆå¥½çš„ç»éªŒæƒ³åˆ†äº«ï¼Œæ¬¢è¿ç•™è¨€è®¨è®ºï¼</p><p class=\"ztext-empty-paragraph\"><br/></p><hr/><p class=\"ztext-empty-paragraph\"><br/></p><p data-pid=\"tNtu45qF\">å¦‚æœè¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œåˆ«å¿˜äº†ç‚¹ä¸ªèµ ï¼Œè½¬å‘ç»™æ›´å¤šéœ€è¦çš„æœ‹å‹ã€‚æƒ³äº†è§£æ›´å¤šè¿ç»´å¹²è´§å’Œå®æˆ˜ç»éªŒï¼Œè®°å¾—å…³æ³¨@è¿ç»´èº¬è¡Œå½•ï¼Œæˆ‘ä¼šæŒç»­åˆ†äº«æ›´å¤šæœ‰ä»·å€¼çš„æŠ€æœ¯å†…å®¹ï¼</p>",
        "favorite_count": 1222,
        "id": "1917629141840267041",
        "preview_text": "",
        "is_labeled": false,
        "vote_next_step": "vote",
        "author": {
          "id": "b99b56cf7360a8a0696ccd8bdd97d83d",
          "url": "https://api.zhihu.com/people/b99b56cf7360a8a0696ccd8bdd97d83d",
          "user_type": "people",
          "url_token": "dearisyou",
          "name": "å¤´åƒæˆ‘å¥³å„¿",
          "is_org": false,
          "gender": 1,
          "is_following": false,
          "is_followed": false,
          "headline": "ä¸ªäººåšå®¢ï¼šwww.fuzoupyy.work",
          "avatar_url": "https://picx.zhimg.com/50/v2-8079941e4b19752e816a1ccbfdc95506_l.jpg?source=b6762063",
          "followers_count": 485
        },
        "preview_type": "default",
        "visited_count": 35694,
        "answer_type": "normal",
        "navigator_vote": false,
        "allow_segment_interaction": true,
        "url": "https://api.zhihu.com/answers/1917629141840267041"
      },
      "brief": "{\"source\": \"TS\", \"type\": \"answer\", \"id\": 1917629141840267041}",
      "attached_info": "Cq4GCNX3q7PPnMfysAEQBBoJNzMyMzI0ODYxIK+ausIGKO4CMB5ANUovCgZJdGVtQ0YSH2RvY190eXBlOiBBbnN3ZXIKaWQ6IDc1Njg5MDAxNwoYACAAOgBKKAodVFNfU09VUkNFX05FQVJMSU5FX0NPTlRFTlRfVjISATAYACAAOgBaCDY3NDk3MzgzYiBmYjc0NGUyOTE4MTBjNzNjODM2MjA0ZGE5MmQ0MDBkMnITMTkxNzYyOTE0MTg0MDI2NzA0MYoBCTQ3MzQ3OTAxOKoBCXJlY29tbWVuZMIBIGI5OWI1NmNmNzM2MGE4YTA2OTZjY2Q4YmRkOTdkODNk8gEKCAwSBk5vcm1hbPIBKAgKEiRjZDFmOGI2MS0wYWZmLTQ4MGItODhlZS00ODI3OGE0ZDlhZDfyAQUICxIBOYICAIgCquKZxrwzkgIgYjk5YjU2Y2Y3MzYwYThhMDY5NmNjZDhiZGQ5N2Q4M2SaAgDKAhZTaG9ySW50ZXJlc3RXZWlnaHRSdWxlygIWQWN0aW9uU2hvckludGVyZXN0UnVsZcoCG0ludGVyYWN0aW9uU2hvckludGVyZXN0UnVsZcoCGFBlcmlvZEludGVyZXN0V2VpZ2h0UnVsZcoCFENvbnRlbnRBZ2VXZWlnaHRSdWxlygIXVGVzdGVkQW5kV29ya1dlaWdodFJ1bGXaAgZJdGVtQ0boAgP6AgtOT1JNQUxfRkxPV4oDIDgwNWY4ODBkMDUyOTQ4YzFhNzUzMThhOTczODFhYzllmgMNCgJ2MhAAGgVvdGhlcqgD7pYC2AMA6gMVdGV4dEFsbFNpdGVNdkl0ZW1DRlYy+gMfEgxVTktOT1dOX01PREUgACoNTk9fSU1BR0VfTU9ERYAEAIgEAJIEBk5vcm1hbJoEATOgBACoBACwBAC6BAZtYW51YWzCBAMxNzDIBADSBA/mjqjojZDlt7Lmm7TmlrDYBADwBAD5BAAAAIDaO5k/gQUAAAAAAAAAAIkFYm0sOUbTsz+SBQCaBQNkZnSiBQNkZnSyBQExuQUAAAAAAAAAANAFAOAFAOgFAPAFCZAGAKAGN6gGAJICLgoJNzMyMzI0ODYxEhMxOTE3NjI5MTQxODQwMjY3MDQxGAQiCklNQUdFX1RFWFQ=",
      "action_card": false
    }
  ],
  "paging": {
    "is_end": false,
    "is_start": false,
    "next": "https://www.zhihu.com/api/v3/feed/topstory/recommend?action=down&ad_interval=-10&after_id=53&desktop=true&end_offset=55&page_number=10&session_token=fb744e291810c73c836204da92d400d2",
    "previous": "https://www.zhihu.com/api/v3/feed/topstory/recommend?action=pull&ad_interval=-10&before_id=53&desktop=true&end_offset=55&page_number=10&session_token=fb744e291810c73c836204da92d400d2",
    "totals": 0
  },
  "fresh_text": "æ¨èå·²æ›´æ–°"
}